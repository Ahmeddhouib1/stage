block_text,block_label
"@pin_code @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  dukpt pin for msr transaction when encryption is off
""""""
This feature file verify pin block decryption is correct for msr transaction when encryption is off
based on ticket https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1252
""""""
Scenario Outline: verify pin block decryption is correct for msr transaction when encryption is off
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
##################select dukpt pin################""",Precondition
"When I send a 60.x Configuration Write message to the terminal with:
| p60_req_group_num         | 6 |
| p60_req_index_num         | 7 |
| p60_req_data_config_param | 1 |
Then I should receive the 60.x Configuration Write response from terminal with params:
| p60_res_status | 2 |
When I send a 60.x Configuration Write message to the terminal with:
| p60_req_group_num         | 6 |
| p60_req_index_num         | 8 |
| p60_req_data_config_param | 0 |",Unknown
"Then I should receive the 60.x Configuration Write response from terminal with params:
| p60_res_status | 2 |
################## swipe the card #########################""",Unknown
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      |                                              |
#################### send 31.x message for pin entry #############################",CVM Process
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1     |
| p31_req_customer_acc_num             | <pan> |
| p31_req_set_encryption_configuration | *     |
| p31_req_set_key_type                 | D     |
| p31_req_form_name                    |       |
############################### enter pin #############################
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |
################################# decrypt the enetered pin ###############################",CVM Process
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |",Unknown
"@41x @msr @00x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:Swipe Transaction with 41.x Card Read with parse fields
""""""
This feature file Validates MSR transaction using 41.x Card Read Request
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1160.
""""""
Scenario Outline:  Check MSR flow using 41.x (track1 ,track2)",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
Then I wait for 23 seconds,Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |",Unknown
And I wait for 2 seconds,Unknown
"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                            |
| p41_res_encryption      | 00                                           |
| p41_res_track_1_status  | 0                                            |
| p41_res_track_2_status  | 0                                            |
| p41_res_track_3_status  | 1                                            |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_track_3         |                                              |
| p41_res_pan             | <pan>                                        |
| p41_res_masked_pan      | <pan>                                        |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_account_name    | <name>                                       |
| p41_res_error_code      | 0                                            |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data |<name>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |",Extract Card Data
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | pan                 | name                      | exp_date | code | disc_data_t1         | disc_data_t2  |
| MasterCard | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 122560965000469      | 965000469     |
| VISA       | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372      | 887693372     |
| AMEX 1     | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 57431313685          | 13685         |
| DISCOVER   | 6510000000000091    | CARD/IMAGE 09             | 1712     | 702  | 1000041300000        | 1000041300000 |
| Diners     | 36039667170472      | PETTITT/JO                | 0012     | 521  | 16010000000000000946 | 1000041300000 |
Scenario Outline:  Check MSR flow using 41.x (track1 only)
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
Then I wait for 3 seconds,Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data |                                              |
| track3_data |                                              |",Unknown
And I wait for 2 seconds,Unknown
"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                            |
| p41_res_encryption      | 00                                           |
| p41_res_track_1_status  | 0                                            |
| p41_res_track_2_status  | 1                                            |
| p41_res_track_3_status  | 1                                            |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_track_2         |                                              |
| p41_res_track_3         |                                              |
| p41_res_pan             | <pan>                                        |
| p41_res_masked_pan      | <pan>                                        |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_account_name    | <name>                                       |
| p41_res_error_code      | 0                                            |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data |<name>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |",Extract Card Data
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | pan                 | name                      | exp_date | code | disc_data_t1         |
| MasterCard | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 122560965000469      |
| VISA       | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372      |
| AMEX 1     | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 57431313685          |
| DISCOVER   | 6510000000000091    | CARD/IMAGE 09             | 1712     | 702  | 1000041300000        |
| Diners     | 36039667170472      | PETTITT/JO                | 0012     | 521  | 16010000000000000946 |
Scenario Outline: Check MSR flow while using 41.x (track2 only)
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
Then I wait for 3 seconds,Unknown
"When I swipe card using this params:
| track1_data |                                      |
| track2_data | <pan>=<exp_date><code><disc_data_t2> |
| track3_data |                                      |",Unknown
And I wait for 2 seconds,Unknown
"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                    |
| p41_res_encryption      | 00                                   |
| p41_res_track_1_status  | 1                                    |
| p41_res_track_2_status  | 0                                    |
| p41_res_track_3_status  | 1                                    |
| p41_res_track_1         |                                      |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2> |
| p41_res_track_3         |                                      |
| p41_res_pan             | <pan>                                |
| p41_res_masked_pan      | <pan>                                |
| p41_res_expiration_date | <exp_date>                           |
| p41_res_account_name    |                                      |
| p41_res_error_code      | 0                                    |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data |        |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |",Extract Card Data
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | pan              | name                      | exp_date | code | disc_data_t2  |
| MasterCard | 45358179327829   | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 965000469     |
| VISA       | 34798979016630   | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 823693372     |
| AMEX 1     | 37158413190797   | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 13685         |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09             | 1712     | 702  | 1000041300000 |
| Diners     | 36039667170472   | PETTITT/JO                | 0012     | 521  | 1000041300000 |",Precondition
"@sde @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate On-Guard SDE Encryption for MSR transaction with 1 only track card data
""""""
This feature file validates Validate On-Guard SDE Encryption for MSR transaction with one track only card data
based on ticket ARC-5325
""""""
Scenario: Enable On-Guard SDE Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |",Unknown
"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track1 data
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 |                                              |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      |                                                              |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | masked_pan       | masked_disc_data_t1          | null_characters          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 5413330000000011 | 000000000000000              | \x00\x00\x00\x00\x00\x00 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 374245000001008  | 000000000                    | \x00\x00\x00\x00         |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 4264510000005621 | 0000000000000000000000000000 |                          |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 6510000000000091 | 0000000000000                | \x00\x00\x00\x00         |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 36039600000472   | 00000000000000000000         | \x00\x00                 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track2 data",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 |                                      |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| track3 |                                      |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                    |
| p23_res_card_source | M                                                    |
| p23_res_track1      |                                                      |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>? |
| p23_res_track3      | @regexp:.+                                           |",Card Swipe
"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | <pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | exp_date | code | disc_data_t2   | masked_pan       | masked_disc_data_t2 | null_characters      |
| Mastercard | 5413330089020011 | 2412     | 221  | 0000014000001  | 5413330000000011 | 0000000000000       | \x00\x00\x00         |
| Amex       | 374245001731008  | 2103     | 201  | 15041234500000 | 374245000001008  | 00000000000000      | \x00\x00\x00         |
| VISA       | 4264510228395621 | 1709     | 206  | 0000070400100  | 4264510000005621 | 0000000000000       | \x00\x00\x00         |
| DISCOVER   | 6510000000000091 | 1712     | 702  | 1000041300000  | 6510000000000091 | 0000000000000       | \x00\x00\x00         |
| Diners     | 36039667170472   | 0012     | 521  | 1000041300000  | 36039600000472   | 0000000000000       | \x00\x00\x00\x00\x00 |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@p2p @chapter_x @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: validate chapter X Decryption
""""""
This feature file validates chapterX Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1348
""""""
Scenario Outline: chapter X Encryption For MSR Transaction",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"And decrypted field 'p23_res_track3' with Chapter X algorithm should match the following data:
| ret                 | 00                                                         |
| ez_track2_decrypted | <pan>D<exp_date><code><disc_data_t2><null_characters>      |
| ey_track1_decrypted | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>.+$ |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000000000000     | 0000000000000       | FFFFFFFFFFF     |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | FFFFFFFFFFF     |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | FFFFFFFFFFF     |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | FFFFFFFFFFF     |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | FFFFFFFFFFFFF   |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       | FFFFFFFFFFF     |
| Mastercard | 541389099130     | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 541389000130     | 00000000000000000000         | 0000000000000       | FFFFFFFFFFFFFFF |
@msr @fpe @00x @61x @23x @62x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate On Guard FPE Encryption for MSR Transaction
""""""
This feature file validates On Guard FPE Encryption For MSR Transaction
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-993.
""""""
Scenario Outline: On-Guard FPE Encryption For MSR Transaction",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"And decrypted field ""p23_res_track3"" with ON GUARD algorithm should match the following MSR data:
| track2 | <pan>=<exp_date><code><disc_data_t2> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |
@sde @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate On-Guard SDE Encryption for MSR transaction
""""""
This feature file validates On-Guard SDE Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-985
""""""
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
#Step 5",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\|<pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |                          |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |                          |
@rsa @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate RSA Encryption for MSR transaction
""""""
This feature file validates RSA Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1313
""""""
Scenario Outline: RSA Encryption For MSR Transaction
#Step 5",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"When RSA OAEP algorithm private key is set to 'Files\p2p_encryptions\private_RSA_key\private_verify_key.pem'
Then raw field 'p23_res_track3' with RSA OAEP algorithm should have the following attributes:
| cryptogram_length | 344 |
And decrypted field 'p23_res_track3' with RSA OAEP algorithm should match '%B<pan>^<name>^<exp_date><code><disc_data_t1>?;<pan>=<exp_date><code><disc_data_t2>?'
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000000000000     | 0000000000000       |                          |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |                          |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |                          |
@sde @msr @00x @62x @61x @23x
Feature: Validate separator of On-Guard SDE Encryption for Manual Entry transaction
""""""
This feature file validates separator of On-Guard SDE Encryption for Manual Entry transaction
based on ticket    https://ingenico-nar.atlassian.net/browse/ARC-1299
Note : ArcSec.json used in current FF is the version from DefaultConfig of ARC Build ""arc-app-23.09.03-0001""
""""""
@dx8000 @ex8000 @dx4000
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
##################### Enable Onguard_SDE with specific separator #####################
And a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
##################### ########################################## #####################",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
##################### Verify Onguard_SDE enabled #####################
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
##################### ##################### #####################",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 372 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Card""
And  I wait until Element ""btn_cancel"" visible
And  I wait until Element ""btn_manual_entry"" visible",Card Swipe
"When I click Element ""btn_manual_entry""
##################### Enter card details #####################
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"And I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"And I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"And I click Element ""btn_manual_confirm""",Unknown
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                             |
| p23_res_card_source | H                                                             |
| p23_res_track1      | %M<masked_pan>^<name>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.{1,92}                                               |",Card Swipe
"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | <pan><separator><expect_exp_date><separator><code><null_characters> |
Examples:
| card_type  | pan                 | name             | exp_date | expect_exp_date | code | masked_pan          | masked_disc_data_t1 | masked_disc_data_t2 | null_characters              | separator | ASCII |
| Mastercard | 5413332389          | MANUALLY/ENTERED | 1224     | 2412            | 221  | 5413330009          | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | #         | 23    |
| Amex       | 374245001748        | MANUALLY/ENTERED | 1225     | 2512            | 201  | 374245000748        | 000000000000000     | 000000000000        | \x00\x00\x00                 | ;         | 3B    |
| VISA       | 42645122835621      | MANUALLY/ENTERED | 1227     | 2712            | 206  | 42645100005621      | 000000000000000     | 000000000000        | \x00                         | \|        | 7C    |
| DISCOVER   | 6510000000352591    | MANUALLY/ENTERED | 1227     | 2712            | 702  | 6510000000002591    | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00\x00 | %         | 25    |
| Diners     | 36039667176631472   | MANUALLY/ENTERED | 1228     | 2812            | 521  | 36039600000001472   | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00     | &         | 26    |
| VISA       | 476173900101012010  | MANUALLY/ENTERED | 1229     | 2912            | 201  | 476173000000002010  | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | \x20      | 20    |
| JCB        | 3569990010745082211 | MANUALLY/ENTERED | 1225     | 2512            | 601  | 3569990000000002211 | 000000000000000     | 000000000000        | \x00\x00\x00\x00             | ,         | 2C    |
| Mastercard | 5413330089099130    | MANUALLY/ENTERED | 1226     | 2612            | 201  | 5413330000009130    | 000000000000000     | 000000000000        | \x00                         |           | empty |
@rx5000 @rx7000
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
##################### Enable Onguard_SDE with specific separator #####################
And a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
##################### ########################################## #####################",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
##################### Verify Onguard_SDE enabled #####################
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
##################### ##################### #####################",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 372 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Card""
And  I wait until Element ""btn_cancel"" visible
And  I wait until Element ""btn_manual_entry"" visible",Card Swipe
"When I click Element ""btn_manual_entry""
##################### Enter card details #####################
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"And I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"And I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>"" and then ENTER",Unknown
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                             |
| p23_res_card_source | H                                                             |
| p23_res_track1      | %M<masked_pan>^<name>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.{1,92}                                               |",Card Swipe
"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | <pan><separator><expect_exp_date><separator><code><null_characters> |
Examples:
| card_type  | pan                 | name             | exp_date | expect_exp_date | code | masked_pan          | masked_disc_data_t1 | masked_disc_data_t2 | null_characters              | separator | ASCII |
| Mastercard | 5413332389          | MANUALLY/ENTERED | 1224     | 2412            | 221  | 5413330009          | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | #         | 23    |
| Amex       | 374245001748        | MANUALLY/ENTERED | 1225     | 2512            | 201  | 374245000748        | 000000000000000     | 000000000000        | \x00\x00\x00                 | ;         | 3B    |
| VISA       | 42645122835621      | MANUALLY/ENTERED | 1227     | 2712            | 206  | 42645100005621      | 000000000000000     | 000000000000        | \x00                         | \|        | 7C    |
| DISCOVER   | 6510000000352591    | MANUALLY/ENTERED | 1227     | 2712            | 702  | 6510000000002591    | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00\x00 | %         | 25    |
| Diners     | 36039667176631472   | MANUALLY/ENTERED | 1228     | 2812            | 521  | 36039600000001472   | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00     | &         | 26    |
| VISA       | 476173900101012010  | MANUALLY/ENTERED | 1229     | 2912            | 201  | 476173000000002010  | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | \x20      | 20    |
| JCB        | 3569990010745082211 | MANUALLY/ENTERED | 1225     | 2512            | 601  | 3569990000000002211 | 000000000000000     | 000000000000        | \x00\x00\x00\x00             | ,         | 2C    |
| Mastercard | 5413330089099130    | MANUALLY/ENTERED | 1226     | 2612            | 201  | 5413330000009130    | 000000000000000     | 000000000000        | \x00                         |           | empty |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Teardown - Reset to Default State
Given a existing file ""Files/p2p_encryptions/ArcNoEncryption.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"@msr @tep6 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Voltage Encryption Tep6 for MSR Transaction
""""""
This feature file validates Voltage Encryption TEP6 for MSR Transaction.
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1266
""""""
Scenario Outline: Voltage TEP6 Encryption for MSR transaction",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
And I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 31 |",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"And  I wait until Element ""btn_cancel"" visible
#this step is equivalent to the manual swipe of a card
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |",Card Swipe
"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |",Extract Card Data
"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
#  | Maestro    | 501833000060       | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
#issue is when pan=12 digits to be checked",Extract Card Data
"@msr @tep7 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Voltage Encryption Tep7 for MSR Transaction
""""""
This feature file validates Voltage Encryption TEP7 for MSR Transaction.
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1309
""""""
Scenario Outline: Voltage TEP7 Encryption for MSR transaction",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
And I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
And I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 32 |",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"And  I wait until Element ""btn_cancel"" visible
#this step is equivalent to the manual swipe of a card
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |",Card Swipe
"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
And I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |",Extract Card Data
"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
#  | Maestro    | 501833000060        | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
#issue is when pan=12 digits to be checked",Extract Card Data
"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: change weak pin with a strong entered pin with msr transaction
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1384
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and change weak pin with a strong entered pin
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################",Precondition
"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |",CVM Process
"#And I Wait until Element ""fixed_title"" contains ""Please enter your PIN:""",Unknown
"And I enter pin ""<weak_pin>""
######################## enter the new strong pin #####################",Unknown
And I wait for 4 seconds,Unknown
"And I enter pin ""<strong_pin>""
################### validate the new strong pin #######################",Unknown
And I wait for 4 seconds,Unknown
"And I enter pin ""<strong_pin>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"And I Wait until Element ""fixed_title"" contains ""Please reenter your 4-digit PIN""
################# variable is back to false after pin change ##########################",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | false  |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |",Extract Card Data
"@pin_code @master_session @sde @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when SDE is enabled
""""""
This feature file verify pin block decryption is correct when SDE is enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable On-Guard SDE Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |",Unknown
"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
Scenario Outline: verify pin block decryption is correct with masked pan
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+:4:.+                                              |",Card Swipe
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1            |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_set_encryption_configuration | 0            |
| p31_req_set_key_type                 | *            |
| p31_req_form_name                    |              |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@00x @29x @60x @23x @87x @41x
Feature: verify message 29.x of variables 396 398 399 400
""""""
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
""""""
@dx8000 @ex8000 @dx4000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400
Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Extract Card Data
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible",Unknown
"And I click Element ""btn_manual_entry""
When I click Element ""ed_pan""",Unknown
"Then I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"Then I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"Then I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                     |
| p23_res_card_source | H                                                                     |
| p23_res_track1      | M<pan>^<cardholdername>^<expect_exp_date><add_data1><code><add_data1> |
| p23_res_track2      | <pan>=<expect_exp_date><add_data1><code><add_data2>                   |
| p23_res_track3      |                                                                       |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | add_data2 | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | 000       | MANUALLY/ENTERED |
@rx5000 @rx7000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible",Unknown
"And I click Element ""btn_manual_entry""
When I click Element ""ed_pan""",Unknown
"Then I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"Then I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                     |
| p23_res_card_source | H                                                                     |
| p23_res_track1      | M<pan>^<cardholdername>^<expect_exp_date><add_data1><code><add_data1> |
| p23_res_track2      | <pan>=<expect_exp_date><add_data1><code><add_data2>                   |
| p23_res_track3      |                                                                       |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | add_data2 | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | 000       | MANUALLY/ENTERED |
@dx8000 @ex8000 @dx4000 @me
Scenario Outline: Manual entry transaction with 87.x and 29.x message to verify variables 396 398 399 400",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 1          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible",Unknown
"And I click Element ""btn_manual_entry""
When I click Element ""ed_pan""",Unknown
"Then I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"Then I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"Then I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                        |
| p87_res_card_source | H                                                                        |
| p87_res_card_data   | @regexp:^M<pan>\^<cardholdername>\^<expect_exp_date><add_data1><code>.*$ |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | MANUALLY/ENTERED |
@rx5000 @rx7000 @me
Scenario Outline: Manual entry transaction with 87.x and 29.x message to verify variables 396 398 399 400",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 1          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible",Unknown
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER",Unknown
"Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                        |
| p87_res_card_source | H                                                                        |
| p87_res_card_data   | @regexp:^M<pan>\^<cardholdername>\^<expect_exp_date><add_data1><code>.*$ |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | MANUALLY/ENTERED |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Scenario Outline: MSR transaction with 23.x and 29.x message to verify variables 394 395 396 398 399 400",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |",Unknown
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      |                                              |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | amount | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  |
| Mastercard | 120    | 5413339000000119 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Scenario Outline: MSR transaction with 41.x and 29.x message to verify variables 394 395 396 398 399 400",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
Then I wait for 23 seconds,Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |",Unknown
And I wait for 2 seconds,Unknown
"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                            |
| p41_res_encryption      | 00                                           |
| p41_res_track_1_status  | 0                                            |
| p41_res_track_2_status  | 0                                            |
| p41_res_track_3_status  | 1                                            |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_track_3         |                                              |
| p41_res_pan             | <pan>                                        |
| p41_res_masked_pan      | <pan>                                        |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_account_name    | <name>                                       |
| p41_res_error_code      | 0                                            |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type | pan              | name          | exp_date | code | disc_data_t1  | disc_data_t2  |
| DISCOVER  | 6510000000000091 | CARD/IMAGE 09 | 1712     | 702  | 1000041300000 | 1000041300000 |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Scenario Outline: MSR transaction with 87.x and 29.x message to verify variables 394 395 396 398 399 400",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                                                    |
| p87_res_card_source | M                                                                                                    |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type | pan            | name                      | exp_date | code | disc_data_t1    | disc_data_t2 |
| VISA      | 34798979016630 | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372 | 887693372    |",Extract Card Data
"@sde @msr @00x @60x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate track encryption indicator values
""""""
This feature file validates track encryption indicator with its values for msr track1 , track2 , track1&2
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1800
""""""
Scenario: Enable On-Guard SDE Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |",Unknown
"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track1 data and track encryption indicator =1
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 |                                              |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      |                                                              |
| p23_res_track3      | @regexp:.+:1:.+                                              |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | masked_pan       | masked_disc_data_t1          | null_characters          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 5413330000000011 | 000000000000000              | \x00\x00\x00\x00\x00\x00 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 374245000001008  | 000000000                    | \x00\x00\x00\x00         |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 4264510000005621 | 0000000000000000000000000000 |                          |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 6510000000000091 | 0000000000000                | \x00\x00\x00\x00         |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 36039600000472   | 00000000000000000000         | \x00\x00                 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track2 data and track encryption indicator = 2",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 |                                      |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| track3 |                                      |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                    |
| p23_res_card_source | M                                                    |
| p23_res_track1      |                                                      |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>? |
| p23_res_track3      | @regexp:.+:2:.+                                      |
Examples:
| card_type  | pan              | exp_date | code | disc_data_t2   | masked_pan       | masked_disc_data_t2 | null_characters      |
| Mastercard | 5413330089020011 | 2412     | 221  | 0000014000001  | 5413330000000011 | 0000000000000       | \x00\x00\x00         |
| Amex       | 374245001731008  | 2103     | 201  | 15041234500000 | 374245000001008  | 00000000000000      | \x00\x00\x00         |
| VISA       | 4264510228395621 | 1709     | 206  | 0000070400100  | 4264510000005621 | 0000000000000       | \x00\x00\x00         |
| DISCOVER   | 6510000000000091 | 1712     | 702  | 1000041300000  | 6510000000000091 | 0000000000000       | \x00\x00\x00         |
| Diners     | 36039667170472   | 0012     | 521  | 1000041300000  | 36039600000472   | 0000000000000       | \x00\x00\x00\x00\x00 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with track1 and track2 data and track encryption indicator =4",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+:4:.+                                              |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       |
Scenario: Teardown - Reset to Default State",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate an invalid PIN change where the cardholder will enter the same weak PIN in the first and second attempt
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1385
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter the same weak PIN in the first and second attempt.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder will enter the same weak PIN in the first and second attempt
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################",Precondition
"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>""
######################## enter the same weak pin again #####################",CVM Process
And I wait for 4 seconds,Unknown
"And I enter pin ""<weak_pin>""
####### 31.x should return A because the second pin entry is same as the first weak pin entered################### #######################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | A |
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################",CVM Process
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |",Extract Card Data
"@41x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Swipe non standard cards
""""""
This feature file Validates MSR transaction For Non Standard Card using 41.x Card Read Request
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1208
""""""
Scenario Outline: Check MSR flow while using Non-Standard cards with two tracks(track1 ,track2)",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
And I wait for 2 seconds,Unknown
"And I swipe card using this params:
| track1_data | <track1_data> |
| track2_data | <track2_data> |
| track3_data |               |",Unknown
And I wait 3 seconds,Unknown
"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M             |
| p41_res_encryption      | 00            |
| p41_res_track_1_status  | 0             |
| p41_res_track_2_status  | 0             |
| p41_res_track_3_status  | 1             |
| p41_res_track_1         | <track1_data> |
| p41_res_track_2         | <track2_data> |
| p41_res_track_3         |               |
| p41_res_pan             | <pan>         |
| p41_res_masked_pan      | <masked_pan>  |
| p41_res_expiration_date | <exp_date>    |
| p41_res_account_name    | <name>        |
| p41_res_error_code      | 0             |",Unknown
"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Examples:
| type                                                             | track1_data                                                     | track2_data                            | track1_res                                                      | track2_res                             | pan                    | masked_pan             | exp_date | name                |
| NonStandard card -- ISO parser                                   | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | 4147200000002105       | 4147200000002105       | 2603     |                     |
| NonStandard card -- Track 1 and Track 2 pan-only                 | 1234567890123456                                                | 1234567890123456                       | 1234567890123456                                                | 1234567890123456                       | 1234567890123456       | 1234567890123456       |          |                     |
| NonStandard card -- Non Payment card                             | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 0000198800001234560011 | 0000198800001234560011 | 2012     |                     |
| NonStandard card -- FDMS TEST CARD/VISA modified without exp-dat | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | 4000620001234803       | 4000620001234803       |          | FDMS TEST CARD/VISA |
Scenario Outline: Check MSR flow while using Non-Standard cards with track1 only
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 41.x Card Read Message message to the terminal with:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
And I wait for 2 seconds,Unknown
"And I swipe card using this params:
| track1_data | <track1_data> |
| track2_data |               |
| track3_data |               |",Unknown
And I wait 3 seconds,Unknown
"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M             |
| p41_res_encryption      | 00            |
| p41_res_track_1_status  | 0             |
| p41_res_track_2_status  | 1             |
| p41_res_track_3_status  | 1             |
| p41_res_track_1         | <track1_data> |
| p41_res_track_2         |               |
| p41_res_track_3         |               |
| p41_res_pan             | <pan>         |
| p41_res_masked_pan      | <masked_pan>  |
| p41_res_expiration_date |               |
| p41_res_account_name    |               |
| p41_res_error_code      | 0             |",Unknown
"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Examples:
| type                                 | track1_data                        | track1_res                         | pan                         | masked_pan                  | exp_date | name |
| NonStandard Card -- Track 1 pan-only | 1234567890123456                   | 1234567890123456                   | 1234567890123456            | 1234567890123456            | 2603     |      |
| NonStandard Card -- Non Payment card | 10063576813       1234567890123456 | 10063576813       1234567890123456 | 100635768131234567890123456 | 100635768131234567890123456 |          |      |
| NonStandard Card -- Track 1 pan-only | 5413339000000119                   | 5413339000000119                   | 5413339000000119            | 5413339000000119            | 2012     |      |
Scenario Outline: Check MSR flow while using Non-Standard cards with track2 only
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
And I wait for 2 seconds,Unknown
"And I swipe card using this params:
| track1_data |               |
| track2_data | <track2_data> |
| track3_data |               |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M             |
| p41_res_encryption      | 00            |
| p41_res_track_1_status  | 1             |
| p41_res_track_2_status  | 0             |
| p41_res_track_3_status  | 1             |
| p41_res_track_1         |               |
| p41_res_track_2         | <track2_data> |
| p41_res_track_3         |               |
| p41_res_pan             | <pan>         |
| p41_res_masked_pan      | <masked_pan>  |
| p41_res_expiration_date | <exp_date>    |
| p41_res_account_name    | <name>        |
| p41_res_error_code      | 0             |",Unknown
"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Examples:
| type                                 | track2_data                            | track2_res                             | pan                    | masked_pan             | exp_date | name |
| NonStandard Card -- Track 2 pan-only | 1234567890123456                       | 1234567890123456                       | 1234567890123456       | 1234567890123456       |          |      |
| NonStandard Card -- Track 2 pan-only | B4445222AE299990007                    | B4445222AE299990007                    |                        |                        |          |      |
| NonStandard Card -- Non Payment card | 0000198800001234560011=2012=0000002008 | 0000198800001234560011=2012=0000002008 | 0000198800001234560011 | 0000198800001234560011 | 2012     |      |
| NonStandard Card -- Gift ECR         | 1234567897=251210100000001             | 1234567897=251210100000001             | 1234567897             | 1234567897             | 2512     |      |",Precondition
"@sde @msr @00x @62x @61x @23x
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate separator of On-Guard SDE Encryption for MSR transaction
""""""
This feature file validates separator of On-Guard SDE Encryption for MSR transaction
based on ticket    https://ingenico-nar.atlassian.net/browse/ARC-1299
Note : ArcSec.json used in current FF is the version from DefaultConfig of ARC Build ""arc-app-23.09.02-0006""
""""""
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
##################### Enable Onguard_SDE with specific separator #####################
Given a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
##################### ########################################## #####################",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
##################### Verify Onguard_SDE enabled #####################
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
##################### ##################### #####################",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.{1,252}                                             |",Card Swipe
"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1><separator><pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          | separator | ASCII |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          | #         | 23    |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2512     | 201  | 150412345                    | 1504123450    |                      | 374245000001008  | 000000000                    | 0000000000          | \x00\x00                 | ;         | 3B    |
| VISA       | 4264510228395621 | JOHN/SMITH         | 2712     | 206  | 0000000000000000000704001000 | 0000070400100 | 123456789            | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 | \|        | 7C    |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 2712     | 702  | 1000041300000                | 1000041300999 |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 | %         | 25    |
| Diners     | 36039667170472   | PETTITT/JO         | 2812     | 521  | 160100000000000007778946     | 1000051300000 | 0123456789           | 36039600000472   | 000000000000000000000000     | 0000000000000       | \x00\x00                 | &         | 26    |
| VISA       | 4761739001010010 | VISA Credit        | 2912     | 201  | 16010000000000000946         | 10000413      | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 00000000            | \x00\x00\x00\x00\x00\x00 | \x20      | 20    |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 601  | 16010000000000946            | 1000041300000 | 01234567890123456789 | 5413330000009130 | 00000000000000000            | 0000000000000       | \x00\x00\x00\x00         |           | empty |
| JCB        | 3569990010082211 | JCB/TEST           | 2612     | 201  | 1234567891234                | 987654321098  | 01234567890123456789 | 3569990000002211 | 0000000000000                | 000000000000        | \x00\x00\x00\x00         | ,         | 2C    |
Scenario: Teardown - Reset to Default State
Given a existing file ""Files/p2p_encryptions/ArcNoEncryption.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"@p2p @secbin @msr @chapter_x @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: validate whitelisting with chapter X Decryption
""""""
This feature file validates whitelisting with chapterX Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1356
""""""
Scenario: Enable Whitelisting Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p62_req_file_name       | apstitan_on.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
Scenario Outline: whitelisting with chapter X Encryption For MSR Transaction",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |",Unknown
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 541389099130     | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
Scenario: Teardown - Reset to Default State",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
| p62_req_file_name       | apstitan_off.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
@msr @fpe @secbin @00x @61x @23x @62x @13x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Whitelisting With On Guard FPE Encryption for MSR Transaction
""""""
This feature file validates whitelisting for MSR Transaction
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-977.
""""""
Scenario: Enable Whitelisting Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p62_req_file_name       | apstitan_on.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
Scenario Outline: Whitelisting with on guard FPE for MSR Transaction",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |",Card Swipe
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  |                 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                 |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  |                 |
Scenario: Teardown - Reset to Default State",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
| p62_req_file_name       | apstitan_off.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
@rsa @msr @secbin @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate RSA Encryption for MSR transaction
""""""
This feature file validates RSA Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1335
""""""
Scenario: Enable Whitelisting Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p62_req_file_name       | apstitan_on.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
Scenario Outline: RSA Encryption For MSR Transaction
#Step 5",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"And  I wait until Element ""btn_cancel"" visible
#this step is equivalent to the manual swipe of a card
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | @regexp:.*                                   |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
| Maestro    | 501833000060        | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
Scenario: Teardown - Reset to Default State",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
| p62_req_file_name       | apstitan_off.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |",Unknown
"@pin_code @master_session @fpe @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when FPE enabled
""""""
This feature file verify pin block decryption is correct when FPE enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable On-Guard FPE Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardFPE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
Scenario Outline: verify pin block decryption is correct with masked pan",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1            |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_set_encryption_configuration | 0            |
| p31_req_set_key_type                 | *            |
| p31_req_form_name                    |              |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110044 | 8          | ffffff     |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234123  | 7          | fffffff    |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@00x @29x @60x @23x @87x @41x @fpe
Feature: verify message 29.x of variables 396 398 399 400
""""""
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
""""""
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
Scenario: Enable On-Guard FPE Encryption Configuration
########## Enable FPE encryption###############",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardFPE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
@dx8000 @ex8000 @dx4000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when FPE encryption enabled
########## start transaction ###############
Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Extract Card Data
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible",Unknown
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^<cardholdername>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.*                                                              |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type | pan             | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan      | cardholdername   |
| Amex      | 374245002771003 | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003 | MANUALLY/ENTERED |
@rx5000 @rx7000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when FPE encryption enabled
########## start transaction ###############",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible",Unknown
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^<cardholdername>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.*                                                              |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type | pan             | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan      | cardholdername   |
| Amex      | 374245002771003 | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003 | MANUALLY/ENTERED |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Scenario Outline: Manual entry transaction to verify 29.x variables 394 395 396 398 399 400 when FPE encryption enabled
########## start transaction ###############",Extract Card Data
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 |
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
Scenario: Teardown - Reset to Default State",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@sde @msr @00x @60x @61x @23x
Feature:  Validate track encryption indicator values
""""""
This feature file validates track encryption indicator with its values for manual entry , encryption indicator=3
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1800
""""""
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Enable On-Guard SDE Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |",Unknown
"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@dx8000 @ex8000 @dx4000
Scenario Outline: On-Guard SDE Encryption For Manual Entry Transaction with encryption indicator =3",Unknown
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""
And I successfully changed configuration ""0019"" ""0001"" to ""0""",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.+:3:.+                                                         |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | null_characters              |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | \x00\x00\x00\x00\x00\x00\x00 |
| Amex       | 374245002771003  | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003  | \x00\x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | 2507            | 0725     | 206  | 000000000000000     | 000000000000        | 4264510000005621 | \x00\x00\x00\x00\x00\x00\x00 |
| DISCOVER   | 6510000000000091 | 2606            | 0626     | 702  | 000000000000000     | 000000000000        | 6510000000000091 | \x00\x00\x00\x00\x00\x00\x00 |
@rx5000 @rx7000
Scenario Outline: On-Guard SDE Encryption For Manual Entry Transaction with encryption indicator =3
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
And I successfully changed configuration ""0019"" ""0001"" to ""0""",Card Swipe
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.+:3:.+                                                         |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | null_characters              |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | \x00\x00\x00\x00\x00\x00\x00 |
| Amex       | 374245002771003  | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003  | \x00\x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | 2507            | 0725     | 206  | 000000000000000     | 000000000000        | 4264510000005621 | \x00\x00\x00\x00\x00\x00\x00 |
| DISCOVER   | 6510000000000091 | 2606            | 0626     | 702  | 000000000000000     | 000000000000        | 6510000000000091 | \x00\x00\x00\x00\x00\x00\x00 |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Teardown - Reset to Default State",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1386
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder will enter the same strong PIN in the first and second attempt
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################",Precondition
"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the strong pin################################
And I enter pin ""<strong_pin>""
######################## enter the same strong pin again #####################",CVM Process
And I wait for 4 seconds,Unknown
"And I enter pin ""<strong_pin>""
####### 31.x should return B because the second pin entry is same as the first strong pin entered################### #######################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | B |
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################",CVM Process
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |",Extract Card Data
"@41 @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:Swipe Transaction with 41.x Card Read with parse fields
Scenario: Send 41.x Card Read Request then simulate swipe",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
And I wait for 2 seconds,Unknown
"Then Axium swipe magnetic card:
| track1 | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| track2 | 5413330089099130=25122011483594900000                                   |
| track3 |                                                                         |",Unknown
And I wait 3 seconds,Unknown
"And I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                                                       |
| p41_res_encryption      | 00                                                                      |
| p41_res_track_1_status  | 0                                                                       |
| p41_res_track_2_status  | 0                                                                       |
| p41_res_track_3_status  | 1                                                                       |
| p41_res_track_1         | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| p41_res_track_2         | 5413330089099130=25122011483594900000                                   |
| p41_res_track_3         |                                                                         |
| p41_res_pan             | 5413330089099130                                                        |
| p41_res_masked_pan      | 5413330089099130                                                        |
| p41_res_expiration_date | 2512                                                                    |
| p41_res_account_name    | UAT USA/TEST CARD 20                                                    |
| p41_res_error_code      | 0                                                                       |",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
@pin_code @master_session @tep2 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when TEP2 enabled
""""""
This feature file verify pin block decryption is correct when TEP2 enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable Voltage TEP2 Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/voltage_5_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_5_default-signed.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 5  |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
Scenario Outline: verify pin block decryption is correct with masked pan",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 5  |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |",Extract Card Data
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | *                                                |
| p31_req_form_name                    |                                                  |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 4321     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 552211   | 6          | ffffffff   |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 55221100 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@00x @29x @60x @23x @87x @41x @sde
Feature: verify message 29.x of variables 396 398 399 400
""""""
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
""""""
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
Scenario: Enable On-Guard SDE Encryption Configuration
########## enable SDE encryption ###############",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |",Unknown
"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@dx8000 @ex8000 @dx4000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when SDE encryption enabled
########## start transaction ###############",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"And I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible",Unknown
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.*                                                              |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 19     |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | MANUALLY/ENTERED |
@rx5000 @rx7000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when SDE encryption enabled",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"And I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible",Unknown
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.*                                                              |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 19     |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | MANUALLY/ENTERED |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Scenario Outline: Manual entry transaction to verify 29.x variables 394 395 396 398 399 400 when SDE encryption enabled
########## start transaction ###############",Extract Card Data
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 19     |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
########## remove encryption ###############
Examples:
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 | null_characters |
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |                 |
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
Scenario: Teardown - Reset to Default State
########## remove encryption ###############",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate an invalid PIN change where the cardholder will type a third entered PIN that does not match the second entered PIN
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1387
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder enter a 3rd entered pin doesnt match the second enetered pin
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################",Precondition
"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>""",CVM Process
"And I wait for 4 seconds
#################enter strong pin################################",Unknown
"And I enter pin ""<strong_pin1>""
######################## enter another strong pin  #####################",Unknown
And I wait for 4 seconds,Unknown
"And I enter pin ""<strong_pin2>""
####### 31.x should return C because the 3rd pin entry is not same as the 2nd strong pin entered################### #######################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | C |
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################",CVM Process
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin1 | strong_pin2 |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258        | 1593        |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124        | 0101        |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988        | 3124        |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101        | 0258        |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593        | 9988        |",Extract Card Data
"@87x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: MSR transaction For Non Standard Card Using 87.x Card Read Request
""""""
This feature file Validates MSR transaction For Non Standard Card using 87.x Card Read Request
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1199
""""""
Scenario Outline: Check MSR flow while using 87.x with Non-Standard two tracks(track1 ,track2)",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"When I swipe card using this params:
| track1_data | <track1_data> |
| track2_data | <track2_data> |
| track3_data |               |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                |
| p87_res_card_source | M                                                |
| p87_res_card_data   | @regexp:^<track1_res>\u001c<track2_res>\u001c.*$ |
Examples:
| track1_data                                                      | track2_data                            | track1_res                                                       | track2_res                             |
| B4147200000002105 KOIRALA/SASMIT 2603201000000000000000000000000 | 4147200000002105=260320100000000       | B4147200000002105 KOIRALA/SASMIT 2603201000000000000000000000000 | 4147200000002105=260320100000000       |
| 1234567890123456                                                 | 1234567890123456                       | 1234567890123456                                                 | 1234567890123456                       |
| 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000  | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000  | 0000198800001234560011=2012=0000002008 |
Scenario Outline: Check MSR flow while using 87.x with  Non-Standard track1 only",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"When I swipe card using this params:
| track1_data | <track1_data> |
| track2_data |               |
| track3_data |               |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                        |
| p87_res_card_source | M                        |
| p87_res_card_data   | @regexp:^<track1_res>.*$ |
Examples:
| track1_data                         | track2_data | track1_res                          | track1_res |
| 1234567890123456                    |             | 1234567890123456                    |            |
| 1006357681?3       1234567890123456 |             | 1006357681?3       1234567890123456 |            |
| 5413339000000119                    |             | 5413339000000119                    |            |
Scenario Outline: Check MSR flow while using 87.x with Non-Standard track2 only",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"When I swipe card using this params:
| track1_data |               |
| track2_data | <track2_data> |
| track3_data |               |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                        |
| p87_res_card_source | M                        |
| p87_res_card_data   | @regexp:^<track1_res>.*$ |
Examples:
| track1_data | track2_data                            | track1_res | track2_res                             |
|             | B4445222AE299990007                    |            | B4445222AE299990007                    |
|             | 1234567890123456                       |            | 1234567890123456                       |
|             | 0000198800001234560011=2012=0000002008 |            | 0000198800001234560011=2012=0000002008 |
@41 @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:Swipe Transaction with 41.x Card Read without parse fields
Scenario: Send 41.x Card Read Request then simulate swipe",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 0 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
And I wait for 2 seconds,Unknown
"Then Axium swipe magnetic card:
| track1 | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| track2 | 5413330089099130=25122011483594900000                                   |
| track3 |                                                                         |",Unknown
And I wait for 30 seconds,Unknown
"And I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source         | M                                                                       |
| p41_res_encryption     | 00                                                                      |
| p41_res_track_1_status | 0                                                                       |
| p41_res_track_2_status | 0                                                                       |
| p41_res_track_3_status | 1                                                                       |
| p41_res_track_1        | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| p41_res_track_2        | 5413330089099130=25122011483594900000                                   |
| p41_res_track_3        |                                                                         |
| p41_res_error_code     | 0                                                                       |",Unknown
"@pin_code @master_session @tep4 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when TEP4 enabled
""""""
This feature file verify pin block decryption is correct when TEP4 enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable Voltage TEP4 Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/voltage_6_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_6_default-signed.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 6  |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
Scenario Outline: verify pin block decryption is correct with masked pan",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 6  |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |",Extract Card Data
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | *                                                |
| p31_req_form_name                    |                                                  |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 432100   | 6          | ffffffff   |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522     | 4          | ffffffffff |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522001  | 7          | fffffff    |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 12341234 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate invalid PIN change where the cardholder types the second entered PIN with more than 10 digits
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1389
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN change where the cardholder types the second entered PIN with more than 10 digits
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################",Precondition
"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>""",CVM Process
"And I wait for 5 seconds
#################enter 10/11 digits pin pin################################",Unknown
"And I enter pin ""<second_pin>""",Unknown
"And I wait for 11 seconds
####### 31.x should return A because the 2nd pin entry is 10 or 11 digits length################### #######################",CVM Process
"Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | A |
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################",CVM Process
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | second_pin  |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 5026301670  |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 6986301671  |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988112589  |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 1122772211  |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4321     | 11445332271 |",Extract Card Data
"@87x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: MSR transaction using 87.x Card Read Request
""""""
This feature file Validates MSR transaction using 87.x Card Read Request
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1155
""""""
Scenario Outline: Check MSR flow while using 87.x with two tracks(track1 ,track2)",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                                                    |
| p87_res_card_source | M                                                                                                    |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |
Examples:
| card_type   | pan                 | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| MasterCard  | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| VISA        | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026887693372 | 887693372    |
| AMEX 1      | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
| NonStandard | 999000              | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |
Scenario Outline: Check MSR flow while using  87.x with  track1 only",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data |                                              |
| track3_data |                                              |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                |
| p87_res_card_source | M                                                                |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C\x1C$ |
Examples:
| card_type   | pan                 | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| MasterCard  | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| VISA        | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026887693372 | 887693372    |
| AMEX 1      | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
| NonStandard | 999000              | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |
Scenario Outline: Check MSR flow while using 87.x with track2 only",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"When I swipe card using this params:
| track1_data |                                      |
| track2_data | <pan>=<exp_date><code><disc_data_t2> |
| track3_data |                                      |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                      |
| p87_res_card_source | M                                                      |
| p87_res_card_data   | @regexp:^\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |
Examples:
| card_type   | pan            | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| MasterCard  | 45358179327829 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| VISA        | 34798979016630 | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026823693372 | 823693372    |
| AMEX 1      | 37158413190797 | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
| NonStandard | 999000         | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |",Unknown
"@41x @msr @00x @24x @21x @27x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate On-Demand Messages using 41.x EFT message
""""""
This feature file Validates on-demand messages using 41.x EFT message
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1159.
""""""
Scenario Outline: On-Demand Messages using 41.x EFT message",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"When I send a 21.x Numeric Input message to the terminal with:
| p21_req_display_char        | 0              |
| p21_req_min_input_length    | <min_input>    |
| p21_req_max_input_length    | <max_input>    |
| p21_req_prompt_index        | <prompt_index> |
| p21_req_form_specific_index | input_numeric  |
And I Wait until Element ""fixed_title"" contains ""<title>""
#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"When I click Element ""input_box""",Unknown
"And  I send keys to Element ""input_box"" text ""<input_data>"" and then ENTER
Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | 0            |
| p21_res_input_data | <input_data> |",Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I Wait until Element ""title"" contains ""Welcome""
When I send a 27.x Alpha Input message to the terminal with params:
| p27_req_display_char     | 0           |
| p27_req_min_input_length | 00          |
| p27_req_max_input_length | 40          |
| p27_req_prompt_index     | 016         |
| p27_req_form_specificid  | input_alpha |
And I Wait until Element ""fixed_title"" contains ""Please enter Cashback:""
#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"When I click Element ""input_box""",Unknown
"And I send keys to Element ""input_box"" text ""ISAT-v-1.9.66"" and then ENTER
Then I should receive the 27.x Alpha Input response from terminal with params:
| p27_res_exit_type  | 0             |
| p27_res_data_input | ISAT-v-1.9.66 |",Unknown
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 0 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
And I wait for 2 second,Unknown
"Then I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |",Unknown
When I wait for 5 second,Unknown
"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source         | M                                            |
| p41_res_encryption     | 00                                           |
| p41_res_track_1_status | 0                                            |
| p41_res_track_2_status | 0                                            |
| p41_res_track_3_status | 1                                            |
| p41_res_track_1        | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_track_2        | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_track_3        |                                              |
| p41_res_error_code     | 0                                            |",Unknown
"When I send a 31.x Pin Entry message to the terminal with params:
| p31_req_set_key_type                 | D     |
| p31_req_set_encryption_configuration | 0     |
| p31_req_prompt_index_number          | 1     |
| p31_req_customer_acc_num             | <pan> |
| p31_req_form_name                    |       |
And I enter pin ""1234""
Then I should receive in '30' seconds the 31.x Pin Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |",CVM Process
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I Wait until Element ""title"" contains ""Welcome!""
When I send a 21.x Numeric Input message to the terminal with:
| p21_req_display_char        | 0              |
| p21_req_min_input_length    | <min_input>    |
| p21_req_max_input_length    | <max_input>    |
| p21_req_prompt_index        | <prompt_index> |
| p21_req_form_specific_index | input_numeric  |",Unknown
"And I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 0 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
"And I Wait until Element ""fixed_title"" contains ""<title>""
And I wait until Element ""line_display"" visible
#And I wait until Element ""btn_cancel"" visible",Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |",Display Confirmation
"Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | a |
| p21_res_input_data |   |",Unknown
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I Wait until Element ""title"" contains ""Welcome!""",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"Then I should receive the 41.x response from terminal with params:
| p41_res_source         | U  |
| p41_res_encryption     | 98 |
| p41_res_track_1_status | 1  |
| p41_res_track_2_status | 1  |
| p41_res_track_3_status | 1  |
| p41_res_track_1        |    |
| p41_res_track_2        |    |
| p41_res_track_3        |    |
| p41_res_error_code     | a  |
And I wait 1 second",Unknown
"And I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                                                                                             | disc_data_t2   | additional_data      | min_input | max_input | prompt_index | input_data | title                   |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000\u001c5413339000000119=24122210000014000001\u001c0123456789012345678901234567890123456789 | 0000014000001  | 01234567890123456789 | 01        | 10        | 001          | 6724240113 | Enter home phone number |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                                                                                                | 15041234500000 |                      | 01        | 20        | 001          | 77457777   | Enter home phone number |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000                                                                             | 0000070400100  |                      | 01        | 40        | 001          | 558555     | Enter home phone number |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                                                                                            | 1000041300000  |                      | 01        | 40        | 001          | 88855588   | Enter home phone number |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946                                                                                     | 1000041300000  | 01234567890123456789 | 01        | 40        | 001          | 74158552   | Enter home phone number |
@pin_code @master_session @tep6 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when TEP6 enabled
""""""
This feature file verify pin block decryption is correct when TEP6 enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable Voltage TEP6 Encryption Configuration
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/voltage_31_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_31_default-signed.apk |
| p62_req_encoding_format | B                             |
| p62_req_fast_download   | 1                             |
| p62_req_unpack_flag     | 0                             |
And I should receive the 62.x File Write response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 31 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
Scenario Outline: verify pin block decryption is correct with masked pan",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 31 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |",Extract Card Data
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | *                                                |
| p31_req_form_name                    |                                                  |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 432100   | 6          | ffffffff   |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522     | 4          | ffffffffff |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522110  | 7          | fffffff    |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 12341234 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate an valid PIN change where the cardholder will type the second entered PIN is more than 4 digits and less than 10 digits
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1388
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and valid PIN change where the cardholder will type the second entered PIN is more than 4 digits and less than 10 digits
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################",Precondition
"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>""",CVM Process
"And I wait for 4 seconds
#################enter strong pin >4digits################################",Unknown
"And I enter pin ""<strong_pin>""
######################## reenter the strong pin  #####################",Unknown
And I wait for 7 seconds,Unknown
"And I enter pin ""<strong_pin>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |
############### variable is back to false after pin change ############################",CVM Process
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | false   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 15933       |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 010198      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 3124312     |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 02580259    |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 998866027   |",Extract Card Data
"@87x @msr @00x @24x @21x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate On-Demand Messages using 87.x EFT message
""""""
This feature file Validates on-demand messages using 87.x EFT message
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1158.
""""""
Scenario Outline: On-Demand Messages using 87.x EFT message",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"When I send a 21.x Numeric Input message to the terminal with:
| p21_req_display_char        | 0              |
| p21_req_min_input_length    | <min_input>    |
| p21_req_max_input_length    | <max_input>    |
| p21_req_prompt_index        | <prompt_index> |
| p21_req_form_specific_index | input_numeric  |
And I Wait until Element ""fixed_title"" contains ""<title>""
#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"When I click Element ""input_box""",Unknown
"And  I send keys to Element ""input_box"" text ""<input_data>"" and then ENTER
Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | 0            |
| p21_res_input_data | <input_data> |",Unknown
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""image_card"" visible",Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I Wait until Element ""title"" contains ""Welcome""
When I send a 27.x Alpha Input message to the terminal with params:
| p27_req_display_char     | 0           |
| p27_req_min_input_length | 00          |
| p27_req_max_input_length | 40          |
| p27_req_prompt_index     | 016         |
| p27_req_form_specificid  | input_alpha |
And I Wait until Element ""fixed_title"" contains ""Please enter Cashback:""
#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"And I click Element ""input_box""",Unknown
"And I send keys to Element ""input_box"" text ""ISAT-v-1.9.66"" and then ENTER
Then I should receive the 27.x Alpha Input response from terminal with params:
| p27_res_exit_type  | 0             |
| p27_res_data_input | ISAT-v-1.9.66 |",Unknown
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data | <additional_data><additional_data>           |
Then I should receive the 87.x Card Read response from terminal with params:
| p87_res_exit_type   | 0                                            |
| p87_res_card_source | M                                            |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code>.*$ |",Unknown
"When I send a 31.x Pin Entry message to the terminal with params:
| p31_req_set_key_type                 | D     |
| p31_req_set_encryption_configuration | 0     |
| p31_req_prompt_index_number          | 1     |
| p31_req_customer_acc_num             | <pan> |
| p31_req_form_name                    |       |
And I enter pin ""1234""
Then I should receive in '30' seconds the 31.x Pin Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |",CVM Process
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I Wait until Element ""title"" contains ""Welcome!""
When I send a 21.x Numeric Input message to the terminal with:
| p21_req_display_char        | 0              |
| p21_req_min_input_length    | <min_input>    |
| p21_req_max_input_length    | <max_input>    |
| p21_req_prompt_index        | <prompt_index> |
| p21_req_form_specific_index | input_numeric  |",Unknown
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |
| po87_req_options        |            |",Unknown
"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible
Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | a |
| p21_res_input_data |   |",Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I Wait until Element ""title"" contains ""Welcome!""
When I send a 27.x Alpha Input message to the terminal with params:
| p27_req_display_char     | 0           |
| p27_req_min_input_length | 00          |
| p27_req_max_input_length | 40          |
| p27_req_prompt_index     | 206         |
| p27_req_form_specificid  | input_alpha |
#And I wait until Element ""btn_cancel"" visible",Unknown
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible
Then I should receive the 27.x Alpha Input response from terminal with params:
| p27_res_exit_type  | a |
| p27_res_data_input |   |",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | a        |
| p87_res_card_source | ?        |
| p87_res_card_data   | \x1C\x1C |",Unknown
"And I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                                                                                             | disc_data_t2   | additional_data      | min_input | max_input | prompt_index | input_data | title                   |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000\u001c5413339000000119=24122210000014000001\u001c0123456789012345678901234567890123456789 | 0000014000001  | 01234567890123456789 | 01        | 10        | 001          | 6724240113 | Enter home phone number |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                                                                                                | 15041234500000 |                      | 01        | 20        | 001          | 77457777   | Enter home phone number |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000                                                                             | 0000070400100  |                      | 01        | 40        | 001          | 558555     | Enter home phone number |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                                                                                            | 1000041300000  |                      | 01        | 40        | 001          | 88855588   | Enter home phone number |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946                                                                                     | 1000041300000  | 01234567890123456789 | 01        | 40        | 001          | 74158552   | Enter home phone number |
@pin_code @master_session @tep7 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when TEP7 enabled
""""""
This feature file verify pin block decryption is correct when TEP7 enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable Voltage TEP7 Encryption Configuration
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/voltage_32_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_32_default-signed.apk |
| p62_req_encoding_format | B                             |
| p62_req_fast_download   | 1                             |
| p62_req_unpack_flag     | 0                             |
And I should receive the 62.x File Write response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 32 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
Scenario Outline: verify pin block decryption is correct with masked pan",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 32 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |",Extract Card Data
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | *                                                |
| p31_req_form_name                    |                                                  |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 4321     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 552211   | 6          | ffffffff   |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/COW           | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 55221100 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate invalid PIN change where the cardholder types the second entered PIN with 12 digits
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1390
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN change where the cardholder types the second entered PIN with 12 digits
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################",Precondition
"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>""",CVM Process
"And I wait for 5 seconds
#################enter 12 digits pin pin################################",Unknown
"And I enter pin ""<second_pin>""",Unknown
"And I wait for 12 seconds
####### 31.x should return A because the 2nd pin entry is 12 digits length################### #######################",CVM Process
"Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | A |
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################",CVM Process
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | second_pin   |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 502630167012 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 698630167113 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 998811258914 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 112277221125 |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4321     | 114453322716 |",Extract Card Data
"@pin_code @master_session @rsa @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when RSA enabled
""""""
This feature file verify pin block decryption is correct when RSA enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable RSA Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcRSA-OAEP.apk"" file using these params:
| p62_req_file_name       | ArcRSA-OAEP.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |
Scenario Outline: verify pin block decryption is correct with masked pan",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1            |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_set_encryption_configuration | 0            |
| p31_req_set_key_type                 | *            |
| p31_req_form_name                    |              |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"@pin_code @master_session @chapter_x @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when chapter X enabled
""""""
This feature file verify pin block decryption is correct when chapter X enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable chapterX Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcSec_chapter_X.apk"" file using these params:
| p62_req_file_name       | ArcSec_chapter_X.apk |
| p62_req_encoding_format | B                    |
| p62_req_fast_download   | 1                    |
| p62_req_unpack_flag     | 0                    |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
Scenario Outline: verify pin block decryption is correct with masked pan",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1            |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_set_encryption_configuration | 0            |
| p31_req_set_key_type                 | *            |
| p31_req_form_name                    |              |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 2211001  | 7          | fffffff    |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 12341234 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"@23x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: 23.x Card Read Request Swipe one track
Scenario Outline: Send 23.x Card Read Request swipe first track",Card Swipe
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M  |
| p23_req_prompt_index   | 03 |",Card Swipe
"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 |                                              |
| track3 |                                              |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | @regexp:.*                                   |
| p23_res_track3      | @regexp:.*                                   |
Examples:
| card_type     | pan                 | name                       | exp_date | code | disc_data_t1    | disc_data_t2 |
| Discover 1    | 62217984210356      | LYUATZMDAU/ABKBXTDWTDZJPHY | 2008     | 305  | 937343886685    | 886685       |
| Discover 2    | 648682809137410     | YHQJOKMYVWVNLRP/RHWSDMBOER | 2009     | 418  | 7254640409      | 0409         |
| Discover 3    | 656147069906747     | ICVLSVZXZM/RLBOT           | 2011     | 596  | 11020664082766  | 64082766     |
| Discover 4    | 521781446878188     | MCOZPS/FTYJMUOLLBYS        | 2006     | 651  | 95135762802916  | 62802916     |
| MasterCard    | 45358179327829      | EKRLOFKPUUTQURT/ALMPWTZUL  | 2007     | 707  | 122560965000469 | 965000469    |
| VISA          | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC  | 2011     | 885  | 131026823693372 | 823693372    |
| AMEX 1        | 37158413190797      | YYBROXFQJRXJW/EVXOV        | 2001     | 442  | 57431313685     | 13685        |
| AMEX 2        | 700199380329310926  | TPZRJLK/NKTUBHJNNWZI       | 2005     | 807  | 3121187689      | 7689         |
| loyalty cards | 62211933327452      | PZNLQXRGCDILK/TDDZHWEUCTJ  | 2009     | 680  | 9497511743      | 1743         |
| other cards   | 2830654628589795710 | XSYWIV/LHJPNU              | 2008     | 770  | 29814983505     | 83505        |
Scenario Outline: Send 23.x Card Read Request swipe second track",Card Swipe
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M  |
| p23_req_prompt_index   | 03 |",Card Swipe
"And I Wait until Element ""title"" contains ""Please slide card""
Then I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"When Axium swipe magnetic card:
| track1 |                                      |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| track3 |                                      |",Unknown
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                    |
| p23_res_card_source | M                                    |
| p23_res_track1      | @regexp:.*                           |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2> |
| p23_res_track3      | @regexp:.*                           |",Card Swipe
"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type     | pan                 | name                       | exp_date | code | disc_data_t1    | disc_data_t2 |
| Discover 1    | 62217984210356      | LYUATZMDAU/ABKBXTDWTDZJPHY | 2008     | 305  | 937343886685    | 886685       |
| Discover 2    | 648682809137410     | YHQJOKMYVWVNLRP/RHWSDMBOER | 2009     | 418  | 7254640409      | 0409         |
| Discover 3    | 656147069906747     | ICVLSVZXZM/RLBOT           | 2011     | 596  | 11020664082766  | 64082766     |
| Discover 4    | 521781446878188     | MCOZPS/FTYJMUOLLBYS        | 2006     | 651  | 95135762802916  | 62802916     |
| MasterCard    | 45358179327829      | EKRLOFKPUUTQURT/ALMPWTZUL  | 2007     | 707  | 122560965000469 | 965000469    |
| VISA          | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC  | 2011     | 885  | 131026823693372 | 823693372    |
| AMEX 1        | 37158413190797      | YYBROXFQJRXJW/EVXOV        | 2001     | 442  | 57431313685     | 13685        |
| AMEX 2        | 700199380329310926  | TPZRJLK/NKTUBHJNNWZI       | 2005     | 807  | 3121187689      | 7689         |
| loyalty cards | 62211933327452      | PZNLQXRGCDILK/TDDZHWEUCTJ  | 2009     | 680  | 9497511743      | 1743         |
| other cards   | 2830654628589795710 | XSYWIV/LHJPNU              | 2008     | 770  | 29814983505     | 83505        |",Precondition
"@23x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Swipe non standard cards
""""""
This feature file Validates MSR transaction For Non Standard Card using 23.x Card Read Request
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1207
""""""
Scenario Outline: Check MSR flow while using Non-Standard cards with two tracks(track1 ,track2)",Card Swipe
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3          |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Card Swipe
"When I swipe card using this params:
| track1_data | <track1_data> |
| track2_data | <track2_data> |
| track3_data |               |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0            |
| p23_res_card_source | M            |
| p23_res_track1      | <track1_res> |
| p23_res_track2      | <track2_res> |
| p23_res_track3      |              |",Card Swipe
"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| type                                                             | track1_data                                                     | track2_data                            | track1_res                                                      | track2_res                             |
| NonStandard card -- ISO parser                                   | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       |
| NonStandard card -- Track 1 and Track 2 pan-only                 | 1234567890123456                                                | 1234567890123456                       | 1234567890123456                                                | 1234567890123456                       |
| NonStandard card -- Non Payment card                             | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 |
| NonStandard card -- FDMS TEST CARD/VISA modified without exp-dat | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       |
Scenario Outline: Check MSR flow while using Non-Standard cards with track1 only
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3          |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Card Swipe
"When I swipe card using this params:
| track1_data | <track1_data> |
| track2_data |               |
| track3_data |               |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0            |
| p23_res_card_source | M            |
| p23_res_track1      | <track1_res> |
| p23_res_track2      |              |
| p23_res_track3      |              |",Card Swipe
"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| type                                 | track1_data                         | track1_res                         |
| NonStandard Card -- Track 1 pan-only | 1234567890123456                    | 1234567890123456                   |
| NonStandard Card -- Non Payment card | 1006357681?3       1234567890123456 | 10063576813       1234567890123456 |
| NonStandard Card -- Track 1 pan-only | 5413339000000119                    | 5413339000000119                   |
Scenario Outline: Check MSR flow while using Non-Standard cards with track2 only
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3          |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Card Swipe
"When I swipe card using this params:
| track1_data |               |
| track2_data | <track2_data> |
| track3_data |               |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0            |
| p23_res_card_source | M            |
| p23_res_track1      |              |
| p23_res_track2      | <track2_res> |
| p23_res_track3      |              |",Card Swipe
"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| type                                 | track2_data                            | track2_res                             |
| NonStandard Card -- Track 2 pan-only | B4445222AE299990007                    | B4445222AE299990007                    |
| NonStandard Card -- Track 2 pan-only | 1234567890123456                       | 1234567890123456                       |
| NonStandard Card -- Non Payment card | 0000198800001234560011=2012=0000002008 | 0000198800001234560011=2012=0000002008 |
| NonStandard Card -- Gift ECR         | 1234567897=251210100000001             | 1234567897=251210100000001             |",Precondition
"@smoke @00x @13x @23x @24x @29x @31x @cashback @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: MSR Debit Cashback with PIN entry transaction with various card brands
""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-918
""""""
Scenario Outline: Perform MSR Debit Cashback with PIN entry Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 13.x amount message to the terminal with:
| p13_req_amount   | <amount>          |
| p13_req_cashback | <cashback_amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And  I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |",Extract Card Data
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 8                   |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |",Display Confirmation
And I wait for 1 second,Unknown
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 3     |
| p31_req_customer_acc_num             | <pan> |
| p31_req_set_encryption_configuration | *     |
| p31_req_set_key_type                 | *     |
And Axium pinpad enter PIN 1234
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_status         | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I wait for 2 seconds
Examples:
| card_type  | amount | cashback_amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 50              | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 1000            | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 2000            | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 10000           | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 4000            | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |",Unknown
"@23x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Cancel 23.x Card Read Request
Scenario: Send 23.x Card Read Request then simulate swipe",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3          |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Card Swipe
"And Axium swipe magnetic card:
| track1 | B62217984210356^LYUATZMDAU/ABKBXTDWTDZJPHY^2008305937343886685 |
| track2 | 62217984210356=2008305886685                                   |
| track3 |                                                                |",Unknown
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                              |
| p23_res_card_source | M                                                              |
| p23_res_track1      | B62217984210356^LYUATZMDAU/ABKBXTDWTDZJPHY^2008305937343886685 |
| p23_res_track2      | 62217984210356=2008305886685                                   |
| p23_res_track3      |                                                                |
@smoke @msr @00x @13x @23x @20x @29x @24x
Feature: MSR Credit Signature transaction with various card brands
""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-917
""""""
@dx8000 @ex8000 @dx4000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |",Extract Card Data
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |",Display Confirmation
"And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible
When Draw line from 100x800 to 200x500
And Draw line from 200x500 to 300x800
And Draw line from 100x800 to 200x500
And Draw line from 200x500 to 300x800
And Draw line from 140x700 to 250x700",Unknown
"And I click Element ""btn_enter""",Unknown
"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |
| p20_res_data   | 4 |",Unknown
"When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |",Extract Card Data
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
And I wait for 2 seconds,Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
@rx5000 @rx7000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |",Extract Card Data
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |",Display Confirmation
"And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible
When Draw line from 200x300 to 300x360
And Draw line from 300x360 to 360x400",Unknown
"And I click Element ""btn_enter""",Unknown
"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |
| p20_res_data   | 2 |",Unknown
"When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |",Extract Card Data
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I wait for 2 seconds
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |",Unknown
"@collis @msr @emv @cless @visa @amex @online_pin_cvm @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: 23.x Card Read Request
""""""
Using this feature file, we ensure that the reader should be disabled after start performing a transaction
Test link test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1198
""""""
Scenario Outline: Send 23.x Card Read Request insert and remove chip card then swipe .",Card Swipe
"Given I successfully changed configuration ""0019"" ""0001"" to ""1""
And I successfully changed configuration ""0019"" ""0021"" to ""1""
And  I initiating Collis Test Case with the following params:
| brand     | American_Express |
| interface | contact          |
| test_plan | Quick_Chip_1__2  |
| test_case | <test_case>      |
And I wait 20 seconds",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When  I send a 13.x amount message to the terminal with:
| p13_req_amount   | <amount> |
| p13_req_cashback |          |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"When I insert card
And I wait 2 seconds
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 100 |
| p23_req_form_name      |     |
| p23_req_enable_devices | S   |
And I wait 2 seconds
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0 |
| p23_res_card_source | Q |
| p23_res_track1      |   |
| p23_res_track2      |   |
| p23_res_track3      |   |",Card Swipe
"When I enter pin ""00123""",Unknown
"And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
When I remove card
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| p33_05_res_status                  | 00         |
| p33_05_res_emvh_current_packet_nbr | 0          |
| p33_05_res_emvh_packet_type        | 0          |
| p33_05_res_payload                 | @regexp:.* |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| tag    | name                                           | value                  |
| 0x4F   | application_identifier                         | <adf>                  |
| 0x84   | dedicated_file_df_name                         | <adf>                  |
| 0x9C   | transaction_type                               | 00                     |
| 0x1001 | ingenico_proprietary_pin_entry_required_flag   | U                      |
| 0x1002 | ingenico_proprietary_signature_required_flag   | U                      |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                     |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | U                      |
| 0x1010 | ingenico_proprietary_error_response_code       | CRPRE                  |
| 0x5F20 | cardholder_name                                | <cardholder_name>      |
| 0x5F24 | application_expiration_date                    | <exp_date>31           |
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                   |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                      |
| 0x9001 | ingenico_proprietary_card_entry_mode           | C                      |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>       |
| 0x9F03 | amount_other                                   | 000000000000           |
| 0x9F0D | issuer_action_code_default                     | BC50ECA800             |
| 0x9F0E | issuer_action_code_denial                      | 0000000000             |
| 0x9F0F | issuer_action_code_online                      | BC78FCF800             |
| 0x9F1A | terminal_country_code                          | 0840                   |
| 0x9F1B | terminal_floor_limit                           | 00002710               |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6} |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}          |
| 0x9F39 | point_of_service_pos_entry_mode                | 05                     |
| 0xDF03 | pin_try_limit_kernel_v2                        | C800000000             |
| 0xDF04 | pin_try_counter                                | 0000000000             |
| 0xDF05 | aip_for_visa_contactless                       | C800000000             |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                     |
And I should receive the 09.x Set Allowed Payment response from terminal with params:
| p09_res_card_type        | 02 |
| p09_res_msg_version      | 02 |
| p09_res_transaction_type | 01 |
| p09_res_card_status      | R  |
And I Wait until Element ""title"" contains ""Card removed\nTransaction canceled""",Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |",Unknown
"And I should not receive in ""2"" seconds anything from terminal
Then I Wait until Element ""title"" contains ""Card removed\nTransaction canceled""
And I successfully changed configuration ""0019"" ""0001"" to ""0""",Unknown
"And I successfully changed configuration ""0019"" ""0021"" to ""0""
Examples:
| test_case                                | adf              | cardholder_name  | pan             | exp_date | amount |
| AXP QC 032 - Online PIN - Successful PIN | A000000025010801 | AEIPS 22/VER 2.3 | 374245001751006 | 2512     | 3250   |
Scenario Outline: Send 23.x Card Read Request Tap and Remove contacless card then swipe .",Card Swipe
"Given I successfully changed configuration ""0008"" ""0001"" to ""9""
And I initiating Collis Test Case with the following params:
| brand     | Visa                                 |
| interface | contactless                          |
| test_plan | 06_VisaL3Testing_series_01_build_019 |
| test_case | <test_case>                          |
And I wait 20 seconds",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When  I send a 13.x amount message to the terminal with:
| p13_req_amount   | <amount> |
| p13_req_cashback |          |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 371        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | MC         |
And I Wait until Element ""title"" contains ""Tap""
And I tap contactless card
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                          |
| p23_res_card_source | E                          |
| p23_res_track1      |                            |
| p23_res_track2      | <pan>=<exp_date><add_data> |
| p23_res_track3      | @regexp:.*                 |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| p33_02_res_status                  | 00         |
| p33_02_res_emvh_current_packet_nbr | 0          |
| p33_02_res_emvh_packet_type        | 0          |
| p33_02_res_payload                 | @regexp:.+ |
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
Then  the reported ""track2_equivalent_data"" container should have the following params:
| tag    | name                                         | value                      |
| 0x4F   | application_identifier                       | <adf>                      |
| 0x57   | track_2_equivalent_data                      | <pan>D<exp_date><add_data> |
| 0x84   | dedicated_file_df_name                       | <adf>                      |
| 0x1002 | ingenico_proprietary_signature_required_flag | 0                          |
| 0x5F28 | issuer_country_code_kernel_2                 | 0840                       |
| 0x5F20 | cardholder_name                              | <cardholder_name>          |
| 0x5F24 | application_expiration_date                  | <exp_date>31               |
| 0x9F1A | terminal_country_code                        | 0840                       |
| 0x9F1B | terminal_floor_limit                         | 00002710                   |
| 0xFF25 | Encryption/Whitelisting_mode                 | 00                         |",Card Swipe
"When I enter pin ""1234""",Unknown
"Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| p33_03_req_status                  | 00         |
| p33_03_req_emvh_current_packet_nbr | 0          |
| p33_03_req_emvh_packet_type        | 0          |
| p33_03_req_payload                 | @regexp:.+ |
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
Then the reported ""authorization_request_data"" container should have the following params:
| tag    | name                                           | value                      |
| 0x4F   | application_identifier                         | <adf>                      |
| 0x57   | track_2_equivalent_data                        | <pan>D<exp_date><add_data> |
| 0x84   | dedicated_file_df_name                         | <adf>                      |
| 0x95   | terminal_verification_results                  | 0000000000                 |
| 0x9C   | transaction_type                               | 00                         |
| 0x1002 | ingenico_proprietary_signature_required_flag   | 0                          |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                         |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | 1                          |
| 0x5F20 | cardholder_name                                | <cardholder_name>          |
| 0x5F24 | application_expiration_date                    | <exp_date>31               |
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                       |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                          |
| 0x9001 | ingenico_proprietary_card_entry_mode           | D                          |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>           |
| 0x9F03 | amount_other                                   | 000000000000               |
| 0x9F1A | terminal_country_code                          | 0840                       |
| 0x9F1B | terminal_floor_limit                           | 00002710                   |
| 0x9F26 | application_cryptogram                         | @regexp:[0-9A-Fa-f]{16}    |
| 0x9F27 | cryptogram_information_data                    | 80                         |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6}     |
| 0x9F34 | cardholder_verification_method_cvm_results     | @regexp:[048C]{1}20300     |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}              |
| 0x9F39 | point_of_service_pos_entry_mode                | 07                         |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                         |
When I send a 33.04 Authorization Response message to the terminal with params:
| p33_04_res_status                  | 00             |
| p33_04_res_emvh_current_packet_nbr | 0              |
| p33_04_res_emvh_packet_type        | 0              |
| p33_04_res_payload                 | T008A:0002:a00 |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| p33_05_res_status                  | 00         |
| p33_05_res_emvh_current_packet_nbr | 0          |
| p33_05_res_emvh_packet_type        | 0          |
| p33_05_res_payload                 | @regexp:.* |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| tag    | name                                           | value                      |
| 0x4F   | application_identifier                         | <adf>                      |
| 0x57   | track_2_equivalent_data                        | <pan>D<exp_date><add_data> |
| 0x84   | dedicated_file_df_name                         | <adf>                      |
| 0x8A   | authorisation_response_code                    | 00                         |
| 0x95   | terminal_verification_results                  | 0000000000                 |
| 0x9C   | transaction_type                               | 00                         |
| 0x1002 | ingenico_proprietary_signature_required_flag   | 0                          |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                         |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | 1                          |
| 0x5F20 | cardholder_name                                | <cardholder_name>          |
| 0x5F24 | application_expiration_date                    | <exp_date>31               |
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                       |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                          |
| 0x9001 | ingenico_proprietary_card_entry_mode           | D                          |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>           |
| 0x9F03 | amount_other                                   | 000000000000               |
| 0x9F1A | terminal_country_code                          | 0840                       |
| 0x9F1B | terminal_floor_limit                           | 00002710                   |
| 0x9F26 | application_cryptogram                         | @regexp:[0-9A-Fa-f]{16}    |
| 0x9F27 | cryptogram_information_data                    | 80                         |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6}     |
| 0x9F34 | cardholder_verification_method_cvm_results     | @regexp:[048C]{1}20300     |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}              |
| 0x9F39 | point_of_service_pos_entry_mode                | 07                         |
| 0xDF03 | pin_try_limit_kernel_v2                        | DC4000A800                 |
| 0xDF04 | pin_try_counter                                | 0010000000                 |
| 0xDF05 | aip_for_visa_contactless                       | DC4004F800                 |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                         |
And I Wait until Element ""title"" contains ""Approved""",Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><add_data> |
| track2_data | <pan>=<exp_date>201<disc_data_t2>  |
| track3_data |                                    |",Unknown
"And I should not receive in ""2"" seconds anything from terminal
Then I Wait until Element ""title"" contains ""Approved""
And I successfully changed configuration ""0008"" ""0001"" to ""0""
Examples:
| test_case     | adf            | cardholder_name | pan              | exp_date | add_data    | amount | disc_data_t2  |
| VISA.TC.1002a | A0000000031010 | L3TEST/CARD1002 | 4761731000000027 | 3112     | 20119058101 | 1600   | 0000014000001 |
@msr @fpe @00x @62x @61x @63x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate steps of deleting package and files from terminal
""""""
this testcase is to validate the steps of deleting a file and a package from terminal
""""""
Scenario Outline: delete a file from terminal",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent file through 62.x Write File request with:
| p62_req_file_name       | <path>     |
| p62_req_encoding_format | 7          |
| p62_req_fast_download   | 1          |
| p62_req_unpack_flag     | 0          |
| p62_req_record_type     | 0          |
| p62_req_segment_nbr     | 01         |
| p62_req_file_data       | @regexp:.* |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 63.x Find File message to the terminal with:
| p63_req_file_name | Test.txt |
And I should receive the 63.x Find File response from terminal with params:
| p63_res_result      | 0  |
| p63_res_file_length | 40 |
When I delete file ""/sdcard/Android/data/com.ingenico.retail.arcapp/files/Test.txt"" from terminal
And I send a 63.x Find File message to the terminal with:
| p63_req_file_name | Test.txt |
Then I should receive the 63.x Find File response from terminal with params:
| p63_res_result      | 1 |
| p63_res_file_length | 0 |
Examples:
| path           |
| Files/Test.txt |
Scenario: Enable encryption and Whitelisting Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardFPE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p62_req_file_name       | apstitan_on.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
Scenario Outline: Validate steps of deleting package from terminal",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |",Unknown
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | 1000 |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data | <additional_data><additional_data>           |",Card Swipe
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | @regexp:.+                                   |
When I uninstall package ""com.ingenico.retail.aps.secure.parameters"" from terminal",Card Swipe
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |
#    Then I should receive the 23.x Card Read response from terminal with params:
#      | p23_res_exit_type   | 0          |
#      | p23_res_card_source | M          |
#      | p23_res_track1      | @regexp:.+ |
#      | p23_res_track2      | @regexp:.+ |
#      | p23_res_track3      | @regexp:.+ |",Card Swipe
"And decrypted field ""p23_res_track3"" with ON GUARD algorithm should match the following MSR data:
| track2 | <pan>=<exp_date><code><disc_data_t2> |
Examples:
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 |
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@sde @msr @00x @62x @61x @41x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate step of decryption for On-Guard SDE dukpt Encryption for MSR transaction
Scenario: Enable OGSDE DUKPT with AES128 Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES128.apk"" file using these params:
| p62_req_file_name       | ArcOnGuard-SDE-AES128.apk |
| p62_req_encoding_format | B                         |
| p62_req_fast_download   | 1                         |
| p62_req_unpack_flag     | 0                         |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
Scenario Outline: On-Guard SDE DUKPT AES Encryption For MSR Transaction",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Precondition
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
And I wait for 2 seconds,Unknown
"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |",Unknown
And I wait 2 seconds,Unknown
"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                                            |
| p41_res_encryption      | 19                                                           |
| p41_res_track_1_status  | 0                                                            |
| p41_res_track_2_status  | 0                                                            |
| p41_res_track_3_status  | 0                                                            |
| p41_res_track_1         | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p41_res_track_2         | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p41_res_track_3         | @regexp:.+                                                   |
| p41_res_pan             | <masked_pan>                                                 |
| p41_res_masked_pan      | <masked_pan>                                                 |
| p41_res_expiration_date | <exp_date>                                                   |
| p41_res_account_name    | <name>                                                       |
| p41_res_error_code      | 0                                                            |
######################### MSR transaction decryption for SDE AES DUKPT#############################",Unknown
"And decrypted field 'p41_res_track_3' with AES DUKPT algorithm should match the following MSR data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\x00<pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters                          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       | \x00\x00\x00\x00\x00\x00\x00\x00         |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00                 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00                 |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00                 |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@msr @fpe @00x @61x @23x @62x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @known_issue @ARC-5904
Feature: Validate On-Guard FPE simplify decryption step for MSR Transaction
""""""
This feature file Validates decryption step  for FPE simplify
ARC-5904: decryption of FPE simplify dont work for PAN lengths<=14 digits
""""""
Scenario: Enable On-Guard FPE Encryption Configuration format simplify",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnguardFPEsimplfy.apk"" file using these params:
| p62_req_file_name       | ArcOnguardFPEsimplfy.apk |
| p62_req_encoding_format | B                        |
| p62_req_fast_download   | 1                        |
| p62_req_unpack_flag     | 0                        |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
Scenario Outline: On-Guard FPE Encryption For MSR Transaction",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:^B.+\|.+\|.{20}050006$                               |",Card Swipe
"Then decrypted field 'p23_res_track3' with ON GUARD Simplify algorithm should match the following data:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | @regexp:.*                                   |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2    | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001   | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001   | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000  |                      | 374245000001008  | 000000000                    | 00000000000000      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100   |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000   |                      | 6510000000000091 | 0000000000000                | 0000000000000       |
#      | Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000   |                      | 36039600000472   | 00000000000000000000         | 0000000000000       |
#      | Diners     | 36070500001335   | CARD/IMAGE 33      | 1712     | 201  | 12010000000000000081000000   | 120100008100000 |                      | 36070500001335   | 00000000000000000000000000   | 000000000000000     |
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000   | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000   | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@p2p @secbin @chapter_x @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable chapter_x Encryption Configuration
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @aes128 @aes192 @aes256
Feature: Disable On-Guard SDE DUKPT Encryption Configuration
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @jobs @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable On-Guard SDE Encryption Configuration
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @rsa @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable RSA Encryption Configuration
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @voltage @tep2 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable Voltage TEP2 Encryption Configuration
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @voltage @tep4 @msr @me @dme @emv @cless @61x @62x @00x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable Voltage TEP4 Encryption Configuration
Scenario: Disable Voltage TEP4 Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @voltage @tep6 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable Voltage TEP6 Encryption Configuration
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @voltage @tep7 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable Voltage TEP7 Encryption Configuration
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@p2p @msr @me @dme @emv @cless @secbin @chapter_x @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable chapter_x Encryption Configuration
Scenario: Enable chapterX Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcSec_chapter_X.apk"" file using these params:
| p62_req_file_name       | ArcSec_chapter_X.apk |
| p62_req_encoding_format | B                    |
| p62_req_fast_download   | 1                    |
| p62_req_unpack_flag     | 0                    |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
@secbin @fpe @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable On-Guard FPE Encryption Configuration
Scenario: Enable On-Guard FPE Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardFPE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable On-Guard SDE DUKPT AES Encryption Configuration
@aes128
Scenario: Enable OGSDE DUKPT with AES128 Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES128.apk"" file using these params:
| p62_req_file_name       | ArcOnGuard-SDE-AES128.apk |
| p62_req_encoding_format | B                         |
| p62_req_fast_download   | 1                         |
| p62_req_unpack_flag     | 0                         |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@aes192
Scenario: Enable OGSDE DUKPT with AES192 Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES192.apk"" file using these params:
| p62_req_file_name       | ArcOnGuard-SDE-AES192.apk |
| p62_req_encoding_format | B                         |
| p62_req_fast_download   | 1                         |
| p62_req_unpack_flag     | 0                         |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@aes256
Scenario: Enable OGSDE DUKPT with AES256 Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES256.apk"" file using these params:
| p62_req_file_name       | ArcOnGuard-SDE-AES256.apk |
| p62_req_encoding_format | B                         |
| p62_req_fast_download   | 1                         |
| p62_req_unpack_flag     | 0                         |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@secbin @rsa @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable RSA Encryption Configuration
Scenario: Enable RSA Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcRSA-OAEP.apk"" file using these params:
| p62_req_file_name       | ArcRSA-OAEP.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |
@p2p @secbin @msr @me @dme @emv @cless @voltage @tep2 @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable Voltage TEP2 Encryption Configuration
Scenario: Enable Voltage TEP2 Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/voltage_5_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_5_default-signed.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 5  |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
@p2p @secbin @voltage @tep4 @msr @me @dme @emv @cless @00x @61x @62x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable Voltage TEP4 Encryption Configuration
Scenario: Enable Voltage TEP4 Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/voltage_6_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_6_default-signed.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 6  |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
@p2p @secbin @voltage @tep6 @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable Voltage TEP6 Encryption Configuration
Scenario: Enable Voltage TEP6 Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/voltage_31_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_31_default-signed.apk |
| p62_req_encoding_format | B                             |
| p62_req_fast_download   | 1                             |
| p62_req_unpack_flag     | 0                             |
And I should receive the 62.x File Write response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 31 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
@p2p @secbin @voltage @tep7 @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable Voltage TEP7 Encryption Configuration
Scenario: Enable Voltage TEP7 Encryption Configuration",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/voltage_32_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_32_default-signed.apk |
| p62_req_encoding_format | B                             |
| p62_req_fast_download   | 1                             |
| p62_req_unpack_flag     | 0                             |
And I should receive the 62.x File Write response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 32 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |",Unknown
"@pin_code @msr @00x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct for master session pin when encryption is off
""""""
This feature file Feature Validates master session pin when encryption is off
testlink testcase : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1230
""""""
Scenario Outline: Validate master session pin when encryption is off
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
##################select master session pin################""",Precondition
"And I successfully changed configuration ""0006"" ""0007"" to ""0""",Unknown
"And I successfully changed configuration ""0006"" ""0008"" to ""0""
################## swipe the card #########################""",Unknown
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | 1000 |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      |                                              |
#################### send 31.x message for pin entry #############################",CVM Process
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |",Extract Card Data
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | M                                                |
| p31_req_form_name                    |                                                  |
############################### enter pin #############################
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | 0          |
| p31_res_pin_data | @regexp:.* |
################################# decrypt the enetered pin ###############################",CVM Process
"And I will decrypt pin block M/S from 'p31_res_pin_data' using the sequence of pan: '<pan>' and initial vector '<initial_vector>' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | initial_vector   | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 0000000000000000 | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 0000000000000000 | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 0000000000000000 | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 0000000000000000 | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 22110055 | 8          | ffffff     |
@msr @23x @20x @29x @00x @13x @24x @credit
Feature: MSR Credit Signature transaction with various card brands
""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-917
""""""
@dx8000 @ex8000 @dx4000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |",Extract Card Data
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |",Display Confirmation
"And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible
When Draw line from 100x800 to 200x500
And Draw line from 200x500 to 300x800
And Draw line from 100x800 to 200x500
And Draw line from 200x500 to 300x800
And Draw line from 140x700 to 250x700",Unknown
"And I click Element ""btn_enter""",Unknown
"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |
| p20_res_data   | 4 |",Unknown
"When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |",Extract Card Data
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I wait for 2 seconds
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
@rx5000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |",Extract Card Data
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |",Display Confirmation
"And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible
Then Draw line from 200x300 to 300x400
Then Draw line from 300x500 to 400x600
Then Draw line from 400x500 to 100x800",Unknown
"And I click Element ""btn_enter""",Unknown
"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |
| p20_res_data   | 3 |",Unknown
"When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |",Extract Card Data
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I wait for 2 seconds
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
@rx7000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |",Extract Card Data
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |",Display Confirmation
"And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible
Then Draw line from 200x300 to 300x400
Then Draw line from 300x400 to 1100x500
Then Draw line from 600x500 to 1000x200",Unknown
"And I click Element ""btn_enter""",Unknown
"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |
| p20_res_data   | 3 |",Unknown
"When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |",Extract Card Data
And I wait for 1 second,Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"And I wait for 2 seconds
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
@msr @00x @23x @13x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: validate track sentinel for msr transaction
""""""
This feature file validates track sentinel for msr transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1000
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1031
""""""
Scenario Outline: validate track sentinel for msr transaction",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"And I send a 13.x amount message to the terminal with:
| p13_req_amount | 1000 |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
################ clear tracks : track 1 starts with B , track 2 starts with pan #############",Unknown
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
##################### validate track sentinels when encryption is ON #########################
@sde
Scenario: Enable On-Guard SDE Encryption Configuration",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |",Unknown
"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@sde
Scenario Outline: validate start sentinel and end sentinel for 23. eft message when encryption is on
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"And  I successfully changed configuration ""0008"" ""0001"" to ""9""
And I successfully changed configuration ""0019"" ""0001"" to ""1""",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Unknown
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
#################Track 1 : Start sentinel % , End sentinel ?
#################Track2 : Start sentinel ; , End sentinel ?
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\|<pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
@sde
Scenario: Teardown - Reset to Default State",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |",Unknown
"@msr @collis @emv @unionpay @signature_cvm @credit @00x @13x @23x @33x @04x @09x @dx8000 @ex8000 @rx5000 @rx7000
Feature: Validate UnionPay collis testcase TAIS_POS_004
""""""
- Requirement: Mandatory
- Test purpose and description : To validate POS is able to complete the credit transaction correctly
and terminal will only check the first digit of the service code.
Teminal support the track 1 data contain Chinese characters
- Card No: FT04
- Amount: 400
- Testing Steps:
1. Please swipe a card first and the terminal shall prompt to use a chip card.
2. Please insert a card and select purchase function.
3. Choose 'UICC Credit'.
4. Enter ""400.00"" as transaction amount.
5. Enter a correct online PIN as '111111' if required.
6. Processing completion
- Expected result/note
1. The terminal goes online to complete the transaction;
2. The transaction is approved.
Collis reports :resources\Collis\Reports\contact\UnionPay\Functional_V202205\POS\TAIS_POS_004.zip
Notes :
- Testcase does not contain EMV tag cardholder name (0x9F20)
- Testcase contains card image issue : the value of EMV-tag ""0x9F1F"" = ""          0775""
- Step 1. is is simulated in current Feature
""""""
Scenario Outline: Instructions to cover testcase TAIS_POS_004
####################### Enable EMV Contact reader #######################",Unknown
"Given I successfully changed configuration ""0019"" ""0001"" to ""1""
And I successfully changed configuration ""0008"" ""0001"" to ""0""
####################### Initiating Collis #######################
When  I initiating Collis Test Case with the following params:
| brand     | UnionPay           |
| interface | contact            |
| test_plan | Functional_V202205 |
| test_case | <test_case>        |
And I wait 20 seconds",Unknown
"And I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
####################### Start Transaction #######################",Precondition
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
####################### Swipe card step #######################",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I swipe card using this params:
| track1_data | B<PAN>^<app_label>^<exp_date><code><add_data> |
| track2_data | <PAN>=<exp_date><code><add_data>              |
| track3_data |                                               |",Card Swipe
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                             |
| p23_res_card_source | M                                             |
| p23_res_track1      | B<PAN>^<app_label>^<exp_date><code><add_data> |
| p23_res_track2      | <PAN>=<exp_date><code><add_data>              |
| p23_res_track3      |                                               |
####################### EMV Transaction flow #######################
When I insert card
And I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 100        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | S          |",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0 |
| p23_res_card_source | S |
| p23_res_track1      |   |
| p23_res_track2      |   |
| p23_res_track3      |   |",Card Swipe
"And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
When I send a 33.00 EMV Transaction Initiation message to the terminal with:
| p33_00_req_status                  | 00 |
| p33_00_req_emvh_current_packet_nbr | 0  |
| p33_00_req_emvh_packet_type        | 0  |
Then I Wait until Element ""title"" contains ""<app_label>\nPlease wait\nDo not remove card""
And  I should receive the 33.00 Emv Transaction Initiation response from terminal with params:
| p33_00_res_status                  | 00 |
| p33_00_res_emvh_current_packet_nbr | 0  |
| p33_00_res_emvh_packet_type        | 0  |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| p33_02_res_status                  | 00         |
| p33_02_res_emvh_current_packet_nbr | 0          |
| p33_02_res_emvh_packet_type        | 0          |
| p33_02_res_payload                 | @regexp:.+ |
####################### 33.02 payload verification #######################
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
Then  the reported ""track2_equivalent_data"" container should have the following params:
| tag    | name                         | value                             |
| 0x4F   | application_identifier       | <AID>02                           |
| 0x50   | application_label            | <app_label>                       |
| 0x57   | track_2_equivalent_data      | <PAN>D<exp_date><code><add_data>F |
| 0x5A   | Primary_Account_Number_(PAN) | <PAN>                             |
| 0x84   | dedicated_file_df_name       | <AID>02                           |
| 0x5F20 | cardholder_name              | UICC<test_card>                   |
| 0x5F24 | application_expiration_date  | <exp_date>31                      |
| 0x5F28 | Issuer_Country_Code          | 0156                              |
| 0x5F2D | preferred_languages          | cn                                |
| 0x9F07 | Application_Usage_Control    | FF00                              |
| 0x9F09 | Application_Version_Number   | @regexp:\d{4}                     |
| 0x9F1A | Terminal_Country_Code        | 0840                              |
| 0x9F1B | Terminal_Floor_Limit         | 00000000                          |
#      | 0x9F1F | Track1_Discretionary_Data    | @regexp:[\s]{10}0775              |
| 0xFF25 | Encryption_Whitelisting_Mode | 00                                |
| 0x100E | User_Language                | EN                                |
#####################################################################
When I send a 04.x Set Payment Type message to the terminal with params:
| p04_req_force_payment_type | 1   |
| p04_req_payment_type       | B   |
| p04_req_amount             | 000 |
Then I should receive the 04.x Set Payment Type response from terminal with params:
| p04_res_force_payment_type | 0   |
| p04_res_payment_type       | B   |
| p04_res_amount             | 000 |",Unknown
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"And I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""",Unknown
"Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| p33_03_req_status                  | 00         |
| p33_03_req_emvh_current_packet_nbr | 0          |
| p33_03_req_emvh_packet_type        | 0          |
| p33_03_req_payload                 | @regexp:.+ |
####################### 33.03 payload verification #######################
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
Then the reported ""authorization_request_data"" container should have the following params:
| tag    | name                                       | value                             |
| 0x4F   | application_identifier                     | <AID>02                           |
| 0x50   | Application_Label                          | <app_label>                       |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}            |
| 0x84   | dedicated_file_df_name                     | <AID>02                           |
| 0x95   | terminal_verification_results              | 000800E000                        |
| 0x9A   | transaction_date                           | @regexp:\d{6}                     |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}            |
| 0x9C   | transaction_type (Purchase)                | 00                                |
| 0x5F20 | cardholder_name                            | UICC<test_card>                   |
| 0x5F24 | application_expiration_date                | <exp_date>31                      |
| 0x5F2A | Transaction_Currency_Code                  | 0840                              |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                    |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>02                           |
| 0x9F07 | Application_Usage_Control                  | FF00                              |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                     |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                     |
| 0x9F0D | issuer_action_code_default                 | FC609CA800                        |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                        |
| 0x9F0F | issuer_action_code_online                  | FC689CF800                        |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}           |
| 0x9F1A | terminal_country_code                      | 0840                              |
| 0x9F1B | terminal_floor_limit                       | 00000000                          |
#      | 0x9F1F | Track1_Discretionary_Data                  | @regexp:[\s]{10}0775              |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                     |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}           |
| 0x9F27 | cryptogram_information_data                | 80                                |
| 0x9F33 | terminal_capabilities                      | E0F8C8                            |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300              |
| 0x9F35 | terminal_type                              | 22                                |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}            |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                        |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                |
#Ingenico property
| 0x1001 | pin_entry_required_flag                    | 0                                 |
| 0x1002 | signature_required_flag                    | 1                                 |
| 0x1005 | transaction_type                           | 00                                |
| 0x100E | User_Language                              | EN                                |
| 0x100F | pin_entry_successful_flag                  | 0                                 |
| 0x9000 | card_payment_type                          | B                                 |
| 0x9001 | card_entry_mode                            | C                                 |
#####################################################################
When I send a 33.04 Authorization Response message to the terminal with params:
| p33_04_res_status                  | 00             |
| p33_04_res_emvh_current_packet_nbr | 0              |
| p33_04_res_emvh_packet_type        | 0              |
| p33_04_res_payload                 | T008A:0002:a00 |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| p33_05_res_status                  | 00         |
| p33_05_res_emvh_current_packet_nbr | 0          |
| p33_05_res_emvh_packet_type        | 0          |
| p33_05_res_payload                 | @regexp:.* |
####################### 33.05 payload verification #######################
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| tag    | name                                       | value                             |
| 0x4F   | application_identifier                     | <AID>02                           |
| 0x50   | Application_Label                          | <app_label>                       |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}            |
| 0x84   | dedicated_file_df_name                     | <AID>02                           |
| 0x89   | Authorization_Code                         | 3030                              |
| 0x8A   | authorisation_response_code                | 00                                |
| 0x8E   | cardholder_verification_method_cvm_list    | 00000000000000005E0342031F00      |
| 0x95   | terminal_verification_results              | 000800E000                        |
| 0x9A   | transaction_date                           | @regexp:\d{6}                     |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}            |
| 0x9C   | transaction_type (Purchase)                | 00                                |
| 0x5F20 | cardholder_name                            | UICC<test_card>                   |
| 0x5F24 | application_expiration_date                | <exp_date>31                      |
| 0x5F28 | Issuer_Country_Code                        | 0156                              |
| 0x5F2A | Transaction_Currency_Code                  | 0840                              |
| 0x5F2D | Preferred_Languages                        | cn                                |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                    |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>02                           |
| 0x9F07 | Application_Usage_Control                  | FF00                              |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                     |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                     |
| 0x9F0D | issuer_action_code_default                 | FC609CA800                        |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                        |
| 0x9F0F | issuer_action_code_online                  | FC689CF800                        |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}           |
| 0x9F1A | terminal_country_code                      | 0840                              |
| 0x9F1B | terminal_floor_limit                       | 00000000                          |
#      | 0x9F1F | Track1_Discretionary_Data                  | @regexp:[\s]{10}0775              |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                     |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}           |
| 0x9F27 | cryptogram_information_data                | 40                                |
| 0x9F33 | terminal_capabilities                      | E0F8C8                            |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300              |
| 0x9F35 | terminal_type                              | 22                                |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}            |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                        |
| 0xDF03 | Terminal_Action_Code_(TAC)_Default         | D84000A800                        |
| 0xDF04 | Terminal_Action_Code_Denial                | 0010000000                        |
| 0xDF05 | Terminal_Action_Code_Online                | D84004F800                        |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                |
#Ingenico property
| 0x1001 | pin_entry_required_flag                    | 0                                 |
| 0x1002 | signature_required_flag                    | 1                                 |
| 0x1003 | Confirmation_Response_Code                 | A                                 |
| 0x1005 | transaction_type                           | 00                                |
| 0x100E | User_Language                              | EN                                |
| 0x100F | pin_entry_successful_flag                  | 0                                 |
| 0x9000 | card_payment_type                          | B                                 |
| 0x9001 | card_entry_mode                            | C                                 |
#####################################################################
And I Wait until Element ""title"" contains ""Approved\nPlease remove card""
When  I remove card
And I wait 4 seconds
Then I should receive the 09.x Set Allowed Payments response from terminal with params:
| p09_res_card_type        | 02 |
| p09_res_msg_version      | 02 |
| p09_res_transaction_type | 01 |
| p09_res_card_status      | R  |
And I Wait until Element ""title"" contains ""Approved""
####################### Terminal Offline #######################",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
####################### Manual Validations #######################
#No manual validation
####################### Finalize collis #######################",Precondition
"When I finalizing Collis Test Case as ""approved""
Then I expect Collis Test Case to be ""passed""
Examples:
| test_case    | AID            | app_label        | PAN              | test_card | exp_date | code | add_data      | amount |
| TAIS_POS_004 | A0000003330101 | UICC Credit Card | 6210948000000045 | FT04      | 3010     | 220  | 0000000000000 | 400000 |",Unknown
"@msr @collis @emv @unionpay @signature_cvm @credit @00x @13x @23x @33x @04x @09x @dx8000 @ex8000 @rx5000 @rx7000
Feature: Validate UnionPay collis testcase TAIS_POS_005
""""""
- Requirement: Mandatory
- Test purpose and description : To validate POS is able to complete the quasi credit transaction correctly
when the application Label(Tag:50) and Application Preferred Name(Tag:9F12) contain Chinese Characters
- Card No: FT05
- Amount: 500
- Testing Steps:
1.Please swipe a card first and the terminal shall prompt to use a chip card.
2.Please insert a card and select purchase function.
3. Choose 'UICC Quasi Credit'.
4. Enter ""500.00"" as transaction amount.
5. Enter a correct online PIN as '111111' if required.
6. Processing completion
- Expected result/note
1. The terminal goes online to complete the transaction;
2. The transaction is approved.
Collis reports :resources\Collis\Reports\contact\UnionPay\Functional_V202205\POS\TAIS_POS_005.zip
Note :
- Cucumber does not support Chinese words
- The Application Label from the image card is : D2 F8 C1 AA 36 32 B1 EA D7 BC BF A8 40 B2 E2 CA D4 D7 A8 D3 C3 43 61 72 64 73
- encoded using Character encoding GB 18030 (Chinese) :  62@Cards (in English : UnionPay 62 Standard Card@Test Cards)
- The Application Label only detects the readable characters (0x5F20 = '    62      @        Cards')
""""""
Scenario Outline: Instructions to cover testcase TAIS_POS_005
####################### Enable EMV Contact reader #######################",Unknown
"Given I successfully changed configuration ""0019"" ""0001"" to ""1""
And I successfully changed configuration ""0008"" ""0001"" to ""0""
####################### Initiating Collis #######################
When  I initiating Collis Test Case with the following params:
| brand     | UnionPay           |
| interface | contact            |
| test_plan | Functional_V202205 |
| test_case | <test_case>        |
And I wait 20 seconds",Unknown
"And I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
####################### Start Transaction #######################",Precondition
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
####################### Swipe card step #######################",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I swipe card using this params:
| track1_data | B<PAN>^<app_label>^<exp_date><code><add_data> |
| track2_data | <PAN>=<exp_date><code><add_data>              |
| track3_data |                                               |",Card Swipe
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                             |
| p23_res_card_source | M                                             |
| p23_res_track1      | B<PAN>^<app_label>^<exp_date><code><add_data> |
| p23_res_track2      | <PAN>=<exp_date><code><add_data>              |
| p23_res_track3      |                                               |
####################### EMV Transaction flow #######################
When I insert card
And I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 100        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | S          |",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0 |
| p23_res_card_source | S |
| p23_res_track1      |   |
| p23_res_track2      |   |
| p23_res_track3      |   |",Card Swipe
"And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
When I send a 33.00 EMV Transaction Initiation message to the terminal with:
| p33_00_req_status                  | 00 |
| p33_00_req_emvh_current_packet_nbr | 0  |
| p33_00_req_emvh_packet_type        | 0  |
Then I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
And  I should receive the 33.00 Emv Transaction Initiation response from terminal with params:
| p33_00_res_status                  | 00 |
| p33_00_res_emvh_current_packet_nbr | 0  |
| p33_00_res_emvh_packet_type        | 0  |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| p33_02_res_status                  | 00         |
| p33_02_res_emvh_current_packet_nbr | 0          |
| p33_02_res_emvh_packet_type        | 0          |
| p33_02_res_payload                 | @regexp:.+ |
####################### 33.02 payload verification #######################
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
Then  the reported ""track2_equivalent_data"" container should have the following params:
| tag    | name                         | value                                                 |
| 0x4F   | application_identifier       | <AID>03                                               |
| 0x50   | application_label            | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x57   | track_2_equivalent_data      | <PAN>D<exp_date><code><add_data>F                     |
| 0x5A   | Primary_Account_Number_(PAN) | <PAN>                                                 |
| 0x84   | dedicated_file_df_name       | <AID>03                                               |
| 0x5F20 | cardholder_name              | UICC<test_card>                                       |
| 0x5F24 | application_expiration_date  | <exp_date>31                                          |
| 0x5F28 | Issuer_Country_Code          | 0156                                                  |
| 0x5F2D | preferred_languages          | zh                                                    |
| 0x9F07 | Application_Usage_Control    | FF00                                                  |
| 0x9F09 | Application_Version_Number   | @regexp:\d{4}                                         |
| 0x9F1A | Terminal_Country_Code        | 0840                                                  |
| 0x9F1B | Terminal_Floor_Limit         | 00000000                                              |
| 0x9F1F | Track1_Discretionary_Data    | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| 0xFF25 | Encryption_Whitelisting_Mode | 00                                                    |
| 0x100E | User_Language                | EN                                                    |
#####################################################################
When I send a 04.x Set Payment Type message to the terminal with params:
| p04_req_force_payment_type | 1   |
| p04_req_payment_type       | B   |
| p04_req_amount             | 000 |
Then I should receive the 04.x Set Payment Type response from terminal with params:
| p04_res_force_payment_type | 0   |
| p04_res_payment_type       | B   |
| p04_res_amount             | 000 |",Unknown
"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |",Send Amount
"And I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""",Unknown
"Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| p33_03_req_status                  | 00         |
| p33_03_req_emvh_current_packet_nbr | 0          |
| p33_03_req_emvh_packet_type        | 0          |
| p33_03_req_payload                 | @regexp:.+ |
####################### 33.03 payload verification #######################
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
Then the reported ""authorization_request_data"" container should have the following params:
| tag    | name                                       | value                                                 |
| 0x4F   | application_identifier                     | <AID>03                                               |
| 0x50   | Application_Label                          | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F                     |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x84   | dedicated_file_df_name                     | <AID>03                                               |
| 0x95   | terminal_verification_results              | 000800E000                                            |
| 0x9A   | transaction_date                           | @regexp:\d{6}                                         |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9C   | transaction_type (Purchase)                | 00                                                    |
| 0x5F20 | cardholder_name                            | UICC<test_card>                                       |
| 0x5F24 | application_expiration_date                | <exp_date>31                                          |
| 0x5F2A | Transaction_Currency_Code                  | 0840                                                  |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                                        |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>03                                               |
| 0x9F07 | Application_Usage_Control                  | FF00                                                  |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                                         |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                                         |
| 0x9F0D | issuer_action_code_default                 | FC6004A800                                            |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                                            |
| 0x9F0F | issuer_action_code_online                  | FC6804F800                                            |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F1A | terminal_country_code                      | 0840                                                  |
| 0x9F1B | terminal_floor_limit                       | 00000000                                              |
| 0x9F1F | Track1_Discretionary_Data                  | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                                         |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F27 | cryptogram_information_data                | 80                                                    |
| 0x9F33 | terminal_capabilities                      | E0F8C8                                                |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300                                  |
| 0x9F35 | terminal_type                              | 22                                                    |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                                    |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                                            |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                                    |
#Ingenico property
| 0x1001 | pin_entry_required_flag                    | 0                                                     |
| 0x1002 | signature_required_flag                    | 1                                                     |
| 0x1005 | transaction_type                           | 00                                                    |
| 0x100E | User_Language                              | EN                                                    |
| 0x100F | pin_entry_successful_flag                  | 0                                                     |
| 0x9000 | card_payment_type                          | B                                                     |
| 0x9001 | card_entry_mode                            | C                                                     |
#####################################################################
When I send a 33.04 Authorization Response message to the terminal with params:
| p33_04_res_status                  | 00             |
| p33_04_res_emvh_current_packet_nbr | 0              |
| p33_04_res_emvh_packet_type        | 0              |
| p33_04_res_payload                 | T008A:0002:a00 |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| p33_05_res_status                  | 00         |
| p33_05_res_emvh_current_packet_nbr | 0          |
| p33_05_res_emvh_packet_type        | 0          |
| p33_05_res_payload                 | @regexp:.* |
####################### 33.05 payload verification #######################
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| tag    | name                                       | value                                                 |
| 0x4F   | application_identifier                     | <AID>03                                               |
| 0x50   | Application_Label                          | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F                     |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x84   | dedicated_file_df_name                     | <AID>03                                               |
| 0x89   | Authorization_Code                         | 3030                                                  |
| 0x8A   | authorisation_response_code                | 00                                                    |
| 0x8E   | cardholder_verification_method_cvm_list    | 00000000000000005E0342031F00                          |
| 0x95   | terminal_verification_results              | 000800E000                                            |
| 0x9A   | transaction_date                           | @regexp:\d{6}                                         |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9C   | transaction_type (Purchase)                | 00                                                    |
| 0x5F20 | cardholder_name                            | UICC<test_card>                                       |
| 0x5F24 | application_expiration_date                | <exp_date>31                                          |
| 0x5F28 | Issuer_Country_Code                        | 0156                                                  |
| 0x5F2A | Transaction_Currency_Code                  | 0840                                                  |
| 0x5F2D | Preferred_Languages                        | zh                                                    |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                                        |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>03                                               |
| 0x9F07 | Application_Usage_Control                  | FF00                                                  |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                                         |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                                         |
| 0x9F0D | issuer_action_code_default                 | FC6004A800                                            |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                                            |
| 0x9F0F | issuer_action_code_online                  | FC6804F800                                            |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F1A | terminal_country_code                      | 0840                                                  |
| 0x9F1B | terminal_floor_limit                       | 00000000                                              |
| 0x9F1F | Track1_Discretionary_Data                  | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                                         |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F27 | cryptogram_information_data                | 40                                                    |
| 0x9F33 | terminal_capabilities                      | E0F8C8                                                |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300                                  |
| 0x9F35 | terminal_type                              | 22                                                    |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                                    |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                                            |
| 0xDF03 | Terminal_Action_Code_(TAC)_Default         | D84000A800                                            |
| 0xDF04 | Terminal_Action_Code_Denial                | 0010000000                                            |
| 0xDF05 | Terminal_Action_Code_Online                | D84004F800                                            |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                                    |
#Ingenico property
| 0x1001 | pin_entry_required_flag                    | 0                                                     |
| 0x1002 | signature_required_flag                    | 1                                                     |
| 0x1003 | Confirmation_Response_Code                 | A                                                     |
| 0x1005 | transaction_type                           | 00                                                    |
| 0x100E | User_Language                              | EN                                                    |
| 0x100F | pin_entry_successful_flag                  | 0                                                     |
| 0x9000 | card_payment_type                          | B                                                     |
| 0x9001 | card_entry_mode                            | C                                                     |
#####################################################################
And I Wait until Element ""title"" contains ""Approved\nPlease remove card""
When  I remove card
And I wait 4 seconds
Then I should receive the 09.x Set Allowed Payments response from terminal with params:
| p09_res_card_type        | 02 |
| p09_res_msg_version      | 02 |
| p09_res_transaction_type | 01 |
| p09_res_card_status      | R  |
And I Wait until Element ""title"" contains ""Approved""
####################### Terminal Offline #######################",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
####################### Manual Validations #######################
#No manual validation
####################### Finalize collis #######################",Precondition
"When I finalizing Collis Test Case as ""approved""
Then I expect Collis Test Case to be ""passed""
Examples:
| test_case    | AID            | app_label        | PAN              | test_card | exp_date | code | add_data      | amount |
| TAIS_POS_005 | A0000003330101 | UICC Credit Card | 6210948000000052 | FT05      | 3010     | 220  | 0000000000000 | 500000 |
@sde @msr @jobs @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Jobs for MSR transaction
""""""
This feature file validate jobs for Msr Transactions config (0091, 0054)
Jobs values allowed for msr:
0 : Track 1
2 : Track 2
6 : PAN from Track1
7 : PAN from Track2,
10 Expiry date from Track1
11 Expiry date from Track2
14 Cardholder name from Track1
18 :Track1 no sentinels
19 :Track2 no sentinels
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1033
""""""
Scenario: Enable On-Guard SDE Encryption Configuration and Update jobs values(7 =PAN from Track2, 2 = Track-2 data, 10 Expiry date from Track1)",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_config_name | ArcSec/onGuardSde/jobsMsr |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2                         |
| p61_res_config_name           | ArcSec/onGuardSde/jobsMsr |
| p61_res_data_config_parameter | 18,19                     |",Precondition
"When I have successfully sent ""Files/Jobs_Msr/ArcSec.apk"" file using these params:
| p62_req_file_name       | ArcSec.apk |
| p62_req_encoding_format | B          |
| p62_req_fast_download   | 1          |
| p62_req_unpack_flag     | 0          |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |",Unknown
"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_config_name | ArcSec/onGuardSde/jobsMsr |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2                         |
| p61_res_config_name           | ArcSec/onGuardSde/jobsMsr |
| p61_res_data_config_parameter | 7,2,10                    |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | <pan>\|;<pan>=<exp_date><code><disc_data_t2>?<lrc_val>\|<exp_date><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          | lrc_val |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       | \x00\x00                 | 9       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00             | 4       |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 | 2       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00                 | 4       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 | 4       |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       | \x00\x00                 | 6       |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       | \x00\x00                 | 9       |
@msr @tep2 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Voltage Encryption Tep2 for MSR Transaction
""""""
This feature file validates Voltage Encryption TEP2 for MSR Transaction.
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1228
""""""
Scenario Outline: Voltage TEP2 Encryption for MSR transaction",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 5  |
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |",Card Swipe
"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |",Extract Card Data
"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |",Extract Card Data
"@msr @tep4 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Voltage Encryption Tep4 for MSR Transaction
""""""
This feature file validates Voltage Encryption Tep4 for MSR Transaction.
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1236
""""""
Scenario Outline: Voltage TEP4 Encryption for MSR transaction",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 6  |
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |",Card Swipe
"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |",Extract Card Data
"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |",Extract Card Data
"| p61_res_status                | 2  |
When I send a 61.x Read Configuration message to the terminal with:
""""""
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Scenario Outline: verify pin block decryption is correct for msr transaction when encryption is off
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
This feature file verify pin block decryption is correct for msr transaction when encryption is off
Then I should receive the 00.x Offline response from terminal with params:
Feature:  Validate  dukpt pin for msr transaction when encryption is off
Given I send a 00.x Offline message to the terminal with params:
@pin_code @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
""""""
| p61_res_data_config_parameter | 0  |
| p61_res_group_num             | 91 |
based on ticket https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1252
| p00_res_reason_code | 0000 |
##################select dukpt pin################""
Then I should receive the 61.x Read Configuration response from terminal with params:
And I wait until Element ""imageOffline"" visible",Precondition
"| p61_res_status                | 2  |
based on ticket https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1252
And I Wait until Element ""title"" contains ""This Lane Closed""
@pin_code @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
##################select dukpt pin################""
This feature file verify pin block decryption is correct for msr transaction when encryption is off
Feature:  Validate  dukpt pin for msr transaction when encryption is off
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_data_config_parameter | 0  |
| p61_res_group_num             | 91 |
And I wait until Element ""imageOffline"" visible
| p61_res_index_num             | 1  |
""""""
| p61_req_group_num | 91 |
""""""
When I send a 61.x Read Configuration message to the terminal with:
Scenario Outline: verify pin block decryption is correct for msr transaction when encryption is off
| p00_req_reason_code | 0000 |
| p61_req_index_num | 1  |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"When I send a 60.x Configuration Write message to the terminal with:
Then I should receive the 60.x Configuration Write response from terminal with params:
| p60_req_index_num         | 7 |
| p60_res_status | 2 |
When I send a 60.x Configuration Write message to the terminal with:
| p60_req_data_config_param | 0 |
| p60_req_index_num         | 8 |
| p60_req_group_num         | 6 |
| p60_req_group_num         | 6 |
| p60_req_data_config_param | 1 |",Unknown
"| p60_req_index_num         | 8 |
| p60_req_data_config_param | 1 |
| p60_req_group_num         | 6 |
| p60_req_data_config_param | 0 |
| p60_req_index_num         | 7 |
| p60_req_group_num         | 6 |
| p60_res_status | 2 |
Then I should receive the 60.x Configuration Write response from terminal with params:
When I send a 60.x Configuration Write message to the terminal with:
When I send a 60.x Configuration Write message to the terminal with:",Unknown
"Then I should receive the 60.x Configuration Write response from terminal with params:
################## swipe the card #########################""
| p60_res_status | 2 |",Unknown
"################## swipe the card #########################""
| p60_res_status | 2 |
Then I should receive the 60.x Configuration Write response from terminal with params:",Unknown
"And  I wait until Element ""btn_cancel"" visible
When I send a 23.x Read Card message to the terminal with:
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |",Card Swipe
"And  I wait until Element ""btn_cancel"" visible
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
When I send a 23.x Read Card message to the terminal with:
Then I Wait until Element ""title"" contains ""Please slide card""",Card Swipe
"| p23_res_exit_type   | 0                                            |
| track3 |                                              |
#################### send 31.x message for pin entry #############################
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_card_source | M                                            |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      |                                              |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",CVM Process
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
When Axium swipe magnetic card:
| track3 |                                              |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
#################### send 31.x message for pin entry #############################
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      |                                              |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_card_source | M                                            |",CVM Process
"| p31_req_set_key_type                 | D     |
| p31_res_pin_data       | @regexp:.* |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_customer_acc_num             | <pan> |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_status         | 0          |
And I enter pin ""<pin_code>""
When I send a 31.x PIN Entry message to the terminal with:
################################# decrypt the enetered pin ###############################
| p31_req_form_name                    |       |
############################### enter pin #############################
| p31_res_pin_data_block | @regexp:.* |
| p31_req_prompt_index_number          | 1     |
| p31_req_set_encryption_configuration | *     |",CVM Process
"############################### enter pin #############################
| p31_req_customer_acc_num             | <pan> |
| p31_res_pin_data_ksn   | @regexp:.* |
################################# decrypt the enetered pin ###############################
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1     |
| p31_req_form_name                    |       |
| p31_req_set_encryption_configuration | *     |
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data       | @regexp:.* |
| p31_res_status         | 0          |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_set_key_type                 | D     |",CVM Process
"| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| length   | <pin_length>                  |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| pinblock | 0<pin_length><pin_code><tail> |
| tail     | <tail>                        |
| pin_code | <pin_code>                    |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
Examples:
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |",Unknown
"| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |
| tail     | <tail>                        |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| length   | <pin_length>                  |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| pinblock | 0<pin_length><pin_code><tail> |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| pin_code | <pin_code>                    |
Examples:",Unknown
"Scenario Outline:  Check MSR flow using 41.x (track1 ,track2)
""""""
This feature file Validates MSR transaction using 41.x Card Read Request
Feature:Swipe Transaction with 41.x Card Read with parse fields
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1160.
""""""
@41x @msr @00x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Unknown
"""""""
""""""
@41x @msr @00x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
This feature file Validates MSR transaction using 41.x Card Read Request
Feature:Swipe Transaction with 41.x Card Read with parse fields
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1160.
Scenario Outline:  Check MSR flow using 41.x (track1 ,track2)",Unknown
"And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"| p41_req_contactless_flag | 0 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_smc_flag         | 0 |
| p41_req_msr_flag         | 1 |
| p41_req_parse_flag       | 1 |",Unknown
"| p41_req_smc_flag         | 0 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_parse_flag       | 1 |",Unknown
Then I wait for 23 seconds,Unknown
Then I wait for 23 seconds,Unknown
"When I swipe card using this params:
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3_data |                                              |",Unknown
"| track3_data |                                              |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When I swipe card using this params:
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |",Unknown
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"| p41_res_error_code      | 0                                            |
| p41_res_track_3_status  | 1                                            |
| p41_res_account_name    | <name>                                       |
| p41_res_masked_pan      | <pan>                                        |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_track_3         |                                              |
| p41_res_source          | M                                            |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_track_2_status  | 0                                            |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_encryption      | 00                                           |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_track_1_status  | 0                                            |
| p41_res_pan             | <pan>                                        |",Unknown
"| p41_res_expiration_date | <exp_date>                                   |
| p41_res_encryption      | 00                                           |
| p41_res_error_code      | 0                                            |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_masked_pan      | <pan>                                        |
| p41_res_track_3_status  | 1                                            |
| p41_res_source          | M                                            |
| p41_res_track_3         |                                              |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_track_1_status  | 0                                            |
| p41_res_track_2_status  | 0                                            |
| p41_res_pan             | <pan>                                        |
| p41_res_account_name    | <name>                                       |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2>         |",Unknown
"| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000398 |
| p29_res_variable_data |<name>  |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
| p29_res_variable_id   | 000399 |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
| p29_res_variable_data | <exp_date> |
| p29_res_variable_id   | 000400     |
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_data | <pan>  |
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"| p29_res_variable_data | <pan>  |
| p29_req_variable_id | 400 |
| p29_req_variable_id | 398 |
| p29_res_status        | 2          |
| p29_res_variable_data | <exp_date> |
| p29_res_status        | 2      |
| p29_req_variable_id | 399 |
| p29_res_variable_id   | 000400     |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data |<name>  |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"| AMEX 1     | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 57431313685          | 13685         |
Examples:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 00.x Offline message to the terminal with params:
| VISA       | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372      | 887693372     |
Scenario Outline:  Check MSR flow using 41.x (track1 only)
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| DISCOVER   | 6510000000000091    | CARD/IMAGE 09             | 1712     | 702  | 1000041300000        | 1000041300000 |
And I wait until Element ""imageOffline"" visible
| card_type  | pan                 | name                      | exp_date | code | disc_data_t1         | disc_data_t2  |
Then I should receive the 00.x Offline response from terminal with params:
| MasterCard | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 122560965000469      | 965000469     |
| Diners     | 36039667170472      | PETTITT/JO                | 0012     | 521  | 16010000000000000946 | 1000041300000 |
| p00_res_reason_code | 0000 |
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Scenario Outline:  Check MSR flow using 41.x (track1 only)
| p00_res_reason_code | 0000 |
| AMEX 1     | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 57431313685          | 13685         |
When I send a 00.x Offline message to the terminal with params:
| VISA       | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372      | 887693372     |
| p00_res_reason_code | 0000 |
| DISCOVER   | 6510000000000091    | CARD/IMAGE 09             | 1712     | 702  | 1000041300000        | 1000041300000 |
| MasterCard | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 122560965000469      | 965000469     |
| Diners     | 36039667170472      | PETTITT/JO                | 0012     | 521  | 16010000000000000946 | 1000041300000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Examples:
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
| card_type  | pan                 | name                      | exp_date | code | disc_data_t1         | disc_data_t2  |",Precondition
"| p41_req_smc_flag         | 0 |
| p41_req_contactless_flag | 0 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |",Unknown
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_smc_flag         | 0 |
| p41_req_contactless_flag | 0 |
| p41_req_msr_flag         | 1 |",Unknown
Then I wait for 3 seconds,Unknown
Then I wait for 3 seconds,Unknown
"| track2_data |                                              |
| track3_data |                                              |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When I swipe card using this params:",Unknown
"When I swipe card using this params:
| track3_data |                                              |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data |                                              |",Unknown
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"| p41_res_track_3         |                                              |
| p41_res_pan             | <pan>                                        |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_account_name    | <name>                                       |
| p41_res_source          | M                                            |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_encryption      | 00                                           |
| p41_res_track_2         |                                              |
| p41_res_error_code      | 0                                            |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_track_1_status  | 0                                            |
| p41_res_track_3_status  | 1                                            |
| p41_res_track_2_status  | 1                                            |
| p41_res_masked_pan      | <pan>                                        |",Unknown
"| p41_res_account_name    | <name>                                       |
| p41_res_track_3         |                                              |
| p41_res_track_2_status  | 1                                            |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_error_code      | 0                                            |
| p41_res_pan             | <pan>                                        |
| p41_res_track_2         |                                              |
| p41_res_source          | M                                            |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_track_3_status  | 1                                            |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_track_1_status  | 0                                            |
| p41_res_encryption      | 00                                           |
| p41_res_masked_pan      | <pan>                                        |",Unknown
"| p29_req_variable_id | 399 |
| p29_res_status        | 2          |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
| p29_res_variable_data |<name>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <pan>  |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000400     |
| p29_res_variable_id   | 000399 |
| p29_req_variable_id | 398 |
| p29_res_variable_id   | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <exp_date> |",Extract Card Data
"| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
| p29_res_status        | 2      |
| p29_res_variable_data |<name>  |
| p29_res_variable_id   | 000400     |
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <pan>  |
| p29_res_variable_id   | 000399 |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |
| p29_res_variable_data | <exp_date> |
| p29_res_variable_id   | 000398 |",Extract Card Data
"Given I send a 00.x Offline message to the terminal with:
| VISA       | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372      |
| p00_req_reason_code | 0000 |
Examples:
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
| AMEX 1     | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 57431313685          |
| Diners     | 36039667170472      | PETTITT/JO                | 0012     | 521  | 16010000000000000946 |
| DISCOVER   | 6510000000000091    | CARD/IMAGE 09             | 1712     | 702  | 1000041300000        |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| MasterCard | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 122560965000469      |
Then I should receive the 00.x Offline response from terminal with params:
When I send a 00.x Offline message to the terminal with params:
Scenario Outline: Check MSR flow while using 41.x (track2 only)
| card_type  | pan                 | name                      | exp_date | code | disc_data_t1         |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p00_req_reason_code | 0000 |
Scenario Outline: Check MSR flow while using 41.x (track2 only)
When I send a 00.x Offline message to the terminal with params:
Examples:
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with:
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| MasterCard | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 122560965000469      |
| Diners     | 36039667170472      | PETTITT/JO                | 0012     | 521  | 16010000000000000946 |
| card_type  | pan                 | name                      | exp_date | code | disc_data_t1         |
| VISA       | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372      |
And I Wait until Element ""title"" contains ""This Lane Closed""
| DISCOVER   | 6510000000000091    | CARD/IMAGE 09             | 1712     | 702  | 1000041300000        |
| p00_res_reason_code | 0000 |
| AMEX 1     | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 57431313685          |",Precondition
"| p41_req_msr_flag         | 1 |
| p41_req_smc_flag         | 0 |
| p41_req_contactless_flag | 0 |
| p41_req_parse_flag       | 1 |
When I send a 41.x Card Read Message message to the terminal with params:",Unknown
"| p41_req_smc_flag         | 0 |
| p41_req_msr_flag         | 1 |
| p41_req_parse_flag       | 1 |
| p41_req_contactless_flag | 0 |
When I send a 41.x Card Read Message message to the terminal with params:",Unknown
Then I wait for 3 seconds,Unknown
Then I wait for 3 seconds,Unknown
"| track3_data |                                      |
When I swipe card using this params:
| track2_data | <pan>=<exp_date><code><disc_data_t2> |
| track1_data |                                      |",Unknown
"| track3_data |                                      |
When I swipe card using this params:
| track2_data | <pan>=<exp_date><code><disc_data_t2> |
| track1_data |                                      |",Unknown
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"| p41_res_track_3         |                                      |
| p41_res_error_code      | 0                                    |
| p41_res_source          | M                                    |
| p41_res_track_3_status  | 1                                    |
| p41_res_track_2_status  | 0                                    |
| p41_res_encryption      | 00                                   |
| p41_res_track_1         |                                      |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_account_name    |                                      |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2> |
| p41_res_track_1_status  | 1                                    |
| p41_res_pan             | <pan>                                |
| p41_res_expiration_date | <exp_date>                           |
| p41_res_masked_pan      | <pan>                                |",Unknown
"| p41_res_track_3_status  | 1                                    |
| p41_res_track_2_status  | 0                                    |
| p41_res_account_name    |                                      |
| p41_res_encryption      | 00                                   |
| p41_res_source          | M                                    |
| p41_res_expiration_date | <exp_date>                           |
| p41_res_pan             | <pan>                                |
| p41_res_track_3         |                                      |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2> |
| p41_res_masked_pan      | <pan>                                |
| p41_res_error_code      | 0                                    |
| p41_res_track_1         |                                      |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_track_1_status  | 1                                    |",Unknown
"| p29_res_variable_data |        |
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_req_variable_id | 398 |
| p29_res_variable_id   | 000400     |
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_data | <pan>  |
| p29_res_variable_data | <exp_date> |",Extract Card Data
"| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
| p29_req_variable_id | 400 |
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data |        |
| p29_res_status        | 2          |
| p29_res_variable_data | <exp_date> |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <pan>  |
| p29_req_variable_id | 398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000400     |",Extract Card Data
"Examples:
| AMEX 1     | 37158413190797   | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 13685         |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09             | 1712     | 702  | 1000041300000 |
| MasterCard | 45358179327829   | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 965000469     |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
| card_type  | pan              | name                      | exp_date | code | disc_data_t2  |
| Diners     | 36039667170472   | PETTITT/JO                | 0012     | 521  | 1000041300000 |
| VISA       | 34798979016630   | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 823693372     |
| p00_res_reason_code | 0000 |",Precondition
"| Diners     | 36039667170472   | PETTITT/JO                | 0012     | 521  | 1000041300000 |
| AMEX 1     | 37158413190797   | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 13685         |
| card_type  | pan              | name                      | exp_date | code | disc_data_t2  |
| p00_res_reason_code | 0000 |
| VISA       | 34798979016630   | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 823693372     |
Then I should receive the 00.x Offline response from terminal with params:
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09             | 1712     | 702  | 1000041300000 |
| MasterCard | 45358179327829   | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 965000469     |
Examples:
When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"Scenario: Enable On-Guard SDE Encryption Configuration
@sde @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
based on ticket ARC-5325
This feature file validates Validate On-Guard SDE Encryption for MSR transaction with one track only card data
Feature:  Validate On-Guard SDE Encryption for MSR transaction with 1 only track card data
""""""
""""""",Unknown
"Feature:  Validate On-Guard SDE Encryption for MSR transaction with 1 only track card data
This feature file validates Validate On-Guard SDE Encryption for MSR transaction with one track only card data
based on ticket ARC-5325
@sde @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
""""""
Scenario: Enable On-Guard SDE Encryption Configuration
""""""",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p62_req_unpack_flag     | 0                 |
| p62_res_status      | 0            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B                 |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_res_file_length | @regexp:.\d* |
| p62_req_fast_download   | 1                 |
| p62_req_file_name       | ArcOnGuardSDE.apk |",Unknown
"Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
| p62_res_status      | 0            |
| p62_req_encoding_format | B                 |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_res_file_length | @regexp:.\d* |
| p62_req_file_name       | ArcOnGuardSDE.apk |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p61_res_data_config_parameter | 19 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track1 data
| p61_res_status                | 2  |
| p00_res_reason_code | 0000 |
| p61_req_group_num | 91 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 19 |
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
Then I should receive the 00.x Offline response from terminal with params:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p00_req_reason_code | 0000 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_group_num             | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:",Precondition
"| p61_res_status                | 2  |
| p00_req_reason_code | 0000 |
| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 19 |
| p61_res_status                | 2  |
| p00_res_reason_code | 0000 |
| p61_res_index_num             | 1  |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track1 data
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_group_num             | 91 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
Then I should receive the 00.x Offline response from terminal with params:
| p61_req_index_num | 1  |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
Then I should receive the 61.x Read Configuration response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"| track2 |                                              |
| track3 |                                              |
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track2      |                                                              |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                            |
Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                                            |
When Axium swipe magnetic card:",Card Swipe
"| p23_res_track2      |                                                              |
When Axium swipe magnetic card:
| p23_res_exit_type   | 0                                                            |
| track3 |                                              |
| track2 |                                              |
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_card_source | M                                                            |",Card Swipe
"Examples:
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 5413330000000011 | 000000000000000              | \x00\x00\x00\x00\x00\x00 |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 36039600000472   | 00000000000000000000         | \x00\x00                 |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | masked_pan       | masked_disc_data_t1          | null_characters          |
| result | B<pan>^<name>^<exp_date><code><disc_data_t1><null_characters> |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 6510000000000091 | 0000000000000                | \x00\x00\x00\x00         |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 4264510000005621 | 0000000000000000000000000000 |                          |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 374245000001008  | 000000000                    | \x00\x00\x00\x00         |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track2 data",Unknown
"| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 4264510000005621 | 0000000000000000000000000000 |                          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 5413330000000011 | 000000000000000              | \x00\x00\x00\x00\x00\x00 |
| result | B<pan>^<name>^<exp_date><code><disc_data_t1><null_characters> |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | masked_pan       | masked_disc_data_t1          | null_characters          |
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 36039600000472   | 00000000000000000000         | \x00\x00                 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track2 data
Examples:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 374245000001008  | 000000000                    | \x00\x00\x00\x00         |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 6510000000000091 | 0000000000000                | \x00\x00\x00\x00         |",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p61_res_group_num             | 91 |
| p00_res_reason_code | 0000 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
| p00_req_reason_code | 0000 |
| p61_res_data_config_parameter | 19 |
Then I should receive the 61.x Read Configuration response from terminal with params:",Precondition
"| p61_res_index_num             | 1  |
Given I send a 00.x Offline message to the terminal with params:
| p61_req_index_num | 1  |
| p00_req_reason_code | 0000 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 19 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p23_req_prompt_index   | 3 |
And  I wait until Element ""btn_cancel"" visible
When I send a 23.x Read Card message to the terminal with:
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |",Card Swipe
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible
| p23_req_enable_devices | M |",Card Swipe
"| track1 |                                      |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>? |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | @regexp:.+                                           |
| p23_res_card_source | M                                                    |
| p23_res_exit_type   | 0                                                    |
| track3 |                                      |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| p23_res_track1      |                                                      |
When Axium swipe magnetic card:",Card Swipe
"| track1 |                                      |
| p23_res_track3      | @regexp:.+                                           |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| p23_res_card_source | M                                                    |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>? |
| p23_res_track1      |                                                      |
When Axium swipe magnetic card:
| p23_res_exit_type   | 0                                                    |
| track3 |                                      |",Card Swipe
"Scenario: Teardown - Reset to Default State
| result | <pan>=<exp_date><code><disc_data_t2><null_characters> |
| card_type  | pan              | exp_date | code | disc_data_t2   | masked_pan       | masked_disc_data_t2 | null_characters      |
| VISA       | 4264510228395621 | 1709     | 206  | 0000070400100  | 4264510000005621 | 0000000000000       | \x00\x00\x00         |
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| Amex       | 374245001731008  | 2103     | 201  | 15041234500000 | 374245000001008  | 00000000000000      | \x00\x00\x00         |
| Mastercard | 5413330089020011 | 2412     | 221  | 0000014000001  | 5413330000000011 | 0000000000000       | \x00\x00\x00         |
Examples:
| DISCOVER   | 6510000000000091 | 1712     | 702  | 1000041300000  | 6510000000000091 | 0000000000000       | \x00\x00\x00         |
| Diners     | 36039667170472   | 0012     | 521  | 1000041300000  | 36039600000472   | 0000000000000       | \x00\x00\x00\x00\x00 |",Unknown
"| VISA       | 4264510228395621 | 1709     | 206  | 0000070400100  | 4264510000005621 | 0000000000000       | \x00\x00\x00         |
| Diners     | 36039667170472   | 0012     | 521  | 1000041300000  | 36039600000472   | 0000000000000       | \x00\x00\x00\x00\x00 |
Examples:
| Mastercard | 5413330089020011 | 2412     | 221  | 0000014000001  | 5413330000000011 | 0000000000000       | \x00\x00\x00         |
| Amex       | 374245001731008  | 2103     | 201  | 15041234500000 | 374245000001008  | 00000000000000      | \x00\x00\x00         |
| result | <pan>=<exp_date><code><disc_data_t2><null_characters> |
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| DISCOVER   | 6510000000000091 | 1712     | 702  | 1000041300000  | 6510000000000091 | 0000000000000       | \x00\x00\x00         |
| card_type  | pan              | exp_date | code | disc_data_t2   | masked_pan       | masked_disc_data_t2 | null_characters      |
Scenario: Teardown - Reset to Default State",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |",Precondition
"""""""
| p62_req_unpack_flag     | 0                   |
This feature file validates chapterX Encryption for MSR transaction
""""""
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_status                | 2  |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1                   |
Scenario Outline: chapter X Encryption For MSR Transaction
@p2p @chapter_x @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: validate chapter X Decryption
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_encoding_format | B                   |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
| p62_res_status      | 0          |
Then I should receive the 61.x Configuration Read response from terminal with params:
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1348
| p61_req_index_num | 1  |
| p61_req_group_num | 91 |
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_res_group_num             | 91 |",Unknown
"| p62_req_file_name       | ArcNoEncryption.apk |
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
Feature: validate chapter X Decryption
| p62_res_status      | 0          |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_unpack_flag     | 0                   |
This feature file validates chapterX Encryption for MSR transaction
| p61_res_data_config_parameter | 0  |
| p61_res_group_num             | 91 |
| p62_req_fast_download   | 1                   |
Scenario Outline: chapter X Encryption For MSR Transaction
| p61_req_index_num | 1  |
""""""
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_index_num             | 1  |
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1348
@p2p @chapter_x @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_res_file_length | @regexp:.* |
""""""
| p62_req_encoding_format | B                   |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p61_res_data_config_parameter | 30 |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
| p61_req_group_num | 91 |
| p61_res_status                | 2  |",Unknown
"| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |
When I send a 61.x Configuration Read message to the terminal with:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_index_num | 1  |
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |",Unknown
"| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_enable_devices | M          |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |
| p23_req_prompt_index   | 311        |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_enable_devices | M          |",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"And  I wait until Element ""btn_cancel"" visible",Unknown
"| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
| p23_res_exit_type   | 0                                                            |
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
When Axium swipe magnetic card:
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_card_source | M                                                            |
Then I should receive the 23.x Card Read response from terminal with params:",Card Swipe
"| track3 | <additional_data><additional_data>           |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                            |
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_card_source | M                                                            |",Card Swipe
"| ey_track1_decrypted | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>.+$ |
Examples:
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-993.
Feature: Validate On Guard FPE Encryption for MSR Transaction
""""""
| Mastercard | 541389099130     | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 541389000130     | 00000000000000000000         | 0000000000000       | FFFFFFFFFFFFFFF |
| ez_track2_decrypted | <pan>D<exp_date><code><disc_data_t2><null_characters>      |
Scenario Outline: On-Guard FPE Encryption For MSR Transaction
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | FFFFFFFFFFFFF   |
This feature file validates On Guard FPE Encryption For MSR Transaction
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000000000000     | 0000000000000       | FFFFFFFFFFF     |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | FFFFFFFFFFF     |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | FFFFFFFFFFF     |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       | FFFFFFFFFFF     |
@msr @fpe @00x @61x @23x @62x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
And decrypted field 'p23_res_track3' with Chapter X algorithm should match the following data:
| ret                 | 00                                                         |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | FFFFFFFFFFF     |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters |",Unknown
"| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters |
| ez_track2_decrypted | <pan>D<exp_date><code><disc_data_t2><null_characters>      |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | FFFFFFFFFFF     |
@msr @fpe @00x @61x @23x @62x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario Outline: On-Guard FPE Encryption For MSR Transaction
| ey_track1_decrypted | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>.+$ |
And decrypted field 'p23_res_track3' with Chapter X algorithm should match the following data:
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-993.
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       | FFFFFFFFFFF     |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | FFFFFFFFFFFFF   |
| ret                 | 00                                                         |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000000000000     | 0000000000000       | FFFFFFFFFFF     |
""""""
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | FFFFFFFFFFF     |
Examples:
| Mastercard | 541389099130     | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 541389000130     | 00000000000000000000         | 0000000000000       | FFFFFFFFFFFFFFF |
""""""
This feature file validates On Guard FPE Encryption For MSR Transaction
Feature: Validate On Guard FPE Encryption for MSR Transaction
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | FFFFFFFFFFF     |",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_data_config_parameter | 2  |
| p61_req_index_num | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |",Unknown
"Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 2  |",Unknown
"| p23_req_enable_devices | M          |
When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |
| p23_req_prompt_index   | 311        |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M          |
| p23_req_form_name      | read_cards |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_prompt_index   | 311        |",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"And  I wait until Element ""btn_cancel"" visible",Unknown
"| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
When Axium swipe magnetic card:
| p23_res_track3      | @regexp:.+                                                   |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| track3 | <additional_data><additional_data>           |
| p23_res_card_source | M                                                            |",Card Swipe
"| track3 | <additional_data><additional_data>           |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
When Axium swipe magnetic card:
| p23_res_exit_type   | 0                                                            |
| p23_res_track3      | @regexp:.+                                                   |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_card_source | M                                                            |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"Feature: Validate On-Guard SDE Encryption for MSR transaction
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |
""""""
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-985
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
And decrypted field ""p23_res_track3"" with ON GUARD algorithm should match the following MSR data:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      |
#Step 5
This feature file validates On-Guard SDE Encryption for MSR transaction
""""""
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       |
@sde @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Examples:",Unknown
"Scenario Outline: On-Guard SDE Encryption For MSR Transaction
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      |
Examples:
And decrypted field ""p23_res_track3"" with ON GUARD algorithm should match the following MSR data:
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       |
""""""
@sde @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
Feature: Validate On-Guard SDE Encryption for MSR transaction
""""""
This feature file validates On-Guard SDE Encryption for MSR transaction
#Step 5
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-985
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       |",Unknown
"Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_data_config_parameter | 19 |
| p61_req_index_num | 1  |
Given I send a 00.x Offline message to the terminal with params:
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p61_res_index_num             | 1  |
When I send a 61.x Read Configuration message to the terminal with:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_index_num             | 1  |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 19 |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p61_req_index_num | 1  |
| p61_res_status                | 2  |",Precondition
"When I send a 23.x Read Card message to the terminal with:
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"And  I wait until Element ""btn_cancel"" visible
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |",Card Swipe
"When Axium swipe magnetic card:
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_card_source | M                                                            |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_exit_type   | 0                                                            |
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_exit_type   | 0                                                            |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                                            |
When Axium swipe magnetic card:",Card Swipe
"This feature file validates RSA Encryption for MSR transaction
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          |
@rsa @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
Examples:
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\|<pan>=<exp_date><code><disc_data_t2><null_characters> |
#Step 5
""""""
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
""""""
Feature: Validate RSA Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1313
Scenario Outline: RSA Encryption For MSR Transaction
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |                          |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |                          |",Unknown
"Scenario Outline: RSA Encryption For MSR Transaction
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
#Step 5
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |                          |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
""""""
""""""
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\|<pan>=<exp_date><code><disc_data_t2><null_characters> |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
@rsa @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |                          |
This feature file validates RSA Encryption for MSR transaction
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
Feature: Validate RSA Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1313
Examples:
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:",Unknown
"When I send a 61.x Read Configuration message to the terminal with:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
| p61_res_data_config_parameter | 9  |
| p61_req_index_num | 1  |
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
Given I send a 00.x Offline message to the terminal with params:
| p61_res_status                | 2  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_index_num             | 1  |
| p00_res_reason_code | 0000 |",Precondition
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
When I send a 61.x Read Configuration message to the terminal with:
| p00_req_reason_code | 0000 |
| p61_req_index_num | 1  |
| p00_res_reason_code | 0000 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_group_num             | 91 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |",Card Swipe
"| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                                            |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| track3 | <additional_data><additional_data>           |
| p23_res_exit_type   | 0                                                            |
When Axium swipe magnetic card:",Card Swipe
"| p23_res_exit_type   | 0                                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_card_source | M                                                            |
| p23_res_track3      | @regexp:.+                                                   |
Then I should receive the 23.x Card Read response from terminal with params:
| track3 | <additional_data><additional_data>           |
When Axium swipe magnetic card:
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"| p62_req_fast_download   | 1                            |
@sde @msr @00x @62x @61x @23x
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000000000000     | 0000000000000       |                          |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
""""""
And decrypted field 'p23_res_track3' with RSA OAEP algorithm should match '%B<pan>^<name>^<exp_date><code><disc_data_t1>?;<pan>=<exp_date><code><disc_data_t2>?'
Feature: Validate separator of On-Guard SDE Encryption for Manual Entry transaction
based on ticket    https://ingenico-nar.atlassian.net/browse/ARC-1299
##################### ########################################## #####################
Then I should receive the 62.x Write File response from terminal with params:
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |                          |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
When RSA OAEP algorithm private key is set to 'Files\p2p_encryptions\private_RSA_key\private_verify_key.pem'
""""""
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |                          |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
##################### Enable Onguard_SDE with specific separator #####################
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
| p62_req_unpack_flag     | 0                            |
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
Then raw field 'p23_res_track3' with RSA OAEP algorithm should have the following attributes:
Examples:
@dx8000 @ex8000 @dx4000
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
Note : ArcSec.json used in current FF is the version from DefaultConfig of ARC Build ""arc-app-23.09.03-0001""
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
| p62_req_encoding_format | B                            |
This feature file validates separator of On-Guard SDE Encryption for Manual Entry transaction
And a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
| cryptogram_length | 344 |",Unknown
"Feature: Validate separator of On-Guard SDE Encryption for Manual Entry transaction
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
| p62_req_encoding_format | B                            |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |                          |
""""""
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
Then I should receive the 62.x Write File response from terminal with params:
##################### ########################################## #####################
##################### Enable Onguard_SDE with specific separator #####################
And a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
based on ticket    https://ingenico-nar.atlassian.net/browse/ARC-1299
| p62_res_file_length | @regexp:.\d* |
@dx8000 @ex8000 @dx4000
@sde @msr @00x @62x @61x @23x
Then raw field 'p23_res_track3' with RSA OAEP algorithm should have the following attributes:
| p62_res_status      | 0            |
""""""
| p62_req_fast_download   | 1                            |
Note : ArcSec.json used in current FF is the version from DefaultConfig of ARC Build ""arc-app-23.09.03-0001""
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
Examples:
When RSA OAEP algorithm private key is set to 'Files\p2p_encryptions\private_RSA_key\private_verify_key.pem'
| cryptogram_length | 344 |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |                          |
| p62_req_unpack_flag     | 0                            |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000000000000     | 0000000000000       |                          |
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
And decrypted field 'p23_res_track3' with RSA OAEP algorithm should match '%B<pan>^<name>^<exp_date><code><disc_data_t1>?;<pan>=<exp_date><code><disc_data_t2>?'
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
This feature file validates separator of On-Guard SDE Encryption for Manual Entry transaction",Unknown
"| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_data_config_parameter | 19 |
| p61_req_group_num | 91 |
| p00_res_reason_code | 0000 |
When I send a 61.x Read Configuration message to the terminal with:
Then I should receive the 61.x Read Configuration response from terminal with params:
##################### Verify Onguard_SDE enabled #####################
##################### ##################### #####################
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
When I send a 00.x Offline message to the terminal with params:
| p61_res_group_num             | 91 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 19 |
| p00_res_reason_code | 0000 |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
##################### ##################### #####################
Then I should receive the 61.x Read Configuration response from terminal with params:
And I wait until Element ""imageOffline"" visible
##################### Verify Onguard_SDE enabled #####################
| p61_req_index_num | 1  |
| p00_req_reason_code | 0000 |
| p61_res_status                | 2  |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
When I send a 61.x Read Configuration message to the terminal with:",Precondition
"When I send a 23.x Read Card message to the terminal with:
Then I Wait until Element ""title"" contains ""Card""
| p23_req_enable_devices | M   |
| p23_req_prompt_index   | 372 |
And  I wait until Element ""btn_cancel"" visible
And  I wait until Element ""btn_manual_entry"" visible",Card Swipe
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 372 |
And  I wait until Element ""btn_manual_entry"" visible
Then I Wait until Element ""title"" contains ""Card""
And  I wait until Element ""btn_cancel"" visible
| p23_req_enable_devices | M   |",Card Swipe
"And I click Element ""ed_pan""
##################### Enter card details #####################
When I click Element ""btn_manual_entry""",Unknown
"When I click Element ""btn_manual_entry""
##################### Enter card details #####################
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"And I press enter button
And I send keys to Element ""ed_pan"" text ""<pan>""",Unknown
"And I click Element ""ed_expiry_date""",Unknown
"And I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"And I press enter button
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""",Unknown
"And I click Element ""ed_cvv""",Unknown
"And I click Element ""ed_cvv""",Unknown
"And I press enter button
And I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"And I click Element ""btn_manual_confirm""",Unknown
"And I click Element ""btn_manual_confirm""",Unknown
"| p23_res_exit_type   | 0                                                             |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_card_source | H                                                             |
| p23_res_track3      | @regexp:.{1,92}                                               |
| p23_res_track1      | %M<masked_pan>^<name>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?         |",Card Swipe
"| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?         |
| p23_res_exit_type   | 0                                                             |
| p23_res_card_source | H                                                             |
| p23_res_track1      | %M<masked_pan>^<name>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track3      | @regexp:.{1,92}                                               |
Then I should receive the 23.x Card Read response from terminal with params:",Card Swipe
"| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
| JCB        | 3569990010745082211 | MANUALLY/ENTERED | 1225     | 2512            | 601  | 3569990000000002211 | 000000000000000     | 000000000000        | \x00\x00\x00\x00             | ,         | 2C    |
| card_type  | pan                 | name             | exp_date | expect_exp_date | code | masked_pan          | masked_disc_data_t1 | masked_disc_data_t2 | null_characters              | separator | ASCII |
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
| Mastercard | 5413330089099130    | MANUALLY/ENTERED | 1226     | 2612            | 201  | 5413330000009130    | 000000000000000     | 000000000000        | \x00                         |           | empty |
| VISA       | 476173900101012010  | MANUALLY/ENTERED | 1229     | 2912            | 201  | 476173000000002010  | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | \x20      | 20    |
| DISCOVER   | 6510000000352591    | MANUALLY/ENTERED | 1227     | 2712            | 702  | 6510000000002591    | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00\x00 | %         | 25    |
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
##################### Enable Onguard_SDE with specific separator #####################
| p62_req_unpack_flag     | 0                            |
Examples:
Then I should receive the 62.x Write File response from terminal with params:
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
| VISA       | 42645122835621      | MANUALLY/ENTERED | 1227     | 2712            | 206  | 42645100005621      | 000000000000000     | 000000000000        | \x00                         | \|        | 7C    |
##################### ########################################## #####################
And a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
| Amex       | 374245001748        | MANUALLY/ENTERED | 1225     | 2512            | 201  | 374245000748        | 000000000000000     | 000000000000        | \x00\x00\x00                 | ;         | 3B    |
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| p62_req_fast_download   | 1                            |
| p62_res_file_length | @regexp:.\d* |
| Mastercard | 5413332389          | MANUALLY/ENTERED | 1224     | 2412            | 221  | 5413330009          | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | #         | 23    |
@rx5000 @rx7000
| result | <pan><separator><expect_exp_date><separator><code><null_characters> |
| p62_req_encoding_format | B                            |
| Diners     | 36039667176631472   | MANUALLY/ENTERED | 1228     | 2812            | 521  | 36039600000001472   | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00     | &         | 26    |
| p62_res_status      | 0            |",Unknown
"| p62_res_file_length | @regexp:.\d* |
| card_type  | pan                 | name             | exp_date | expect_exp_date | code | masked_pan          | masked_disc_data_t1 | masked_disc_data_t2 | null_characters              | separator | ASCII |
| Mastercard | 5413330089099130    | MANUALLY/ENTERED | 1226     | 2612            | 201  | 5413330000009130    | 000000000000000     | 000000000000        | \x00                         |           | empty |
| DISCOVER   | 6510000000352591    | MANUALLY/ENTERED | 1227     | 2712            | 702  | 6510000000002591    | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00\x00 | %         | 25    |
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
| Amex       | 374245001748        | MANUALLY/ENTERED | 1225     | 2512            | 201  | 374245000748        | 000000000000000     | 000000000000        | \x00\x00\x00                 | ;         | 3B    |
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
| result | <pan><separator><expect_exp_date><separator><code><null_characters> |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
| p62_req_unpack_flag     | 0                            |
| Diners     | 36039667176631472   | MANUALLY/ENTERED | 1228     | 2812            | 521  | 36039600000001472   | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00     | &         | 26    |
Then I should receive the 62.x Write File response from terminal with params:
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| VISA       | 476173900101012010  | MANUALLY/ENTERED | 1229     | 2912            | 201  | 476173000000002010  | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | \x20      | 20    |
| p62_res_status      | 0            |
@rx5000 @rx7000
And a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
Examples:
| VISA       | 42645122835621      | MANUALLY/ENTERED | 1227     | 2712            | 206  | 42645100005621      | 000000000000000     | 000000000000        | \x00                         | \|        | 7C    |
##################### Enable Onguard_SDE with specific separator #####################
| p62_req_fast_download   | 1                            |
| p62_req_encoding_format | B                            |
| Mastercard | 5413332389          | MANUALLY/ENTERED | 1224     | 2412            | 221  | 5413330009          | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | #         | 23    |
| JCB        | 3569990010745082211 | MANUALLY/ENTERED | 1225     | 2512            | 601  | 3569990000000002211 | 000000000000000     | 000000000000        | \x00\x00\x00\x00             | ,         | 2C    |
##################### ########################################## #####################",Unknown
"##################### ##################### #####################
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
| p61_res_index_num             | 1  |
When I send a 00.x Offline message to the terminal with params:
| p61_res_group_num             | 91 |
And I wait until Element ""imageOffline"" visible
##################### Verify Onguard_SDE enabled #####################
| p61_req_group_num | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
When I send a 61.x Read Configuration message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_data_config_parameter | 19 |
| p61_req_index_num | 1  |",Precondition
"| p00_res_reason_code | 0000 |
| p61_res_group_num             | 91 |
##################### ##################### #####################
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
Then I should receive the 61.x Read Configuration response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 19 |
When I send a 00.x Offline message to the terminal with params:
| p61_req_group_num | 91 |
##################### Verify Onguard_SDE enabled #####################",Precondition
"Then I Wait until Element ""title"" contains ""Card""
And  I wait until Element ""btn_manual_entry"" visible
| p23_req_enable_devices | M   |
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 372 |
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Card""
| p23_req_prompt_index   | 372 |
When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_manual_entry"" visible
| p23_req_enable_devices | M   |",Card Swipe
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""
##################### Enter card details #####################",Unknown
"And I click Element ""ed_pan""
##################### Enter card details #####################
When I click Element ""btn_manual_entry""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"And I click Element ""ed_expiry_date""",Unknown
"And I click Element ""ed_expiry_date""",Unknown
"And I press enter button
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"And I click Element ""ed_cvv""",Unknown
"And I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>"" and then ENTER",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>"" and then ENTER",Unknown
"| p23_res_track1      | %M<masked_pan>^<name>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?         |
| p23_res_exit_type   | 0                                                             |
| p23_res_card_source | H                                                             |
| p23_res_track3      | @regexp:.{1,92}                                               |
Then I should receive the 23.x Card Read response from terminal with params:",Card Swipe
"| p23_res_track3      | @regexp:.{1,92}                                               |
| p23_res_exit_type   | 0                                                             |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track1      | %M<masked_pan>^<name>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_card_source | H                                                             |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?         |",Card Swipe
"| p61_res_data_config_parameter | 0  |
| p61_res_group_num             | 91 |
Scenario: Teardown - Reset to Default State
| p62_req_unpack_flag     | 0                   |
| p62_res_status      | 0          |
| DISCOVER   | 6510000000352591    | MANUALLY/ENTERED | 1227     | 2712            | 702  | 6510000000002591    | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00\x00 | %         | 25    |
| p62_res_file_length | @regexp:.* |
Then I should receive the 61.x Configuration Read response from terminal with params:
| VISA       | 42645122835621      | MANUALLY/ENTERED | 1227     | 2712            | 206  | 42645100005621      | 000000000000000     | 000000000000        | \x00                         | \|        | 7C    |
| p62_req_encoding_format | B                   |
| p61_req_group_num | 91 |
| Mastercard | 5413330089099130    | MANUALLY/ENTERED | 1226     | 2612            | 201  | 5413330000009130    | 000000000000000     | 000000000000        | \x00                         |           | empty |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| Amex       | 374245001748        | MANUALLY/ENTERED | 1225     | 2512            | 201  | 374245000748        | 000000000000000     | 000000000000        | \x00\x00\x00                 | ;         | 3B    |
| Mastercard | 5413332389          | MANUALLY/ENTERED | 1224     | 2412            | 221  | 5413330009          | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | #         | 23    |
Examples:
Given a existing file ""Files/p2p_encryptions/ArcNoEncryption.apk""
| result | <pan><separator><expect_exp_date><separator><code><null_characters> |
| p61_res_status                | 2  |
| card_type  | pan                 | name             | exp_date | expect_exp_date | code | masked_pan          | masked_disc_data_t1 | masked_disc_data_t2 | null_characters              | separator | ASCII |
| p62_req_fast_download   | 1                   |
| JCB        | 3569990010745082211 | MANUALLY/ENTERED | 1225     | 2512            | 601  | 3569990000000002211 | 000000000000000     | 000000000000        | \x00\x00\x00\x00             | ,         | 2C    |
| Diners     | 36039667176631472   | MANUALLY/ENTERED | 1228     | 2812            | 521  | 36039600000001472   | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00     | &         | 26    |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_file_name       | ArcNoEncryption.apk |
| VISA       | 476173900101012010  | MANUALLY/ENTERED | 1229     | 2912            | 201  | 476173000000002010  | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | \x20      | 20    |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:",Unknown
"| p62_req_fast_download   | 1                   |
| Amex       | 374245001748        | MANUALLY/ENTERED | 1225     | 2512            | 201  | 374245000748        | 000000000000000     | 000000000000        | \x00\x00\x00                 | ;         | 3B    |
| p62_req_unpack_flag     | 0                   |
| Diners     | 36039667176631472   | MANUALLY/ENTERED | 1228     | 2812            | 521  | 36039600000001472   | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00     | &         | 26    |
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| p61_req_index_num | 1  |
| VISA       | 476173900101012010  | MANUALLY/ENTERED | 1229     | 2912            | 201  | 476173000000002010  | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | \x20      | 20    |
Given a existing file ""Files/p2p_encryptions/ArcNoEncryption.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| result | <pan><separator><expect_exp_date><separator><code><null_characters> |
| Mastercard | 5413330089099130    | MANUALLY/ENTERED | 1226     | 2612            | 201  | 5413330000009130    | 000000000000000     | 000000000000        | \x00                         |           | empty |
Scenario: Teardown - Reset to Default State
| DISCOVER   | 6510000000352591    | MANUALLY/ENTERED | 1227     | 2712            | 702  | 6510000000002591    | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00\x00 | %         | 25    |
| card_type  | pan                 | name             | exp_date | expect_exp_date | code | masked_pan          | masked_disc_data_t1 | masked_disc_data_t2 | null_characters              | separator | ASCII |
| p62_req_encoding_format | B                   |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Then I should receive the 61.x Configuration Read response from terminal with params:
| Mastercard | 5413332389          | MANUALLY/ENTERED | 1224     | 2412            | 221  | 5413330009          | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | #         | 23    |
Then I should receive the 62.x Write File response from terminal with params:
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
| p61_res_status                | 2  |
Examples:
| p62_res_file_length | @regexp:.* |
| VISA       | 42645122835621      | MANUALLY/ENTERED | 1227     | 2712            | 206  | 42645100005621      | 000000000000000     | 000000000000        | \x00                         | \|        | 7C    |
| JCB        | 3569990010745082211 | MANUALLY/ENTERED | 1225     | 2512            | 601  | 3569990000000002211 | 000000000000000     | 000000000000        | \x00\x00\x00\x00             | ,         | 2C    |
| p62_res_status      | 0          |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
When I send a 00.x Offline message to the terminal with params:",Precondition
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"""""""
""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1266
This feature file validates Voltage Encryption TEP6 for MSR Transaction.
@msr @tep6 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario Outline: Voltage TEP6 Encryption for MSR transaction
Feature: Validate Voltage Encryption Tep6 for MSR Transaction",Unknown
"This feature file validates Voltage Encryption TEP6 for MSR Transaction.
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1266
""""""
Feature: Validate Voltage Encryption Tep6 for MSR Transaction
Scenario Outline: Voltage TEP6 Encryption for MSR transaction
@msr @tep6 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
""""""",Unknown
"And I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
And I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |",Precondition
"| p61_res_data_config_parameter | 31 |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |",Unknown
"| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 31 |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:",Unknown
"| p23_req_enable_devices | M |
When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 3 |",Card Swipe
"| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"| p23_res_exit_type   | 0          |
| track3 | <additional_data><additional_data>           |
| p23_res_card_source | M          |
When Axium swipe magnetic card:
And  I wait until Element ""btn_cancel"" visible
Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track1      | @regexp:.* |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | @regexp:.* |
#this step is equivalent to the manual swipe of a card
| p23_res_track2      | @regexp:.* |",Card Swipe
"And  I wait until Element ""btn_cancel"" visible
| track3 | <additional_data><additional_data>           |
| p23_res_exit_type   | 0          |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | @regexp:.* |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
#this step is equivalent to the manual swipe of a card
When Axium swipe magnetic card:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | @regexp:.* |",Card Swipe
"And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |
And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Unknown
"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | @regexp:.* |
| p29_res_variable_id   | 000398     |
| p29_req_variable_id | 000398 |",Extract Card Data
"| p29_res_variable_id   | 000398     |
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | @regexp:.* |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000398 |",Extract Card Data
"| pan | <pan> |
And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:",Unknown
"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |",Unknown
"| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |
When I send a 29.x Get Variable message to the terminal with:
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
| p29_req_variable_id | 000399 |
#issue is when pan=12 digits to be checked
| p29_res_variable_id   | 000400     |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
| p29_res_status        | 2      |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |
| p29_res_variable_id   | 000399 |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
#  | Maestro    | 501833000060       | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
| p29_res_variable_data | <exp_date> |
Then I should receive the 29.x Get Variable response from terminal with params:
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| p29_res_status        | 2          |
Examples:
| p29_req_variable_id | 000400 |
| p29_res_variable_data | <name> |",Extract Card Data
"| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| p29_res_status        | 2      |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |
| p29_res_variable_data | <exp_date> |
| p29_res_status        | 2          |
| p29_res_variable_id   | 000399 |
| p29_res_variable_id   | 000400     |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
| p29_res_variable_data | <name> |
Then I should receive the 29.x Get Variable response from terminal with params:
Examples:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
#  | Maestro    | 501833000060       | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
| p29_req_variable_id | 000400 |
| p29_req_variable_id | 000399 |
#issue is when pan=12 digits to be checked
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
When I send a 29.x Get Variable message to the terminal with:
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |",Extract Card Data
"""""""
This feature file validates Voltage Encryption TEP7 for MSR Transaction.
Scenario Outline: Voltage TEP7 Encryption for MSR transaction
@msr @tep7 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1309
Feature: Validate Voltage Encryption Tep7 for MSR Transaction",Unknown
"Scenario Outline: Voltage TEP7 Encryption for MSR transaction
""""""
Feature: Validate Voltage Encryption Tep7 for MSR Transaction
@msr @tep7 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
This feature file validates Voltage Encryption TEP7 for MSR Transaction.
""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1309",Unknown
"And I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"And I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |",Precondition
"| p61_res_data_config_parameter | 32 |
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
And I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_group_num | 91 |",Unknown
"| p61_res_data_config_parameter | 32 |
| p61_req_index_num | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_status                | 2  |
And I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |",Unknown
"| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"| p23_res_track2      | @regexp:.* |
| p23_res_card_source | M          |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And  I wait until Element ""btn_cancel"" visible
#this step is equivalent to the manual swipe of a card
| p23_res_track1      | @regexp:.* |
| p23_res_exit_type   | 0          |
When Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | @regexp:.* |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"When Axium swipe magnetic card:
#this step is equivalent to the manual swipe of a card
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | @regexp:.* |
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | @regexp:.* |
| track3 | <additional_data><additional_data>           |
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |
And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:",Unknown
"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2> |",Unknown
"And I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | @regexp:.* |
| p29_req_variable_id | 000398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |",Extract Card Data
"| p29_res_variable_id   | 000398     |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | @regexp:.* |
| p29_req_variable_id | 000398 |
| p29_res_status        | 2          |
And I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"| pan | <pan> |
And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:",Unknown
"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |",Unknown
"| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
Then I should receive the 29.x Get Variable response from terminal with params:
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
| p29_req_variable_id | 000400 |
#issue is when pan=12 digits to be checked
| p29_res_variable_id   | 000400     |
Then I should receive the 29.x Get Variable response from terminal with params:
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
| p29_req_variable_id | 000399 |
| p29_res_variable_data | <exp_date> |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
| p29_res_variable_data | <name> |
| p29_res_status        | 2          |
Examples:
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
#  | Maestro    | 501833000060        | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |",Extract Card Data
"| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
Then I should receive the 29.x Get Variable response from terminal with params:
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000400     |
| p29_req_variable_id | 000399 |
#issue is when pan=12 digits to be checked
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000400 |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
| p29_res_variable_data | <exp_date> |
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
#  | Maestro    | 501833000060        | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
| p29_res_variable_id   | 000399 |
Examples:
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| p29_res_status        | 2          |
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |",Extract Card Data
"- The first entered PIN does not match the second entered PIN.
- The application validates the PIN according to the following rules:
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- All digits in the PIN are the same (e.g., 4444, 3333)
################## enable pin change support ###########################
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
- The third entered PIN matches the second entered PIN.
""""""
- is not a weak PIN. The PIN is considered weak if:
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
- The number of keys entered does not exceed 12.
- The second entered PIN:
Scenario Outline: Perform MSR transaction and change weak pin with a strong entered pin
Feature: change weak pin with a strong entered pin with msr transaction
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1384
""""""
| p00_res_reason_code | 0000 |
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- The number of keys entered is more than four.",Precondition
"- Each digit in the PIN is an increment of the previous digit (1234, 3456)
Given I send a 00.x Offline message to the terminal with params:
- is not a weak PIN. The PIN is considered weak if:
""""""
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
- The first entered PIN does not match the second entered PIN.
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
- The second entered PIN:
- The number of keys entered does not exceed 12.
- The number of keys entered is more than four.
Then I should receive the 00.x Offline response from terminal with params:
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
""""""
################## enable pin change support ###########################
- The third entered PIN matches the second entered PIN.
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1384
Feature: change weak pin with a strong entered pin with msr transaction
Scenario Outline: Perform MSR transaction and change weak pin with a strong entered pin
| p00_res_reason_code | 0000 |
- The application validates the PIN according to the following rules:
- All digits in the PIN are the same (e.g., 4444, 3333)",Precondition
"| p28_res_variable_id | 000920 |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_req_variable_data | 1      |
| p28_res_status      | 2      |
When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |",Unknown
"| p28_req_variable_id   | 000920 |
When I send a 28.x Set Variable message to the terminal with:
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_req_variable_data | 1      |
| p28_res_status      | 2      |
| p28_req_response_type | 1      |
| p28_res_variable_id | 000920 |",Unknown
"| p29_res_status        | 2      |
| p29_res_variable_data | true   |
| p29_res_variable_id   | 000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |",Extract Card Data
"Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | true   |
| p29_req_variable_id | 00000920 |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |",Extract Card Data
"################## swipe card ###########################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |
When I send a 23.x Card Read message to the terminal with:
And I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |",Card Swipe
"And I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"| p23_res_exit_type   | 0                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| track3 | <additional_data><additional_data>           |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
And Axium swipe magnetic card:",Card Swipe
"And Axium swipe magnetic card:
| p23_res_exit_type   | 0                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                            |
| p23_res_track3      | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_customer_acc_num             |    |
| p31_req_form_name                    |    |
| p31_req_prompt_index_number          | 14 |",CVM Process
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_encryption_configuration | 0  |
| p31_req_customer_acc_num             |    |
| p31_req_set_key_type                 | D  |
| p31_req_prompt_index_number          | 14 |
| p31_req_form_name                    |    |",CVM Process
"#And I Wait until Element ""fixed_title"" contains ""Please enter your PIN:""",Unknown
"#And I Wait until Element ""fixed_title"" contains ""Please enter your PIN:""",Unknown
"######################## enter the new strong pin #####################
And I enter pin ""<weak_pin>""",Unknown
"######################## enter the new strong pin #####################
And I enter pin ""<weak_pin>""",Unknown
And I wait for 4 seconds,Unknown
And I wait for 4 seconds,Unknown
"################### validate the new strong pin #######################
And I enter pin ""<strong_pin>""",Unknown
"And I enter pin ""<strong_pin>""
################### validate the new strong pin #######################",Unknown
And I wait for 4 seconds,Unknown
And I wait for 4 seconds,Unknown
"| p31_res_pin_data_ksn   | @regexp:.* |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data_block | @regexp:.* |
| p31_res_status         | 0          |
And I enter pin ""<strong_pin>""
| p31_res_pin_data       | @regexp:.* |",CVM Process
"| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_status         | 0          |
And I enter pin ""<strong_pin>""
| p31_res_pin_data_block | @regexp:.* |
Then I should receive the 31.x PIN Entry response from terminal with params:",CVM Process
"################# variable is back to false after pin change ##########################
And I Wait until Element ""fixed_title"" contains ""Please reenter your 4-digit PIN""",Unknown
"################# variable is back to false after pin change ##########################
And I Wait until Element ""fixed_title"" contains ""Please reenter your 4-digit PIN""",Unknown
"| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
Examples:
| p29_res_variable_id   | 000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | false  |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| p29_req_variable_id | 00000920 |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| p29_res_status        | 2      |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |",Extract Card Data
"| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
When I send a 29.x Get Variable message to the terminal with:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
| p29_req_variable_id | 00000920 |
| p29_res_variable_data | false  |
| p29_res_status        | 2      |
Examples:
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
| p29_res_variable_id   | 000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |",Extract Card Data
"based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
Given I send a 00.x Offline message to the terminal with params:
""""""
@pin_code @master_session @sde @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Scenario: Enable On-Guard SDE Encryption Configuration
| p00_res_reason_code | 0000 |
Feature:  Validate  pin block decryption is correct when SDE is enabled
""""""
This feature file verify pin block decryption is correct when SDE is enabled",Precondition
"""""""
""""""
This feature file verify pin block decryption is correct when SDE is enabled
| p00_res_reason_code | 0000 |
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
Given I send a 00.x Offline message to the terminal with params:
Scenario: Enable On-Guard SDE Encryption Configuration
Feature:  Validate  pin block decryption is correct when SDE is enabled
@pin_code @master_session @sde @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"| p62_req_encoding_format | B                 |
| p62_res_file_length | @regexp:.\d* |
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_fast_download   | 1                 |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_unpack_flag     | 0                 |
| p62_res_status      | 0            |",Unknown
"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_res_file_length | @regexp:.\d* |
| p62_res_status      | 0            |
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_fast_download   | 1                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_unpack_flag     | 0                 |
| p62_req_encoding_format | B                 |",Unknown
"And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_req_group_num | 91 |
Scenario Outline: verify pin block decryption is correct with masked pan
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 19 |
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 19 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
Then I should receive the 00.x Offline response from terminal with params:
Then I should receive the 61.x Read Configuration response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p61_res_status                | 2  |",Precondition
"| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
Then I should receive the 00.x Offline response from terminal with params:
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_data_config_parameter | 19 |
| p61_req_group_num | 91 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 19 |
When I send a 61.x Read Configuration message to the terminal with:
Then I should receive the 61.x Read Configuration response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p61_res_status                | 2  |
Scenario Outline: verify pin block decryption is correct with masked pan
| p61_res_status                | 2  |
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |",Precondition
"| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |",Card Swipe
"When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
| p23_req_prompt_index   | 3 |
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |",Card Swipe
"| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
When Axium swipe magnetic card:
| p23_res_track3      | @regexp:.+:4:.+                                              |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |",Card Swipe
"| track3 |                                              |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                                            |
| p23_res_exit_type   | 0                                                            |
| p23_res_track3      | @regexp:.+:4:.+                                              |
When Axium swipe magnetic card:",Card Swipe
"And I enter pin ""<pin_code>""
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_form_name                    |              |
When I send a 31.x PIN Entry message to the terminal with:
| p31_res_pin_data       | @regexp:.* |
| p31_req_prompt_index_number          | 1            |
| p31_req_set_encryption_configuration | 0            |
| p31_res_pin_data_block | @regexp:.* |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_set_key_type                 | *            |",CVM Process
"| p31_req_set_key_type                 | *            |
| p31_req_set_encryption_configuration | 0            |
When I send a 31.x PIN Entry message to the terminal with:
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_form_name                    |              |
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data       | @regexp:.* |
| p31_res_status         | 0          |
| p31_req_prompt_index_number          | 1            |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_customer_acc_num             | <masked_pan> |",CVM Process
"| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
Examples:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| tail     | <tail>                        |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| pinblock | 0<pin_length><pin_code><tail> |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |",Unknown
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
Scenario: Teardown - Reset to Default State
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |
| tail     | <tail>                        |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| pin_code | <pin_code>                    |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| pinblock | 0<pin_length><pin_code><tail> |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
Examples:",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"| p62_req_fast_download   | 1                   |
| p62_res_status      | 0          |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
Feature: verify message 29.x of variables 396 398 399 400
""""""
@00x @29x @60x @23x @87x @41x
| p62_req_unpack_flag     | 0                   |
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
""""""
| p61_req_index_num | 1  |
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_file_name       | ArcNoEncryption.apk |
@dx8000 @ex8000 @dx4000 @me
| p61_res_data_config_parameter | 0  |
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400
| p62_req_encoding_format | B                   |
When I send a 61.x Configuration Read message to the terminal with:
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_file_length | @regexp:.* |",Extract Card Data
"| p62_req_file_name       | ArcNoEncryption.apk |
| p62_res_file_length | @regexp:.* |
| p61_res_status                | 2  |
| p62_req_fast_download   | 1                   |
When I send a 61.x Configuration Read message to the terminal with:
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
""""""
| p62_req_encoding_format | B                   |
Feature: verify message 29.x of variables 396 398 399 400
| p62_req_unpack_flag     | 0                   |
| p61_res_group_num             | 91 |
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 0  |
Then I should receive the 62.x Write File response from terminal with params:
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_index_num             | 1  |
""""""
| p61_req_group_num | 91 |
@dx8000 @ex8000 @dx4000 @me
| p62_res_status      | 0          |
@00x @29x @60x @23x @87x @41x
Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible",Precondition
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
When I send a 00.x Offline message to the terminal with params:",Precondition
"| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| p23_req_prompt_index   | 312 |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""btn_cancel"" visible",Unknown
"When I click Element ""ed_pan""
And I click Element ""btn_manual_entry""",Unknown
"And I click Element ""btn_manual_entry""
When I click Element ""ed_pan""",Unknown
"And I press enter button
Then I send keys to Element ""ed_pan"" text ""<pan>""",Unknown
"And I press enter button
Then I send keys to Element ""ed_pan"" text ""<pan>""",Unknown
"When I click Element ""ed_cvv""",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I press enter button
Then I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"Then I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"Then I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"And I press enter button
Then I send keys to Element ""ed_expiry_date"" text ""<exp_date>""",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"| p23_res_track2      | <pan>=<expect_exp_date><add_data1><code><add_data2>                   |
| p23_res_track1      | M<pan>^<cardholdername>^<expect_exp_date><add_data1><code><add_data1> |
| p23_res_track3      |                                                                       |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                     |
| p23_res_card_source | H                                                                     |",Card Swipe
"| p23_res_card_source | H                                                                     |
| p23_res_track3      |                                                                       |
| p23_res_track1      | M<pan>^<cardholdername>^<expect_exp_date><add_data1><code><add_data1> |
| p23_res_track2      | <pan>=<expect_exp_date><add_data1><code><add_data2>                   |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                     |",Card Swipe
"| p29_res_variable_data | <pan>  |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000400            |
| p29_res_status        | 2                |
@rx5000 @rx7000 @me
| p29_req_variable_id | 396 |
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <expect_exp_date> |
| p29_res_status        | 2      |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
Examples:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000398 |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | 000       | MANUALLY/ENTERED |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <cardholdername> |
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000395 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399           |
| p29_req_variable_id | 399 |
| p29_res_variable_data | true   |
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | add_data2 | cardholdername   |",Extract Card Data
"| p29_res_status        | 2      |
| p29_res_variable_data | true   |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <expect_exp_date> |
| p29_res_variable_id   | 000398 |
| p29_req_variable_id | 396 |
| p29_req_variable_id | 395 |
| p29_res_variable_data | <cardholdername> |
| p29_res_variable_id   | 000400            |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
| p29_res_variable_data | <pan>  |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_req_variable_id | 398 |
| p29_res_variable_id   | 000396 |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | add_data2 | cardholdername   |
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
Examples:
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400
| p29_res_variable_data | 0      |
@rx5000 @rx7000 @me
| p29_req_variable_id | 399 |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | 000       | MANUALLY/ENTERED |
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| p23_req_enable_devices | M   |
| p23_req_prompt_index   | 312 |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"| p23_req_prompt_index   | 312 |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M   |",Card Swipe
"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible",Unknown
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible",Unknown
"And I click Element ""btn_manual_entry""
When I click Element ""ed_pan""",Unknown
"And I click Element ""btn_manual_entry""
When I click Element ""ed_pan""",Unknown
"Then I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"Then I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I press enter button
Then I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"Then I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"| p23_res_track2      | <pan>=<expect_exp_date><add_data1><code><add_data2>                   |
| p23_res_card_source | H                                                                     |
Then I should receive the 23.x Read Card response from terminal with params:
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
| p23_res_track1      | M<pan>^<cardholdername>^<expect_exp_date><add_data1><code><add_data1> |
| p23_res_track3      |                                                                       |
| p23_res_exit_type   | 0                                                                     |",Card Swipe
"| p23_res_track2      | <pan>=<expect_exp_date><add_data1><code><add_data2>                   |
| p23_res_exit_type   | 0                                                                     |
| p23_res_track1      | M<pan>^<cardholdername>^<expect_exp_date><add_data1><code><add_data1> |
| p23_res_track3      |                                                                       |
| p23_res_card_source | H                                                                     |
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
Then I should receive the 23.x Read Card response from terminal with params:",Card Swipe
"Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000400            |
When I send a 29.x Get Variable message to the terminal with:
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | add_data2 | cardholdername   |
| p29_res_status        | 2                 |
| p29_req_variable_id | 396 |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000399           |
| p29_res_variable_id   | 000395 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | true   |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
@dx8000 @ex8000 @dx4000 @me
| p29_req_variable_id | 398 |
| p29_req_variable_id | 400 |
| p29_res_variable_id   | 000396 |
Scenario Outline: Manual entry transaction with 87.x and 29.x message to verify variables 396 398 399 400
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <cardholdername> |
| p29_res_variable_data | 0      |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | 000       | MANUALLY/ENTERED |
| p29_req_variable_id | 395 |
| p29_req_variable_id | 399 |
| p29_res_variable_data | <expect_exp_date> |
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
"| p29_req_variable_id | 398 |
| p29_res_variable_data | <pan>  |
Examples:
| p29_res_variable_id   | 000395 |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
| p29_res_status        | 2      |
Scenario Outline: Manual entry transaction with 87.x and 29.x message to verify variables 396 398 399 400
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 396 |
| p29_req_variable_id | 400 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <expect_exp_date> |
| p29_res_variable_data | true   |
| p29_res_variable_id   | 000398 |
| p29_res_status        | 2                |
| p29_res_variable_id   | 000396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 399 |
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | add_data2 | cardholdername   |
| p29_res_variable_id   | 000400            |
@dx8000 @ex8000 @dx4000 @me
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | 000       | MANUALLY/ENTERED |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | 0      |
| p29_res_status        | 2      |
| p29_res_variable_data | <cardholdername> |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"| p87_req_enabled_devices | M          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_form_name       | read_cards |
| p87_req_prompt_index    | 1          |",Unknown
"| p87_req_enabled_devices | M          |
| p87_req_form_name       | read_cards |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 1          |",Unknown
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible",Unknown
"When I click Element ""ed_pan""
And I click Element ""btn_manual_entry""",Unknown
"When I click Element ""ed_pan""
And I click Element ""btn_manual_entry""",Unknown
"Then I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"Then I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I press enter button
Then I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"And I press enter button
Then I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"Then I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"Then I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"| p87_res_exit_type   | 0                                                                        |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_card_data   | @regexp:^M<pan>\^<cardholdername>\^<expect_exp_date><add_data1><code>.*$ |
| p87_res_card_source | H                                                                        |",Unknown
"Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                        |
| p87_res_card_source | H                                                                        |
| p87_res_card_data   | @regexp:^M<pan>\^<cardholdername>\^<expect_exp_date><add_data1><code>.*$ |",Unknown
"| p29_req_variable_id | 400 |
| p29_req_variable_id | 399 |
Scenario Outline: Manual entry transaction with 87.x and 29.x message to verify variables 396 398 399 400
| p29_req_variable_id | 396 |
| p29_res_status        | 2      |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 395 |
| p29_res_status        | 2                |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000395 |
@rx5000 @rx7000 @me
| p29_res_variable_data | <expect_exp_date> |
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | cardholdername   |
| p29_res_variable_data | true   |
| p29_res_status        | 2                 |
| p29_res_status        | 2      |
| p29_res_variable_data | <cardholdername> |
| p29_res_variable_id   | 000400            |
Examples:
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
| p29_res_variable_id   | 000399           |
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000396 |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | MANUALLY/ENTERED |
| p29_res_variable_data | <pan>  |",Extract Card Data
"| p29_res_variable_id   | 000398 |
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | cardholdername   |
| p29_req_variable_id | 396 |
| p29_res_variable_id   | 000396 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
@rx5000 @rx7000 @me
| p29_req_variable_id | 398 |
| p29_req_variable_id | 400 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <pan>  |
| p29_req_variable_id | 399 |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000400            |
Scenario Outline: Manual entry transaction with 87.x and 29.x message to verify variables 396 398 399 400
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | 0      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000399           |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000395 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| p29_res_status        | 2                 |
| p29_res_variable_data | <cardholdername> |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | MANUALLY/ENTERED |
| p29_req_variable_id | 395 |",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p00_res_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p87_req_enabled_devices | M          |
| p87_req_prompt_index    | 1          |
| p87_req_form_name       | read_cards |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:",Unknown
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |
| p87_req_prompt_index    | 1          |",Unknown
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""btn_manual_entry"" visible",Unknown
"And I click Element ""ed_pan""
When I click Element ""btn_manual_entry""",Unknown
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I press enter button
And I send keys to Element ""ed_pan"" text ""<pan>""",Unknown
"And I press enter button
And I send keys to Element ""ed_pan"" text ""<pan>""",Unknown
"When I click Element ""ed_cvv""",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I press enter button
And I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"And I press enter button
And I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER",Unknown
"| p87_res_card_data   | @regexp:^M<pan>\^<cardholdername>\^<expect_exp_date><add_data1><code>.*$ |
| p87_res_exit_type   | 0                                                                        |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_card_source | H                                                                        |",Unknown
"| p87_res_exit_type   | 0                                                                        |
| p87_res_card_source | H                                                                        |
| p87_res_card_data   | @regexp:^M<pan>\^<cardholdername>\^<expect_exp_date><add_data1><code>.*$ |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:",Unknown
"| p29_res_variable_id   | 000400            |
| p29_res_variable_id   | 000399           |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | cardholdername   |
Examples:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
| p29_res_variable_data | 0      |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | MANUALLY/ENTERED |
| p29_req_variable_id | 400 |
| p29_res_status        | 2                 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <expect_exp_date> |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 399 |
| p29_res_status        | 2                |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <cardholdername> |
| p29_res_status        | 2      |
| p29_res_variable_data | <pan>  |
Scenario Outline: MSR transaction with 23.x and 29.x message to verify variables 394 395 396 398 399 400
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
| p29_res_variable_id   | 000396 |
| p29_req_variable_id | 398 |
| p29_res_variable_id   | 000395 |",Extract Card Data
"| p29_res_variable_data | <expect_exp_date> |
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
| p29_req_variable_id | 400 |
| p29_res_status        | 2      |
| p29_res_status        | 2                |
| p29_res_variable_id   | 000398 |
| p29_res_variable_id   | 000400            |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
| p29_res_variable_id   | 000396 |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <cardholdername> |
| p29_res_variable_id   | 000395 |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
Examples:
| p29_req_variable_id | 395 |
Scenario Outline: MSR transaction with 23.x and 29.x message to verify variables 394 395 396 398 399 400
| p29_res_variable_id   | 000399           |
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | cardholdername   |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_data | <pan>  |
| p29_res_status        | 2      |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | MANUALLY/ENTERED |",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |
When I send a 23.x Card Read message to the terminal with:
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |",Card Swipe
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_enable_devices | M          |
| p23_req_form_name      | read_cards |",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"And  I wait until Element ""btn_cancel"" visible",Unknown
"When I swipe card using this params:
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3_data |                                              |",Unknown
"When I swipe card using this params:
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3_data |                                              |",Unknown
"| p23_res_exit_type   | 0                                            |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                            |
| p23_res_track3      |                                              |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"| p23_res_card_source | M                                            |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      |                                              |",Card Swipe
"Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 400 |
Examples:
| p29_req_variable_id | 399 |
| p29_res_variable_id   | 000395 |
| p29_req_variable_id | 394 |
| p29_res_variable_id   | 000398 |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | true   |
| card_type  | amount | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  |
| p29_res_variable_id   | 000400     |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <name> |
| p29_res_variable_id   | 000394 |
| p29_res_status        | 2          |
| p29_req_variable_id | 396 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000396 |
Scenario Outline: MSR transaction with 41.x and 29.x message to verify variables 394 395 396 398 399 400
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
| p29_res_status        | 2      |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| Mastercard | 120    | 5413339000000119 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 |
| p29_req_variable_id | 395 |
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | 0      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <exp_date> |
| p29_res_status        | 2      |",Extract Card Data
"| p29_req_variable_id | 400 |
| p29_res_status        | 2      |
Examples:
| p29_req_variable_id | 396 |
| p29_req_variable_id | 398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
| p29_req_variable_id | 399 |
| p29_res_variable_id   | 000395 |
Scenario Outline: MSR transaction with 41.x and 29.x message to verify variables 394 395 396 398 399 400
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <name> |
| p29_res_variable_data | 0      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 |
| p29_req_variable_id | 395 |
| p29_res_variable_id   | 000398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <exp_date> |
Then I should receive the 29.x Get Variable response from terminal with params:
| card_type  | amount | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
| p29_res_variable_id   | 000394 |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <code> |
| p29_res_variable_data | true   |
| p29_res_status        | 2      |
| p29_res_status        | 2          |
| p29_res_variable_data | <pan>  |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000400     |
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible",Precondition
"| p41_req_msr_flag         | 1 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |
| p41_req_parse_flag       | 1 |",Unknown
"| p41_req_contactless_flag | 0 |
| p41_req_parse_flag       | 1 |
| p41_req_smc_flag         | 0 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_msr_flag         | 1 |",Unknown
Then I wait for 23 seconds,Unknown
Then I wait for 23 seconds,Unknown
"| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3_data |                                              |",Unknown
"| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |
When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Unknown
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_encryption      | 00                                           |
| p41_res_error_code      | 0                                            |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_pan             | <pan>                                        |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_account_name    | <name>                                       |
| p41_res_track_3_status  | 1                                            |
| p41_res_masked_pan      | <pan>                                        |
| p41_res_track_1_status  | 0                                            |
| p41_res_source          | M                                            |
| p41_res_track_3         |                                              |
| p41_res_track_2_status  | 0                                            |",Unknown
"| p41_res_masked_pan      | <pan>                                        |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_track_1_status  | 0                                            |
| p41_res_track_3_status  | 1                                            |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_source          | M                                            |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_account_name    | <name>                                       |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_track_3         |                                              |
| p41_res_error_code      | 0                                            |
| p41_res_track_2_status  | 0                                            |
| p41_res_encryption      | 00                                           |
| p41_res_pan             | <pan>                                        |",Unknown
"| p29_req_variable_id | 400 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | 0      |
| p29_res_variable_data | <name> |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <pan>  |
| p29_req_variable_id | 395 |
When I send a 29.x Get Variable message to the terminal with:
Scenario Outline: MSR transaction with 87.x and 29.x message to verify variables 394 395 396 398 399 400
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | <exp_date> |
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| DISCOVER  | 6510000000000091 | CARD/IMAGE 09 | 1712     | 702  | 1000041300000 | 1000041300000 |
Examples:
| p29_res_status        | 2      |
| p29_req_variable_id | 396 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
| p29_req_variable_id | 398 |
| p29_res_status        | 2      |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
| p29_res_variable_id   | 000398 |
| card_type | pan              | name          | exp_date | code | disc_data_t1  | disc_data_t2  |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000400     |",Extract Card Data
"| p29_res_variable_id   | 000399 |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_req_variable_id | 400 |
| p29_res_variable_data | true   |
| p29_res_variable_id   | 000396 |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | 0      |
| p29_res_status        | 2          |
| p29_req_variable_id | 394 |
| DISCOVER  | 6510000000000091 | CARD/IMAGE 09 | 1712     | 702  | 1000041300000 | 1000041300000 |
| p29_req_variable_id | 396 |
| p29_res_variable_id   | 000395 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <name> |
| p29_req_variable_id | 395 |
Scenario Outline: MSR transaction with 87.x and 29.x message to verify variables 394 395 396 398 399 400
Examples:
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
| p29_res_status        | 2      |
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 399 |
| card_type | pan              | name          | exp_date | code | disc_data_t1  | disc_data_t2  |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_id   | 000400     |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <code> |
| p29_res_variable_id   | 000394 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
| p29_res_status        | 2      |
| p29_res_variable_data | <exp_date> |",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:",Unknown
"| p87_req_enabled_devices | M          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_form_name       | read_cards |
| p87_req_prompt_index    | 3          |",Unknown
"And I wait for 1 second
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait for 1 second
And I wait until Element ""btn_cancel"" visible",Unknown
"Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| track3_data |                                              |
| p87_res_card_source | M                                                                                                    |
When I swipe card using this params:
| p87_res_exit_type   | 0                                                                                                    |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |",Unknown
"| p87_res_card_source | M                                                                                                    |
| p87_res_exit_type   | 0                                                                                                    |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
When I swipe card using this params:
| track3_data |                                              |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Unknown
"Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <pan>  |
| p29_res_variable_data | <code> |
| p29_req_variable_id | 400 |
| p29_res_variable_data | <exp_date> |
| p29_req_variable_id | 396 |
| p29_res_variable_id   | 000396 |
| p29_res_variable_id   | 000394 |
| p29_res_status        | 2          |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
| p29_res_status        | 2      |
| p29_res_variable_data | true   |
| p29_res_status        | 2      |
| card_type | pan            | name                      | exp_date | code | disc_data_t1    | disc_data_t2 |
| p29_req_variable_id | 399 |
| VISA      | 34798979016630 | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372 | 887693372    |
| p29_res_variable_id   | 000395 |
| p29_req_variable_id | 395 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | 0      |
| p29_req_variable_id | 398 |
| p29_res_status        | 2      |
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <name> |
Then I should receive the 29.x Get Variable response from terminal with params:
Examples:",Extract Card Data
"Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | true   |
| card_type | pan            | name                      | exp_date | code | disc_data_t1    | disc_data_t2 |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 396 |
| p29_res_variable_id   | 000400     |
Examples:
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <exp_date> |
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_req_variable_id | 394 |
| p29_res_variable_data | 0      |
| p29_res_variable_id   | 000396 |
| p29_req_variable_id | 398 |
| p29_res_variable_data | <name> |
| p29_req_variable_id | 400 |
| p29_req_variable_id | 395 |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <pan>  |
| p29_res_variable_id   | 000398 |
| p29_res_status        | 2      |
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
| VISA      | 34798979016630 | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372 | 887693372    |
| p29_res_variable_id   | 000399 |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"This feature file validates track encryption indicator with its values for msr track1 , track2 , track1&2
Scenario: Enable On-Guard SDE Encryption Configuration
Feature:  Validate track encryption indicator values
""""""
""""""
@sde @msr @00x @60x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1800",Unknown
"@sde @msr @00x @60x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate track encryption indicator values
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1800
This feature file validates track encryption indicator with its values for msr track1 , track2 , track1&2
Scenario: Enable On-Guard SDE Encryption Configuration
""""""
""""""",Unknown
"| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p62_req_unpack_flag     | 0                 |
| p62_res_file_length | @regexp:.\d* |
| p62_res_status      | 0            |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_fast_download   | 1                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B                 |",Unknown
"| p62_res_file_length | @regexp:.\d* |
| p62_req_fast_download   | 1                 |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_unpack_flag     | 0                 |
| p62_res_status      | 0            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |",Unknown
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p61_req_group_num | 91 |
And I wait until Element ""imageOffline"" visible
| p61_res_data_config_parameter | 19 |
| p61_req_group_num | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
Then I should receive the 61.x Read Configuration response from terminal with params:
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track1 data and track encryption indicator =1
| p61_res_index_num             | 1  |
| p00_req_reason_code | 0000 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 19 |
| p61_res_group_num             | 91 |
| p61_res_group_num             | 91 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_index_num             | 1  |
Given I send a 00.x Offline message to the terminal with params:
| p61_req_index_num | 1  |
When I send a 61.x Read Configuration message to the terminal with:",Precondition
"Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track1 data and track encryption indicator =1
Then I should receive the 00.x Offline response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 19 |
| p61_req_group_num | 91 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_status                | 2  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_req_reason_code | 0000 |
| p61_res_data_config_parameter | 19 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_index_num | 1  |
Given I send a 00.x Offline message to the terminal with params:
| p61_req_group_num | 91 |
And I wait until Element ""imageOffline"" visible
| p61_res_status                | 2  |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_index_num             | 1  |
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
| p00_res_reason_code | 0000 |",Precondition
"And  I wait until Element ""btn_cancel"" visible
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
Then I Wait until Element ""title"" contains ""Please slide card""",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
| p23_req_enable_devices | M |",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 374245000001008  | 000000000                    | \x00\x00\x00\x00         |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | masked_pan       | masked_disc_data_t1          | null_characters          |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3 |                                              |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 6510000000000091 | 0000000000000                | \x00\x00\x00\x00         |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 4264510000005621 | 0000000000000000000000000000 |                          |
| track2 |                                              |
| p23_res_track3      | @regexp:.+:1:.+                                              |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                            |
When Axium swipe magnetic card:
Examples:
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 5413330000000011 | 000000000000000              | \x00\x00\x00\x00\x00\x00 |
| p23_res_track2      |                                                              |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track2 data and track encryption indicator = 2
| p23_res_card_source | M                                                            |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 36039600000472   | 00000000000000000000         | \x00\x00                 |",Card Swipe
"Examples:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 374245000001008  | 000000000                    | \x00\x00\x00\x00         |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 5413330000000011 | 000000000000000              | \x00\x00\x00\x00\x00\x00 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 6510000000000091 | 0000000000000                | \x00\x00\x00\x00         |
| p23_res_track3      | @regexp:.+:1:.+                                              |
| p23_res_card_source | M                                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_exit_type   | 0                                                            |
| track2 |                                              |
| track3 |                                              |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | masked_pan       | masked_disc_data_t1          | null_characters          |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 36039600000472   | 00000000000000000000         | \x00\x00                 |
When Axium swipe magnetic card:
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      |                                                              |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track2 data and track encryption indicator = 2
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 4264510000005621 | 0000000000000000000000000000 |                          |
Then I should receive the 23.x Card Read response from terminal with params:",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p61_res_data_config_parameter | 19 |
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_group_num             | 91 |
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_index_num             | 1  |
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 19 |
And I wait until Element ""imageOffline"" visible
| p61_res_index_num             | 1  |
| p00_req_reason_code | 0000 |
| p61_res_group_num             | 91 |
When I send a 61.x Read Configuration message to the terminal with:
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"| p23_req_enable_devices | M |
When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
| p23_req_prompt_index   | 3 |
Then I Wait until Element ""title"" contains ""Please slide card""",Card Swipe
"When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |",Card Swipe
"| p23_res_exit_type   | 0                                                    |
| Mastercard | 5413330089020011 | 2412     | 221  | 0000014000001  | 5413330000000011 | 0000000000000       | \x00\x00\x00         |
| card_type  | pan              | exp_date | code | disc_data_t2   | masked_pan       | masked_disc_data_t2 | null_characters      |
| Amex       | 374245001731008  | 2103     | 201  | 15041234500000 | 374245000001008  | 00000000000000      | \x00\x00\x00         |
When Axium swipe magnetic card:
| DISCOVER   | 6510000000000091 | 1712     | 702  | 1000041300000  | 6510000000000091 | 0000000000000       | \x00\x00\x00         |
| track1 |                                      |
| track3 |                                      |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with track1 and track2 data and track encryption indicator =4
| Diners     | 36039667170472   | 0012     | 521  | 1000041300000  | 36039600000472   | 0000000000000       | \x00\x00\x00\x00\x00 |
| p23_res_card_source | M                                                    |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>? |
Examples:
| p23_res_track1      |                                                      |
| p23_res_track3      | @regexp:.+:2:.+                                      |
Then I should receive the 23.x Card Read response from terminal with params:
| VISA       | 4264510228395621 | 1709     | 206  | 0000070400100  | 4264510000005621 | 0000000000000       | \x00\x00\x00         |
| track2 | <pan>=<exp_date><code><disc_data_t2> |",Card Swipe
"| track3 |                                      |
| DISCOVER   | 6510000000000091 | 1712     | 702  | 1000041300000  | 6510000000000091 | 0000000000000       | \x00\x00\x00         |
| Mastercard | 5413330089020011 | 2412     | 221  | 0000014000001  | 5413330000000011 | 0000000000000       | \x00\x00\x00         |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
When Axium swipe magnetic card:
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with track1 and track2 data and track encryption indicator =4
| p23_res_card_source | M                                                    |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | @regexp:.+:2:.+                                      |
| VISA       | 4264510228395621 | 1709     | 206  | 0000070400100  | 4264510000005621 | 0000000000000       | \x00\x00\x00         |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>? |
| card_type  | pan              | exp_date | code | disc_data_t2   | masked_pan       | masked_disc_data_t2 | null_characters      |
| p23_res_exit_type   | 0                                                    |
Examples:
| track1 |                                      |
| Amex       | 374245001731008  | 2103     | 201  | 15041234500000 | 374245000001008  | 00000000000000      | \x00\x00\x00         |
| Diners     | 36039667170472   | 0012     | 521  | 1000041300000  | 36039600000472   | 0000000000000       | \x00\x00\x00\x00\x00 |
| p23_res_track1      |                                                      |",Card Swipe
"And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:
| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 19 |
| p61_res_status                | 2  |
| p61_req_index_num | 1  |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_res_reason_code | 0000 |
| p61_res_index_num             | 1  |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_group_num             | 91 |",Precondition
"| p61_res_data_config_parameter | 19 |
Then I should receive the 61.x Read Configuration response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p61_res_status                | 2  |
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
| p00_res_reason_code | 0000 |
| p61_req_index_num | 1  |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_group_num             | 91 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""",Card Swipe
"| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible
| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"| p23_res_exit_type   | 0                                                            |
When Axium swipe magnetic card:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      |
| track3 |                                              |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
Scenario: Teardown - Reset to Default State
| p23_res_track3      | @regexp:.+:4:.+                                              |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| p23_res_card_source | M                                                            |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |",Card Swipe
"| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       |
Examples:
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Scenario: Teardown - Reset to Default State
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      |
| p23_res_track3      | @regexp:.+:4:.+                                              |
| p23_res_card_source | M                                                            |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track3 |                                              |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       |
| p23_res_exit_type   | 0                                                            |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"| p62_req_file_name       | ArcNoEncryption.apk |
| p61_res_status                | 2  |
| p62_req_fast_download   | 1                   |
| p62_res_status      | 0          |
| p61_req_index_num | 1  |
| p62_res_file_length | @regexp:.* |
| p62_req_unpack_flag     | 0                   |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 0  |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B                   |
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:",Unknown
"| p62_res_file_length | @regexp:.* |
Then I should receive the 62.x Write File response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 0  |
| p62_res_status      | 0          |
| p62_req_encoding_format | B                   |
| p61_req_group_num | 91 |
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_fast_download   | 1                   |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_unpack_flag     | 0                   |",Unknown
"- The third entered PIN matches the second entered PIN.
| p00_req_reason_code | 0000 |
- All digits in the PIN are the same (e.g., 4444, 3333)
- The number of keys entered does not exceed 12.
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate an invalid PIN change where the cardholder will enter the same weak PIN in the first and second attempt
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder will enter the same weak PIN in the first and second attempt
- is not a weak PIN. The PIN is considered weak if:
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- The second entered PIN:
- The application validates the PIN according to the following rules:
Then I should receive the 00.x Offline response from terminal with params:
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1385
| p00_res_reason_code | 0000 |
- The number of keys entered is more than four.
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
In this testcase, we are testing an invalid PIN change where the cardholder will enter the same weak PIN in the first and second attempt.
""""""
Given I send a 00.x Offline message to the terminal with params:",Precondition
"- The application validates the PIN according to the following rules:
- is not a weak PIN. The PIN is considered weak if:
- The number of keys entered does not exceed 12.
| p00_req_reason_code | 0000 |
- The second entered PIN:
""""""
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
In this testcase, we are testing an invalid PIN change where the cardholder will enter the same weak PIN in the first and second attempt.
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Then I should receive the 00.x Offline response from terminal with params:
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- All digits in the PIN are the same (e.g., 4444, 3333)
- The first entered PIN does not match the second entered PIN.
################## enable pin change support ###########################
- The application validates the PIN according to the following rules:
Feature: validate an invalid PIN change where the cardholder will enter the same weak PIN in the first and second attempt
And I Wait until Element ""title"" contains ""This Lane Closed""
- The third entered PIN matches the second entered PIN.
| p00_res_reason_code | 0000 |
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1385
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder will enter the same weak PIN in the first and second attempt
Given I send a 00.x Offline message to the terminal with params:",Precondition
"Then I should receive the 28.x Set Variable response from terminal with params:
| p28_req_response_type | 1      |
| p28_res_variable_id | 000920 |
When I send a 28.x Set Variable message to the terminal with:
| p28_res_status      | 2      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |",Unknown
"Then I should receive the 28.x Set Variable response from terminal with params:
| p28_req_variable_id   | 000920 |
| p28_res_variable_id | 000920 |
| p28_req_variable_data | 1      |
| p28_res_status      | 2      |
When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |",Extract Card Data
"| p29_req_variable_id | 00000920 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"################## swipe card ###########################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"| p23_req_enable_devices | M          |
When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |
And I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_prompt_index   | 311        |",Card Swipe
"And I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_prompt_index   | 311        |
When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| track3 | <additional_data><additional_data>           |
| p23_res_card_source | M                                            |
And Axium swipe magnetic card:",Card Swipe
"| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                            |
| p23_res_exit_type   | 0                                            |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p31_req_prompt_index_number          | 14 |
| p31_req_set_key_type                 | D  |
| p31_req_customer_acc_num             |    |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_encryption_configuration | 0  |
And I enter pin ""<weak_pin>""
| p31_req_form_name                    |    |
#################enter the weak pin################################
######################## enter the same weak pin again #####################",CVM Process
"#################enter the weak pin################################
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_encryption_configuration | 0  |
| p31_req_prompt_index_number          | 14 |
| p31_req_form_name                    |    |
| p31_req_customer_acc_num             |    |
######################## enter the same weak pin again #####################
And I enter pin ""<weak_pin>""
| p31_req_set_key_type                 | D  |",CVM Process
And I wait for 4 seconds,Unknown
And I wait for 4 seconds,Unknown
"Then I should receive the 31.x PIN Entry response from terminal with params:
############## variable keeps the value true since pin is not sucessfully changed ##########################
####### 31.x should return A because the second pin entry is same as the first weak pin entered################### #######################
| p31_res_status   | A |
| p31_res_pin_data |   |
And I enter pin ""<weak_pin>""",CVM Process
"Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | A |
############## variable keeps the value true since pin is not sucessfully changed ##########################
####### 31.x should return A because the second pin entry is same as the first weak pin entered################### #######################
| p31_res_pin_data |   |
And I enter pin ""<weak_pin>""",CVM Process
"| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
Examples:
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| p29_req_variable_id | 00000920 |
| p29_res_variable_id   | 000920 |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
When I send a 29.x Get Variable message to the terminal with:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
| p29_res_variable_data | true   |",Extract Card Data
"| p29_res_variable_data | true   |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
| p29_res_status        | 2      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
Examples:
When I send a 29.x Get Variable message to the terminal with:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| p29_res_variable_id   | 000920 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |",Extract Card Data
"Feature: Swipe non standard cards
""""""
This feature file Validates MSR transaction For Non Standard Card using 41.x Card Read Request
""""""
Scenario Outline: Check MSR flow while using Non-Standard cards with two tracks(track1 ,track2)
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1208
@41x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Unknown
"""""""
""""""
Feature: Swipe non standard cards
This feature file Validates MSR transaction For Non Standard Card using 41.x Card Read Request
@41x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1208
Scenario Outline: Check MSR flow while using Non-Standard cards with two tracks(track1 ,track2)",Unknown
"And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with:",Precondition
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_contactless_flag | 0 |
| p41_req_parse_flag       | 1 |
| p41_req_smc_flag         | 0 |
| p41_req_msr_flag         | 1 |",Unknown
"| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_smc_flag         | 0 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_contactless_flag | 0 |",Unknown
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"And I swipe card using this params:
| track1_data | <track1_data> |
| track2_data | <track2_data> |
| track3_data |               |",Unknown
"And I swipe card using this params:
| track1_data | <track1_data> |
| track2_data | <track2_data> |
| track3_data |               |",Unknown
And I wait 3 seconds,Unknown
And I wait 3 seconds,Unknown
"| p41_res_pan             | <pan>         |
| p41_res_track_3         |               |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_track_2_status  | 0             |
| p41_res_error_code      | 0             |
| p41_res_encryption      | 00            |
| p41_res_track_1_status  | 0             |
| p41_res_account_name    | <name>        |
| p41_res_track_3_status  | 1             |
| p41_res_track_2         | <track2_data> |
| p41_res_expiration_date | <exp_date>    |
| p41_res_track_1         | <track1_data> |
| p41_res_source          | M             |
| p41_res_masked_pan      | <masked_pan>  |",Unknown
"| p41_res_masked_pan      | <masked_pan>  |
| p41_res_track_3         |               |
| p41_res_track_3_status  | 1             |
| p41_res_track_2_status  | 0             |
| p41_res_pan             | <pan>         |
| p41_res_track_1         | <track1_data> |
| p41_res_error_code      | 0             |
| p41_res_encryption      | 00            |
| p41_res_track_2         | <track2_data> |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_account_name    | <name>        |
| p41_res_track_1_status  | 0             |
| p41_res_source          | M             |
| p41_res_expiration_date | <exp_date>    |",Unknown
"And I wait until Element ""imageOffline"" visible
Scenario Outline: Check MSR flow while using Non-Standard cards with track1 only
Examples:
| NonStandard card -- Track 1 and Track 2 pan-only                 | 1234567890123456                                                | 1234567890123456                       | 1234567890123456                                                | 1234567890123456                       | 1234567890123456       | 1234567890123456       |          |                     |
When I send a 00.x Offline message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with:
| NonStandard card -- FDMS TEST CARD/VISA modified without exp-dat | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | 4000620001234803       | 4000620001234803       |          | FDMS TEST CARD/VISA |
| p00_req_reason_code | 0000 |
| NonStandard card -- ISO parser                                   | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | 4147200000002105       | 4147200000002105       | 2603     |                     |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| type                                                             | track1_data                                                     | track2_data                            | track1_res                                                      | track2_res                             | pan                    | masked_pan             | exp_date | name                |
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| NonStandard card -- Non Payment card                             | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 0000198800001234560011 | 0000198800001234560011 | 2012     |                     |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| NonStandard card -- FDMS TEST CARD/VISA modified without exp-dat | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | 4000620001234803       | 4000620001234803       |          | FDMS TEST CARD/VISA |
When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Scenario Outline: Check MSR flow while using Non-Standard cards with track1 only
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| NonStandard card -- Track 1 and Track 2 pan-only                 | 1234567890123456                                                | 1234567890123456                       | 1234567890123456                                                | 1234567890123456                       | 1234567890123456       | 1234567890123456       |          |                     |
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with:
| type                                                             | track1_data                                                     | track2_data                            | track1_res                                                      | track2_res                             | pan                    | masked_pan             | exp_date | name                |
Examples:
| NonStandard card -- Non Payment card                             | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 0000198800001234560011 | 0000198800001234560011 | 2012     |                     |
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
| NonStandard card -- ISO parser                                   | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | 4147200000002105       | 4147200000002105       | 2603     |                     |",Precondition
"| p41_req_contactless_flag | 0 |
When I send a 41.x Card Read Message message to the terminal with:
| p41_req_smc_flag         | 0 |
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |",Unknown
"| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |
When I send a 41.x Card Read Message message to the terminal with:
| p41_req_parse_flag       | 1 |",Unknown
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"And I swipe card using this params:
| track3_data |               |
| track1_data | <track1_data> |
| track2_data |               |",Unknown
"| track2_data |               |
| track1_data | <track1_data> |
| track3_data |               |
And I swipe card using this params:",Unknown
And I wait 3 seconds,Unknown
And I wait 3 seconds,Unknown
"| p41_res_source          | M             |
| p41_res_error_code      | 0             |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_track_1_status  | 0             |
| p41_res_track_3_status  | 1             |
| p41_res_track_1         | <track1_data> |
| p41_res_track_2_status  | 1             |
| p41_res_track_2         |               |
| p41_res_pan             | <pan>         |
| p41_res_track_3         |               |
| p41_res_expiration_date |               |
| p41_res_encryption      | 00            |
| p41_res_masked_pan      | <masked_pan>  |
| p41_res_account_name    |               |",Unknown
"| p41_res_track_2_status  | 1             |
| p41_res_masked_pan      | <masked_pan>  |
| p41_res_track_1_status  | 0             |
| p41_res_error_code      | 0             |
| p41_res_track_3         |               |
| p41_res_encryption      | 00            |
| p41_res_pan             | <pan>         |
| p41_res_expiration_date |               |
| p41_res_track_2         |               |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_track_3_status  | 1             |
| p41_res_source          | M             |
| p41_res_account_name    |               |
| p41_res_track_1         | <track1_data> |",Unknown
"| NonStandard Card -- Track 1 pan-only | 1234567890123456                   | 1234567890123456                   | 1234567890123456            | 1234567890123456            | 2603     |      |
Examples:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with:
And I wait until Element ""imageOffline"" visible
| type                                 | track1_data                        | track1_res                         | pan                         | masked_pan                  | exp_date | name |
| NonStandard Card -- Track 1 pan-only | 5413339000000119                   | 5413339000000119                   | 5413339000000119            | 5413339000000119            | 2012     |      |
| NonStandard Card -- Non Payment card | 10063576813       1234567890123456 | 10063576813       1234567890123456 | 100635768131234567890123456 | 100635768131234567890123456 |          |      |
Scenario Outline: Check MSR flow while using Non-Standard cards with track2 only
When I send a 00.x Offline message to the terminal with:",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 00.x Offline message to the terminal with:
Given I send a 00.x Offline message to the terminal with:
| NonStandard Card -- Track 1 pan-only | 5413339000000119                   | 5413339000000119                   | 5413339000000119            | 5413339000000119            | 2012     |      |
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
| NonStandard Card -- Non Payment card | 10063576813       1234567890123456 | 10063576813       1234567890123456 | 100635768131234567890123456 | 100635768131234567890123456 |          |      |
| p00_req_reason_code | 0000 |
| type                                 | track1_data                        | track1_res                         | pan                         | masked_pan                  | exp_date | name |
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Scenario Outline: Check MSR flow while using Non-Standard cards with track2 only
| p00_res_reason_code | 0000 |
Examples:
| NonStandard Card -- Track 1 pan-only | 1234567890123456                   | 1234567890123456                   | 1234567890123456            | 1234567890123456            | 2603     |      |",Precondition
"| p41_req_parse_flag       | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_msr_flag         | 1 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_smc_flag         | 0 |",Unknown
"| p41_req_smc_flag         | 0 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_parse_flag       | 1 |",Unknown
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_track_2         | <track2_data> |
| p41_res_track_2_status  | 0             |
| track1_data |               |
| track3_data |               |
| p41_res_track_3         |               |
| p41_res_track_1         |               |
And I swipe card using this params:
| p41_res_masked_pan      | <masked_pan>  |
| p41_res_account_name    | <name>        |
| p41_res_track_3_status  | 1             |
| p41_res_error_code      | 0             |
| p41_res_pan             | <pan>         |
| p41_res_track_1_status  | 1             |
| p41_res_expiration_date | <exp_date>    |
| p41_res_encryption      | 00            |
| track2_data | <track2_data> |
| p41_res_source          | M             |",Unknown
"| p41_res_track_3_status  | 1             |
| p41_res_track_1         |               |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_masked_pan      | <masked_pan>  |
| p41_res_encryption      | 00            |
| track3_data |               |
| p41_res_account_name    | <name>        |
| p41_res_error_code      | 0             |
| p41_res_track_2_status  | 0             |
| p41_res_source          | M             |
| p41_res_expiration_date | <exp_date>    |
| track2_data | <track2_data> |
| track1_data |               |
And I swipe card using this params:
| p41_res_track_1_status  | 1             |
| p41_res_track_3         |               |
| p41_res_pan             | <pan>         |
| p41_res_track_2         | <track2_data> |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
And I wait until Element ""imageOffline"" visible
| NonStandard Card -- Track 2 pan-only | 1234567890123456                       | 1234567890123456                       | 1234567890123456       | 1234567890123456       |          |      |
When I send a 00.x Offline message to the terminal with:
| NonStandard Card -- Gift ECR         | 1234567897=251210100000001             | 1234567897=251210100000001             | 1234567897             | 1234567897             | 2512     |      |
| NonStandard Card -- Non Payment card | 0000198800001234560011=2012=0000002008 | 0000198800001234560011=2012=0000002008 | 0000198800001234560011 | 0000198800001234560011 | 2012     |      |
| p00_req_reason_code | 0000 |
| type                                 | track2_data                            | track2_res                             | pan                    | masked_pan             | exp_date | name |
| NonStandard Card -- Track 2 pan-only | B4445222AE299990007                    | B4445222AE299990007                    |                        |                        |          |      |",Precondition
"When I send a 00.x Offline message to the terminal with:
And I Wait until Element ""title"" contains ""This Lane Closed""
Examples:
| NonStandard Card -- Non Payment card | 0000198800001234560011=2012=0000002008 | 0000198800001234560011=2012=0000002008 | 0000198800001234560011 | 0000198800001234560011 | 2012     |      |
| type                                 | track2_data                            | track2_res                             | pan                    | masked_pan             | exp_date | name |
| NonStandard Card -- Track 2 pan-only | 1234567890123456                       | 1234567890123456                       | 1234567890123456       | 1234567890123456       |          |      |
And I wait until Element ""imageOffline"" visible
| NonStandard Card -- Track 2 pan-only | B4445222AE299990007                    | B4445222AE299990007                    |                        |                        |          |      |
| p00_res_reason_code | 0000 |
| NonStandard Card -- Gift ECR         | 1234567897=251210100000001             | 1234567897=251210100000001             | 1234567897             | 1234567897             | 2512     |      |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p62_res_status      | 0            |
| p62_req_encoding_format | B                            |
Given a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
##################### ########################################## #####################
@sde @msr @00x @62x @61x @23x
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1                            |
| p62_res_file_length | @regexp:.\d* |
Note : ArcSec.json used in current FF is the version from DefaultConfig of ARC Build ""arc-app-23.09.02-0006""
Feature: Validate separator of On-Guard SDE Encryption for MSR transaction
""""""
based on ticket    https://ingenico-nar.atlassian.net/browse/ARC-1299
""""""
This feature file validates separator of On-Guard SDE Encryption for MSR transaction
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
##################### Enable Onguard_SDE with specific separator #####################",Unknown
"@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
##################### Enable Onguard_SDE with specific separator #####################
This feature file validates separator of On-Guard SDE Encryption for MSR transaction
""""""
| p62_res_file_length | @regexp:.\d* |
| p62_res_status      | 0            |
##################### ########################################## #####################
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
Then I should receive the 62.x Write File response from terminal with params:
Note : ArcSec.json used in current FF is the version from DefaultConfig of ARC Build ""arc-app-23.09.02-0006""
Given a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
Feature: Validate separator of On-Guard SDE Encryption for MSR transaction
based on ticket    https://ingenico-nar.atlassian.net/browse/ARC-1299
| p62_req_unpack_flag     | 0                            |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
""""""
@sde @msr @00x @62x @61x @23x",Unknown
"| p00_req_reason_code | 0000 |
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
| p00_res_reason_code | 0000 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_group_num             | 91 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_data_config_parameter | 19 |
Then I should receive the 00.x Offline response from terminal with params:
##################### Verify Onguard_SDE enabled #####################
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_index_num | 1  |
And I wait until Element ""imageOffline"" visible
| p61_res_index_num             | 1  |
##################### ##################### #####################
When I send a 00.x Offline message to the terminal with params:",Precondition
"| p61_res_status                | 2  |
| p61_req_index_num | 1  |
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_index_num             | 1  |
| p00_req_reason_code | 0000 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 19 |
| p00_res_reason_code | 0000 |
##################### ##################### #####################
| p61_req_group_num | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_group_num             | 91 |
When I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
##################### Verify Onguard_SDE enabled #####################",Precondition
"When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""",Card Swipe
"When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |",Card Swipe
"| track3 | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
Then I should receive the 23.x Card Read response from terminal with params:
When Axium swipe magnetic card:
| p23_res_card_source | M                                                            |
| p23_res_exit_type   | 0                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track3      | @regexp:.{1,252}                                             |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
Then I should receive the 23.x Card Read response from terminal with params:
| track3 | <additional_data><additional_data>           |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
When Axium swipe magnetic card:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | @regexp:.{1,252}                                             |
| p23_res_card_source | M                                                            |
| p23_res_exit_type   | 0                                                            |",Card Swipe
"| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          | separator | ASCII |
| p61_req_group_num | 91 |
| p62_res_file_length | @regexp:.* |
Given a existing file ""Files/p2p_encryptions/ArcNoEncryption.apk""
| Diners     | 36039667170472   | PETTITT/JO         | 2812     | 521  | 160100000000000007778946     | 1000051300000 | 0123456789           | 36039600000472   | 000000000000000000000000     | 0000000000000       | \x00\x00                 | &         | 26    |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 0  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_res_status      | 0          |
Then I should receive the 61.x Configuration Read response from terminal with params:
| VISA       | 4264510228395621 | JOHN/SMITH         | 2712     | 206  | 0000000000000000000704001000 | 0000070400100 | 123456789            | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 | \|        | 7C    |
Examples:
| p61_res_index_num             | 1  |
| result | B<pan>^<name>^<exp_date><code><disc_data_t1><separator><pan>=<exp_date><code><disc_data_t2><null_characters> |
| p61_res_group_num             | 91 |
| VISA       | 4761739001010010 | VISA Credit        | 2912     | 201  | 16010000000000000946         | 10000413      | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 00000000            | \x00\x00\x00\x00\x00\x00 | \x20      | 20    |
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2512     | 201  | 150412345                    | 1504123450    |                      | 374245000001008  | 000000000                    | 0000000000          | \x00\x00                 | ;         | 3B    |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          | #         | 23    |
| p62_req_fast_download   | 1                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B                   |
| JCB        | 3569990010082211 | JCB/TEST           | 2612     | 201  | 1234567891234                | 987654321098  | 01234567890123456789 | 3569990000002211 | 0000000000000                | 000000000000        | \x00\x00\x00\x00         | ,         | 2C    |
| p61_req_index_num | 1  |
Scenario: Teardown - Reset to Default State
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 601  | 16010000000000946            | 1000041300000 | 01234567890123456789 | 5413330000009130 | 00000000000000000            | 0000000000000       | \x00\x00\x00\x00         |           | empty |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 2712     | 702  | 1000041300000                | 1000041300999 |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 | %         | 25    |
| p62_req_file_name       | ArcNoEncryption.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_unpack_flag     | 0                   |",Unknown
"| p62_res_file_length | @regexp:.* |
| Diners     | 36039667170472   | PETTITT/JO         | 2812     | 521  | 160100000000000007778946     | 1000051300000 | 0123456789           | 36039600000472   | 000000000000000000000000     | 0000000000000       | \x00\x00                 | &         | 26    |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| VISA       | 4264510228395621 | JOHN/SMITH         | 2712     | 206  | 0000000000000000000704001000 | 0000070400100 | 123456789            | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 | \|        | 7C    |
| p61_res_group_num             | 91 |
Examples:
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 2712     | 702  | 1000041300000                | 1000041300999 |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 | %         | 25    |
| p62_res_status      | 0          |
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_unpack_flag     | 0                   |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          | separator | ASCII |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 601  | 16010000000000946            | 1000041300000 | 01234567890123456789 | 5413330000009130 | 00000000000000000            | 0000000000000       | \x00\x00\x00\x00         |           | empty |
| JCB        | 3569990010082211 | JCB/TEST           | 2612     | 201  | 1234567891234                | 987654321098  | 01234567890123456789 | 3569990000002211 | 0000000000000                | 000000000000        | \x00\x00\x00\x00         | ,         | 2C    |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          | #         | 23    |
Given a existing file ""Files/p2p_encryptions/ArcNoEncryption.apk""
| p61_res_data_config_parameter | 0  |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
Scenario: Teardown - Reset to Default State
| p61_res_status                | 2  |
| p61_req_index_num | 1  |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2512     | 201  | 150412345                    | 1504123450    |                      | 374245000001008  | 000000000                    | 0000000000          | \x00\x00                 | ;         | 3B    |
| VISA       | 4761739001010010 | VISA Credit        | 2912     | 201  | 16010000000000000946         | 10000413      | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 00000000            | \x00\x00\x00\x00\x00\x00 | \x20      | 20    |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_index_num             | 1  |
| result | B<pan>^<name>^<exp_date><code><disc_data_t1><separator><pan>=<exp_date><code><disc_data_t2><null_characters> |
Then I should receive the 61.x Configuration Read response from terminal with params:
Then I should receive the 62.x Write File response from terminal with params:",Unknown
"| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
When I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1356
Feature: validate whitelisting with chapter X Decryption
""""""
""""""
@p2p @secbin @msr @chapter_x @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Enable Whitelisting Configuration
This feature file validates whitelisting with chapterX Encryption for MSR transaction",Unknown
"This feature file validates whitelisting with chapterX Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1356
""""""
Feature: validate whitelisting with chapter X Decryption
@p2p @secbin @msr @chapter_x @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Enable Whitelisting Configuration
""""""",Unknown
"| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |",Precondition
"| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
| p62_req_unpack_flag     | 0               |
| p62_req_file_name       | apstitan_on.apk |
| p62_req_fast_download   | 1               |
Scenario Outline: whitelisting with chapter X Encryption For MSR Transaction
When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B               |",Unknown
"| p62_req_fast_download   | 1               |
Scenario Outline: whitelisting with chapter X Encryption For MSR Transaction
| p62_req_file_name       | apstitan_on.apk |
| p62_req_encoding_format | B               |
Then I should receive the 62.x Write File response from terminal with params:
When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p62_res_file_length | @regexp:\d* |
| p62_req_unpack_flag     | 0               |
| p62_res_status      | 0           |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p61_req_group_num | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 30 |
| p61_res_index_num             | 1  |",Unknown
"| p61_res_data_config_parameter | 30 |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:",Unknown
"| p23_req_form_name      | read_cards |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |",Card Swipe
"| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |
When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"And  I wait until Element ""btn_cancel"" visible",Unknown
"| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |",Unknown
"| track3 | <additional_data><additional_data>           |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:",Unknown
"Scenario: Teardown - Reset to Default State
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Read Card response from terminal with params:
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 541389099130     | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| p23_res_card_source | M                                            |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 |
Examples:
| p23_res_exit_type   | 0                                            |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"| p23_res_exit_type   | 0                                            |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_card_source | M                                            |
Then I should receive the 23.x Read Card response from terminal with params:
| Mastercard | 541389099130     | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
Scenario: Teardown - Reset to Default State
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Examples:
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |",Card Swipe
"Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p62_req_unpack_flag     | 0               |
Feature: Validate Whitelisting With On Guard FPE Encryption for MSR Transaction
Scenario: Enable Whitelisting Configuration
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1               |
When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
| p62_res_file_length | @regexp:\d* |
| p62_req_file_name       | apstitan_off.apk |
| p62_req_encoding_format | B               |
| p62_res_status      | 0           |
""""""
@msr @fpe @secbin @00x @61x @23x @62x @13x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-977.
""""""
This feature file validates whitelisting for MSR Transaction",Unknown
"""""""
Feature: Validate Whitelisting With On Guard FPE Encryption for MSR Transaction
When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-977.
This feature file validates whitelisting for MSR Transaction
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B               |
| p62_req_unpack_flag     | 0               |
| p62_req_file_name       | apstitan_off.apk |
| p62_req_fast_download   | 1               |
| p62_res_file_length | @regexp:\d* |
@msr @fpe @secbin @00x @61x @23x @62x @13x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Enable Whitelisting Configuration
""""""
| p62_res_status      | 0           |",Unknown
"| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"Scenario Outline: Whitelisting with on guard FPE for MSR Transaction
| p62_res_file_length | @regexp:\d* |
| p62_req_file_name       | apstitan_on.apk |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
| p62_req_encoding_format | B               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:",Unknown
"When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p62_res_status      | 0           |
| p62_req_encoding_format | B               |
| p62_req_unpack_flag     | 0               |
| p62_res_file_length | @regexp:\d* |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1               |
| p62_req_file_name       | apstitan_on.apk |
Scenario Outline: Whitelisting with on guard FPE for MSR Transaction",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 2  |
| p61_req_index_num | 1  |",Unknown
"| p61_res_data_config_parameter | 2  |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_group_num             | 91 |
| p61_req_index_num | 1  |
| p61_res_status                | 2  |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:
When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |",Send Amount
"| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:
When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |",Send Amount
"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Unknown
"When I send a 23.x Card Read message to the terminal with:
| track3_data |                                              |
When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| p23_req_prompt_index   | 312 |",Card Swipe
"| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When I swipe card using this params:
When I send a 23.x Card Read message to the terminal with:
| track3_data |                                              |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| p23_req_enable_devices | M   |
| p23_req_prompt_index   | 312 |",Card Swipe
"| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_card_source | M                                            |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                 |
| p23_res_track3      | <additional_data><additional_data>           |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                 |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  |                 |
Scenario: Teardown - Reset to Default State
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  |                 |
Examples:
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data |
| p23_res_exit_type   | 0                                            |
Then I should receive the 23.x Read Card response from terminal with params:
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                 |",Card Swipe
"| p23_res_exit_type   | 0                                            |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  |                 |
| p23_res_card_source | M                                            |
Scenario: Teardown - Reset to Default State
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                 |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track3      | <additional_data><additional_data>           |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  |                 |
Examples:
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                 |",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"""""""
| p62_res_status      | 0           |
Scenario: Enable Whitelisting Configuration
This feature file validates RSA Encryption for MSR transaction
@rsa @msr @secbin @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1335
| p62_req_fast_download   | 1               |
| p62_res_file_length | @regexp:\d* |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_unpack_flag     | 0               |
""""""
| p62_req_file_name       | apstitan_off.apk |
| p62_req_encoding_format | B               |
Feature: Validate RSA Encryption for MSR transaction",Unknown
"| p62_req_unpack_flag     | 0               |
| p62_res_file_length | @regexp:\d* |
Scenario: Enable Whitelisting Configuration
| p62_req_fast_download   | 1               |
When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
| p62_req_file_name       | apstitan_off.apk |
""""""
Feature: Validate RSA Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1335
""""""
@rsa @msr @secbin @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B               |
This feature file validates RSA Encryption for MSR transaction
| p62_res_status      | 0           |",Unknown
"And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |",Precondition
"| p62_res_file_length | @regexp:\d* |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1               |
When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
Scenario Outline: RSA Encryption For MSR Transaction
| p62_req_encoding_format | B               |
| p62_res_status      | 0           |
| p62_req_file_name       | apstitan_on.apk |
| p62_req_unpack_flag     | 0               |
#Step 5",Unknown
"| p62_res_status      | 0           |
| p62_req_fast_download   | 1               |
When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
Scenario Outline: RSA Encryption For MSR Transaction
| p62_req_unpack_flag     | 0               |
#Step 5
| p62_res_file_length | @regexp:\d* |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_file_name       | apstitan_on.apk |
| p62_req_encoding_format | B               |",Unknown
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 9  |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_group_num | 91 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p61_res_group_num             | 91 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 9  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_index_num | 1  |
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_status                | 2  |
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p61_req_group_num | 91 |
| p61_res_index_num             | 1  |",Precondition
"| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"| track2 | <pan>=<exp_date><code><disc_data_t2>         |
And  I wait until Element ""btn_cancel"" visible
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3 | <additional_data><additional_data>           |
#this step is equivalent to the manual swipe of a card
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_card_source | M                                            |
| p23_res_track3      | @regexp:.*                                   |
When Axium swipe magnetic card:
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_exit_type   | 0                                            |",Card Swipe
"| p23_res_card_source | M                                            |
| track3 | <additional_data><additional_data>           |
| p23_res_exit_type   | 0                                            |
When Axium swipe magnetic card:
And  I wait until Element ""btn_cancel"" visible
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
#this step is equivalent to the manual swipe of a card
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | @regexp:.*                                   |",Card Swipe
"| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
Scenario: Teardown - Reset to Default State
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
| p29_res_variable_data | <pan>  |
| Maestro    | 501833000060        | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
| p29_res_variable_data | <name> |
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| p29_req_variable_id | 000399 |
| p29_res_variable_data | <exp_date> |
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
| p29_res_variable_id   | 000400     |
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
| p29_res_status        | 2      |
| p29_res_status        | 2      |
| p29_req_variable_id | 000400 |
| p29_res_variable_id   | 000398 |
Examples:
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |",Extract Card Data
"| Maestro    | 501833000060        | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <exp_date> |
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
| p29_res_variable_data | <name> |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |
| p29_req_variable_id | 000399 |
| p29_res_variable_data | <pan>  |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000400     |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
Scenario: Teardown - Reset to Default State
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
Examples:
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000398 |
| p29_res_variable_id   | 000398 |
| p29_res_status        | 2      |
| p29_res_status        | 2      |
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p62_res_file_length | @regexp:\d* |
| p62_req_file_name       | apstitan_off.apk |
| p62_req_encoding_format | B               |
When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1               |
| p62_res_status      | 0           |",Unknown
"| p62_req_fast_download   | 1               |
When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
| p62_req_file_name       | apstitan_off.apk |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_file_length | @regexp:\d* |
| p62_res_status      | 0           |
| p62_req_unpack_flag     | 0               |
| p62_req_encoding_format | B               |",Unknown
"""""""
| p00_req_reason_code | 0000 |
""""""
@pin_code @master_session @fpe @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Then I should receive the 00.x Offline response from terminal with params:
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
Scenario: Enable On-Guard FPE Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
This feature file verify pin block decryption is correct when FPE enabled
Feature:  Validate  pin block decryption is correct when FPE enabled",Precondition
"Feature:  Validate  pin block decryption is correct when FPE enabled
@pin_code @master_session @fpe @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Enable On-Guard FPE Encryption Configuration
""""""
| p00_res_reason_code | 0000 |
""""""
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
| p00_req_reason_code | 0000 |
This feature file verify pin block decryption is correct when FPE enabled
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p61_res_data_config_parameter | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_index_num             | 1  |
| p62_req_encoding_format | B                 |
| p61_res_status                | 2  |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p62_res_file_length | @regexp:\d* |
Scenario Outline: verify pin block decryption is correct with masked pan
| p62_req_fast_download   | 1                 |
| p62_req_file_name       | ArcOnGuardFPE.apk |
| p61_req_index_num | 1  |
| p62_req_unpack_flag     | 0                 |",Unknown
"| p61_req_index_num | 1  |
| p62_res_file_length | @regexp:\d* |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 2  |
| p62_res_status      | 0           |
| p62_req_fast_download   | 1                 |
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0                 |
| p62_req_file_name       | ArcOnGuardFPE.apk |
Scenario Outline: verify pin block decryption is correct with masked pan
| p61_res_index_num             | 1  |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
Then I should receive the 62.x Write File response from terminal with params:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_encoding_format | B                 |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_data_config_parameter | 2  |
| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
And I wait until Element ""imageOffline"" visible
| p61_req_index_num | 1  |
When I send a 61.x Read Configuration message to the terminal with:
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_res_reason_code | 0000 |
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |",Precondition
"| p61_res_group_num             | 91 |
| p00_req_reason_code | 0000 |
| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p61_req_group_num | 91 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 2  |
And I wait until Element ""imageOffline"" visible
| p61_req_index_num | 1  |",Precondition
"And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"| p23_req_prompt_index   | 3 |
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"| p23_res_card_source | M                                                            |
| p23_res_track3      | @regexp:.+                                                   |
Then I should receive the 23.x Card Read response from terminal with params:
When Axium swipe magnetic card:
| track3 |                                              |
| p23_res_exit_type   | 0                                                            |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |",Card Swipe
"| p23_res_card_source | M                                                            |
| p23_res_exit_type   | 0                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | @regexp:.+                                                   |
When Axium swipe magnetic card:",Card Swipe
"| p31_req_form_name                    |              |
| p31_res_pin_data_ksn   | @regexp:.* |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1            |
| p31_req_set_key_type                 | *            |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data       | @regexp:.* |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_res_status         | 0          |
| p31_res_pin_data_block | @regexp:.* |
| p31_req_set_encryption_configuration | 0            |",CVM Process
"| p31_req_set_key_type                 | *            |
| p31_req_prompt_index_number          | 1            |
| p31_req_form_name                    |              |
| p31_req_customer_acc_num             | <masked_pan> |
And I enter pin ""<pin_code>""
| p31_res_pin_data_block | @regexp:.* |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_status         | 0          |
| p31_req_set_encryption_configuration | 0            |
When I send a 31.x PIN Entry message to the terminal with:",CVM Process
"| pinblock | 0<pin_length><pin_code><tail> |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| length   | <pin_length>                  |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234123  | 7          | fffffff    |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110044 | 8          | ffffff     |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
Examples:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
Scenario: Teardown - Reset to Default State
| tail     | <tail>                        |
| pin_code | <pin_code>                    |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |",Unknown
"| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
Scenario: Teardown - Reset to Default State
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110044 | 8          | ffffff     |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234123  | 7          | fffffff    |
| pin_code | <pin_code>                    |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| length   | <pin_length>                  |
Examples:
| tail     | <tail>                        |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| pinblock | 0<pin_length><pin_code><tail> |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_index_num             | 1  |
| p62_req_unpack_flag     | 0                   |
########## Enable FPE encryption###############
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 0  |
| p61_req_group_num | 91 |
""""""
| p62_req_encoding_format | B                   |
Feature: verify message 29.x of variables 396 398 399 400
| p61_res_group_num             | 91 |
| p62_req_file_name       | ArcNoEncryption.apk |
Scenario: Enable On-Guard FPE Encryption Configuration
| p62_req_fast_download   | 1                   |
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
| p62_res_file_length | @regexp:.* |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_res_status      | 0          |
@00x @29x @60x @23x @87x @41x @fpe
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
When I send a 61.x Configuration Read message to the terminal with:
""""""",Extract Card Data
"| p61_res_status                | 2  |
Then I should receive the 62.x Write File response from terminal with params:
Feature: verify message 29.x of variables 396 398 399 400
@00x @29x @60x @23x @87x @41x @fpe
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_res_file_length | @regexp:.* |
| p62_req_file_name       | ArcNoEncryption.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_encoding_format | B                   |
| p61_res_data_config_parameter | 0  |
| p61_req_index_num | 1  |
| p62_req_fast_download   | 1                   |
########## Enable FPE encryption###############
| p62_req_unpack_flag     | 0                   |
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
When I send a 61.x Configuration Read message to the terminal with:
""""""
| p62_res_status      | 0          |
| p61_res_index_num             | 1  |
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
| p61_req_group_num | 91 |
""""""
Scenario: Enable On-Guard FPE Encryption Configuration
| p61_res_group_num             | 91 |",Extract Card Data
"| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p62_req_file_name       | ArcOnGuardFPE.apk |
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when FPE encryption enabled
| p62_res_status      | 0           |
@dx8000 @ex8000 @dx4000 @me
| p61_req_group_num | 91 |
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
| p62_req_fast_download   | 1                 |
| p61_res_data_config_parameter | 2  |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_status                | 2  |
########## start transaction ###############
Then I should receive the 61.x Configuration Read response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p62_res_file_length | @regexp:\d* |
| p62_req_unpack_flag     | 0                 |
| p61_req_index_num | 1  |
| p62_req_encoding_format | B                 |",Extract Card Data
"| p61_req_index_num | 1  |
| p62_req_unpack_flag     | 0                 |
| p62_res_file_length | @regexp:\d* |
| p61_req_group_num | 91 |
| p61_res_index_num             | 1  |
Then I should receive the 62.x Write File response from terminal with params:
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
| p62_req_encoding_format | B                 |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_file_name       | ArcOnGuardFPE.apk |
########## start transaction ###############
| p62_req_fast_download   | 1                 |
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when FPE encryption enabled
| p61_res_data_config_parameter | 2  |
| p61_res_group_num             | 91 |
@dx8000 @ex8000 @dx4000 @me
| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_res_status      | 0           |",Extract Card Data
"| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
When I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 2  |
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:",Unknown
"| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 2  |
| p61_res_group_num             | 91 |
| p61_req_index_num | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_index_num             | 1  |",Unknown
"Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| p23_req_enable_devices | M   |
| p23_req_prompt_index   | 312 |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| p23_req_enable_devices | M   |
| p23_req_prompt_index   | 312 |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I click Element ""ed_pan""
When I click Element ""btn_manual_entry""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"And I press enter button
And I send keys to Element ""ed_pan"" text ""<pan>""",Unknown
"When I click Element ""ed_cvv""",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I press enter button
And I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"And I press enter button
And I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"And I press enter button
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"| p23_res_exit_type   | 0                                                                       |
| p23_res_track3      | @regexp:.*                                                              |
| p23_res_card_source | H                                                                       |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track1      | %M<masked_pan>^<cardholdername>^<expect_exp_date><masked_disc_data_t1>? |",Card Swipe
"| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^<cardholdername>^<expect_exp_date><masked_disc_data_t1>? |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.*                                                              |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | <expect_exp_date> |
| p29_req_variable_id | 400 |
| p29_res_status        | 2      |
| p29_res_status        | 2            |
Then I should receive the 29.x Get Variable response from terminal with params:
@rx5000 @rx7000 @me
| p29_res_status        | 2                 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | true   |
| p29_res_variable_id   | 000396 |
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when FPE encryption enabled
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000398       |
| p29_res_status        | 2      |
| Amex      | 374245002771003 | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003 | MANUALLY/ENTERED |
| p29_res_variable_id   | 000400            |
Then I should receive the 29.x Get Variable response from terminal with params:
Examples:
| card_type | pan             | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan      | cardholdername   |
| p29_req_variable_id | 396 |
| p29_res_variable_data | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000399           |
| p29_res_status        | 2                |
| p29_res_variable_data | <masked_pan> |
| p29_res_variable_data | <cardholdername> |
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
########## start transaction ###############
| p29_req_variable_id | 399 |",Extract Card Data
"@rx5000 @rx7000 @me
| p29_req_variable_id | 396 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | 2      |
########## start transaction ###############
| p29_res_status        | 2            |
| Amex      | 374245002771003 | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003 | MANUALLY/ENTERED |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000398       |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | <cardholdername> |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000400            |
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_status        | 2      |
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when FPE encryption enabled
| p29_req_variable_id | 395 |
| p29_res_variable_id   | 000396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <expect_exp_date> |
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| card_type | pan             | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan      | cardholdername   |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Examples:
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
When I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |",Precondition
"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible",Precondition
"| p61_req_index_num | 1  |
When I send a 61.x Configuration Read message to the terminal with:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 2  |
| p61_res_index_num             | 1  |",Unknown
"| p61_res_group_num             | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_data_config_parameter | 2  |",Unknown
"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"| p23_req_prompt_index   | 312 |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M   |",Card Swipe
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible",Unknown
"And I click Element ""ed_pan""
When I click Element ""btn_manual_entry""",Unknown
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I press enter button
And I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"And I press enter button
And I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
| p23_res_track3      | @regexp:.*                                                              |
| p23_res_track1      | %M<masked_pan>^<cardholdername>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                                       |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_card_source | H                                                                       |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |",Card Swipe
"| p23_res_track1      | %M<masked_pan>^<cardholdername>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track3      | @regexp:.*                                                              |",Card Swipe
"########## start transaction ###############
When I send a 29.x Get Variable message to the terminal with:
Examples:
Then I should receive the 29.x Get Variable response from terminal with params:
Scenario Outline: Manual entry transaction to verify 29.x variables 394 395 396 398 399 400 when FPE encryption enabled
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_req_variable_id | 398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000398       |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 396 |
| p29_res_variable_id   | 000399           |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <cardholdername> |
| p29_req_variable_id | 400 |
| p29_res_status        | 2                |
| p29_res_status        | 2      |
| p29_res_variable_data | true   |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000396 |
| p29_req_variable_id | 399 |
| Amex      | 374245002771003 | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003 | MANUALLY/ENTERED |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_data | <expect_exp_date> |
| p29_res_variable_data | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 395 |
| p29_res_variable_id   | 000395 |
| card_type | pan             | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan      | cardholdername   |",Extract Card Data
"Examples:
| Amex      | 374245002771003 | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003 | MANUALLY/ENTERED |
| p29_req_variable_id | 396 |
| p29_req_variable_id | 395 |
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 399 |
| card_type | pan             | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan      | cardholdername   |
| p29_res_variable_data | <expect_exp_date> |
| p29_res_variable_data | <masked_pan> |
Scenario Outline: Manual entry transaction to verify 29.x variables 394 395 396 398 399 400 when FPE encryption enabled
| p29_res_variable_id   | 000399           |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2                |
Then I should receive the 29.x Get Variable response from terminal with params:
########## start transaction ###############
| p29_req_variable_id | 398 |
| p29_res_variable_data | <cardholdername> |
| p29_res_variable_id   | 000396 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000395 |
| p29_res_status        | 2            |
| p29_res_variable_id   | 000400            |
| p29_res_status        | 2      |
| p29_res_status        | 2                 |
| p29_res_variable_data | 2      |
| p29_req_variable_id | 400 |
| p29_res_variable_id   | 000398       |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | true   |",Extract Card Data
"| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
When I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"When I send a 23.x Card Read message to the terminal with:
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_prompt_index   | 311        |
| p23_req_enable_devices | M          |
| p23_req_form_name      | read_cards |",Card Swipe
"| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |
| p23_req_prompt_index   | 311        |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"And  I wait until Element ""btn_cancel"" visible",Unknown
"| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_card_source | M                                                            |
| p23_res_track3      | @regexp:.+                                                   |
Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_exit_type   | 0                                                            |
| track3 | <additional_data><additional_data>           |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
When Axium swipe magnetic card:",Card Swipe
"| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| track3 | <additional_data><additional_data>           |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
When Axium swipe magnetic card:
| p23_res_card_source | M                                                            |
| p23_res_exit_type   | 0                                                            |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
| p29_res_status        | 2          |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000400     |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
Examples:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2            |
| p29_res_variable_data | <code> |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | 2      |
| p29_req_variable_id | 394 |
| p29_res_variable_data | true   |
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |
| p29_req_variable_id | 400 |
| p29_res_variable_data | <exp_date> |
| p29_res_status        | 2      |
Scenario: Teardown - Reset to Default State
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
| p29_req_variable_id | 396 |
| p29_res_variable_data | <masked_pan> |
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000395 |
| p29_res_variable_id   | 000398       |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | <name> |
| p29_req_variable_id | 395 |",Extract Card Data
"When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000396 |
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
| p29_res_variable_data | true   |
| p29_res_variable_data | <masked_pan> |
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <code> |
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <name> |
| p29_res_variable_id   | 000394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 394 |
| p29_res_status        | 2      |
Examples:
| p29_res_variable_id   | 000399 |
Scenario: Teardown - Reset to Default State
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | 2      |
| p29_res_variable_data | <exp_date> |
| p29_req_variable_id | 398 |
| p29_res_variable_id   | 000400     |
| p29_res_status        | 2            |
| p29_req_variable_id | 396 |
| p29_res_variable_id   | 000395 |
| p29_res_status        | 2      |
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 395 |
| p29_res_variable_id   | 000398       |
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |
| p29_res_status        | 2      |
| p29_req_variable_id | 400 |",Extract Card Data
"| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate track encryption indicator values
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p62_req_fast_download   | 1                   |
| p61_res_data_config_parameter | 0  |
| p61_res_status                | 2  |
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1800
This feature file validates track encryption indicator with its values for manual entry , encryption indicator=3
Then I should receive the 62.x Write File response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
Scenario: Enable On-Guard SDE Encryption Configuration
| p62_req_unpack_flag     | 0                   |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_index_num             | 1  |
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
""""""
@sde @msr @00x @60x @61x @23x
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
""""""",Unknown
"| p61_req_group_num | 91 |
| p62_req_fast_download   | 1                   |
| p62_req_encoding_format | B                   |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
Feature:  Validate track encryption indicator values
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
Scenario: Enable On-Guard SDE Encryption Configuration
""""""
| p62_req_file_name       | ArcNoEncryption.apk |
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1800
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p62_res_status      | 0          |
@sde @msr @00x @60x @61x @23x
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0                   |
| p62_res_file_length | @regexp:.* |
""""""
| p61_res_group_num             | 91 |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
This feature file validates track encryption indicator with its values for manual entry , encryption indicator=3
| p61_res_data_config_parameter | 0  |",Unknown
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:",Precondition
"Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_res_file_length | @regexp:.\d* |
| p62_res_status      | 0            |
| p62_req_fast_download   | 1                 |
| p62_req_encoding_format | B                 |
| p62_req_unpack_flag     | 0                 |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
Then I should receive the 62.x Write File response from terminal with params:",Unknown
"| p62_req_fast_download   | 1                 |
| p62_res_status      | 0            |
| p62_req_unpack_flag     | 0                 |
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_res_file_length | @regexp:.\d* |
Then I should receive the 62.x Write File response from terminal with params:",Unknown
"| p61_res_status                | 2  |
When I send a 61.x Read Configuration message to the terminal with:
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
Scenario Outline: On-Guard SDE Encryption For Manual Entry Transaction with encryption indicator =3
| p61_res_data_config_parameter | 19 |
| p61_req_group_num | 91 |
@dx8000 @ex8000 @dx4000",Unknown
"Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
@dx8000 @ex8000 @dx4000
Scenario Outline: On-Guard SDE Encryption For Manual Entry Transaction with encryption indicator =3
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 19 |",Unknown
"And I successfully changed configuration ""0019"" ""0001"" to ""0""
Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""
And I successfully changed configuration ""0019"" ""0001"" to ""0""",Unknown
"| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
And I wait until Element ""imageOffline"" visible
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_data_config_parameter | 19 |
| p61_res_status                | 2  |
When I send a 61.x Read Configuration message to the terminal with:
| p00_req_reason_code | 0000 |",Precondition
"| p00_res_reason_code | 0000 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_group_num             | 91 |
When I send a 61.x Read Configuration message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_data_config_parameter | 19 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p61_req_index_num | 1  |
And I wait until Element ""imageOffline"" visible",Precondition
"| p23_req_enable_devices | M   |
When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"And I click Element ""ed_pan""
When I click Element ""btn_manual_entry""",Unknown
"And I click Element ""ed_pan""
When I click Element ""btn_manual_entry""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"And I press enter button
And I send keys to Element ""ed_pan"" text ""<pan>""",Unknown
"When I click Element ""ed_cvv""",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I press enter button
And I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I press enter button
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""",Unknown
"And I press enter button
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"Examples:
| p23_res_exit_type   | 0                                                                       |
| DISCOVER   | 6510000000000091 | 2606            | 0626     | 702  | 000000000000000     | 000000000000        | 6510000000000091 | \x00\x00\x00\x00\x00\x00\x00 |
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
Scenario Outline: On-Guard SDE Encryption For Manual Entry Transaction with encryption indicator =3
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track3      | @regexp:.+:3:.+                                                         |
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | null_characters              |
And I successfully changed configuration ""0019"" ""0001"" to ""0""
| VISA       | 4264510228395621 | 2507            | 0725     | 206  | 000000000000000     | 000000000000        | 4264510000005621 | \x00\x00\x00\x00\x00\x00\x00 |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | \x00\x00\x00\x00\x00\x00\x00 |
@rx5000 @rx7000
| p23_res_card_source | H                                                                       |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| Amex       | 374245002771003  | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003  | \x00\x00\x00\x00\x00\x00\x00 |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |",Card Swipe
"| Amex       | 374245002771003  | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003  | \x00\x00\x00\x00\x00\x00\x00 |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
@rx5000 @rx7000
Scenario Outline: On-Guard SDE Encryption For Manual Entry Transaction with encryption indicator =3
| p23_res_track3      | @regexp:.+:3:.+                                                         |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
Then I should receive the 23.x Read Card response from terminal with params:
| DISCOVER   | 6510000000000091 | 2606            | 0626     | 702  | 000000000000000     | 000000000000        | 6510000000000091 | \x00\x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | 2507            | 0725     | 206  | 000000000000000     | 000000000000        | 4264510000005621 | \x00\x00\x00\x00\x00\x00\x00 |
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | null_characters              |
And I successfully changed configuration ""0019"" ""0001"" to ""0""
| p23_res_card_source | H                                                                       |
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
| p23_res_exit_type   | 0                                                                       |
Examples:
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | \x00\x00\x00\x00\x00\x00\x00 |",Card Swipe
"| p61_res_index_num             | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
When I send a 00.x Offline message to the terminal with params:
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
| p61_res_group_num             | 91 |
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 19 |
And I wait until Element ""imageOffline"" visible",Precondition
"| p61_req_index_num | 1  |
| p00_req_reason_code | 0000 |
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
When I send a 00.x Offline message to the terminal with params:
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_index_num             | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_res_reason_code | 0000 |
| p61_res_data_config_parameter | 19 |
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_group_num             | 91 |",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M   |
| p23_req_prompt_index   | 312 |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""",Card Swipe
"Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |",Card Swipe
"And I click Element ""ed_pan""
When I click Element ""btn_manual_entry""",Unknown
"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan""",Unknown
"And I press enter button
And I send keys to Element ""ed_pan"" text ""<pan>""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
| DISCOVER   | 6510000000000091 | 2606            | 0626     | 702  | 000000000000000     | 000000000000        | 6510000000000091 | \x00\x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | 2507            | 0725     | 206  | 000000000000000     | 000000000000        | 4264510000005621 | \x00\x00\x00\x00\x00\x00\x00 |
| p23_res_exit_type   | 0                                                                       |
Then I should receive the 23.x Read Card response from terminal with params:
Scenario: Teardown - Reset to Default State
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | \x00\x00\x00\x00\x00\x00\x00 |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| Amex       | 374245002771003  | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003  | \x00\x00\x00\x00\x00\x00\x00 |
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | null_characters              |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
Examples:
| p23_res_card_source | H                                                                       |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p23_res_track3      | @regexp:.+:3:.+                                                         |",Card Swipe
"Examples:
| VISA       | 4264510228395621 | 2507            | 0725     | 206  | 000000000000000     | 000000000000        | 4264510000005621 | \x00\x00\x00\x00\x00\x00\x00 |
Scenario: Teardown - Reset to Default State
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
| DISCOVER   | 6510000000000091 | 2606            | 0626     | 702  | 000000000000000     | 000000000000        | 6510000000000091 | \x00\x00\x00\x00\x00\x00\x00 |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p23_res_track3      | @regexp:.+:3:.+                                                         |
| p23_res_card_source | H                                                                       |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| Amex       | 374245002771003  | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003  | \x00\x00\x00\x00\x00\x00\x00 |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | null_characters              |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | \x00\x00\x00\x00\x00\x00\x00 |
| p23_res_exit_type   | 0                                                                       |",Card Swipe
"Given I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p62_res_file_length | @regexp:.* |
| p61_res_data_config_parameter | 0  |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0                   |
| p61_req_group_num | 91 |
| p62_req_fast_download   | 1                   |
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B                   |
| p62_res_status      | 0          |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p62_req_file_name       | ArcNoEncryption.apk |",Unknown
"| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p62_res_status      | 0          |
| p61_res_status                | 2  |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1                   |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p62_req_encoding_format | B                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_file_name       | ArcNoEncryption.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_data_config_parameter | 0  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_res_file_length | @regexp:.* |",Unknown
"- The first entered PIN does not match the second entered PIN.
################## enable pin change support ###########################
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
- is not a weak PIN. The PIN is considered weak if:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
- The second entered PIN:
| p00_req_reason_code | 0000 |
- The number of keys entered is more than four.
Then I should receive the 00.x Offline response from terminal with params:
- The application validates the PIN according to the following rules:
- The application validates the PIN according to the following rules:
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder will enter the same strong PIN in the first and second attempt
- The third entered PIN matches the second entered PIN.
Given I send a 00.x Offline message to the terminal with params:
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered does not exceed 12.
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1386
""""""
- All digits in the PIN are the same (e.g., 4444, 3333)
""""""
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
Feature: validate an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- Each digit in the PIN is an increment of the previous digit (1234, 3456)",Precondition
"| p00_res_reason_code | 0000 |
Feature: validate an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
""""""
- is not a weak PIN. The PIN is considered weak if:
- The third entered PIN matches the second entered PIN.
- All digits in the PIN are the same (e.g., 4444, 3333)
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder will enter the same strong PIN in the first and second attempt
Then I should receive the 00.x Offline response from terminal with params:
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- The number of keys entered is more than four.
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1386
- The second entered PIN:
- The application validates the PIN according to the following rules:
################## enable pin change support ###########################
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
And I Wait until Element ""title"" contains ""This Lane Closed""
- The first entered PIN does not match the second entered PIN.
""""""
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered does not exceed 12.
Given I send a 00.x Offline message to the terminal with params:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
| p00_req_reason_code | 0000 |",Precondition
"| p28_res_variable_id | 000920 |
Then I should receive the 28.x Set Variable response from terminal with params:
When I send a 28.x Set Variable message to the terminal with:
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
| p28_req_response_type | 1      |
| p28_res_status      | 2      |",Unknown
"| p28_res_variable_id | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_req_variable_id   | 000920 |
| p28_req_response_type | 1      |
| p28_res_status      | 2      |
When I send a 28.x Set Variable message to the terminal with:",Unknown
"| p29_req_variable_id | 00000920 |
| p29_res_variable_data | true   |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
"| p29_res_variable_id   | 000920 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | true   |
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |",Extract Card Data
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"################## swipe card ###########################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"And I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |
When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_exit_type   | 0                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
And Axium swipe magnetic card:
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_card_source | M                                            |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| track3 | <additional_data><additional_data>           |",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
And Axium swipe magnetic card:
| p23_res_exit_type   | 0                                            |
| track3 | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"When I send a 31.x PIN Entry message to the terminal with:
#################enter the strong pin################################
######################## enter the same strong pin again #####################
| p31_req_form_name                    |    |
| p31_req_customer_acc_num             |    |
| p31_req_prompt_index_number          | 14 |
And I enter pin ""<strong_pin>""
| p31_req_set_key_type                 | D  |
| p31_req_set_encryption_configuration | 0  |",CVM Process
"######################## enter the same strong pin again #####################
#################enter the strong pin################################
| p31_req_form_name                    |    |
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_key_type                 | D  |
| p31_req_set_encryption_configuration | 0  |
And I enter pin ""<strong_pin>""",CVM Process
And I wait for 4 seconds,Unknown
And I wait for 4 seconds,Unknown
"############## variable keeps the value true since pin is not sucessfully changed ##########################
Then I should receive the 31.x PIN Entry response from terminal with params:
And I enter pin ""<strong_pin>""
| p31_res_status   | B |
| p31_res_pin_data |   |
####### 31.x should return B because the second pin entry is same as the first strong pin entered################### #######################",CVM Process
"And I enter pin ""<strong_pin>""
####### 31.x should return B because the second pin entry is same as the first strong pin entered################### #######################
############## variable keeps the value true since pin is not sucessfully changed ##########################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | B |
| p31_res_pin_data |   |",CVM Process
"| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Then I should receive the 29.x Get Variable response from terminal with params:
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
| p29_res_status        | 2      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
Examples:",Extract Card Data
"| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| p29_res_status        | 2      |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
| p29_res_variable_data | true   |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
Examples:
| p29_res_variable_id   | 000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |
| p29_req_variable_id | 00000920 |",Extract Card Data
"Feature:Swipe Transaction with 41.x Card Read with parse fields
@41 @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Send 41.x Card Read Request then simulate swipe",Unknown
"@41 @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:Swipe Transaction with 41.x Card Read with parse fields
Scenario: Send 41.x Card Read Request then simulate swipe",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_smc_flag         | 0 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_contactless_flag | 0 |",Unknown
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_msr_flag         | 1 |
| p41_req_smc_flag         | 0 |",Unknown
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"Then Axium swipe magnetic card:
| track3 |                                                                         |
| track2 | 5413330089099130=25122011483594900000                                   |
| track1 | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |",Unknown
"| track3 |                                                                         |
Then Axium swipe magnetic card:
| track1 | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| track2 | 5413330089099130=25122011483594900000                                   |",Unknown
And I wait 3 seconds,Unknown
And I wait 3 seconds,Unknown
"| p41_res_encryption      | 00                                                                      |
| p41_res_masked_pan      | 5413330089099130                                                        |
| p41_res_source          | M                                                                       |
| p41_res_track_2         | 5413330089099130=25122011483594900000                                   |
| p41_res_track_1         | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| p41_res_track_3         |                                                                         |
| p41_res_track_1_status  | 0                                                                       |
| p41_res_pan             | 5413330089099130                                                        |
| p41_res_error_code      | 0                                                                       |
| p41_res_account_name    | UAT USA/TEST CARD 20                                                    |
| p41_res_track_2_status  | 0                                                                       |
| p41_res_expiration_date | 2512                                                                    |
| p41_res_track_3_status  | 1                                                                       |
And I should receive the 41.x Card Read Message response from terminal with params:",Unknown
"| p41_res_source          | M                                                                       |
| p41_res_track_2         | 5413330089099130=25122011483594900000                                   |
| p41_res_account_name    | UAT USA/TEST CARD 20                                                    |
| p41_res_track_3_status  | 1                                                                       |
| p41_res_expiration_date | 2512                                                                    |
| p41_res_masked_pan      | 5413330089099130                                                        |
| p41_res_error_code      | 0                                                                       |
And I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_pan             | 5413330089099130                                                        |
| p41_res_track_1_status  | 0                                                                       |
| p41_res_track_1         | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| p41_res_track_2_status  | 0                                                                       |
| p41_res_encryption      | 00                                                                      |
| p41_res_track_3         |                                                                         |",Unknown
"Scenario: Enable Voltage TEP2 Encryption Configuration
Feature:  Validate  pin block decryption is correct when TEP2 enabled
| p00_res_reason_code | 0000 |
@pin_code @master_session @tep2 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Given I send a 00.x Offline message to the terminal with params:
This feature file verify pin block decryption is correct when TEP2 enabled
""""""
Then I should receive the 00.x Offline response from terminal with params:
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
""""""
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
""""""
Scenario: Enable Voltage TEP2 Encryption Configuration
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
""""""
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
Feature:  Validate  pin block decryption is correct when TEP2 enabled
When I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
| p00_req_reason_code | 0000 |
@pin_code @master_session @tep2 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
This feature file verify pin block decryption is correct when TEP2 enabled",Precondition
"| p62_res_status      | 0            |
| p61_res_group_num             | 91 |
| p90_req_function | 0 |
| p61_res_status                | 2  |
| p62_req_encoding_format | B                            |
Scenario Outline: verify pin block decryption is correct with masked pan
| p62_res_file_length | @regexp:.\d* |
Then I should receive the 62.x Write File response from terminal with params:
| p90_res_etb      | @regexp:.* |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p90_res_status   | 0          |
| p62_req_fast_download   | 1                            |
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
| p62_req_unpack_flag     | 0                            |
| p61_res_data_config_parameter | 5  |
When I send a 61.x Configuration Read message to the terminal with:
When I send a 90.x MSR Encryption message to the terminal with:
When I have successfully sent ""Files/p2p_encryptions/voltage_5_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_5_default-signed.apk |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p61_req_group_num | 91 |",Unknown
"When I send a 90.x MSR Encryption message to the terminal with:
Then I should receive the 62.x Write File response from terminal with params:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p90_res_status   | 0          |
| p61_res_group_num             | 91 |
| p90_req_function | 0 |
When I send a 61.x Configuration Read message to the terminal with:
Scenario Outline: verify pin block decryption is correct with masked pan
| p62_req_encoding_format | B                            |
| p61_res_status                | 2  |
| p90_res_function | 0          |
| p62_req_fast_download   | 1                            |
| p61_req_index_num | 1  |
| p61_req_group_num | 91 |
| p90_res_etb      | @regexp:.* |
| p61_res_data_config_parameter | 5  |
| p62_res_file_length | @regexp:.\d* |
When I have successfully sent ""Files/p2p_encryptions/voltage_5_default-signed.apk"" file using these params:
| p62_res_status      | 0            |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p61_res_index_num             | 1  |
| p62_req_unpack_flag     | 0                            |
| p62_req_file_name       | voltage_5_default-signed.apk |",Unknown
"| p61_req_group_num | 91 |
| p00_res_reason_code | 0000 |
| p61_res_data_config_parameter | 5  |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
| p61_res_index_num             | 1  |
When I send a 61.x Read Configuration message to the terminal with:
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |",Precondition
"| p61_res_index_num             | 1  |
When I send a 61.x Read Configuration message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
| p61_res_data_config_parameter | 5  |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_group_num             | 91 |
| p61_req_index_num | 1  |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 61.x Read Configuration response from terminal with params:",Precondition
"And  I wait until Element ""btn_cancel"" visible
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |",Card Swipe
"| p23_req_prompt_index   | 3 |
And  I wait until Element ""btn_cancel"" visible
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""",Card Swipe
"| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
When Axium swipe magnetic card:
| p23_res_card_source | M          |
| p23_res_exit_type   | 0          |
| track3 | <additional_data><additional_data>           |
| p23_res_track1      | @regexp:.* |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | @regexp:.* |
| p23_res_exit_type   | 0          |
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
| p23_res_track2      | @regexp:.* |",Card Swipe
"| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | @regexp:.* |
| p29_res_variable_id   | 000398     |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |",Extract Card Data
"| p29_res_variable_data | @regexp:.* |
| p29_res_variable_id   | 000398     |
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000398 |",Extract Card Data
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_form_name                    |                                                  |
And I enter pin ""<pin_code>""
| p31_req_prompt_index_number          | 1                                                |
| p31_res_status         | 0          |
| p31_req_set_key_type                 | *                                                |
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_set_encryption_configuration | 0                                                |",CVM Process
"And I enter pin ""<pin_code>""
| p31_req_prompt_index_number          | 1                                                |
| p31_req_form_name                    |                                                  |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_key_type                 | *                                                |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_status         | 0          |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_res_pin_data       | @regexp:.* |",CVM Process
"| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| length   | <pin_length>                  |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| tail     | <tail>                        |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
Scenario: Teardown - Reset to Default State
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
Examples:
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 55221100 | 8          | ffffff     |
| pinblock | 0<pin_length><pin_code><tail> |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| pin_code | <pin_code>                    |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 552211   | 6          | ffffffff   |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 4321     | 4          | ffffffffff |",Unknown
"| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 4321     | 4          | ffffffffff |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| length   | <pin_length>                  |
Scenario: Teardown - Reset to Default State
| pin_code | <pin_code>                    |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 552211   | 6          | ffffffff   |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| pinblock | 0<pin_length><pin_code><tail> |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 55221100 | 8          | ffffff     |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| tail     | <tail>                        |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
Examples:",Unknown
"| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
| p61_res_status                | 2  |
Then I should receive the 62.x Write File response from terminal with params:
Then I should receive the 61.x Configuration Read response from terminal with params:
""""""
Scenario: Enable On-Guard SDE Encryption Configuration
| p61_req_group_num | 91 |
########## enable SDE encryption ###############
| p61_res_data_config_parameter | 0  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
""""""
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_res_file_length | @regexp:.* |
Feature: verify message 29.x of variables 396 398 399 400
@00x @29x @60x @23x @87x @41x @sde
| p62_res_status      | 0          |
| p61_req_index_num | 1  |
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_fast_download   | 1                   |
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
| p62_req_encoding_format | B                   |
| p62_req_unpack_flag     | 0                   |",Extract Card Data
"Feature: verify message 29.x of variables 396 398 399 400
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_res_file_length | @regexp:.* |
| p61_req_group_num | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
When I send a 61.x Configuration Read message to the terminal with:
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
""""""
| p62_req_fast_download   | 1                   |
""""""
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
Scenario: Enable On-Guard SDE Encryption Configuration
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_req_unpack_flag     | 0                   |
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
@00x @29x @60x @23x @87x @41x @sde
########## enable SDE encryption ###############",Extract Card Data
"| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"| p62_res_status      | 0            |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_fast_download   | 1                 |
| p62_res_file_length | @regexp:.\d* |
| p62_req_encoding_format | B                 |
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:",Unknown
"| p62_res_status      | 0            |
| p62_req_fast_download   | 1                 |
Then I should receive the 62.x Write File response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_unpack_flag     | 0                 |
| p62_res_file_length | @regexp:.\d* |
| p62_req_encoding_format | B                 |
| p62_req_file_name       | ArcOnGuardSDE.apk |",Unknown
"Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_group_num | 91 |
| p61_res_index_num             | 1  |
@dx8000 @ex8000 @dx4000 @me
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 19 |
| p61_res_status                | 2  |
When I send a 61.x Read Configuration message to the terminal with:
########## start transaction ###############
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when SDE encryption enabled",Extract Card Data
"Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when SDE encryption enabled
@dx8000 @ex8000 @dx4000 @me
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 19 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_index_num | 1  |
########## start transaction ###############",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
And I send a 00.x Offline message to the terminal with params:",Precondition
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| p23_req_enable_devices | M   |
| p23_req_prompt_index   | 312 |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""line_display"" visible",Unknown
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"And I click Element ""ed_pan""
When I click Element ""btn_manual_entry""",Unknown
"And I click Element ""ed_pan""
When I click Element ""btn_manual_entry""",Unknown
"And I press enter button
And I send keys to Element ""ed_pan"" text ""<pan>""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"And I press enter button
And I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button",Unknown
"And I press enter button
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"When I click Element ""btn_manual_confirm""",Unknown
"| p23_res_card_source | H                                                                       |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                                       |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track3      | @regexp:.*                                                              |",Card Swipe
"| p23_res_exit_type   | 0                                                                       |
| p23_res_track3      | @regexp:.*                                                              |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |",Card Swipe
"Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when SDE encryption enabled
| p29_res_variable_id   | 000399           |
| p29_res_variable_id   | 000396 |
Then I should receive the 29.x Get Variable response from terminal with params:
Examples:
| p29_res_variable_data | 19     |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | cardholdername   |
| p29_res_status        | 2                |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
| p29_req_variable_id | 400 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000400            |
| p29_res_status        | 2      |
@rx5000 @rx7000 @me
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <expect_exp_date> |
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 395 |
| p29_res_variable_data | <cardholdername> |
| p29_res_variable_data | <masked_pan> |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000395 |
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_status        | 2                 |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | MANUALLY/ENTERED |
| p29_req_variable_id | 398 |
| p29_res_variable_data | true   |
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2                 |
@rx5000 @rx7000 @me
| p29_req_variable_id | 395 |
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when SDE encryption enabled
| p29_res_status        | 2            |
| p29_req_variable_id | 398 |
| p29_res_variable_id   | 000395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_data | true   |
| p29_res_variable_data | 19     |
| p29_res_variable_id   | 000396 |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
| p29_res_variable_data | <cardholdername> |
| p29_req_variable_id | 400 |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <expect_exp_date> |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | MANUALLY/ENTERED |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000400            |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | cardholdername   |
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
Examples:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399           |
| p29_res_status        | 2                |",Extract Card Data
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"Given I successfully changed configuration ""0007"" ""0029"" to ""1""",Unknown
"And I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible",Precondition
"And I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| p23_req_prompt_index   | 312 |",Card Swipe
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| p23_req_prompt_index   | 312 |",Card Swipe
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"And I wait until Element ""btn_manual_entry"" visible
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"And I click Element ""ed_pan""
When I click Element ""btn_manual_entry""",Unknown
"And I click Element ""ed_pan""
When I click Element ""btn_manual_entry""",Unknown
"And I press enter button
And I send keys to Element ""ed_pan"" text ""<pan>""",Unknown
"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button",Unknown
"When I click Element ""ed_cvv""",Unknown
"When I click Element ""ed_cvv""",Unknown
"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button",Unknown
"And I press enter button
And I send keys to Element ""ed_cvv"" text ""<code>""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"When I click Element ""ed_expiry_date""",Unknown
"| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track3      | @regexp:.*                                                              |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |",Card Swipe
"| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_card_source | H                                                                       |
| p23_res_exit_type   | 0                                                                       |
And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track3      | @regexp:.*                                                              |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |",Card Swipe
"| p29_res_status        | 2            |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | MANUALLY/ENTERED |
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
########## start transaction ###############
| p29_res_variable_data | <masked_pan> |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
| p29_res_variable_data | <cardholdername> |
| p29_req_variable_id | 400 |
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | cardholdername   |
| p29_req_variable_id | 396 |
Scenario Outline: Manual entry transaction to verify 29.x variables 394 395 396 398 399 400 when SDE encryption enabled
| p29_res_status        | 2                |
| p29_res_status        | 2      |
| p29_req_variable_id | 399 |
| p29_res_variable_id   | 000395 |
| p29_req_variable_id | 398 |
| p29_res_variable_data | <expect_exp_date> |
| p29_res_variable_id   | 000400            |
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | 19     |
Examples:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399           |
| p29_res_variable_id   | 000396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr",Extract Card Data
"Examples:
Scenario Outline: Manual entry transaction to verify 29.x variables 394 395 396 398 399 400 when SDE encryption enabled
| p29_res_variable_data | true   |
| p29_res_variable_id   | 000399           |
| p29_res_status        | 2                 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000395 |
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
| p29_res_variable_id   | 000400            |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000396 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
| p29_res_status        | 2            |
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | cardholdername   |
| p29_res_variable_data | 19     |
When I send a 29.x Get Variable message to the terminal with:
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | MANUALLY/ENTERED |
| p29_res_variable_data | <expect_exp_date> |
| p29_res_variable_id   | 000398       |
| p29_req_variable_id | 399 |
| p29_res_variable_data | <cardholdername> |
| p29_req_variable_id | 395 |
########## start transaction ###############
| p29_req_variable_id | 400 |
| p29_res_status        | 2                |
| p29_res_variable_data | <masked_pan> |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
When I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible",Precondition
"| p23_req_prompt_index   | 3 |
Then I Wait until Element ""title"" contains ""Please slide card""
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
| p23_req_enable_devices | M |",Card Swipe
"| track3 | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
Then I should receive the 23.x Card Read response from terminal with params:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                            |
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_card_source | M                                                            |
When Axium swipe magnetic card:",Card Swipe
"| p23_res_card_source | M                                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| track3 | <additional_data><additional_data>           |
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_exit_type   | 0                                                            |
Then I should receive the 23.x Card Read response from terminal with params:
When Axium swipe magnetic card:",Card Swipe
"| p29_res_status        | 2      |
| p29_req_variable_id | 394 |
| p29_res_variable_id   | 000400     |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <code> |
Then I should receive the 29.x Get Variable response from terminal with params:
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 | null_characters |
| p29_req_variable_id | 395 |
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |                 |
| p29_res_variable_id   | 000396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_req_variable_id | 398 |
Examples:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <exp_date> |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 399 |
| p29_res_status        | 2            |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
########## remove encryption ###############
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
Then I should receive the 29.x Get Variable response from terminal with params:
########## remove encryption ###############
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000398       |
Scenario: Teardown - Reset to Default State
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 19     |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <masked_pan> |
| p29_req_variable_id | 400 |
| p29_res_variable_data | <name> |",Extract Card Data
"| p29_res_variable_data | <name> |
Then I should receive the 29.x Get Variable response from terminal with params:
Examples:
| p29_res_variable_id   | 000395 |
| p29_req_variable_id | 395 |
| p29_res_variable_id   | 000396 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
| p29_res_variable_data | <masked_pan> |
| p29_res_status        | 2            |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000398       |
Scenario: Teardown - Reset to Default State
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_req_variable_id | 399 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
########## remove encryption ###############
| p29_res_variable_id   | 000399 |
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 | null_characters |
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |                 |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
########## remove encryption ###############
| p29_res_variable_data | true   |
| p29_req_variable_id | 396 |
| p29_req_variable_id | 398 |
| p29_res_variable_id   | 000400     |
| p29_res_status        | 2      |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <exp_date> |
| p29_res_variable_data | 19     |",Extract Card Data
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |",Precondition
"| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
| p62_res_file_length | @regexp:.* |
Then I should receive the 62.x Write File response from terminal with params:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_file_name       | ArcNoEncryption.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p62_res_status      | 0          |
| p62_req_fast_download   | 1                   |
| p62_req_encoding_format | B                   |
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 0  |
| p61_res_index_num             | 1  |
| p62_req_unpack_flag     | 0                   |",Unknown
"| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p62_res_status      | 0          |
| p62_req_encoding_format | B                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1                   |
| p61_res_data_config_parameter | 0  |
| p61_res_status                | 2  |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_res_file_length | @regexp:.* |
| p61_req_index_num | 1  |
When I send a 61.x Configuration Read message to the terminal with:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_group_num | 91 |
| p62_req_file_name       | ArcNoEncryption.apk |",Unknown
"- The number of keys entered is more than four.
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
Feature: validate an invalid PIN change where the cardholder will type a third entered PIN that does not match the second entered PIN
| p00_res_reason_code | 0000 |
- All digits in the PIN are the same (e.g., 4444, 3333)
""""""
""""""
And I Wait until Element ""title"" contains ""This Lane Closed""
- The first entered PIN does not match the second entered PIN.
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
- is not a weak PIN. The PIN is considered weak if:
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder enter a 3rd entered pin doesnt match the second enetered pin
- The application validates the PIN according to the following rules:
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- The application validates the PIN according to the following rules:
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1387
################## enable pin change support ###########################
Then I should receive the 00.x Offline response from terminal with params:
- The number of keys entered does not exceed 12.
- The second entered PIN:
- The third entered PIN matches the second entered PIN.",Precondition
"################## enable pin change support ###########################
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
""""""
- The application validates the PIN according to the following rules:
- The second entered PIN:
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder enter a 3rd entered pin doesnt match the second enetered pin
- is not a weak PIN. The PIN is considered weak if:
- The third entered PIN matches the second entered PIN.
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
- All digits in the PIN are the same (e.g., 4444, 3333)
- The number of keys entered does not exceed 12.
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
""""""
Then I should receive the 00.x Offline response from terminal with params:
Feature: validate an invalid PIN change where the cardholder will type a third entered PIN that does not match the second entered PIN
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1387
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.",Precondition
"When I send a 28.x Set Variable message to the terminal with:
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_req_response_type | 1      |
| p28_res_variable_id | 000920 |
| p28_req_variable_id   | 000920 |",Unknown
"When I send a 28.x Set Variable message to the terminal with:
| p28_res_status      | 2      |
| p28_req_response_type | 1      |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_req_variable_id   | 000920 |
| p28_res_variable_id | 000920 |",Unknown
"| p29_res_variable_id   | 000920 |
| p29_res_status        | 2      |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_req_variable_id | 00000920 |",Extract Card Data
"################## swipe card ###########################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |
When I send a 23.x Card Read message to the terminal with:
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"| track3 | <additional_data><additional_data>           |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_exit_type   | 0                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_card_source | M                                            |
And Axium swipe magnetic card:",Card Swipe
"| track3 | <additional_data><additional_data>           |
| p23_res_card_source | M                                            |
And Axium swipe magnetic card:
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_exit_type   | 0                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"#################enter the weak pin################################
| p31_req_set_key_type                 | D  |
| p31_req_customer_acc_num             |    |
| p31_req_prompt_index_number          | 14 |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_encryption_configuration | 0  |
| p31_req_form_name                    |    |
And I enter pin ""<weak_pin>""",CVM Process
"| p31_req_customer_acc_num             |    |
And I enter pin ""<weak_pin>""
| p31_req_set_key_type                 | D  |
| p31_req_set_encryption_configuration | 0  |
| p31_req_prompt_index_number          | 14 |
| p31_req_form_name                    |    |
When I send a 31.x PIN Entry message to the terminal with:
#################enter the weak pin################################",CVM Process
"And I wait for 4 seconds
#################enter strong pin################################",Unknown
"And I wait for 4 seconds
#################enter strong pin################################",Unknown
"######################## enter another strong pin  #####################
And I enter pin ""<strong_pin1>""",Unknown
"######################## enter another strong pin  #####################
And I enter pin ""<strong_pin1>""",Unknown
And I wait for 4 seconds,Unknown
And I wait for 4 seconds,Unknown
"| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################
Then I should receive the 31.x PIN Entry response from terminal with params:
And I enter pin ""<strong_pin2>""
####### 31.x should return C because the 3rd pin entry is not same as the 2nd strong pin entered################### #######################
| p31_res_status   | C |",CVM Process
"And I enter pin ""<strong_pin2>""
| p31_res_status   | C |
############## variable keeps the value true since pin is not sucessfully changed ##########################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data |   |
####### 31.x should return C because the 3rd pin entry is not same as the 2nd strong pin entered################### #######################",CVM Process
"| p29_req_variable_id | 00000920 |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin1 | strong_pin2 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000920 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988        | 3124        |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124        | 0101        |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593        | 9988        |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258        | 1593        |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101        | 0258        |",Extract Card Data
"When I send a 29.x Get Variable message to the terminal with:
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593        | 9988        |
Then I should receive the 29.x Get Variable response from terminal with params:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin1 | strong_pin2 |
| p29_req_variable_id | 00000920 |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258        | 1593        |
| p29_res_status        | 2      |
Examples:
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124        | 0101        |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988        | 3124        |
| p29_res_variable_id   | 000920 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101        | 0258        |
| p29_res_variable_data | true   |",Extract Card Data
"""""""
Feature: MSR transaction For Non Standard Card Using 87.x Card Read Request
""""""
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1199
Scenario Outline: Check MSR flow while using 87.x with Non-Standard two tracks(track1 ,track2)
@87x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
This feature file Validates MSR transaction For Non Standard Card using 87.x Card Read Request",Unknown
"Feature: MSR transaction For Non Standard Card Using 87.x Card Read Request
This feature file Validates MSR transaction For Non Standard Card using 87.x Card Read Request
""""""
@87x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1199
""""""
Scenario Outline: Check MSR flow while using 87.x with Non-Standard two tracks(track1 ,track2)",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with:
And I wait until Element ""imageOffline"" visible",Precondition
"| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |
| p87_req_prompt_index    | 3          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:",Unknown
"| p87_req_enabled_devices | M          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_form_name       | read_cards |
| p87_req_prompt_index    | 3          |",Unknown
"And I wait until Element ""btn_cancel"" visible
And I wait for 1 second
Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"And I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait for 1 second",Unknown
"| p87_res_card_data   | @regexp:^<track1_res>\u001c<track2_res>\u001c.*$ |
| p87_res_exit_type   | 0                                                |
| track2_data | <track2_data> |
When I swipe card using this params:
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| B4147200000002105 KOIRALA/SASMIT 2603201000000000000000000000000 | 4147200000002105=260320100000000       | B4147200000002105 KOIRALA/SASMIT 2603201000000000000000000000000 | 4147200000002105=260320100000000       |
| 1234567890123456                                                 | 1234567890123456                       | 1234567890123456                                                 | 1234567890123456                       |
| track1_data | <track1_data> |
Scenario Outline: Check MSR flow while using 87.x with  Non-Standard track1 only
| 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000  | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000  | 0000198800001234560011=2012=0000002008 |
| track3_data |               |
| p87_res_card_source | M                                                |
Examples:
| track1_data                                                      | track2_data                            | track1_res                                                       | track2_res                             |",Unknown
"| p87_res_card_data   | @regexp:^<track1_res>\u001c<track2_res>\u001c.*$ |
Examples:
| p87_res_exit_type   | 0                                                |
| 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000  | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000  | 0000198800001234560011=2012=0000002008 |
| 1234567890123456                                                 | 1234567890123456                       | 1234567890123456                                                 | 1234567890123456                       |
| p87_res_card_source | M                                                |
Scenario Outline: Check MSR flow while using 87.x with  Non-Standard track1 only
| track1_data                                                      | track2_data                            | track1_res                                                       | track2_res                             |
| track2_data | <track2_data> |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| track1_data | <track1_data> |
When I swipe card using this params:
| B4147200000002105 KOIRALA/SASMIT 2603201000000000000000000000000 | 4147200000002105=260320100000000       | B4147200000002105 KOIRALA/SASMIT 2603201000000000000000000000000 | 4147200000002105=260320100000000       |
| track3_data |               |",Unknown
"Given I send a 00.x Offline message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"Given I send a 00.x Offline message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |",Unknown
"| p87_req_enabled_devices | M          |
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait for 1 second
And I wait until Element ""btn_cancel"" visible",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"| 1006357681?3       1234567890123456 |             | 1006357681?3       1234567890123456 |            |
| track3_data |               |
Examples:
| 5413339000000119                    |             | 5413339000000119                    |            |
| p87_res_card_source | M                        |
When I swipe card using this params:
| p87_res_card_data   | @regexp:^<track1_res>.*$ |
| track1_data | <track1_data> |
| track1_data                         | track2_data | track1_res                          | track1_res |
| 1234567890123456                    |             | 1234567890123456                    |            |
| track2_data |               |
| p87_res_exit_type   | 0                        |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
Scenario Outline: Check MSR flow while using 87.x with Non-Standard track2 only",Unknown
"| track1_data | <track1_data> |
| p87_res_exit_type   | 0                        |
Examples:
| 5413339000000119                    |             | 5413339000000119                    |            |
| 1006357681?3       1234567890123456 |             | 1006357681?3       1234567890123456 |            |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| track2_data |               |
| 1234567890123456                    |             | 1234567890123456                    |            |
| p87_res_card_data   | @regexp:^<track1_res>.*$ |
| track1_data                         | track2_data | track1_res                          | track1_res |
Scenario Outline: Check MSR flow while using 87.x with Non-Standard track2 only
| p87_res_card_source | M                        |
When I swipe card using this params:
| track3_data |               |",Unknown
"| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |",Precondition
"| p87_req_form_name       | read_cards |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_enabled_devices | M          |",Unknown
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |
| p87_req_prompt_index    | 3          |",Unknown
"And I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait for 1 second",Unknown
"And I wait for 1 second
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible",Unknown
"@41 @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p87_res_card_data   | @regexp:^<track1_res>.*$ |
| track1_data | track2_data                            | track1_res | track2_res                             |
| track2_data | <track2_data> |
|             | 0000198800001234560011=2012=0000002008 |            | 0000198800001234560011=2012=0000002008 |
|             | B4445222AE299990007                    |            | B4445222AE299990007                    |
| p87_res_card_source | M                        |
|             | 1234567890123456                       |            | 1234567890123456                       |
Examples:
| track3_data |               |
| p87_res_exit_type   | 0                        |
Feature:Swipe Transaction with 41.x Card Read without parse fields
Scenario: Send 41.x Card Read Request then simulate swipe
| track1_data |               |
When I swipe card using this params:
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:",Unknown
"Feature:Swipe Transaction with 41.x Card Read without parse fields
When I swipe card using this params:
| track1_data | track2_data                            | track1_res | track2_res                             |
Scenario: Send 41.x Card Read Request then simulate swipe
| track1_data |               |
| p87_res_card_data   | @regexp:^<track1_res>.*$ |
|             | 0000198800001234560011=2012=0000002008 |            | 0000198800001234560011=2012=0000002008 |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
@41 @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| track2_data | <track2_data> |
| p87_res_exit_type   | 0                        |
|             | B4445222AE299990007                    |            | B4445222AE299990007                    |
|             | 1234567890123456                       |            | 1234567890123456                       |
Examples:
| track3_data |               |
| p87_res_card_source | M                        |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |
| p41_req_parse_flag       | 0 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_msr_flag         | 1 |",Unknown
"| p41_req_contactless_flag | 0 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_smc_flag         | 0 |
| p41_req_parse_flag       | 0 |
| p41_req_msr_flag         | 1 |",Unknown
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"Then Axium swipe magnetic card:
| track1 | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| track3 |                                                                         |
| track2 | 5413330089099130=25122011483594900000                                   |",Unknown
"Then Axium swipe magnetic card:
| track1 | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| track2 | 5413330089099130=25122011483594900000                                   |
| track3 |                                                                         |",Unknown
And I wait for 30 seconds,Unknown
And I wait for 30 seconds,Unknown
"| p41_res_track_2        | 5413330089099130=25122011483594900000                                   |
| p41_res_track_2_status | 0                                                                       |
| p41_res_error_code     | 0                                                                       |
| p41_res_track_1_status | 0                                                                       |
| p41_res_source         | M                                                                       |
| p41_res_track_3        |                                                                         |
| p41_res_track_1        | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| p41_res_encryption     | 00                                                                      |
| p41_res_track_3_status | 1                                                                       |
And I should receive the 41.x Card Read Message response from terminal with params:",Unknown
"| p41_res_track_1_status | 0                                                                       |
| p41_res_source         | M                                                                       |
| p41_res_track_2_status | 0                                                                       |
| p41_res_encryption     | 00                                                                      |
| p41_res_track_3_status | 1                                                                       |
| p41_res_track_2        | 5413330089099130=25122011483594900000                                   |
And I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_track_1        | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| p41_res_error_code     | 0                                                                       |
| p41_res_track_3        |                                                                         |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
""""""
| p00_req_reason_code | 0000 |
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
This feature file verify pin block decryption is correct when TEP4 enabled
@pin_code @master_session @tep4 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when TEP4 enabled
| p00_res_reason_code | 0000 |
Scenario: Enable Voltage TEP4 Encryption Configuration
""""""
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
""""""
Scenario: Enable Voltage TEP4 Encryption Configuration
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
Feature:  Validate  pin block decryption is correct when TEP4 enabled
@pin_code @master_session @tep4 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
This feature file verify pin block decryption is correct when TEP4 enabled
""""""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p90_res_status   | 0          |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_fast_download   | 1                            |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 6  |
| p90_res_function | 0          |
| p62_res_status      | 0           |
| p61_res_index_num             | 1  |
| p62_req_file_name       | voltage_6_default-signed.apk |
When I send a 90.x MSR Encryption message to the terminal with:
Then I should receive the 62.x Write File response from terminal with params:
Scenario Outline: verify pin block decryption is correct with masked pan
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_encoding_format | B                            |
| p90_req_function | 0 |
When I have successfully sent ""Files/p2p_encryptions/voltage_6_default-signed.apk"" file using these params:
| p62_res_file_length | @regexp:\d* |
| p61_res_group_num             | 91 |
| p61_req_index_num | 1  |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_etb      | @regexp:.* |",Unknown
"When I have successfully sent ""Files/p2p_encryptions/voltage_6_default-signed.apk"" file using these params:
| p90_res_status   | 0          |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 6  |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_req_file_name       | voltage_6_default-signed.apk |
Scenario Outline: verify pin block decryption is correct with masked pan
| p61_req_group_num | 91 |
| p62_res_file_length | @regexp:\d* |
| p62_req_fast_download   | 1                            |
| p90_res_etb      | @regexp:.* |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p61_req_index_num | 1  |
| p62_req_encoding_format | B                            |
| p62_req_unpack_flag     | 0                            |
| p90_res_function | 0          |
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
When I send a 90.x MSR Encryption message to the terminal with:
| p61_res_index_num             | 1  |
| p90_req_function | 0 |",Unknown
"Given I send a 00.x Offline message to the terminal with params:
When I send a 61.x Read Configuration message to the terminal with:
And I wait until Element ""imageOffline"" visible
| p61_res_index_num             | 1  |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_data_config_parameter | 6  |
| p00_res_reason_code | 0000 |
| p61_res_group_num             | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
| p00_req_reason_code | 0000 |
| p61_req_group_num | 91 |",Precondition
"| p61_res_data_config_parameter | 6  |
| p61_req_index_num | 1  |
| p61_req_group_num | 91 |
| p00_req_reason_code | 0000 |
| p61_res_status                | 2  |
When I send a 61.x Read Configuration message to the terminal with:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_index_num             | 1  |
Given I send a 00.x Offline message to the terminal with params:
| p61_res_group_num             | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |",Precondition
"Then I Wait until Element ""title"" contains ""Please slide card""
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible
| p23_req_prompt_index   | 3 |",Card Swipe
"| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:
| p23_res_track3      | @regexp:.* |
| p23_res_track1      | @regexp:.* |
| p23_res_exit_type   | 0          |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| track3 | <additional_data><additional_data>           |
| p23_res_card_source | M          |
| p23_res_track2      | @regexp:.* |",Card Swipe
"| track3 | <additional_data><additional_data>           |
| p23_res_track2      | @regexp:.* |
| p23_res_exit_type   | 0          |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_card_source | M          |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track1      | @regexp:.* |
Then I should receive the 23.x Card Read response from terminal with params:
When Axium swipe magnetic card:
| p23_res_track3      | @regexp:.* |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000398     |
| p29_req_variable_id | 000398 |
| p29_res_variable_data | @regexp:.* |
| p29_res_status        | 2          |",Extract Card Data
"Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |
| p29_req_variable_id | 000398 |
| p29_res_status        | 2          |",Extract Card Data
"| p31_req_form_name                    |                                                  |
And I enter pin ""<pin_code>""
| p31_req_prompt_index_number          | 1                                                |
| p31_res_status         | 0          |
| p31_res_pin_data_ksn   | @regexp:.* |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_set_encryption_configuration | 0                                                |
| p31_res_pin_data       | @regexp:.* |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_key_type                 | *                                                |
| p31_res_pin_data_block | @regexp:.* |
When I send a 31.x PIN Entry message to the terminal with:",CVM Process
"| p31_req_set_encryption_configuration | 0                                                |
| p31_res_pin_data       | @regexp:.* |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_set_key_type                 | *                                                |
And I enter pin ""<pin_code>""
| p31_req_form_name                    |                                                  |
| p31_res_pin_data_ksn   | @regexp:.* |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 12341234 | 8          | ffffff     |
| length   | <pin_length>                  |
Scenario: Teardown - Reset to Default State
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522     | 4          | ffffffffff |
| pin_code | <pin_code>                    |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| pinblock | 0<pin_length><pin_code><tail> |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| tail     | <tail>                        |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522001  | 7          | fffffff    |
Examples:
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 432100   | 6          | ffffffff   |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |",Unknown
"| length   | <pin_length>                  |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 432100   | 6          | ffffffff   |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| pinblock | 0<pin_length><pin_code><tail> |
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
Examples:
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522     | 4          | ffffffffff |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| tail     | <tail>                        |
Scenario: Teardown - Reset to Default State
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522001  | 7          | fffffff    |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 12341234 | 8          | ffffff     |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| pin_code | <pin_code>                    |",Unknown
"Given I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p61_res_index_num             | 1  |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0                   |
| p62_res_file_length | @regexp:.* |
| p62_req_encoding_format | B                   |
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
| p62_res_status      | 0          |
| p61_res_data_config_parameter | 0  |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_fast_download   | 1                   |
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_res_group_num             | 91 |
Then I should receive the 62.x Write File response from terminal with params:",Unknown
"| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0                   |
| p62_res_status      | 0          |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 0  |
| p62_req_encoding_format | B                   |
| p61_req_group_num | 91 |
| p61_res_index_num             | 1  |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
Then I should receive the 61.x Configuration Read response from terminal with params:
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1                   |",Unknown
"TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1389
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
""""""
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate invalid PIN change where the cardholder types the second entered PIN with more than 10 digits
################## enable pin change support ###########################
- The number of keys entered is more than four.
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- All digits in the PIN are the same (e.g., 4444, 3333)
Scenario Outline: Perform MSR transaction and enter an invalid PIN change where the cardholder types the second entered PIN with more than 10 digits
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- is not a weak PIN. The PIN is considered weak if:
| p00_res_reason_code | 0000 |
""""""
- The number of keys entered does not exceed 12.
| p00_req_reason_code | 0000 |
- The application validates the PIN according to the following rules:
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
- The third entered PIN matches the second entered PIN.
And I Wait until Element ""title"" contains ""This Lane Closed""
- The second entered PIN:",Precondition
"| p00_req_reason_code | 0000 |
- All digits in the PIN are the same (e.g., 4444, 3333)
- The number of keys entered is more than four.
- The application validates the PIN according to the following rules:
Scenario Outline: Perform MSR transaction and enter an invalid PIN change where the cardholder types the second entered PIN with more than 10 digits
And I Wait until Element ""title"" contains ""This Lane Closed""
- The second entered PIN:
- The application validates the PIN according to the following rules:
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
- The number of keys entered does not exceed 12.
Feature: validate invalid PIN change where the cardholder types the second entered PIN with more than 10 digits
- is not a weak PIN. The PIN is considered weak if:
################## enable pin change support ###########################
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
""""""
Given I send a 00.x Offline message to the terminal with params:
- The first entered PIN does not match the second entered PIN.
""""""
| p00_res_reason_code | 0000 |
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1389
Then I should receive the 00.x Offline response from terminal with params:
- The third entered PIN matches the second entered PIN.
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.",Precondition
"| p28_res_status      | 2      |
| p28_req_variable_data | 1      |
| p28_req_response_type | 1      |
When I send a 28.x Set Variable message to the terminal with:
| p28_req_variable_id   | 000920 |
| p28_res_variable_id | 000920 |
Then I should receive the 28.x Set Variable response from terminal with params:",Unknown
"| p28_req_variable_id   | 000920 |
When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | true   |
| p29_res_variable_id   | 000920 |",Extract Card Data
"| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000920 |
| p29_res_status        | 2      |
| p29_req_variable_id | 00000920 |",Extract Card Data
"################## swipe card ###########################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"################## swipe card ###########################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"| p23_req_form_name      | read_cards |
| p23_req_prompt_index   | 311        |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card""
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"| p23_req_prompt_index   | 311        |
| p23_req_enable_devices | M          |
| p23_req_form_name      | read_cards |
When I send a 23.x Card Read message to the terminal with:
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"| track3 | <additional_data><additional_data>           |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_exit_type   | 0                                            |
And Axium swipe magnetic card:
| p23_res_card_source | M                                            |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                            |
| p23_res_track3      | <additional_data><additional_data>           |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_exit_type   | 0                                            |
And Axium swipe magnetic card:",Card Swipe
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p31_req_set_encryption_configuration | 0  |
| p31_req_customer_acc_num             |    |
#################enter the weak pin################################
| p31_req_form_name                    |    |
And I enter pin ""<weak_pin>""
| p31_req_set_key_type                 | D  |
| p31_req_prompt_index_number          | 14 |
When I send a 31.x PIN Entry message to the terminal with:",CVM Process
"#################enter the weak pin################################
| p31_req_customer_acc_num             |    |
And I enter pin ""<weak_pin>""
| p31_req_set_key_type                 | D  |
| p31_req_set_encryption_configuration | 0  |
| p31_req_prompt_index_number          | 14 |
| p31_req_form_name                    |    |
When I send a 31.x PIN Entry message to the terminal with:",CVM Process
"And I wait for 5 seconds
#################enter 10/11 digits pin pin################################",Unknown
"And I wait for 5 seconds
#################enter 10/11 digits pin pin################################",Unknown
"And I enter pin ""<second_pin>""",Unknown
"And I enter pin ""<second_pin>""",Unknown
"And I wait for 11 seconds
####### 31.x should return A because the 2nd pin entry is 10 or 11 digits length################### #######################",CVM Process
"####### 31.x should return A because the 2nd pin entry is 10 or 11 digits length################### #######################
And I wait for 11 seconds",CVM Process
"| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | A |",CVM Process
"############## variable keeps the value true since pin is not sucessfully changed ##########################
| p31_res_pin_data |   |
| p31_res_status   | A |
Then I should receive the 31.x PIN Entry response from terminal with params:",CVM Process
"| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988112589  |
| p29_res_status        | 2      |
| p29_req_variable_id | 00000920 |
| p29_res_variable_id   | 000920 |
When I send a 29.x Get Variable message to the terminal with:
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 1122772211  |
| p29_res_variable_data | true   |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4321     | 11445332271 |
Then I should receive the 29.x Get Variable response from terminal with params:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | second_pin  |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 5026301670  |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 6986301671  |
Examples:",Extract Card Data
"| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | second_pin  |
Then I should receive the 29.x Get Variable response from terminal with params:
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988112589  |
| p29_res_status        | 2      |
| p29_res_variable_data | true   |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 1122772211  |
Examples:
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4321     | 11445332271 |
| p29_res_variable_id   | 000920 |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 5026301670  |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 6986301671  |
| p29_req_variable_id | 00000920 |
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
"@87x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: MSR transaction using 87.x Card Read Request
Scenario Outline: Check MSR flow while using 87.x with two tracks(track1 ,track2)
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1155
""""""
This feature file Validates MSR transaction using 87.x Card Read Request
""""""",Unknown
"Feature: MSR transaction using 87.x Card Read Request
""""""
This feature file Validates MSR transaction using 87.x Card Read Request
""""""
Scenario Outline: Check MSR flow while using 87.x with two tracks(track1 ,track2)
@87x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1155",Unknown
"| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible",Precondition
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_enabled_devices | M          |
| p87_req_form_name       | read_cards |
| p87_req_prompt_index    | 3          |",Unknown
"| p87_req_prompt_index    | 3          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_enabled_devices | M          |
| p87_req_form_name       | read_cards |",Unknown
"And I wait for 1 second
And I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"And I wait for 1 second
And I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"| AMEX 1      | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
| NonStandard | 999000              | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |
Scenario Outline: Check MSR flow while using  87.x with  track1 only
Examples:
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                                                    |
When I swipe card using this params:
| VISA        | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026887693372 | 887693372    |
| MasterCard  | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| track3_data |                                              |
| p87_res_card_source | M                                                                                                    |
| card_type   | pan                 | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Unknown
"Scenario Outline: Check MSR flow while using  87.x with  track1 only
Examples:
| NonStandard | 999000              | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |
| MasterCard  | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_card_source | M                                                                                                    |
| VISA        | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026887693372 | 887693372    |
When I swipe card using this params:
| card_type   | pan                 | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| track3_data |                                              |
| p87_res_exit_type   | 0                                                                                                    |
| AMEX 1      | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |",Unknown
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with:",Precondition
"| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_enabled_devices | M          |",Unknown
"| p87_req_enabled_devices | M          |
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:",Unknown
"And I wait for 1 second
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible",Unknown
"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"| track3_data |                                              |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C\x1C$ |
Scenario Outline: Check MSR flow while using 87.x with track2 only
| p87_res_exit_type   | 0                                                                |
| p87_res_card_source | M                                                                |
Examples:
| track2_data |                                              |
| VISA        | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026887693372 | 887693372    |
| card_type   | pan                 | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| AMEX 1      | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
| NonStandard | 999000              | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |
| MasterCard  | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:",Unknown
"Scenario Outline: Check MSR flow while using 87.x with track2 only
| p87_res_exit_type   | 0                                                                |
| AMEX 1      | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
| p87_res_card_source | M                                                                |
| track3_data |                                              |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C\x1C$ |
| card_type   | pan                 | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| MasterCard  | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| NonStandard | 999000              | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |
| VISA        | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026887693372 | 887693372    |
When I swipe card using this params:
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
Examples:
| track2_data |                                              |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Unknown
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p87_req_prompt_index    | 3          |
| p87_req_enabled_devices | M          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_form_name       | read_cards |",Unknown
"| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |
| p87_req_prompt_index    | 3          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:",Unknown
"And I wait for 1 second
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible
And I wait for 1 second
Then I Wait until Element ""title"" contains ""Please slide card""",Unknown
"Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| NonStandard | 999000         | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |
| AMEX 1      | 37158413190797 | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
| VISA        | 34798979016630 | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026823693372 | 823693372    |
| p87_res_card_data   | @regexp:^\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |
When I swipe card using this params:
| track3_data |                                      |
| p87_res_card_source | M                                                      |
| MasterCard  | 45358179327829 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| card_type   | pan            | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
Examples:
| p87_res_exit_type   | 0                                                      |
| track2_data | <pan>=<exp_date><code><disc_data_t2> |
| track1_data |                                      |",Unknown
"| p87_res_exit_type   | 0                                                      |
Examples:
| track3_data |                                      |
| track2_data | <pan>=<exp_date><code><disc_data_t2> |
| p87_res_card_data   | @regexp:^\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |
| card_type   | pan            | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| p87_res_card_source | M                                                      |
| AMEX 1      | 37158413190797 | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
When I swipe card using this params:
| VISA        | 34798979016630 | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026823693372 | 823693372    |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| NonStandard | 999000         | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |
| MasterCard  | 45358179327829 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| track1_data |                                      |",Unknown
"Scenario Outline: On-Demand Messages using 41.x EFT message
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1159.
""""""
""""""
This feature file Validates on-demand messages using 41.x EFT message
Feature: Validate On-Demand Messages using 41.x EFT message
@41x @msr @00x @24x @21x @27x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Unknown
"This feature file Validates on-demand messages using 41.x EFT message
""""""
Feature: Validate On-Demand Messages using 41.x EFT message
""""""
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1159.
@41x @msr @00x @24x @21x @27x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario Outline: On-Demand Messages using 41.x EFT message",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"| p24_res_exit_type | 0    |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid     | \x1F |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |",Display Confirmation
"Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_req_form_number | activity_main |
| p24_res_keyid     | \x1F |
When I send a 24.x Form Entry message to the terminal with params:",Display Confirmation
"And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"| p21_req_form_specific_index | input_numeric  |
| p21_req_max_input_length    | <max_input>    |
| p21_req_min_input_length    | <min_input>    |
And I wait until Element ""line_display"" visible
When I send a 21.x Numeric Input message to the terminal with:
| p21_req_display_char        | 0              |
#And I wait until Element ""btn_cancel"" visible
And I Wait until Element ""fixed_title"" contains ""<title>""
| p21_req_prompt_index        | <prompt_index> |",Unknown
"| p21_req_form_specific_index | input_numeric  |
| p21_req_min_input_length    | <min_input>    |
And I Wait until Element ""fixed_title"" contains ""<title>""
#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
| p21_req_display_char        | 0              |
| p21_req_max_input_length    | <max_input>    |
| p21_req_prompt_index        | <prompt_index> |
When I send a 21.x Numeric Input message to the terminal with:",Unknown
"When I click Element ""input_box""",Unknown
"When I click Element ""input_box""",Unknown
"| p21_res_input_data | <input_data> |
And  I send keys to Element ""input_box"" text ""<input_data>"" and then ENTER
Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | 0            |",Unknown
"| p21_res_input_data | <input_data> |
| p21_res_exit_type  | 0            |
Then I should receive the 21.x Numeric Input response from terminal with params:
And  I send keys to Element ""input_box"" text ""<input_data>"" and then ENTER",Unknown
"When I send a 24.x Form Entry message to the terminal with params:
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_req_form_number | activity_main |
| p24_res_keyid     | \x1F |",Display Confirmation
"Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_form_number | activity_main |
| p24_res_exit_type | 0    |
When I send a 24.x Form Entry message to the terminal with params:
| p24_res_keyid     | \x1F |",Display Confirmation
"| p27_req_prompt_index     | 016         |
| p27_req_max_input_length | 40          |
#And I wait until Element ""btn_cancel"" visible
When I send a 27.x Alpha Input message to the terminal with params:
| p27_req_display_char     | 0           |
| p27_req_min_input_length | 00          |
| p27_req_form_specificid  | input_alpha |
And I wait until Element ""line_display"" visible
And I Wait until Element ""title"" contains ""Welcome""
And I Wait until Element ""fixed_title"" contains ""Please enter Cashback:""",Unknown
"| p27_req_max_input_length | 40          |
| p27_req_display_char     | 0           |
When I send a 27.x Alpha Input message to the terminal with params:
And I Wait until Element ""title"" contains ""Welcome""
| p27_req_prompt_index     | 016         |
| p27_req_min_input_length | 00          |
| p27_req_form_specificid  | input_alpha |
#And I wait until Element ""btn_cancel"" visible
And I Wait until Element ""fixed_title"" contains ""Please enter Cashback:""
And I wait until Element ""line_display"" visible",Unknown
"When I click Element ""input_box""",Unknown
"When I click Element ""input_box""",Unknown
"| p27_res_exit_type  | 0             |
And I send keys to Element ""input_box"" text ""ISAT-v-1.9.66"" and then ENTER
Then I should receive the 27.x Alpha Input response from terminal with params:
| p27_res_data_input | ISAT-v-1.9.66 |",Unknown
"| p27_res_data_input | ISAT-v-1.9.66 |
And I send keys to Element ""input_box"" text ""ISAT-v-1.9.66"" and then ENTER
Then I should receive the 27.x Alpha Input response from terminal with params:
| p27_res_exit_type  | 0             |",Unknown
"| p41_req_parse_flag       | 0 |
| p41_req_smc_flag         | 0 |
| p41_req_msr_flag         | 1 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_contactless_flag | 0 |",Unknown
"| p41_req_smc_flag         | 0 |
| p41_req_parse_flag       | 0 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
When I send a 41.x Card Read Message message to the terminal with params:",Unknown
And I wait for 2 second,Unknown
And I wait for 2 second,Unknown
"Then I swipe card using this params:
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3_data |                                              |",Unknown
"| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3_data |                                              |
Then I swipe card using this params:",Unknown
When I wait for 5 second,Unknown
When I wait for 5 second,Unknown
"| p41_res_source         | M                                            |
| p41_res_track_3        |                                              |
| p41_res_error_code     | 0                                            |
| p41_res_track_2_status | 0                                            |
| p41_res_encryption     | 00                                           |
| p41_res_track_1        | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_track_1_status | 0                                            |
| p41_res_track_2        | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_track_3_status | 1                                            |",Unknown
"| p41_res_track_2_status | 0                                            |
| p41_res_track_3        |                                              |
| p41_res_track_2        | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_track_3_status | 1                                            |
| p41_res_error_code     | 0                                            |
| p41_res_source         | M                                            |
| p41_res_track_1        | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_encryption     | 00                                           |
| p41_res_track_1_status | 0                                            |
Then I should receive the 41.x Card Read Message response from terminal with params:",Unknown
"Then I should receive in '30' seconds the 31.x Pin Entry response from terminal with params:
| p31_req_set_encryption_configuration | 0     |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_prompt_index_number          | 1     |
And I enter pin ""1234""
When I send a 31.x Pin Entry message to the terminal with params:
| p31_req_customer_acc_num             | <pan> |
| p31_res_pin_data       | @regexp:.* |
| p31_req_form_name                    |       |
| p31_req_set_key_type                 | D     |
| p31_res_status         | 0          |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"| p31_res_pin_data_block | @regexp:.* |
When I send a 31.x Pin Entry message to the terminal with params:
| p31_res_status         | 0          |
Then I should receive in '30' seconds the 31.x Pin Entry response from terminal with params:
| p31_req_set_encryption_configuration | 0     |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_set_key_type                 | D     |
| p31_req_form_name                    |       |
And I enter pin ""1234""
| p31_res_pin_data       | @regexp:.* |
| p31_req_prompt_index_number          | 1     |
| p31_req_customer_acc_num             | <pan> |",CVM Process
"| p24_res_keyid     | \x1F |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_form_number | activity_main |
When I send a 24.x Form Entry message to the terminal with params:
| p24_res_exit_type | 0    |",Display Confirmation
"| p24_req_form_number | activity_main |
| p24_res_keyid     | \x1F |
Then I should receive the 24.x Form Entry response from terminal with params:
When I send a 24.x Form Entry message to the terminal with params:
| p24_res_exit_type | 0    |",Display Confirmation
"| p21_req_prompt_index        | <prompt_index> |
| p21_req_min_input_length    | <min_input>    |
| p21_req_max_input_length    | <max_input>    |
| p21_req_form_specific_index | input_numeric  |
And I Wait until Element ""title"" contains ""Welcome!""
| p21_req_display_char        | 0              |
When I send a 21.x Numeric Input message to the terminal with:",Unknown
"| p21_req_min_input_length    | <min_input>    |
| p21_req_max_input_length    | <max_input>    |
And I Wait until Element ""title"" contains ""Welcome!""
| p21_req_display_char        | 0              |
When I send a 21.x Numeric Input message to the terminal with:
| p21_req_form_specific_index | input_numeric  |
| p21_req_prompt_index        | <prompt_index> |",Unknown
"| p41_req_msr_flag         | 1 |
| p41_req_parse_flag       | 0 |
And I send a 41.x Card Read Message message to the terminal with params:
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
"| p41_req_smc_flag         | 0 |
And I send a 41.x Card Read Message message to the terminal with params:
| p41_req_contactless_flag | 0 |
| p41_req_parse_flag       | 0 |
| p41_req_msr_flag         | 1 |",Unknown
"And I Wait until Element ""fixed_title"" contains ""<title>""
#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I Wait until Element ""fixed_title"" contains ""<title>""",Unknown
"| p24_req_form_number | activity_main |
When I send a 24.x Form Entry message to the terminal with params:",Display Confirmation
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |",Display Confirmation
"Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | a |
| p21_res_input_data |   |",Unknown
"| p21_res_input_data |   |
| p21_res_exit_type  | a |
Then I should receive the 21.x Numeric Input response from terminal with params:",Unknown
"| p24_res_exit_type | 0    |
And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid     | \x1F |",Display Confirmation
"| p24_res_keyid     | \x1F |
And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |",Display Confirmation
"And I Wait until Element ""title"" contains ""Welcome!""",Unknown
"And I Wait until Element ""title"" contains ""Welcome!""",Unknown
"| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:",Precondition
"| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:",Precondition
"| p41_res_track_1_status | 1  |
And I wait 1 second
| p41_res_track_1        |    |
| p41_res_source         | U  |
| p41_res_encryption     | 98 |
| p41_res_track_2        |    |
| p41_res_error_code     | a  |
| p41_res_track_3_status | 1  |
| p41_res_track_2_status | 1  |
| p41_res_track_3        |    |
Then I should receive the 41.x response from terminal with params:",Unknown
"| p41_res_track_1_status | 1  |
| p41_res_source         | U  |
| p41_res_track_2_status | 1  |
| p41_res_track_3        |    |
And I wait 1 second
| p41_res_track_2        |    |
| p41_res_error_code     | a  |
| p41_res_track_3_status | 1  |
| p41_res_track_1        |    |
Then I should receive the 41.x response from terminal with params:
| p41_res_encryption     | 98 |",Unknown
"Examples:
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000\u001c5413339000000119=24122210000014000001\u001c0123456789012345678901234567890123456789 | 0000014000001  | 01234567890123456789 | 01        | 10        | 001          | 6724240113 | Enter home phone number |
And I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                                                                                             | disc_data_t2   | additional_data      | min_input | max_input | prompt_index | input_data | title                   |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946                                                                                     | 1000041300000  | 01234567890123456789 | 01        | 40        | 001          | 74158552   | Enter home phone number |
""""""
And I Wait until Element ""title"" contains ""This Lane Closed""
This feature file verify pin block decryption is correct when TEP6 enabled
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000                                                                             | 0000070400100  |                      | 01        | 40        | 001          | 558555     | Enter home phone number |
@pin_code @master_session @tep6 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                                                                                            | 1000041300000  |                      | 01        | 40        | 001          | 88855588   | Enter home phone number |
Feature:  Validate  pin block decryption is correct when TEP6 enabled
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                                                                                                | 15041234500000 |                      | 01        | 20        | 001          | 77457777   | Enter home phone number |
Scenario: Enable Voltage TEP6 Encryption Configuration
""""""
| p00_res_reason_code | 0000 |",Precondition
"Examples:
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946                                                                                     | 1000041300000  | 01234567890123456789 | 01        | 40        | 001          | 74158552   | Enter home phone number |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000\u001c5413339000000119=24122210000014000001\u001c0123456789012345678901234567890123456789 | 0000014000001  | 01234567890123456789 | 01        | 10        | 001          | 6724240113 | Enter home phone number |
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
And I Wait until Element ""title"" contains ""This Lane Closed""
And I should receive the 00.x Offline response from terminal with params:
""""""
Feature:  Validate  pin block decryption is correct when TEP6 enabled
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                                                                                            | 1000041300000  |                      | 01        | 40        | 001          | 88855588   | Enter home phone number |
Scenario: Enable Voltage TEP6 Encryption Configuration
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                                                                                             | disc_data_t2   | additional_data      | min_input | max_input | prompt_index | input_data | title                   |
Then I should receive the 00.x Offline response from terminal with params:
@pin_code @master_session @tep6 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p00_res_reason_code | 0000 |
""""""
This feature file verify pin block decryption is correct when TEP6 enabled
| p00_req_reason_code | 0000 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000                                                                             | 0000070400100  |                      | 01        | 40        | 001          | 558555     | Enter home phone number |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                                                                                                | 15041234500000 |                      | 01        | 20        | 001          | 77457777   | Enter home phone number |
Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 90.x MSR Encryption message to the terminal with:
| p62_req_unpack_flag     | 0                             |
| p62_res_file_length | @regexp:.\d* |
| p90_res_etb      | @regexp:.* |
When I have successfully sent ""Files/p2p_encryptions/voltage_31_default-signed.apk"" file using these params:
| p61_res_data_config_parameter | 31 |
Scenario Outline: verify pin block decryption is correct with masked pan
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
And I should receive the 62.x File Write response from terminal with params:
| p62_res_status      | 0            |
| p90_res_status   | 0          |
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_file_name       | voltage_31_default-signed.apk |
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p62_req_encoding_format | B                             |
| p61_req_index_num | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_fast_download   | 1                             |",Unknown
"Then I should receive the 61.x Configuration Read response from terminal with params:
Scenario Outline: verify pin block decryption is correct with masked pan
| p61_res_data_config_parameter | 31 |
When I send a 90.x MSR Encryption message to the terminal with:
| p61_req_index_num | 1  |
| p62_res_status      | 0            |
| p62_req_fast_download   | 1                             |
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p90_res_function | 0          |
| p62_res_file_length | @regexp:.\d* |
| p62_req_unpack_flag     | 0                             |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_file_name       | voltage_31_default-signed.apk |
And I should receive the 62.x File Write response from terminal with params:
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p62_req_encoding_format | B                             |
When I have successfully sent ""Files/p2p_encryptions/voltage_31_default-signed.apk"" file using these params:
| p61_res_status                | 2  |
| p90_res_etb      | @regexp:.* |
| p90_res_status   | 0          |
| p61_res_index_num             | 1  |
| p90_req_function | 0 |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
| p61_res_group_num             | 91 |
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p61_req_index_num | 1  |
| p00_res_reason_code | 0000 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_req_reason_code | 0000 |
| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 31 |",Precondition
"Given I send a 00.x Offline message to the terminal with params:
| p61_res_status                | 2  |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 61.x Read Configuration response from terminal with params:
When I send a 61.x Read Configuration message to the terminal with:
And I wait until Element ""imageOffline"" visible
| p61_req_index_num | 1  |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 31 |",Precondition
"When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible
| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |",Card Swipe
"| p23_res_card_source | M          |
| p23_res_exit_type   | 0          |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | @regexp:.* |
| track3 | <additional_data><additional_data>           |
When Axium swipe magnetic card:
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track2      | @regexp:.* |
| p23_res_track1      | @regexp:.* |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"| p23_res_track3      | @regexp:.* |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:
| p23_res_track2      | @regexp:.* |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | @regexp:.* |
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |",Card Swipe
"| p29_res_status        | 2          |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | @regexp:.* |
| p29_req_variable_id | 000398 |
| p29_res_variable_id   | 000398     |
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
"| p29_res_variable_data | @regexp:.* |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
| p29_res_variable_id   | 000398     |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |",Extract Card Data
"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_encryption_configuration | 0                                                |
| p31_res_status         | 0          |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_key_type                 | *                                                |
| p31_req_form_name                    |                                                  |
| p31_res_pin_data_block | @regexp:.* |
| p31_req_prompt_index_number          | 1                                                |
| p31_res_pin_data       | @regexp:.* |",CVM Process
"| p31_res_pin_data_block | @regexp:.* |
| p31_req_set_encryption_configuration | 0                                                |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_key_type                 | *                                                |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_form_name                    |                                                  |
| p31_res_status         | 0          |
| p31_req_prompt_index_number          | 1                                                |
| p31_res_pin_data       | @regexp:.* |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |",CVM Process
"Scenario: Teardown - Reset to Default State
Examples:
| length   | <pin_length>                  |
| pinblock | 0<pin_length><pin_code><tail> |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| pin_code | <pin_code>                    |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 12341234 | 8          | ffffff     |
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522110  | 7          | fffffff    |
| tail     | <tail>                        |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522     | 4          | ffffffffff |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 432100   | 6          | ffffffff   |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |",Unknown
"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| tail     | <tail>                        |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 432100   | 6          | ffffffff   |
| length   | <pin_length>                  |
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
Examples:
| pinblock | 0<pin_length><pin_code><tail> |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522110  | 7          | fffffff    |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
Scenario: Teardown - Reset to Default State
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 12341234 | 8          | ffffff     |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522     | 4          | ffffffffff |
| pin_code | <pin_code>                    |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:",Precondition
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p62_req_file_name       | ArcNoEncryption.apk |
| p62_res_file_length | @regexp:.* |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p62_req_encoding_format | B                   |
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_unpack_flag     | 0                   |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 0  |
| p61_res_group_num             | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_fast_download   | 1                   |
| p62_res_status      | 0          |",Unknown
"| p61_req_index_num | 1  |
| p62_res_file_length | @regexp:.* |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1                   |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 0  |
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_res_index_num             | 1  |
| p62_res_status      | 0          |
| p62_req_encoding_format | B                   |
| p61_res_status                | 2  |",Unknown
"- The application validates the PIN according to the following rules:
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1388
################## enable pin change support ###########################
Feature: validate an valid PIN change where the cardholder will type the second entered PIN is more than 4 digits and less than 10 digits
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
Scenario Outline: Perform MSR transaction and valid PIN change where the cardholder will type the second entered PIN is more than 4 digits and less than 10 digits
- All digits in the PIN are the same (e.g., 4444, 3333)
- The second entered PIN:
Then I should receive the 00.x Offline response from terminal with params:
""""""
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
- The number of keys entered is more than four.
Given I send a 00.x Offline message to the terminal with params:
- The third entered PIN matches the second entered PIN.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
| p00_res_reason_code | 0000 |
- is not a weak PIN. The PIN is considered weak if:
- The number of keys entered does not exceed 12.",Precondition
"| p00_req_reason_code | 0000 |
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
""""""
- is not a weak PIN. The PIN is considered weak if:
- The number of keys entered is more than four.
- All digits in the PIN are the same (e.g., 4444, 3333)
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1388
- The second entered PIN:
Feature: validate an valid PIN change where the cardholder will type the second entered PIN is more than 4 digits and less than 10 digits
And I Wait until Element ""title"" contains ""This Lane Closed""
- The number of keys entered does not exceed 12.
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- The first entered PIN does not match the second entered PIN.
Given I send a 00.x Offline message to the terminal with params:
- The third entered PIN matches the second entered PIN.
################## enable pin change support ###########################
| p00_res_reason_code | 0000 |
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
Scenario Outline: Perform MSR transaction and valid PIN change where the cardholder will type the second entered PIN is more than 4 digits and less than 10 digits
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
- The application validates the PIN according to the following rules:
- The application validates the PIN according to the following rules:
""""""
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p28_res_variable_id | 000920 |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |",Unknown
"When I send a 28.x Set Variable message to the terminal with:
| p28_req_variable_data | 1      |
| p28_res_variable_id | 000920 |
| p28_req_response_type | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_req_variable_id   | 000920 |",Unknown
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
| p29_res_variable_data | true   |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |",Extract Card Data
"When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | true   |
| p29_res_variable_id   | 000920 |
| p29_req_variable_id | 00000920 |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"################## swipe card ###########################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"################## swipe card ###########################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"When I send a 23.x Card Read message to the terminal with:
And I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |
| p23_req_prompt_index   | 311        |
| p23_req_enable_devices | M          |",Card Swipe
"When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |
| p23_req_prompt_index   | 311        |
And I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_enable_devices | M          |",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_exit_type   | 0                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3 | <additional_data><additional_data>           |
| p23_res_track3      | <additional_data><additional_data>           |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
And Axium swipe magnetic card:
Then I should receive the 23.x Card Read response from terminal with params:",Card Swipe
"And Axium swipe magnetic card:
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:
| track3 | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p31_req_customer_acc_num             |    |
| p31_req_form_name                    |    |
| p31_req_set_key_type                 | D  |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_set_encryption_configuration | 0  |
#################enter the weak pin################################
And I enter pin ""<weak_pin>""",CVM Process
"| p31_req_set_key_type                 | D  |
#################enter the weak pin################################
And I enter pin ""<weak_pin>""
| p31_req_customer_acc_num             |    |
| p31_req_form_name                    |    |
| p31_req_prompt_index_number          | 14 |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_encryption_configuration | 0  |",CVM Process
"And I wait for 4 seconds
#################enter strong pin >4digits################################",Unknown
"#################enter strong pin >4digits################################
And I wait for 4 seconds",Unknown
"And I enter pin ""<strong_pin>""
######################## reenter the strong pin  #####################",Unknown
"And I enter pin ""<strong_pin>""
######################## reenter the strong pin  #####################",Unknown
And I wait for 7 seconds,Unknown
And I wait for 7 seconds,Unknown
"############### variable is back to false after pin change ############################
And I enter pin ""<strong_pin>""
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_status         | 0          |
Then I should receive the 31.x PIN Entry response from terminal with params:",CVM Process
"And I enter pin ""<strong_pin>""
############### variable is back to false after pin change ############################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 3124312     |
| p29_req_variable_id | 00000920 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 02580259    |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 15933       |
| p29_res_variable_data | false   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| p29_res_variable_id   | 000920 |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 998866027   |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 010198      |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"| p29_res_variable_id   | 000920 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 010198      |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 3124312     |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 998866027   |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 15933       |
| p29_res_status        | 2      |
| p29_res_variable_data | false   |
Examples:
| p29_req_variable_id | 00000920 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 02580259    |",Extract Card Data
"Feature: Validate On-Demand Messages using 87.x EFT message
@87x @msr @00x @24x @21x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
""""""
Scenario Outline: On-Demand Messages using 87.x EFT message
""""""
This feature file Validates on-demand messages using 87.x EFT message
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1158.",Unknown
"""""""
Scenario Outline: On-Demand Messages using 87.x EFT message
@87x @msr @00x @24x @21x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1158.
""""""
This feature file Validates on-demand messages using 87.x EFT message
Feature: Validate On-Demand Messages using 87.x EFT message",Unknown
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"| p24_res_exit_type | 0    |
| p24_req_form_number | activity_main |
When I send a 24.x Form Entry message to the terminal with params:
| p24_res_keyid     | \x1F |
Then I should receive the 24.x Form Entry response from terminal with params:",Display Confirmation
"Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_form_number | activity_main |
When I send a 24.x Form Entry message to the terminal with params:
| p24_res_keyid     | \x1F |
| p24_res_exit_type | 0    |",Display Confirmation
"And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"| p21_req_form_specific_index | input_numeric  |
| p21_req_display_char        | 0              |
| p21_req_prompt_index        | <prompt_index> |
| p21_req_min_input_length    | <min_input>    |
And I Wait until Element ""fixed_title"" contains ""<title>""
When I send a 21.x Numeric Input message to the terminal with:
And I wait until Element ""line_display"" visible
#And I wait until Element ""btn_cancel"" visible
| p21_req_max_input_length    | <max_input>    |",Unknown
"#And I wait until Element ""btn_cancel"" visible
When I send a 21.x Numeric Input message to the terminal with:
| p21_req_form_specific_index | input_numeric  |
| p21_req_min_input_length    | <min_input>    |
And I wait until Element ""line_display"" visible
And I Wait until Element ""fixed_title"" contains ""<title>""
| p21_req_display_char        | 0              |
| p21_req_prompt_index        | <prompt_index> |
| p21_req_max_input_length    | <max_input>    |",Unknown
"When I click Element ""input_box""",Unknown
"When I click Element ""input_box""",Unknown
"Then I should receive the 21.x Numeric Input response from terminal with params:
And  I send keys to Element ""input_box"" text ""<input_data>"" and then ENTER
| p21_res_input_data | <input_data> |
| p21_res_exit_type  | 0            |",Unknown
"And  I send keys to Element ""input_box"" text ""<input_data>"" and then ENTER
Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | 0            |
| p21_res_input_data | <input_data> |",Unknown
"| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |
| p87_req_prompt_index    | 3          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:",Unknown
"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |",Unknown
"And I wait until Element ""line_display"" visible
And I wait until Element ""image_card"" visible
And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible",Unknown
"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""image_card"" visible",Unknown
"When I send a 24.x Form Entry message to the terminal with params:
| p24_res_exit_type | 0    |
And I should receive the 24.x Form Entry response from terminal with params:
| p24_req_form_number | activity_main |
| p24_res_keyid     | \x1F |",Display Confirmation
"| p24_res_keyid     | \x1F |
| p24_res_exit_type | 0    |
| p24_req_form_number | activity_main |
When I send a 24.x Form Entry message to the terminal with params:
And I should receive the 24.x Form Entry response from terminal with params:",Display Confirmation
"And I wait until Element ""line_display"" visible
And I Wait until Element ""fixed_title"" contains ""Please enter Cashback:""
#And I wait until Element ""btn_cancel"" visible
And I Wait until Element ""title"" contains ""Welcome""
| p27_req_form_specificid  | input_alpha |
| p27_req_min_input_length | 00          |
| p27_req_prompt_index     | 016         |
When I send a 27.x Alpha Input message to the terminal with params:
| p27_req_max_input_length | 40          |
| p27_req_display_char     | 0           |",Unknown
"And I Wait until Element ""fixed_title"" contains ""Please enter Cashback:""
| p27_req_max_input_length | 40          |
| p27_req_prompt_index     | 016         |
#And I wait until Element ""btn_cancel"" visible
| p27_req_display_char     | 0           |
And I wait until Element ""line_display"" visible
| p27_req_form_specificid  | input_alpha |
When I send a 27.x Alpha Input message to the terminal with params:
And I Wait until Element ""title"" contains ""Welcome""
| p27_req_min_input_length | 00          |",Unknown
"And I click Element ""input_box""",Unknown
"And I click Element ""input_box""",Unknown
"| p27_res_exit_type  | 0             |
Then I should receive the 27.x Alpha Input response from terminal with params:
And I send keys to Element ""input_box"" text ""ISAT-v-1.9.66"" and then ENTER
| p27_res_data_input | ISAT-v-1.9.66 |",Unknown
"| p27_res_data_input | ISAT-v-1.9.66 |
Then I should receive the 27.x Alpha Input response from terminal with params:
And I send keys to Element ""input_box"" text ""ISAT-v-1.9.66"" and then ENTER
| p27_res_exit_type  | 0             |",Unknown
"| p87_req_enabled_devices | M          |
| p87_req_prompt_index    | 3          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_form_name       | read_cards |",Unknown
"| p87_req_prompt_index    | 3          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_enabled_devices | M          |
| p87_req_form_name       | read_cards |",Unknown
"And I wait until Element ""line_display"" visible
And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible",Unknown
"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"| track3_data | <additional_data><additional_data>           |
Then I should receive the 87.x Card Read response from terminal with params:
| p87_res_exit_type   | 0                                            |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code>.*$ |
| p87_res_card_source | M                                            |
When I swipe card using this params:
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |",Unknown
"| p87_res_card_source | M                                            |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p87_res_exit_type   | 0                                            |
| track3_data | <additional_data><additional_data>           |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code>.*$ |
When I swipe card using this params:
Then I should receive the 87.x Card Read response from terminal with params:
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |",Unknown
"Then I should receive in '30' seconds the 31.x Pin Entry response from terminal with params:
| p31_req_set_encryption_configuration | 0     |
| p31_res_status         | 0          |
| p31_req_prompt_index_number          | 1     |
| p31_req_set_key_type                 | D     |
| p31_res_pin_data       | @regexp:.* |
And I enter pin ""1234""
| p31_req_form_name                    |       |
When I send a 31.x Pin Entry message to the terminal with params:
| p31_req_customer_acc_num             | <pan> |
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |",CVM Process
"And I enter pin ""1234""
When I send a 31.x Pin Entry message to the terminal with params:
| p31_req_prompt_index_number          | 1     |
| p31_res_pin_data_block | @regexp:.* |
| p31_req_set_encryption_configuration | 0     |
Then I should receive in '30' seconds the 31.x Pin Entry response from terminal with params:
| p31_res_pin_data       | @regexp:.* |
| p31_req_set_key_type                 | D     |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_form_name                    |       |
| p31_req_customer_acc_num             | <pan> |
| p31_res_status         | 0          |",CVM Process
"| p24_res_exit_type | 0    |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_form_number | activity_main |
| p24_res_keyid     | \x1F |
When I send a 24.x Form Entry message to the terminal with params:",Display Confirmation
"Then I should receive the 24.x Form Entry response from terminal with params:
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
| p24_res_keyid     | \x1F |
| p24_res_exit_type | 0    |",Display Confirmation
"| p21_req_prompt_index        | <prompt_index> |
| p21_req_min_input_length    | <min_input>    |
| p21_req_form_specific_index | input_numeric  |
| p21_req_max_input_length    | <max_input>    |
| p21_req_display_char        | 0              |
When I send a 21.x Numeric Input message to the terminal with:
And I Wait until Element ""title"" contains ""Welcome!""",Unknown
"| p21_req_prompt_index        | <prompt_index> |
When I send a 21.x Numeric Input message to the terminal with:
| p21_req_max_input_length    | <max_input>    |
| p21_req_display_char        | 0              |
And I Wait until Element ""title"" contains ""Welcome!""
| p21_req_form_specific_index | input_numeric  |
| p21_req_min_input_length    | <min_input>    |",Unknown
"| po87_req_options        |            |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_form_name       | read_cards |
| p87_req_prompt_index    | 3          |
| p87_req_enabled_devices | M          |",Unknown
"| po87_req_options        |            |
| p87_req_prompt_index    | 3          |
| p87_req_enabled_devices | M          |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_form_name       | read_cards |",Unknown
"| p21_res_input_data |   |
| p21_res_exit_type  | a |
And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible
Then I should receive the 21.x Numeric Input response from terminal with params:",Unknown
"Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | a |
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I Wait until Element ""title"" contains ""Please slide card""
| p21_res_input_data |   |",Unknown
"| p24_res_keyid     | \x1F |
When I send a 24.x Form Entry message to the terminal with params:
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_form_number | activity_main |
| p24_res_exit_type | 0    |",Display Confirmation
"Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |
| p24_req_form_number | activity_main |
When I send a 24.x Form Entry message to the terminal with params:",Display Confirmation
"#And I wait until Element ""btn_cancel"" visible
| p27_req_form_specificid  | input_alpha |
| p27_req_min_input_length | 00          |
And I Wait until Element ""title"" contains ""Welcome!""
| p27_req_prompt_index     | 206         |
| p27_req_max_input_length | 40          |
When I send a 27.x Alpha Input message to the terminal with params:
| p27_req_display_char     | 0           |",Unknown
"| p27_req_form_specificid  | input_alpha |
| p27_req_min_input_length | 00          |
#And I wait until Element ""btn_cancel"" visible
| p27_req_prompt_index     | 206         |
| p27_req_display_char     | 0           |
When I send a 27.x Alpha Input message to the terminal with params:
| p27_req_max_input_length | 40          |
And I Wait until Element ""title"" contains ""Welcome!""",Unknown
"| p87_req_enabled_devices | M          |
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:",Unknown
"| p87_req_enabled_devices | M          |
| p87_req_form_name       | read_cards |
When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |",Unknown
"And I wait until Element ""btn_cancel"" visible
| p27_res_exit_type  | a |
| p27_res_data_input |   |
And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""line_display"" visible
Then I should receive the 27.x Alpha Input response from terminal with params:",Unknown
"| p27_res_data_input |   |
Then I should receive the 27.x Alpha Input response from terminal with params:
And I Wait until Element ""title"" contains ""Please slide card""
| p27_res_exit_type  | a |
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible",Unknown
"| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible",Precondition
"| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 00.x Offline message to the terminal with params:",Precondition
"| p87_res_card_data   | \x1C\x1C |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_card_source | ?        |
| p87_res_exit_type   | a        |",Unknown
"Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_card_source | ?        |
| p87_res_card_data   | \x1C\x1C |
| p87_res_exit_type   | a        |",Unknown
"| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000                                                                             | 0000070400100  |                      | 01        | 40        | 001          | 558555     | Enter home phone number |
| p00_res_reason_code | 0000 |
And I should receive the 00.x Offline response from terminal with params:
Feature:  Validate  pin block decryption is correct when TEP7 enabled
Examples:
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                                                                                            | 1000041300000  |                      | 01        | 40        | 001          | 88855588   | Enter home phone number |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                                                                                             | disc_data_t2   | additional_data      | min_input | max_input | prompt_index | input_data | title                   |
Scenario: Enable Voltage TEP7 Encryption Configuration
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with:
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946                                                                                     | 1000041300000  | 01234567890123456789 | 01        | 40        | 001          | 74158552   | Enter home phone number |
""""""
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
This feature file verify pin block decryption is correct when TEP7 enabled
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                                                                                                | 15041234500000 |                      | 01        | 20        | 001          | 77457777   | Enter home phone number |
| p00_res_reason_code | 0000 |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000\u001c5413339000000119=24122210000014000001\u001c0123456789012345678901234567890123456789 | 0000014000001  | 01234567890123456789 | 01        | 10        | 001          | 6724240113 | Enter home phone number |
""""""
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
@pin_code @master_session @tep7 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Precondition
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
Examples:
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000                                                                             | 0000070400100  |                      | 01        | 40        | 001          | 558555     | Enter home phone number |
Feature:  Validate  pin block decryption is correct when TEP7 enabled
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                                                                                                | 15041234500000 |                      | 01        | 20        | 001          | 77457777   | Enter home phone number |
""""""
""""""
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000\u001c5413339000000119=24122210000014000001\u001c0123456789012345678901234567890123456789 | 0000014000001  | 01234567890123456789 | 01        | 10        | 001          | 6724240113 | Enter home phone number |
| p00_res_reason_code | 0000 |
This feature file verify pin block decryption is correct when TEP7 enabled
Scenario: Enable Voltage TEP7 Encryption Configuration
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946                                                                                     | 1000041300000  | 01234567890123456789 | 01        | 40        | 001          | 74158552   | Enter home phone number |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                                                                                            | 1000041300000  |                      | 01        | 40        | 001          | 88855588   | Enter home phone number |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                                                                                             | disc_data_t2   | additional_data      | min_input | max_input | prompt_index | input_data | title                   |
@pin_code @master_session @tep7 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
And I should receive the 00.x Offline response from terminal with params:",Precondition
"| p61_res_status                | 2  |
| p90_res_status   | 0          |
| p62_res_file_length | @regexp:.\d* |
And I should receive the 62.x File Write response from terminal with params:
| p62_res_status      | 0            |
Scenario Outline: verify pin block decryption is correct with masked pan
| p90_res_function | 0          |
| p90_res_etb      | @regexp:.* |
| p62_req_encoding_format | B                             |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_data_config_parameter | 32 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p62_req_unpack_flag     | 0                             |
| p90_req_function | 0 |
When I send a 90.x MSR Encryption message to the terminal with:
| p61_req_index_num | 1  |
| p62_req_file_name       | voltage_32_default-signed.apk |
When I have successfully sent ""Files/p2p_encryptions/voltage_32_default-signed.apk"" file using these params:
| p61_res_index_num             | 1  |
| p62_req_fast_download   | 1                             |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:",Unknown
"When I have successfully sent ""Files/p2p_encryptions/voltage_32_default-signed.apk"" file using these params:
| p61_res_index_num             | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0                             |
| p61_req_index_num | 1  |
When I send a 90.x MSR Encryption message to the terminal with:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p62_res_status      | 0            |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p90_res_function | 0          |
| p61_req_group_num | 91 |
| p62_req_fast_download   | 1                             |
| p62_res_file_length | @regexp:.\d* |
Scenario Outline: verify pin block decryption is correct with masked pan
| p62_req_encoding_format | B                             |
| p62_req_file_name       | voltage_32_default-signed.apk |
And I should receive the 62.x File Write response from terminal with params:
| p61_res_data_config_parameter | 32 |
| p90_req_function | 0 |
| p90_res_etb      | @regexp:.* |
| p90_res_status   | 0          |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
When I send a 61.x Read Configuration message to the terminal with:
Given I send a 00.x Offline message to the terminal with params:
| p61_res_group_num             | 91 |
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 32 |
And I wait until Element ""imageOffline"" visible
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_group_num | 91 |
| p00_res_reason_code | 0000 |",Precondition
"| p61_res_data_config_parameter | 32 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_req_reason_code | 0000 |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p00_res_reason_code | 0000 |
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
Given I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible",Precondition
"| p23_req_enable_devices | M |
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"And  I wait until Element ""btn_cancel"" visible
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"When Axium swipe magnetic card:
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_card_source | M          |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | @regexp:.* |
| p23_res_exit_type   | 0          |
| track3 | <additional_data><additional_data>           |
| p23_res_track2      | @regexp:.* |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | @regexp:.* |",Card Swipe
"| track3 | <additional_data><additional_data>           |
When Axium swipe magnetic card:
| p23_res_exit_type   | 0          |
Then I should receive the 23.x Card Read response from terminal with params:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"| p29_req_variable_id | 000398 |
| p29_res_variable_data | @regexp:.* |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000398     |
| p29_res_status        | 2          |",Extract Card Data
"| p29_res_variable_data | @regexp:.* |
| p29_res_variable_id   | 000398     |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_req_variable_id | 000398 |
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
"| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_prompt_index_number          | 1                                                |
| p31_req_set_key_type                 | *                                                |
| p31_res_status         | 0          |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_form_name                    |                                                  |
| p31_res_pin_data_ksn   | @regexp:.* |
When I send a 31.x PIN Entry message to the terminal with:
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data       | @regexp:.* |",CVM Process
"| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_prompt_index_number          | 1                                                |
| p31_req_set_key_type                 | *                                                |
And I enter pin ""<pin_code>""
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
Then I should receive the 31.x PIN Entry response from terminal with params:
When I send a 31.x PIN Entry message to the terminal with:
| p31_res_status         | 0          |
| p31_req_form_name                    |                                                  |
| p31_res_pin_data_block | @regexp:.* |",CVM Process
"| pin_code | <pin_code>                    |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 4321     | 4          | ffffffffff |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| tail     | <tail>                        |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
Examples:
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 552211   | 6          | ffffffff   |
Scenario: Teardown - Reset to Default State
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| VISA       | 4264510228321      | JOHN/COW           | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 55221100 | 8          | ffffff     |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| pinblock | 0<pin_length><pin_code><tail> |
| length   | <pin_length>                  |",Unknown
"| pinblock | 0<pin_length><pin_code><tail> |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/COW           | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 55221100 | 8          | ffffff     |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
Examples:
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 552211   | 6          | ffffffff   |
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
Scenario: Teardown - Reset to Default State
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| length   | <pin_length>                  |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 4321     | 4          | ffffffffff |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p61_res_status                | 2  |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p61_req_group_num | 91 |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_group_num             | 91 |
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_req_index_num | 1  |
| p62_req_unpack_flag     | 0                   |
| p61_res_index_num             | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_res_status      | 0          |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_data_config_parameter | 0  |
| p62_res_file_length | @regexp:.* |
Then I should receive the 61.x Configuration Read response from terminal with params:",Unknown
"| p62_req_unpack_flag     | 0                   |
| p61_res_index_num             | 1  |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_fast_download   | 1                   |
| p61_req_index_num | 1  |
| p61_req_group_num | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 0  |
| p61_res_group_num             | 91 |
| p62_res_status      | 0          |
| p62_req_encoding_format | B                   |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_status                | 2  |
| p62_res_file_length | @regexp:.* |",Unknown
"- The number of keys entered is more than four.
- is not a weak PIN. The PIN is considered weak if:
- The application validates the PIN according to the following rules:
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
| p00_req_reason_code | 0000 |
################## enable pin change support ###########################
- The second entered PIN:
""""""
- All digits in the PIN are the same (e.g., 4444, 3333)
- The first entered PIN does not match the second entered PIN.
Scenario Outline: Perform MSR transaction and enter an invalid PIN change where the cardholder types the second entered PIN with 12 digits
- The third entered PIN matches the second entered PIN.
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
Feature: validate invalid PIN change where the cardholder types the second entered PIN with 12 digits
- The number of keys entered does not exceed 12.
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
- The application validates the PIN according to the following rules:
And I Wait until Element ""title"" contains ""This Lane Closed""
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1390
Then I should receive the 00.x Offline response from terminal with params:
""""""",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
- The number of keys entered does not exceed 12.
Scenario Outline: Perform MSR transaction and enter an invalid PIN change where the cardholder types the second entered PIN with 12 digits
- is not a weak PIN. The PIN is considered weak if:
""""""
- The application validates the PIN according to the following rules:
- The application validates the PIN according to the following rules:
@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
- The third entered PIN matches the second entered PIN.
- The number of keys entered is more than four.
| p00_req_reason_code | 0000 |
- All digits in the PIN are the same (e.g., 4444, 3333)
| p00_res_reason_code | 0000 |
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The second entered PIN:
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1390
################## enable pin change support ###########################
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
Given I send a 00.x Offline message to the terminal with params:
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
Feature: validate invalid PIN change where the cardholder types the second entered PIN with 12 digits
- The first entered PIN does not match the second entered PIN.
""""""",Precondition
"| p28_res_variable_id | 000920 |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
| p28_req_response_type | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
When I send a 28.x Set Variable message to the terminal with:",Unknown
"| p28_req_variable_id   | 000920 |
When I send a 28.x Set Variable message to the terminal with:
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_req_variable_data | 1      |
| p28_res_variable_id | 000920 |
| p28_req_response_type | 1      |",Unknown
"| p29_req_variable_id | 00000920 |
| p29_res_variable_id   | 000920 |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | true   |",Extract Card Data
"| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 00000920 |
| p29_res_status        | 2      |",Extract Card Data
"################## swipe card ###########################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################",Unknown
"| p23_req_enable_devices | M          |
When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |
| p23_req_prompt_index   | 311        |
And I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"| p23_req_form_name      | read_cards |
When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_prompt_index   | 311        |",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"| p23_res_card_source | M                                            |
| p23_res_exit_type   | 0                                            |
| track3 | <additional_data><additional_data>           |
And Axium swipe magnetic card:
| p23_res_track3      | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"| p23_res_exit_type   | 0                                            |
And Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p31_req_set_encryption_configuration | 0  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>""
| p31_req_customer_acc_num             |    |
| p31_req_set_key_type                 | D  |
| p31_req_prompt_index_number          | 14 |
When I send a 31.x PIN Entry message to the terminal with:",CVM Process
"| p31_req_form_name                    |    |
| p31_req_customer_acc_num             |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>""
| p31_req_set_key_type                 | D  |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_set_encryption_configuration | 0  |",CVM Process
"#################enter 12 digits pin pin################################
And I wait for 5 seconds",Unknown
"#################enter 12 digits pin pin################################
And I wait for 5 seconds",Unknown
"And I enter pin ""<second_pin>""",Unknown
"And I enter pin ""<second_pin>""",Unknown
"And I wait for 12 seconds
####### 31.x should return A because the 2nd pin entry is 12 digits length################### #######################",CVM Process
"####### 31.x should return A because the 2nd pin entry is 12 digits length################### #######################
And I wait for 12 seconds",CVM Process
"############## variable keeps the value true since pin is not sucessfully changed ##########################
| p31_res_status   | A |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data |   |",CVM Process
"| p31_res_status   | A |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################",CVM Process
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | second_pin   |
Then I should receive the 29.x Get Variable response from terminal with params:
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 112277221125 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 998811258914 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 698630167113 |
| p29_res_status        | 2      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 502630167012 |
Examples:
| p29_res_variable_data | true   |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4321     | 114453322716 |
| p29_res_variable_id   | 000920 |",Extract Card Data
"Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 00000920 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 698630167113 |
When I send a 29.x Get Variable message to the terminal with:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | second_pin   |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 112277221125 |
| p29_res_status        | 2      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 502630167012 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 998811258914 |
Examples:
| p29_res_variable_data | true   |
| p29_res_variable_id   | 000920 |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4321     | 114453322716 |",Extract Card Data
"@pin_code @master_session @rsa @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
This feature file verify pin block decryption is correct when RSA enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable RSA Encryption Configuration
Then I should receive the 00.x Offline response from terminal with params:
Feature:  Validate  pin block decryption is correct when RSA enabled
""""""
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
Then I should receive the 00.x Offline response from terminal with params:
This feature file verify pin block decryption is correct when RSA enabled
""""""
Scenario: Enable RSA Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
Feature:  Validate  pin block decryption is correct when RSA enabled
""""""
@pin_code @master_session @rsa @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Precondition
"| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
| p62_req_file_name       | ArcRSA-OAEP.apk |
Scenario Outline: verify pin block decryption is correct with masked pan
| p62_req_unpack_flag     | 0               |
| p61_res_group_num             | 91 |
| p62_req_encoding_format | B               |
Then I should receive the 62.x Write File response from terminal with params:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 9  |
When I have successfully sent ""Files/p2p_encryptions/ArcRSA-OAEP.apk"" file using these params:
| p62_req_fast_download   | 1               |
Then I should receive the 61.x Configuration Read response from terminal with params:",Unknown
"Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_fast_download   | 1               |
| p62_req_encoding_format | B               |
Scenario Outline: verify pin block decryption is correct with masked pan
| p62_req_file_name       | ArcRSA-OAEP.apk |
Then I should receive the 62.x Write File response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0               |
| p61_res_data_config_parameter | 9  |
| p61_req_group_num | 91 |
When I have successfully sent ""Files/p2p_encryptions/ArcRSA-OAEP.apk"" file using these params:
| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
| p62_res_file_length | @regexp:\d* |
| p62_res_status      | 0           |",Unknown
"| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
When I send a 61.x Read Configuration message to the terminal with:
| p00_req_reason_code | 0000 |
| p61_req_group_num | 91 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 9  |
| p61_res_group_num             | 91 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p61_res_status                | 2  |
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
And I wait until Element ""imageOffline"" visible
| p61_res_data_config_parameter | 9  |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
When I send a 61.x Read Configuration message to the terminal with:",Precondition
"And  I wait until Element ""btn_cancel"" visible
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |",Card Swipe
"And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |",Card Swipe
"| track3 |                                              |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                                            |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
When Axium swipe magnetic card:
| p23_res_exit_type   | 0                                                            |",Card Swipe
"| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_exit_type   | 0                                                            |
Then I should receive the 23.x Card Read response from terminal with params:
| track3 |                                              |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_card_source | M                                                            |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
When Axium swipe magnetic card:
| p23_res_track3      | @regexp:.+                                                   |",Card Swipe
"Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_set_key_type                 | *            |
| p31_req_set_encryption_configuration | 0            |
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data       | @regexp:.* |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_form_name                    |              |
| p31_req_prompt_index_number          | 1            |
| p31_res_status         | 0          |
When I send a 31.x PIN Entry message to the terminal with:
And I enter pin ""<pin_code>""",CVM Process
"| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_set_encryption_configuration | 0            |
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data       | @regexp:.* |
And I enter pin ""<pin_code>""
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_form_name                    |              |
| p31_res_status         | 0          |
When I send a 31.x PIN Entry message to the terminal with:
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_set_key_type                 | *            |
| p31_req_prompt_index_number          | 1            |",CVM Process
"| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| pinblock | 0<pin_length><pin_code><tail> |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |
| length   | <pin_length>                  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
Scenario: Teardown - Reset to Default State
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| pin_code | <pin_code>                    |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
Examples:
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| tail     | <tail>                        |",Unknown
"Examples:
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| pin_code | <pin_code>                    |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| tail     | <tail>                        |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| pinblock | 0<pin_length><pin_code><tail> |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
Scenario: Teardown - Reset to Default State
| length   | <pin_length>                  |",Unknown
"| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_fast_download   | 1                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_res_status      | 0          |
| p61_req_group_num | 91 |
| p62_req_encoding_format | B                   |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 0  |
| p62_req_unpack_flag     | 0                   |
| p61_req_index_num | 1  |",Unknown
"| p61_res_index_num             | 1  |
| p62_res_file_length | @regexp:.* |
| p62_req_fast_download   | 1                   |
| p61_res_status                | 2  |
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 0  |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_unpack_flag     | 0                   |
| p62_req_encoding_format | B                   |
| p61_res_group_num             | 91 |
| p62_res_status      | 0          |
Then I should receive the 62.x Write File response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |",Unknown
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
""""""
@pin_code @master_session @chapter_x @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Enable chapterX Encryption Configuration
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Feature:  Validate  pin block decryption is correct when chapter X enabled
This feature file verify pin block decryption is correct when chapter X enabled",Precondition
"""""""
""""""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
@pin_code @master_session @chapter_x @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Enable chapterX Encryption Configuration
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
This feature file verify pin block decryption is correct when chapter X enabled
Feature:  Validate  pin block decryption is correct when chapter X enabled
And I Wait until Element ""title"" contains ""This Lane Closed""
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772",Precondition
"| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
| p61_req_index_num | 1  |
| p62_req_fast_download   | 1                    |
When I send a 90.x MSR Encryption message to the terminal with:
| p62_req_encoding_format | B                    |
Then I should receive the 62.x Write File response from terminal with params:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 30 |
Scenario Outline: verify pin block decryption is correct with masked pan
| p90_res_function | 0          |
| p62_res_file_length | @regexp:.\d* |
| p62_res_status      | 0            |
| p61_res_group_num             | 91 |
| p90_req_function | 0 |
| p62_req_file_name       | ArcSec_chapter_X.apk |
| p62_req_unpack_flag     | 0                    |
When I have successfully sent ""Files/p2p_encryptions/ArcSec_chapter_X.apk"" file using these params:
Then I should receive the 90.x MSR Encryption response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |",Unknown
"Then I should receive the 90.x MSR Encryption response from terminal with params:
When I send a 90.x MSR Encryption message to the terminal with:
| p62_res_status      | 0            |
| p61_req_group_num | 91 |
| p90_req_function | 0 |
| p61_req_index_num | 1  |
| p62_res_file_length | @regexp:.\d* |
| p90_res_status   | 0          |
| p62_req_file_name       | ArcSec_chapter_X.apk |
Scenario Outline: verify pin block decryption is correct with masked pan
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_group_num             | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p90_res_function | 0          |
When I have successfully sent ""Files/p2p_encryptions/ArcSec_chapter_X.apk"" file using these params:
| p61_res_data_config_parameter | 30 |
| p90_res_etb      | @regexp:.* |
| p62_req_fast_download   | 1                    |
| p62_req_encoding_format | B                    |
| p61_res_index_num             | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0                    |",Unknown
"| p61_res_group_num             | 91 |
| p61_req_index_num | 1  |
| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_req_group_num | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_data_config_parameter | 30 |
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
When I send a 61.x Read Configuration message to the terminal with:",Precondition
"Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_group_num | 91 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 30 |
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p61_res_status                | 2  |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
| p61_req_index_num | 1  |",Precondition
"| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |",Card Swipe
"When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""",Card Swipe
"| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
When Axium swipe magnetic card:
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| track3 |                                              |
When Axium swipe magnetic card:
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_exit_type   | 0                                                            |",Card Swipe
"| p31_req_customer_acc_num             | <masked_pan> |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data       | @regexp:.* |
| p31_req_set_encryption_configuration | 0            |
| p31_req_prompt_index_number          | 1            |
| p31_res_pin_data_block | @regexp:.* |
And I enter pin ""<pin_code>""
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_key_type                 | *            |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_form_name                    |              |
| p31_res_status         | 0          |",CVM Process
"Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data_block | @regexp:.* |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_set_encryption_configuration | 0            |
And I enter pin ""<pin_code>""
| p31_req_prompt_index_number          | 1            |
| p31_req_form_name                    |              |
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_key_type                 | *            |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data       | @regexp:.* |
| p31_res_status         | 0          |",CVM Process
"Scenario: Teardown - Reset to Default State
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
Examples:
| pinblock | 0<pin_length><pin_code><tail> |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 2211001  | 7          | fffffff    |
| pin_code | <pin_code>                    |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| length   | <pin_length>                  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 12341234 | 8          | ffffff     |
| tail     | <tail>                        |",Unknown
"| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| pinblock | 0<pin_length><pin_code><tail> |
| tail     | <tail>                        |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 12341234 | 8          | ffffff     |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| length   | <pin_length>                  |
Scenario: Teardown - Reset to Default State
| pin_code | <pin_code>                    |
Examples:
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 2211001  | 7          | fffffff    |",Unknown
"| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"| p61_req_group_num | 91 |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_data_config_parameter | 0  |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_group_num             | 91 |
| p62_res_status      | 0          |
| p61_req_index_num | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_fast_download   | 1                   |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p62_req_encoding_format | B                   |
| p62_res_file_length | @regexp:.* |
| p62_req_unpack_flag     | 0                   |
| p61_res_index_num             | 1  |
| p62_req_file_name       | ArcNoEncryption.apk |",Unknown
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_unpack_flag     | 0                   |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_group_num             | 91 |
| p62_res_file_length | @regexp:.* |
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_index_num             | 1  |
| p62_req_fast_download   | 1                   |
| p61_res_data_config_parameter | 0  |
| p61_req_index_num | 1  |
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_res_status      | 0          |
| p62_req_encoding_format | B                   |",Unknown
"Feature: 23.x Card Read Request Swipe one track
Scenario Outline: Send 23.x Card Read Request swipe first track
@23x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Card Swipe
"Scenario Outline: Send 23.x Card Read Request swipe first track
Feature: 23.x Card Read Request Swipe one track
@23x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Card Swipe
"Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Given I send a 00.x Offline message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M  |
| p23_req_prompt_index   | 03 |",Card Swipe
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M  |
| p23_req_prompt_index   | 03 |",Card Swipe
"And I wait for 1 second
And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait for 1 second
And I wait until Element ""btn_cancel"" visible
And I Wait until Element ""title"" contains ""Please slide card""",Unknown
"| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| loyalty cards | 62211933327452      | PZNLQXRGCDILK/TDDZHWEUCTJ  | 2009     | 680  | 9497511743      | 1743         |
| p23_res_track3      | @regexp:.*                                   |
| Discover 1    | 62217984210356      | LYUATZMDAU/ABKBXTDWTDZJPHY | 2008     | 305  | 937343886685    | 886685       |
| card_type     | pan                 | name                       | exp_date | code | disc_data_t1    | disc_data_t2 |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| VISA          | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC  | 2011     | 885  | 131026823693372 | 823693372    |
| MasterCard    | 45358179327829      | EKRLOFKPUUTQURT/ALMPWTZUL  | 2007     | 707  | 122560965000469 | 965000469    |
| AMEX 2        | 700199380329310926  | TPZRJLK/NKTUBHJNNWZI       | 2005     | 807  | 3121187689      | 7689         |
| Discover 3    | 656147069906747     | ICVLSVZXZM/RLBOT           | 2011     | 596  | 11020664082766  | 64082766     |
| track2 |                                              |
| Discover 4    | 521781446878188     | MCOZPS/FTYJMUOLLBYS        | 2006     | 651  | 95135762802916  | 62802916     |
Examples:
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| Discover 2    | 648682809137410     | YHQJOKMYVWVNLRP/RHWSDMBOER | 2009     | 418  | 7254640409      | 0409         |
| p23_res_track2      | @regexp:.*                                   |
When Axium swipe magnetic card:
| AMEX 1        | 37158413190797      | YYBROXFQJRXJW/EVXOV        | 2001     | 442  | 57431313685     | 13685        |
| p23_res_card_source | M                                            |
Scenario Outline: Send 23.x Card Read Request swipe second track
| track3 |                                              |
| other cards   | 2830654628589795710 | XSYWIV/LHJPNU              | 2008     | 770  | 29814983505     | 83505        |",Card Swipe
"| AMEX 2        | 700199380329310926  | TPZRJLK/NKTUBHJNNWZI       | 2005     | 807  | 3121187689      | 7689         |
| Discover 1    | 62217984210356      | LYUATZMDAU/ABKBXTDWTDZJPHY | 2008     | 305  | 937343886685    | 886685       |
| AMEX 1        | 37158413190797      | YYBROXFQJRXJW/EVXOV        | 2001     | 442  | 57431313685     | 13685        |
| p23_res_exit_type   | 0                                            |
| track2 |                                              |
| VISA          | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC  | 2011     | 885  | 131026823693372 | 823693372    |
Scenario Outline: Send 23.x Card Read Request swipe second track
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| Discover 3    | 656147069906747     | ICVLSVZXZM/RLBOT           | 2011     | 596  | 11020664082766  | 64082766     |
| loyalty cards | 62211933327452      | PZNLQXRGCDILK/TDDZHWEUCTJ  | 2009     | 680  | 9497511743      | 1743         |
When Axium swipe magnetic card:
| p23_res_card_source | M                                            |
| track3 |                                              |
| Discover 2    | 648682809137410     | YHQJOKMYVWVNLRP/RHWSDMBOER | 2009     | 418  | 7254640409      | 0409         |
| p23_res_track3      | @regexp:.*                                   |
| card_type     | pan                 | name                       | exp_date | code | disc_data_t1    | disc_data_t2 |
| Discover 4    | 521781446878188     | MCOZPS/FTYJMUOLLBYS        | 2006     | 651  | 95135762802916  | 62802916     |
Then I should receive the 23.x Read Card response from terminal with params:
Examples:
| MasterCard    | 45358179327829      | EKRLOFKPUUTQURT/ALMPWTZUL  | 2007     | 707  | 122560965000469 | 965000469    |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| other cards   | 2830654628589795710 | XSYWIV/LHJPNU              | 2008     | 770  | 29814983505     | 83505        |
| p23_res_track2      | @regexp:.*                                   |",Card Swipe
"Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p23_req_prompt_index   | 03 |
When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M  |",Card Swipe
"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M  |
| p23_req_prompt_index   | 03 |",Card Swipe
"Then I wait until Element ""btn_cancel"" visible
And I Wait until Element ""title"" contains ""Please slide card""
And I wait for 1 second",Unknown
"And I Wait until Element ""title"" contains ""Please slide card""
Then I wait until Element ""btn_cancel"" visible
And I wait for 1 second",Unknown
"| track2 | <pan>=<exp_date><code><disc_data_t2> |
When Axium swipe magnetic card:
| track3 |                                      |
| track1 |                                      |",Unknown
"| track1 |                                      |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
When Axium swipe magnetic card:
| track3 |                                      |",Unknown
"| p23_res_track1      | @regexp:.*                           |
| p23_res_card_source | M                                    |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2> |
| p23_res_exit_type   | 0                                    |
| p23_res_track3      | @regexp:.*                           |",Card Swipe
"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track3      | @regexp:.*                           |
| p23_res_track1      | @regexp:.*                           |
| p23_res_card_source | M                                    |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2> |
| p23_res_exit_type   | 0                                    |",Card Swipe
"| p00_res_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with:
| VISA          | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC  | 2011     | 885  | 131026823693372 | 823693372    |
Then I should receive the 00.x Offline response from terminal with params:
| Discover 2    | 648682809137410     | YHQJOKMYVWVNLRP/RHWSDMBOER | 2009     | 418  | 7254640409      | 0409         |
| loyalty cards | 62211933327452      | PZNLQXRGCDILK/TDDZHWEUCTJ  | 2009     | 680  | 9497511743      | 1743         |
| Discover 4    | 521781446878188     | MCOZPS/FTYJMUOLLBYS        | 2006     | 651  | 95135762802916  | 62802916     |
Examples:
| Discover 1    | 62217984210356      | LYUATZMDAU/ABKBXTDWTDZJPHY | 2008     | 305  | 937343886685    | 886685       |
| MasterCard    | 45358179327829      | EKRLOFKPUUTQURT/ALMPWTZUL  | 2007     | 707  | 122560965000469 | 965000469    |
| Discover 3    | 656147069906747     | ICVLSVZXZM/RLBOT           | 2011     | 596  | 11020664082766  | 64082766     |
| card_type     | pan                 | name                       | exp_date | code | disc_data_t1    | disc_data_t2 |
| AMEX 1        | 37158413190797      | YYBROXFQJRXJW/EVXOV        | 2001     | 442  | 57431313685     | 13685        |
| AMEX 2        | 700199380329310926  | TPZRJLK/NKTUBHJNNWZI       | 2005     | 807  | 3121187689      | 7689         |
| p00_req_reason_code | 0000 |
| other cards   | 2830654628589795710 | XSYWIV/LHJPNU              | 2008     | 770  | 29814983505     | 83505        |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Examples:
| MasterCard    | 45358179327829      | EKRLOFKPUUTQURT/ALMPWTZUL  | 2007     | 707  | 122560965000469 | 965000469    |
| p00_res_reason_code | 0000 |
| Discover 1    | 62217984210356      | LYUATZMDAU/ABKBXTDWTDZJPHY | 2008     | 305  | 937343886685    | 886685       |
| AMEX 2        | 700199380329310926  | TPZRJLK/NKTUBHJNNWZI       | 2005     | 807  | 3121187689      | 7689         |
| AMEX 1        | 37158413190797      | YYBROXFQJRXJW/EVXOV        | 2001     | 442  | 57431313685     | 13685        |
| loyalty cards | 62211933327452      | PZNLQXRGCDILK/TDDZHWEUCTJ  | 2009     | 680  | 9497511743      | 1743         |
| card_type     | pan                 | name                       | exp_date | code | disc_data_t1    | disc_data_t2 |
| Discover 2    | 648682809137410     | YHQJOKMYVWVNLRP/RHWSDMBOER | 2009     | 418  | 7254640409      | 0409         |
| VISA          | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC  | 2011     | 885  | 131026823693372 | 823693372    |
| other cards   | 2830654628589795710 | XSYWIV/LHJPNU              | 2008     | 770  | 29814983505     | 83505        |
| Discover 4    | 521781446878188     | MCOZPS/FTYJMUOLLBYS        | 2006     | 651  | 95135762802916  | 62802916     |
When I send a 00.x Offline message to the terminal with:
| Discover 3    | 656147069906747     | ICVLSVZXZM/RLBOT           | 2011     | 596  | 11020664082766  | 64082766     |",Precondition
"Scenario Outline: Check MSR flow while using Non-Standard cards with two tracks(track1 ,track2)
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1207
This feature file Validates MSR transaction For Non Standard Card using 23.x Card Read Request
@23x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Swipe non standard cards
""""""
""""""",Card Swipe
"""""""
@23x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario Outline: Check MSR flow while using Non-Standard cards with two tracks(track1 ,track2)
This feature file Validates MSR transaction For Non Standard Card using 23.x Card Read Request
""""""
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1207
Feature: Swipe non standard cards",Card Swipe
"| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |",Precondition
"And I wait for 1 second
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_form_name      | read_cards |
| p23_req_prompt_index   | 3          |
And I wait until Element ""btn_cancel"" visible
| p23_req_enable_devices | M          |
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_form_name      | read_cards |
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second
| p23_req_prompt_index   | 3          |
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M          |",Card Swipe
"| p23_res_exit_type   | 0            |
| track2_data | <track2_data> |
| p23_res_track1      | <track1_res> |
| p23_res_card_source | M            |
| track1_data | <track1_data> |
| p23_res_track3      |              |
Then I should receive the 23.x Card Read response from terminal with params:
| track3_data |               |
When I swipe card using this params:
| p23_res_track2      | <track2_res> |",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| track1_data | <track1_data> |
When I swipe card using this params:
| p23_res_exit_type   | 0            |
| p23_res_track3      |              |
| p23_res_track2      | <track2_res> |
| track2_data | <track2_data> |
| track3_data |               |
| p23_res_track1      | <track1_res> |
| p23_res_card_source | M            |",Card Swipe
"| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| NonStandard card -- FDMS TEST CARD/VISA modified without exp-dat | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       |
| NonStandard card -- Track 1 and Track 2 pan-only                 | 1234567890123456                                                | 1234567890123456                       | 1234567890123456                                                | 1234567890123456                       |
When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
| NonStandard card -- ISO parser                                   | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       |
| p00_res_reason_code | 0000 |
| type                                                             | track1_data                                                     | track2_data                            | track1_res                                                      | track2_res                             |
Examples:
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |
Scenario Outline: Check MSR flow while using Non-Standard cards with track1 only
| NonStandard card -- Non Payment card                             | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 |",Precondition
"When I send a 00.x Offline message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:
Scenario Outline: Check MSR flow while using Non-Standard cards with track1 only
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| NonStandard card -- Track 1 and Track 2 pan-only                 | 1234567890123456                                                | 1234567890123456                       | 1234567890123456                                                | 1234567890123456                       |
Examples:
| NonStandard card -- Non Payment card                             | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 |
| NonStandard card -- ISO parser                                   | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       |
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
| NonStandard card -- FDMS TEST CARD/VISA modified without exp-dat | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       |
Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |
| type                                                             | track1_data                                                     | track2_data                            | track1_res                                                      | track2_res                             |",Precondition
"| p23_req_prompt_index   | 3          |
And I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait for 1 second
When I send a 23.x Read Card message to the terminal with:
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |",Card Swipe
"And I wait until Element ""btn_cancel"" visible
| p23_req_enable_devices | M          |
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3          |
| p23_req_form_name      | read_cards |
And I wait for 1 second
Then I Wait until Element ""title"" contains ""Please slide card""",Card Swipe
"| track1_data | <track1_data> |
| p23_res_track2      |              |
| p23_res_track3      |              |
Then I should receive the 23.x Card Read response from terminal with params:
| track3_data |               |
| p23_res_card_source | M            |
When I swipe card using this params:
| p23_res_exit_type   | 0            |
| track2_data |               |
| p23_res_track1      | <track1_res> |",Card Swipe
"| p23_res_card_source | M            |
| track1_data | <track1_data> |
When I swipe card using this params:
| p23_res_track2      |              |
| track3_data |               |
| p23_res_track3      |              |
| track2_data |               |
| p23_res_exit_type   | 0            |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track1      | <track1_res> |",Card Swipe
"| NonStandard Card -- Track 1 pan-only | 5413339000000119                    | 5413339000000119                   |
| type                                 | track1_data                         | track1_res                         |
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Scenario Outline: Check MSR flow while using Non-Standard cards with track2 only
Given I send a 00.x Offline message to the terminal with:
When I send a 00.x Offline message to the terminal with:
| NonStandard Card -- Non Payment card | 1006357681?3       1234567890123456 | 10063576813       1234567890123456 |
| p00_res_reason_code | 0000 |
| NonStandard Card -- Track 1 pan-only | 1234567890123456                    | 1234567890123456                   |
| p00_req_reason_code | 0000 |
Examples:",Precondition
"When I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Scenario Outline: Check MSR flow while using Non-Standard cards with track2 only
Examples:
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
| NonStandard Card -- Non Payment card | 1006357681?3       1234567890123456 | 10063576813       1234567890123456 |
| NonStandard Card -- Track 1 pan-only | 1234567890123456                    | 1234567890123456                   |
| NonStandard Card -- Track 1 pan-only | 5413339000000119                    | 5413339000000119                   |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| type                                 | track1_data                         | track1_res                         |",Precondition
"| p23_req_prompt_index   | 3          |
And I wait until Element ""btn_cancel"" visible
| p23_req_form_name      | read_cards |
When I send a 23.x Read Card message to the terminal with:
And I wait for 1 second
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M          |",Card Swipe
"| p23_req_prompt_index   | 3          |
| p23_req_form_name      | read_cards |
And I wait for 1 second
| p23_req_enable_devices | M          |
And I wait until Element ""btn_cancel"" visible
When I send a 23.x Read Card message to the terminal with:
Then I Wait until Element ""title"" contains ""Please slide card""",Card Swipe
"When I swipe card using this params:
| p23_res_track3      |              |
Then I should receive the 23.x Card Read response from terminal with params:
| track1_data |               |
| p23_res_track1      |              |
| p23_res_track2      | <track2_res> |
| p23_res_exit_type   | 0            |
| track3_data |               |
| p23_res_card_source | M            |
| track2_data | <track2_data> |",Card Swipe
"| track2_data | <track2_data> |
| track3_data |               |
| track1_data |               |
| p23_res_track3      |              |
| p23_res_card_source | M            |
Then I should receive the 23.x Card Read response from terminal with params:
When I swipe card using this params:
| p23_res_exit_type   | 0            |
| p23_res_track2      | <track2_res> |
| p23_res_track1      |              |",Card Swipe
"When I send a 00.x Offline message to the terminal with:
| NonStandard Card -- Gift ECR         | 1234567897=251210100000001             | 1234567897=251210100000001             |
| NonStandard Card -- Non Payment card | 0000198800001234560011=2012=0000002008 | 0000198800001234560011=2012=0000002008 |
| p00_res_reason_code | 0000 |
| NonStandard Card -- Track 2 pan-only | B4445222AE299990007                    | B4445222AE299990007                    |
| NonStandard Card -- Track 2 pan-only | 1234567890123456                       | 1234567890123456                       |
Examples:
| type                                 | track2_data                            | track2_res                             |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| type                                 | track2_data                            | track2_res                             |
| NonStandard Card -- Track 2 pan-only | B4445222AE299990007                    | B4445222AE299990007                    |
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with:
| NonStandard Card -- Non Payment card | 0000198800001234560011=2012=0000002008 | 0000198800001234560011=2012=0000002008 |
Examples:
| NonStandard Card -- Track 2 pan-only | 1234567890123456                       | 1234567890123456                       |
| NonStandard Card -- Gift ECR         | 1234567897=251210100000001             | 1234567897=251210100000001             |",Precondition
"@smoke @00x @13x @23x @24x @29x @31x @cashback @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: MSR Debit Cashback with PIN entry transaction with various card brands
Scenario Outline: Perform MSR Debit Cashback with PIN entry Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
""""""
""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-918",Unknown
"""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-918
@smoke @00x @13x @23x @24x @29x @31x @cashback @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: MSR Debit Cashback with PIN entry transaction with various card brands
""""""
Scenario Outline: Perform MSR Debit Cashback with PIN entry Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands",Unknown
"| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p13_req_amount   | <amount>          |
Then I should receive the 13.x amount response from terminal with params:
When I send a 13.x amount message to the terminal with:
| p13_req_cashback | <cashback_amount> |
| p13_res_status | 0 |",Send Amount
"Then I should receive the 13.x amount response from terminal with params:
| p13_req_amount   | <amount>          |
| p13_req_cashback | <cashback_amount> |
| p13_res_status | 0 |
When I send a 13.x amount message to the terminal with:",Send Amount
"| p23_req_form_name      | read_cards |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_prompt_index   | 311        |
| p23_req_enable_devices | M          |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"| p23_req_form_name      | read_cards |
When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_prompt_index   | 311        |",Card Swipe
"And I wait for 1 second
And  I wait until Element ""btn_cancel"" visible",Unknown
"And I wait for 1 second
And  I wait until Element ""btn_cancel"" visible",Unknown
"| p23_res_exit_type   | 0                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                            |
Then I should receive the 23.x Card Read response from terminal with params:
When Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | <additional_data><additional_data>           |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"| p23_res_card_source | M                                            |
Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3 | <additional_data><additional_data>           |
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_exit_type   | 0                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
When Axium swipe magnetic card:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_req_variable_id | 000400 |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <exp_date> |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
| p29_res_variable_id   | 000400     |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000399 |
| p29_res_variable_data | <name> |
| p29_req_variable_id | 000398 |
| p29_res_status        | 2          |",Extract Card Data
"| p29_res_variable_data | <pan>  |
| p29_req_variable_id | 000398 |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <name> |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000399 |
| p29_req_variable_id | 000400 |
| p29_res_status        | 2          |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <exp_date> |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000400     |",Extract Card Data
"| p24_res_keyid        | \x1F     |
| p24_res_button_state | tn_enter |
When I click Element ""btn_enter""
| p24_req_text_element_id | title               |
When I send a 24.x Form Entry message to the terminal with params:
Then I wait until Element ""btn_enter"" visible
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_req_form_number     | confirmation_amount |
When I click Element ""btn_enter""
| p24_req_prompt_idx      | 8                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_type_of_element | T                   |
| p24_res_buttonid     | b        |
| p24_req_type_of_element | T                   |
Then I should receive the 24.x Form Entry response from terminal with params:
Then I wait until Element ""btn_enter"" visible
| p24_res_exit_type    | 0        |
| p24_res_buttonid     | b        |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_text_element_id | title               |
| p24_res_button_state | tn_enter |",Display Confirmation
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_prompt_idx      | 8                   |
| p24_req_form_number     | confirmation_amount |
| p24_res_keyid        | \x1F     |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
| p24_req_form_number     | confirmation_amount |
| p24_res_buttonid     | b        |
When I click Element ""btn_enter""
| p24_res_button_state | tn_enter |
| p24_res_buttonid     | b        |
When I send a 24.x Form Entry message to the terminal with params:
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_prompt_idx      | 10                  |
| p24_res_button_state | tn_enter |
| p24_res_keyid        | \x1F     |
| p24_req_text_element_id | title               |
| p24_res_exit_type    | 0        |
| p24_req_type_of_element | T                   |
| p24_req_type_of_element | T                   |
| p24_res_exit_type    | 0        |
Then I wait until Element ""btn_enter"" visible
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_text_element_id | title               |",Display Confirmation
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p31_req_prompt_index_number          | 3     |
| p31_res_pin_data       | @regexp:.* |
| p31_res_status         | @regexp:.* |
| p31_req_set_encryption_configuration | *     |
| p31_req_set_key_type                 | *     |
| p31_res_pin_data_ksn   | @regexp:.* |
And Axium pinpad enter PIN 1234
| p31_res_status         | 0          |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_customer_acc_num             | <pan> |
| p31_res_pin_data_block | @regexp:.* |
When I send a 31.x PIN Entry message to the terminal with:",CVM Process
"And Axium pinpad enter PIN 1234
When I send a 31.x PIN Entry message to the terminal with:
| p31_res_status         | 0          |
| p31_req_prompt_index_number          | 3     |
| p31_req_customer_acc_num             | <pan> |
| p31_res_pin_data       | @regexp:.* |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_pin_data_block | @regexp:.* |
| p31_res_status         | @regexp:.* |
| p31_req_set_key_type                 | *     |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_req_set_encryption_configuration | *     |",CVM Process
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |",Display Confirmation
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_form_number     | status_title_only |
| p24_req_text_element_id | title             |",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid     | \x1F |
| p24_res_exit_type | 0    |",Display Confirmation
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid     | \x1F |
| p24_res_exit_type | 0    |",Display Confirmation
"| VISA       | 56789  | 2000            | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| Mastercard | 120    | 50              | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| card_type  | amount | cashback_amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
Examples:
| Diners     | 87654  | 4000            | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 987654 | 10000           | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
And I wait for 2 seconds
| Amex       | 1234   | 1000            | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |",Unknown
"| Amex       | 1234   | 1000            | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| Diners     | 87654  | 4000            | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 120    | 50              | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| DISCOVER   | 987654 | 10000           | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| VISA       | 56789  | 2000            | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
Examples:
And I wait for 2 seconds
| card_type  | amount | cashback_amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |",Unknown
"@23x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Send 23.x Card Read Request then simulate swipe
Feature: Cancel 23.x Card Read Request",Card Swipe
"@23x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Send 23.x Card Read Request then simulate swipe
Feature: Cancel 23.x Card Read Request",Card Swipe
"Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p23_req_enable_devices | M          |
And I wait until Element ""btn_cancel"" visible
| p23_req_form_name      | read_cards |
And I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3          |
And I wait for 1 second
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"And I wait until Element ""btn_cancel"" visible
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3          |
And I wait for 1 second
And I Wait until Element ""title"" contains ""Please slide card""
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |",Card Swipe
"| track1 | B62217984210356^LYUATZMDAU/ABKBXTDWTDZJPHY^2008305937343886685 |
And Axium swipe magnetic card:
| track2 | 62217984210356=2008305886685                                   |
| track3 |                                                                |",Unknown
"And Axium swipe magnetic card:
| track1 | B62217984210356^LYUATZMDAU/ABKBXTDWTDZJPHY^2008305937343886685 |
| track3 |                                                                |
| track2 | 62217984210356=2008305886685                                   |",Unknown
"TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-917
""""""
| p23_res_track2      | 62217984210356=2008305886685                                   |
@dx8000 @ex8000 @dx4000
@smoke @msr @00x @13x @23x @20x @29x @24x
| p23_res_card_source | M                                                              |
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
Feature: MSR Credit Signature transaction with various card brands
| p23_res_track3      |                                                                |
| p23_res_track1      | B62217984210356^LYUATZMDAU/ABKBXTDWTDZJPHY^2008305937343886685 |
| p23_res_exit_type   | 0                                                              |
""""""
Then I should receive the 23.x Read Card response from terminal with params:",Card Swipe
"| p23_res_exit_type   | 0                                                              |
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
| p23_res_track1      | B62217984210356^LYUATZMDAU/ABKBXTDWTDZJPHY^2008305937343886685 |
@dx8000 @ex8000 @dx4000
""""""
Feature: MSR Credit Signature transaction with various card brands
@smoke @msr @00x @13x @23x @20x @29x @24x
| p23_res_track2      | 62217984210356=2008305886685                                   |
| p23_res_card_source | M                                                              |
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-917
| p23_res_track3      |                                                                |
Then I should receive the 23.x Read Card response from terminal with params:
""""""",Card Swipe
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:",Precondition
"Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"Then I should receive the 13.x amount response from terminal with params:
| p13_req_amount | <amount> |
When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |",Send Amount
"| p13_req_amount | <amount> |
When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"| p23_req_prompt_index   | 311        |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_enable_devices | M          |
When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |",Card Swipe
"| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |
When I send a 23.x Card Read message to the terminal with:
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_card_source | M                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_exit_type   | 0                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3 | <additional_data><additional_data>           |
When Axium swipe magnetic card:
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track3      | <additional_data><additional_data>           |",Card Swipe
"| p29_res_variable_data | <pan>  |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
| p29_res_variable_data | <exp_date> |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000399 |
| p29_res_variable_id   | 000400     |
| p29_res_status        | 2      |
| p29_req_variable_id | 000398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <name> |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000399 |
| p29_res_variable_id   | 000398 |",Extract Card Data
"Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
| p29_res_status        | 2      |
| p29_req_variable_id | 000398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398 |
| p29_res_status        | 2      |
| p29_res_variable_data | <name> |
| p29_res_variable_data | <exp_date> |
| p29_res_variable_id   | 000399 |
| p29_req_variable_id | 000400 |
| p29_res_variable_id   | 000400     |
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p24_req_text_element_id | title               |
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_buttonid     | b        |
| p24_req_prompt_idx      | 10                  |
When I send a 24.x Form Entry message to the terminal with params:
Then I wait until Element ""btn_enter"" visible
| p24_req_form_number     | confirmation_amount |
| p24_res_keyid        | \x1F     |
| p24_res_exit_type    | 0        |
| p24_res_button_state | tn_enter |
| p24_req_type_of_element | T                   |",Display Confirmation
"| p24_res_keyid        | \x1F     |
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
Then I should receive the 24.x Form Entry response from terminal with params:
When I send a 24.x Form Entry message to the terminal with params:
| p24_res_buttonid     | b        |
Then I wait until Element ""btn_enter"" visible
| p24_req_text_element_id | title               |
| p24_req_prompt_idx      | 10                  |
| p24_res_button_state | tn_enter |
| p24_res_exit_type    | 0        |
When I click Element ""btn_enter""",Display Confirmation
"When I send a 20.x Signature message to the terminal with params:
Then I wait until Element ""paint_view"" visible
And Draw line from 200x500 to 300x800
When Draw line from 100x800 to 200x500
And I wait for 1 second
| p20_req_form_name    | SIGN |
And Draw line from 100x800 to 200x500
| p20_req_prompt_index | 165  |
And Draw line from 200x500 to 300x800
And Draw line from 140x700 to 250x700",Unknown
"And Draw line from 140x700 to 250x700
| p20_req_prompt_index | 165  |
And I wait for 1 second
And Draw line from 200x500 to 300x800
When I send a 20.x Signature message to the terminal with params:
Then I wait until Element ""paint_view"" visible
And Draw line from 100x800 to 200x500
And Draw line from 200x500 to 300x800
| p20_req_form_name    | SIGN |
When Draw line from 100x800 to 200x500",Unknown
"And I click Element ""btn_enter""",Unknown
"And I click Element ""btn_enter""",Unknown
"| p20_res_data   | 4 |
| p20_res_status | 0 |
Then I should receive the 20.x Signature request response from terminal with params:",Unknown
"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_data   | 4 |
| p20_res_status | 0 |",Unknown
"| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_res_variable_id   | 000701           |
When I send a 29.x Get Variable message to the terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000701 |
| p29_res_variable_data | @skip_comparison |
| p29_res_status        | 2                |
| p29_req_variable_id | 000700 |
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |",Extract Card Data
"Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000701           |
| p29_req_variable_id | 000700 |
| p29_req_variable_id | 000701 |
| p29_res_variable_data | @skip_comparison |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_res_status        | 2                |
| p29_res_status        | 2                |
When I send a 29.x Get Variable message to the terminal with params:
| p29_res_variable_id   | 000700           |",Extract Card Data
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p24_req_form_number     | status_title_only |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_prompt_idx      | 352               |
| p24_req_type_of_element | T                 |
| p24_req_text_element_id | title             |",Display Confirmation
"| p24_req_form_number     | status_title_only |
| p24_req_prompt_idx      | 352               |
| p24_req_type_of_element | T                 |
| p24_req_text_element_id | title             |
When I send a 24.x Form Entry message to the terminal with params:",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"| p24_res_exit_type | 0    |
And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid     | \x1F |",Display Confirmation
"| p24_res_keyid     | \x1F |
| p24_res_exit_type | 0    |
And I should receive the 24.x Form Entry response from terminal with params:",Display Confirmation
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Examples:
| p00_res_reason_code | 0000 |
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
Then I should receive the 00.x Offline response from terminal with params:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
When I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
Then I should receive the 00.x Offline response from terminal with params:
@rx5000 @rx7000
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |",Precondition
"| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| p00_res_reason_code | 0000 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
@rx5000 @rx7000
Examples:",Precondition
"Then I should receive the 13.x amount response from terminal with params:
| p13_req_amount | <amount> |
When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |",Send Amount
"| p13_req_amount | <amount> |
| p13_res_status | 0 |
When I send a 13.x amount message to the terminal with:
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"| p23_req_form_name      | read_cards |
When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_enable_devices | M          |",Card Swipe
"| p23_req_prompt_index   | 311        |
| p23_req_enable_devices | M          |
| p23_req_form_name      | read_cards |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"Then I should receive the 23.x Card Read response from terminal with params:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3 | <additional_data><additional_data>           |
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_exit_type   | 0                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                            |
When Axium swipe magnetic card:",Card Swipe
"| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_card_source | M                                            |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | <additional_data><additional_data>           |
| track3 | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:",Card Swipe
"| p29_req_variable_id | 000400 |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_data | <name> |
| p29_req_variable_id | 000399 |
| p29_res_variable_data | <pan>  |
| p29_res_variable_data | <exp_date> |
| p29_req_variable_id | 000398 |
| p29_res_variable_id   | 000400     |
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000399 |",Extract Card Data
"| p29_req_variable_id | 000399 |
| p29_req_variable_id | 000400 |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <exp_date> |
| p29_res_status        | 2          |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <name> |
| p29_res_variable_data | <pan>  |
| p29_res_variable_id   | 000399 |
| p29_res_variable_id   | 000400     |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
| p24_res_keyid        | \x1F     |
| p24_res_exit_type    | 0        |
| p24_req_type_of_element | T                   |
| p24_res_buttonid     | b        |
When I send a 24.x Form Entry message to the terminal with params:
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
| p24_res_button_state | tn_enter |",Display Confirmation
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_type_of_element | T                   |
| p24_res_exit_type    | 0        |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
| p24_req_prompt_idx      | 10                  |
| p24_res_keyid        | \x1F     |
Then I should receive the 24.x Form Entry response from terminal with params:
When I click Element ""btn_enter""
| p24_req_form_number     | confirmation_amount |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |",Display Confirmation
"| p20_req_form_name    | SIGN |
When I send a 20.x Signature message to the terminal with params:
And I wait for 1 second
And Draw line from 300x360 to 360x400
Then I wait until Element ""paint_view"" visible
When Draw line from 200x300 to 300x360
| p20_req_prompt_index | 165  |",Unknown
"| p20_req_prompt_index | 165  |
When I send a 20.x Signature message to the terminal with params:
And I wait for 1 second
And Draw line from 300x360 to 360x400
| p20_req_form_name    | SIGN |
When Draw line from 200x300 to 300x360
Then I wait until Element ""paint_view"" visible",Unknown
"And I click Element ""btn_enter""",Unknown
"And I click Element ""btn_enter""",Unknown
"| p20_res_data   | 2 |
Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |",Unknown
"| p20_res_data   | 2 |
| p20_res_status | 0 |
Then I should receive the 20.x Signature request response from terminal with params:",Unknown
"When I send a 29.x Get Variable message to the terminal with params:
| p29_res_status        | 2                |
When I send a 29.x Get Variable message to the terminal with params:
| p29_res_variable_id   | 000701           |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000701 |
| p29_res_variable_data | @skip_comparison |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
| p29_req_variable_id | 000700 |",Extract Card Data
"| p29_res_status        | 2                |
When I send a 29.x Get Variable message to the terminal with params:
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000700 |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_res_variable_id   | 000700           |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |",Extract Card Data
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_text_element_id | title             |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_prompt_idx      | 352               |",Display Confirmation
"| p24_req_prompt_idx      | 352               |
| p24_req_type_of_element | T                 |
| p24_req_text_element_id | title             |
| p24_req_form_number     | status_title_only |
When I send a 24.x Form Entry message to the terminal with params:",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |",Display Confirmation
"| p24_res_keyid     | \x1F |
| p24_res_exit_type | 0    |
And I should receive the 24.x Form Entry response from terminal with params:",Display Confirmation
"And I wait for 2 seconds
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
Examples:
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |",Unknown
"Examples:
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
And I wait for 2 seconds",Unknown
"Scenario Outline: Send 23.x Card Read Request insert and remove chip card then swipe .
Using this feature file, we ensure that the reader should be disabled after start performing a transaction
@collis @msr @emv @cless @visa @amex @online_pin_cvm @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Test link test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1198
""""""
""""""
Feature: 23.x Card Read Request",Card Swipe
"Test link test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1198
""""""
""""""
Using this feature file, we ensure that the reader should be disabled after start performing a transaction
Feature: 23.x Card Read Request
Scenario Outline: Send 23.x Card Read Request insert and remove chip card then swipe .
@collis @msr @emv @cless @visa @amex @online_pin_cvm @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Card Swipe
"| interface | contact          |
Given I successfully changed configuration ""0019"" ""0001"" to ""1""
| test_case | <test_case>      |
And I successfully changed configuration ""0019"" ""0021"" to ""1""
| test_plan | Quick_Chip_1__2  |
And I wait 20 seconds
And  I initiating Collis Test Case with the following params:
| brand     | American_Express |",Unknown
"| test_case | <test_case>      |
| interface | contact          |
Given I successfully changed configuration ""0019"" ""0001"" to ""1""
And  I initiating Collis Test Case with the following params:
And I successfully changed configuration ""0019"" ""0021"" to ""1""
| brand     | American_Express |
| test_plan | Quick_Chip_1__2  |
And I wait 20 seconds",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:",Precondition
"And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 00.x Offline message to the terminal with params:",Precondition
"When  I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |
| p13_req_cashback |          |
| p13_req_amount   | <amount> |
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"| p13_res_status | 0 |
| p13_req_amount   | <amount> |
When  I send a 13.x amount message to the terminal with:
| p13_req_cashback |          |
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"| p23_res_track1      |   |
| p23_res_track2      |   |
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | S   |
| p23_res_exit_type   | 0 |
| p23_req_form_name      |     |
When I insert card
| p23_res_track3      |   |
| p23_req_prompt_index   | 100 |
And I wait 2 seconds
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_card_source | Q |
And I wait 2 seconds",Card Swipe
"| p23_req_enable_devices | S   |
| p23_res_track2      |   |
| p23_res_exit_type   | 0 |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_req_form_name      |     |
| p23_res_track1      |   |
| p23_res_card_source | Q |
When I insert card
When I send a 23.x Read Card message to the terminal with:
And I wait 2 seconds
| p23_req_prompt_index   | 100 |
And I wait 2 seconds
| p23_res_track3      |   |",Card Swipe
"When I enter pin ""00123""",Unknown
"When I enter pin ""00123""",Unknown
"When I remove card
| 0x9001 | ingenico_proprietary_card_entry_mode           | C                      |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | U                      |
| 0x9F1A | terminal_country_code                          | 0840                   |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>       |
And I should receive the 09.x Set Allowed Payment response from terminal with params:
| 0x84   | dedicated_file_df_name                         | <adf>                  |
| 0x1002 | ingenico_proprietary_signature_required_flag   | U                      |
| p33_05_res_status                  | 00         |
And I Wait until Element ""title"" contains ""Card removed\nTransaction canceled""
| 0x5F20 | cardholder_name                                | <cardholder_name>      |
And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
| p09_res_card_status      | R  |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}          |
| 0x4F   | application_identifier                         | <adf>                  |
| 0x5F24 | application_expiration_date                    | <exp_date>31           |
| p09_res_msg_version      | 02 |
| 0x9F0E | issuer_action_code_denial                      | 0000000000             |
| 0x9C   | transaction_type                               | 00                     |
| p09_res_transaction_type | 01 |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| 0x1001 | ingenico_proprietary_pin_entry_required_flag   | U                      |
| 0xDF05 | aip_for_visa_contactless                       | C800000000             |
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                   |
| 0x9F1B | terminal_floor_limit                           | 00002710               |
| p33_05_res_emvh_current_packet_nbr | 0          |
| 0x9F0D | issuer_action_code_default                     | BC50ECA800             |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6} |
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| tag    | name                                           | value                  |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                      |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                     |
| 0xDF04 | pin_try_counter                                | 0000000000             |
| 0x9F0F | issuer_action_code_online                      | BC78FCF800             |
| 0x9F03 | amount_other                                   | 000000000000           |
| p09_res_card_type        | 02 |
| 0xDF03 | pin_try_limit_kernel_v2                        | C800000000             |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                     |
| 0x1010 | ingenico_proprietary_error_response_code       | CRPRE                  |
| p33_05_res_payload                 | @regexp:.* |
| 0x9F39 | point_of_service_pos_entry_mode                | 05                     |
| p33_05_res_emvh_packet_type        | 0          |",Unknown
"And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
| 0x9F39 | point_of_service_pos_entry_mode                | 05                     |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| p33_05_res_payload                 | @regexp:.* |
| 0x5F20 | cardholder_name                                | <cardholder_name>      |
| p09_res_msg_version      | 02 |
| tag    | name                                           | value                  |
| p33_05_res_status                  | 00         |
| 0x1002 | ingenico_proprietary_signature_required_flag   | U                      |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>       |
And I should receive the 09.x Set Allowed Payment response from terminal with params:
| 0x9001 | ingenico_proprietary_card_entry_mode           | C                      |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                     |
| 0x9C   | transaction_type                               | 00                     |
| 0x9F03 | amount_other                                   | 000000000000           |
| 0x9F0E | issuer_action_code_denial                      | 0000000000             |
| 0x4F   | application_identifier                         | <adf>                  |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                     |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | U                      |
| p09_res_card_type        | 02 |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
| 0x9F1B | terminal_floor_limit                           | 00002710               |
| 0x9F0F | issuer_action_code_online                      | BC78FCF800             |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}          |
When I remove card
| 0xDF05 | aip_for_visa_contactless                       | C800000000             |
| p33_05_res_emvh_current_packet_nbr | 0          |
| 0x84   | dedicated_file_df_name                         | <adf>                  |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                      |
| 0x1010 | ingenico_proprietary_error_response_code       | CRPRE                  |
| 0xDF04 | pin_try_counter                                | 0000000000             |
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                   |
| p33_05_res_emvh_packet_type        | 0          |
| p09_res_transaction_type | 01 |
| 0x5F24 | application_expiration_date                    | <exp_date>31           |
| 0x1001 | ingenico_proprietary_pin_entry_required_flag   | U                      |
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| 0xDF03 | pin_try_limit_kernel_v2                        | C800000000             |
And I Wait until Element ""title"" contains ""Card removed\nTransaction canceled""
| p09_res_card_status      | R  |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6} |
| 0x9F0D | issuer_action_code_default                     | BC50ECA800             |
| 0x9F1A | terminal_country_code                          | 0840                   |",Unknown
"| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3_data |                                              |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
When I swipe card using this params:",Unknown
"| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
When I swipe card using this params:
| track3_data |                                              |",Unknown
"Then I Wait until Element ""title"" contains ""Card removed\nTransaction canceled""
And I should not receive in ""2"" seconds anything from terminal
And I successfully changed configuration ""0019"" ""0001"" to ""0""",Unknown
"And I successfully changed configuration ""0019"" ""0001"" to ""0""
Then I Wait until Element ""title"" contains ""Card removed\nTransaction canceled""
And I should not receive in ""2"" seconds anything from terminal",Unknown
"And I successfully changed configuration ""0019"" ""0021"" to ""0""
| AXP QC 032 - Online PIN - Successful PIN | A000000025010801 | AEIPS 22/VER 2.3 | 374245001751006 | 2512     | 3250   |
| test_case                                | adf              | cardholder_name  | pan             | exp_date | amount |
Examples:
Scenario Outline: Send 23.x Card Read Request Tap and Remove contacless card then swipe .",Card Swipe
"| test_case                                | adf              | cardholder_name  | pan             | exp_date | amount |
And I successfully changed configuration ""0019"" ""0021"" to ""0""
Examples:
| AXP QC 032 - Online PIN - Successful PIN | A000000025010801 | AEIPS 22/VER 2.3 | 374245001751006 | 2512     | 3250   |
Scenario Outline: Send 23.x Card Read Request Tap and Remove contacless card then swipe .",Card Swipe
"| interface | contactless                          |
| brand     | Visa                                 |
| test_plan | 06_VisaL3Testing_series_01_build_019 |
And I wait 20 seconds
| test_case | <test_case>                          |
Given I successfully changed configuration ""0008"" ""0001"" to ""9""
And I initiating Collis Test Case with the following params:",Unknown
"Given I successfully changed configuration ""0008"" ""0001"" to ""9""
| brand     | Visa                                 |
And I initiating Collis Test Case with the following params:
| test_plan | 06_VisaL3Testing_series_01_build_019 |
| test_case | <test_case>                          |
And I wait 20 seconds
| interface | contactless                          |",Unknown
"| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Precondition
"And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:",Precondition
"| p13_req_cashback |          |
Then I should receive the 13.x amount response from terminal with params:
When  I send a 13.x amount message to the terminal with:
| p13_req_amount   | <amount> |
| p13_res_status | 0 |",Send Amount
"| p13_req_amount   | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_req_cashback |          |
| p13_res_status | 0 |
When  I send a 13.x amount message to the terminal with:",Send Amount
"| 0x84   | dedicated_file_df_name                       | <adf>                      |
| 0x5F24 | application_expiration_date                  | <exp_date>31               |
Then  the reported ""track2_equivalent_data"" container should have the following params:
When I send a 23.x Read Card message to the terminal with:
| tag    | name                                         | value                      |
| 0xFF25 | Encryption/Whitelisting_mode                 | 00                         |
| 0x9F1A | terminal_country_code                        | 0840                       |
| p23_res_track2      | <pan>=<exp_date><add_data> |
| p33_02_res_emvh_packet_type        | 0          |
| p23_res_track3      | @regexp:.*                 |
| 0x5F28 | issuer_country_code_kernel_2                 | 0840                       |
| p23_req_form_name      | read_cards |
And I tap contactless card
| p23_res_track1      |                            |
| p33_02_res_status                  | 00         |
| 0x1002 | ingenico_proprietary_signature_required_flag | 0                          |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_req_prompt_index   | 371        |
| 0x5F20 | cardholder_name                              | <cardholder_name>          |
| 0x57   | track_2_equivalent_data                      | <pan>D<exp_date><add_data> |
And I Wait until Element ""title"" contains ""Tap""
| p33_02_res_payload                 | @regexp:.+ |
| p23_res_card_source | E                          |
| p23_res_exit_type   | 0                          |
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
| 0x9F1B | terminal_floor_limit                         | 00002710                   |
| p23_req_enable_devices | MC         |
| p33_02_res_emvh_current_packet_nbr | 0          |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| 0x4F   | application_identifier                       | <adf>                      |",Card Swipe
"| p33_02_res_status                  | 00         |
| p23_res_exit_type   | 0                          |
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
| tag    | name                                         | value                      |
| 0xFF25 | Encryption/Whitelisting_mode                 | 00                         |
| p23_res_card_source | E                          |
| p33_02_res_emvh_packet_type        | 0          |
Then I should receive the 23.x Read Card response from terminal with params:
| p33_02_res_emvh_current_packet_nbr | 0          |
| 0x57   | track_2_equivalent_data                      | <pan>D<exp_date><add_data> |
| 0x84   | dedicated_file_df_name                       | <adf>                      |
| p23_res_track1      |                            |
Then  the reported ""track2_equivalent_data"" container should have the following params:
And I tap contactless card
| 0x9F1B | terminal_floor_limit                         | 00002710                   |
| 0x1002 | ingenico_proprietary_signature_required_flag | 0                          |
And I Wait until Element ""title"" contains ""Tap""
| p23_res_track3      | @regexp:.*                 |
| 0x5F24 | application_expiration_date                  | <exp_date>31               |
| 0x9F1A | terminal_country_code                        | 0840                       |
When I send a 23.x Read Card message to the terminal with:
| 0x5F28 | issuer_country_code_kernel_2                 | 0840                       |
| p23_req_form_name      | read_cards |
| 0x4F   | application_identifier                       | <adf>                      |
| p33_02_res_payload                 | @regexp:.+ |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| p23_req_prompt_index   | 371        |
| p23_res_track2      | <pan>=<exp_date><add_data> |
| 0x5F20 | cardholder_name                              | <cardholder_name>          |
| p23_req_enable_devices | MC         |",Card Swipe
"When I enter pin ""1234""",Unknown
"When I enter pin ""1234""",Unknown
"| p33_05_res_emvh_current_packet_nbr | 0          |
| 0x9001 | ingenico_proprietary_card_entry_mode           | D                          |
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
| 0x9F34 | cardholder_verification_method_cvm_results     | @regexp:[048C]{1}20300     |
| 0x9F27 | cryptogram_information_data                    | 80                         |
| 0x57   | track_2_equivalent_data                        | <pan>D<exp_date><add_data> |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}              |
| 0x5F24 | application_expiration_date                    | <exp_date>31               |
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                       |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                         |
| p33_03_req_emvh_packet_type        | 0          |
| 0x84   | dedicated_file_df_name                         | <adf>                      |
| 0x9F1A | terminal_country_code                          | 0840                       |
| 0x9F1A | terminal_country_code                          | 0840                       |
| 0x9F39 | point_of_service_pos_entry_mode                | 07                         |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}              |
| 0x9F34 | cardholder_verification_method_cvm_results     | @regexp:[048C]{1}20300     |
| 0x84   | dedicated_file_df_name                         | <adf>                      |
When I send a 33.04 Authorization Response message to the terminal with params:
| p33_04_res_payload                 | T008A:0002:a00 |
| 0x9F1B | terminal_floor_limit                           | 00002710                   |
| p33_05_res_status                  | 00         |
| 0xDF04 | pin_try_counter                                | 0010000000                 |
| 0x57   | track_2_equivalent_data                        | <pan>D<exp_date><add_data> |
| 0xDF03 | pin_try_limit_kernel_v2                        | DC4000A800                 |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>           |
| 0x5F24 | application_expiration_date                    | <exp_date>31               |
| p33_04_res_emvh_packet_type        | 0              |
| 0x9C   | transaction_type                               | 00                         |
| 0x8A   | authorisation_response_code                    | 00                         |
| 0x9F26 | application_cryptogram                         | @regexp:[0-9A-Fa-f]{16}    |
| 0x4F   | application_identifier                         | <adf>                      |
| 0x1002 | ingenico_proprietary_signature_required_flag   | 0                          |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| 0x9F27 | cryptogram_information_data                    | 80                         |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                         |
| 0x1002 | ingenico_proprietary_signature_required_flag   | 0                          |
| p33_04_res_status                  | 00             |
| tag    | name                                           | value                      |
| 0x9001 | ingenico_proprietary_card_entry_mode           | D                          |
| 0x9C   | transaction_type                               | 00                         |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                         |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6}     |
| 0x9F03 | amount_other                                   | 000000000000               |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                         |
| p33_03_req_emvh_current_packet_nbr | 0          |
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| 0x95   | terminal_verification_results                  | 0000000000                 |
| 0x9F26 | application_cryptogram                         | @regexp:[0-9A-Fa-f]{16}    |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                          |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                          |
And I Wait until Element ""title"" contains ""Approved""
| 0x9F39 | point_of_service_pos_entry_mode                | 07                         |
| p33_03_req_payload                 | @regexp:.+ |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6}     |
| 0x95   | terminal_verification_results                  | 0000000000                 |
| 0xDF05 | aip_for_visa_contactless                       | DC4004F800                 |
| 0x5F20 | cardholder_name                                | <cardholder_name>          |
| p33_05_res_emvh_packet_type        | 0          |
| 0x4F   | application_identifier                         | <adf>                      |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>           |
| 0x9F03 | amount_other                                   | 000000000000               |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | 1                          |
| tag    | name                                           | value                      |
| 0x5F20 | cardholder_name                                | <cardholder_name>          |
| p33_05_res_payload                 | @regexp:.* |
Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | 1                          |
Then the reported ""authorization_request_data"" container should have the following params:
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                       |
| 0x9F1B | terminal_floor_limit                           | 00002710                   |
| p33_04_res_emvh_current_packet_nbr | 0              |
| p33_03_req_status                  | 00         |",Unknown
"| 0x9F1B | terminal_floor_limit                           | 00002710                   |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
| p33_05_res_status                  | 00         |
| 0x9F26 | application_cryptogram                         | @regexp:[0-9A-Fa-f]{16}    |
| 0x9C   | transaction_type                               | 00                         |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}              |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>           |
| 0x1002 | ingenico_proprietary_signature_required_flag   | 0                          |
| p33_05_res_payload                 | @regexp:.* |
| 0xDF05 | aip_for_visa_contactless                       | DC4004F800                 |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| 0x5F20 | cardholder_name                                | <cardholder_name>          |
| 0x9F1B | terminal_floor_limit                           | 00002710                   |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6}     |
| 0x9C   | transaction_type                               | 00                         |
| 0x5F20 | cardholder_name                                | <cardholder_name>          |
| 0x9F27 | cryptogram_information_data                    | 80                         |
| 0x57   | track_2_equivalent_data                        | <pan>D<exp_date><add_data> |
| p33_03_req_emvh_current_packet_nbr | 0          |
| 0x95   | terminal_verification_results                  | 0000000000                 |
When I send a 33.04 Authorization Response message to the terminal with params:
| 0x1005 | ingenico_proprietary_transaction_type          | 00                         |
| 0xDF04 | pin_try_counter                                | 0010000000                 |
| 0x5F24 | application_expiration_date                    | <exp_date>31               |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>           |
Then the reported ""authorization_request_data"" container should have the following params:
| 0x8A   | authorisation_response_code                    | 00                         |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6}     |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                          |
| p33_05_res_emvh_current_packet_nbr | 0          |
| 0x9F26 | application_cryptogram                         | @regexp:[0-9A-Fa-f]{16}    |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | 1                          |
Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| tag    | name                                           | value                      |
| 0x9F39 | point_of_service_pos_entry_mode                | 07                         |
| 0x9F34 | cardholder_verification_method_cvm_results     | @regexp:[048C]{1}20300     |
| p33_03_req_status                  | 00         |
| 0x57   | track_2_equivalent_data                        | <pan>D<exp_date><add_data> |
| p33_05_res_emvh_packet_type        | 0          |
| p33_04_res_payload                 | T008A:0002:a00 |
| p33_03_req_emvh_packet_type        | 0          |
| tag    | name                                           | value                      |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                         |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                         |
| 0x9F39 | point_of_service_pos_entry_mode                | 07                         |
| 0x9F27 | cryptogram_information_data                    | 80                         |
| 0x9F1A | terminal_country_code                          | 0840                       |
| 0x5F24 | application_expiration_date                    | <exp_date>31               |
| 0x9001 | ingenico_proprietary_card_entry_mode           | D                          |
| 0x95   | terminal_verification_results                  | 0000000000                 |
| 0x9F03 | amount_other                                   | 000000000000               |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | 1                          |
| p33_04_res_emvh_packet_type        | 0              |
| 0x9001 | ingenico_proprietary_card_entry_mode           | D                          |
| 0x9F1A | terminal_country_code                          | 0840                       |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                         |
| p33_04_res_status                  | 00             |
| 0xDF03 | pin_try_limit_kernel_v2                        | DC4000A800                 |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                          |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}              |
| p33_04_res_emvh_current_packet_nbr | 0              |
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                       |
| 0x9F03 | amount_other                                   | 000000000000               |
| 0x4F   | application_identifier                         | <adf>                      |
| 0x84   | dedicated_file_df_name                         | <adf>                      |
| p33_03_req_payload                 | @regexp:.+ |
| 0x9F34 | cardholder_verification_method_cvm_results     | @regexp:[048C]{1}20300     |
And I Wait until Element ""title"" contains ""Approved""
| 0x84   | dedicated_file_df_name                         | <adf>                      |
| 0x1002 | ingenico_proprietary_signature_required_flag   | 0                          |
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                       |
| 0x4F   | application_identifier                         | <adf>                      |",Unknown
"| track3_data |                                    |
| track1_data | B<pan>^<name>^<exp_date><add_data> |
| track2_data | <pan>=<exp_date>201<disc_data_t2>  |
When I swipe card using this params:",Unknown
"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><add_data> |
| track2_data | <pan>=<exp_date>201<disc_data_t2>  |
| track3_data |                                    |",Unknown
"""""""
| VISA.TC.1002a | A0000000031010 | L3TEST/CARD1002 | 4761731000000027 | 3112     | 20119058101 | 1600   | 0000014000001 |
| test_case     | adf            | cardholder_name | pan              | exp_date | add_data    | amount | disc_data_t2  |
@msr @fpe @00x @62x @61x @63x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Examples:
Scenario Outline: delete a file from terminal
Then I Wait until Element ""title"" contains ""Approved""
And I should not receive in ""2"" seconds anything from terminal
this testcase is to validate the steps of deleting a file and a package from terminal
And I successfully changed configuration ""0008"" ""0001"" to ""0""
""""""
Feature: Validate steps of deleting package and files from terminal",Unknown
"Then I Wait until Element ""title"" contains ""Approved""
| test_case     | adf            | cardholder_name | pan              | exp_date | add_data    | amount | disc_data_t2  |
Scenario Outline: delete a file from terminal
And I should not receive in ""2"" seconds anything from terminal
Examples:
""""""
And I successfully changed configuration ""0008"" ""0001"" to ""0""
@msr @fpe @00x @62x @61x @63x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| VISA.TC.1002a | A0000000031010 | L3TEST/CARD1002 | 4761731000000027 | 3112     | 20119058101 | 1600   | 0000014000001 |
""""""
Feature: Validate steps of deleting package and files from terminal
this testcase is to validate the steps of deleting a file and a package from terminal",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"And I wait until Element ""imageOffline"" visible
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p63_req_file_name | Test.txt |
When I delete file ""/sdcard/Android/data/com.ingenico.retail.arcapp/files/Test.txt"" from terminal
| p62_req_unpack_flag     | 0          |
| p62_req_fast_download   | 1          |
And I should receive the 63.x Find File response from terminal with params:
| p62_req_file_data       | @regexp:.* |
When I send a 63.x Find File message to the terminal with:
Examples:
| p63_res_file_length | 40 |
When I have successfully sent file through 62.x Write File request with:
| p63_res_result      | 1 |
| p62_res_status      | 0           |
| p62_req_encoding_format | 7          |
| p62_req_file_name       | <path>     |
| path           |
Then I should receive the 63.x Find File response from terminal with params:
| p63_res_result      | 0  |
| p62_req_record_type     | 0          |
| Files/Test.txt |
Scenario: Enable encryption and Whitelisting Configuration
| p62_res_file_length | @regexp:\d* |
| p62_req_segment_nbr     | 01         |
And I send a 63.x Find File message to the terminal with:
| p63_req_file_name | Test.txt |
| p63_res_file_length | 0 |
Then I should receive the 62.x Write File response from terminal with params:",Unknown
"| p63_res_result      | 1 |
And I should receive the 63.x Find File response from terminal with params:
| p62_req_record_type     | 0          |
| p62_req_encoding_format | 7          |
| p62_req_fast_download   | 1          |
| p62_req_file_name       | <path>     |
| Files/Test.txt |
| path           |
| p63_req_file_name | Test.txt |
Scenario: Enable encryption and Whitelisting Configuration
When I have successfully sent file through 62.x Write File request with:
When I delete file ""/sdcard/Android/data/com.ingenico.retail.arcapp/files/Test.txt"" from terminal
Then I should receive the 62.x Write File response from terminal with params:
| p63_res_file_length | 40 |
When I send a 63.x Find File message to the terminal with:
| p63_req_file_name | Test.txt |
| p62_res_status      | 0           |
| p62_req_segment_nbr     | 01         |
Examples:
Then I should receive the 63.x Find File response from terminal with params:
| p62_res_file_length | @regexp:\d* |
| p62_req_unpack_flag     | 0          |
And I send a 63.x Find File message to the terminal with:
| p63_res_file_length | 0 |
| p62_req_file_data       | @regexp:.* |
| p63_res_result      | 0  |",Unknown
"And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p62_res_status      | 0           |
| p62_res_status      | 0           |
| p62_req_encoding_format | B                 |
When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_file_name       | apstitan_on.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p61_req_index_num | 1  |
| p62_req_unpack_flag     | 0                 |
When I send a 61.x Configuration Read message to the terminal with:
| p62_res_file_length | @regexp:\d* |
| p61_res_status                | 2  |
| p62_req_file_name       | ArcOnGuardFPE.apk |
| p61_res_group_num             | 91 |
| p62_res_file_length | @regexp:\d* |
| p61_res_data_config_parameter | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B               |
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
| p62_req_fast_download   | 1                 |
Scenario Outline: Validate steps of deleting package from terminal
| p62_req_fast_download   | 1               |",Unknown
"| p61_res_data_config_parameter | 2  |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_unpack_flag     | 0               |
| p62_res_file_length | @regexp:\d* |
| p62_req_file_name       | ArcOnGuardFPE.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p62_req_encoding_format | B               |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_group_num             | 91 |
Scenario Outline: Validate steps of deleting package from terminal
When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p61_res_index_num             | 1  |
When I send a 61.x Configuration Read message to the terminal with:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_res_status      | 0           |
| p62_res_status      | 0           |
| p61_res_status                | 2  |
| p62_req_fast_download   | 1                 |
| p61_req_index_num | 1  |
| p62_res_file_length | @regexp:\d* |
| p62_req_unpack_flag     | 0                 |
| p61_req_group_num | 91 |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1               |
| p62_req_file_name       | apstitan_on.apk |",Unknown
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 2  |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |",Unknown
"| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 2  |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_status                | 2  |",Unknown
"Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |
When I send a 13.x amount message to the terminal with:
| p13_req_amount | 1000 |",Send Amount
"Then I should receive the 13.x amount response from terminal with params:
When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |
| p13_req_amount | 1000 |",Send Amount
"And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible",Unknown
"| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| p23_req_enable_devices | M   |
| p23_req_prompt_index   | 312 |
| track3_data | <additional_data><additional_data>           |
When I swipe card using this params:
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"| p23_req_prompt_index   | 312 |
| track3_data | <additional_data><additional_data>           |
When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M   |
When I swipe card using this params:
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"| p23_res_card_source | M                                            |
| p23_res_track3      | @regexp:.+                                   |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
When I uninstall package ""com.ingenico.retail.aps.secure.parameters"" from terminal
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"| p23_res_exit_type   | 0                                            |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_card_source | M                                            |
When I uninstall package ""com.ingenico.retail.aps.secure.parameters"" from terminal
| p23_res_track3      | @regexp:.+                                   |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:",Unknown
"| p61_res_data_config_parameter | 2  |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
When I send a 61.x Configuration Read message to the terminal with:",Unknown
"| p23_req_enable_devices | M          |
| p23_req_form_name      | read_cards |
When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"| p23_req_prompt_index   | 311        |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"And  I wait until Element ""btn_cancel"" visible",Unknown
"| p23_res_track3      | @regexp:.+                                                   |
When Axium swipe magnetic card:
| p23_res_card_source | M                                                            |
#      | p23_res_card_source | M          |
#      | p23_res_exit_type   | 0          |
#      | p23_res_track3      | @regexp:.+ |
| track3 | <additional_data><additional_data>           |
#    Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                            |
#      | p23_res_track2      | @regexp:.+ |
#      | p23_res_track1      | @regexp:.+ |
Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"| track2 | <pan>=<exp_date><code><disc_data_t2>         |
#    Then I should receive the 23.x Card Read response from terminal with params:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
#      | p23_res_exit_type   | 0          |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_card_source | M                                                            |
| track3 | <additional_data><additional_data>           |
| p23_res_exit_type   | 0                                                            |
#      | p23_res_track3      | @regexp:.+ |
#      | p23_res_track1      | @regexp:.+ |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
#      | p23_res_card_source | M          |
#      | p23_res_track2      | @regexp:.+ |
When Axium swipe magnetic card:",Card Swipe
"| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
Examples:
Scenario: Teardown - Reset to Default State
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 |
And decrypted field ""p23_res_track3"" with ON GUARD algorithm should match the following MSR data:",Unknown
"| track2 | <pan>=<exp_date><code><disc_data_t2> |
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 |
And decrypted field ""p23_res_track3"" with ON GUARD algorithm should match the following MSR data:
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |
Examples:
Scenario: Teardown - Reset to Default State",Unknown
"| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"Then I should receive the 62.x Write File response from terminal with params:
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_res_data_config_parameter | 0  |
| p61_res_index_num             | 1  |
| p62_res_file_length | @regexp:.* |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
@sde @msr @00x @62x @61x @41x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_req_unpack_flag     | 0                   |
| p61_res_group_num             | 91 |
| p62_res_status      | 0          |
Then I should receive the 61.x Configuration Read response from terminal with params:
Feature: Validate step of decryption for On-Guard SDE dukpt Encryption for MSR transaction
Scenario: Enable OGSDE DUKPT with AES128 Encryption Configuration
| p62_req_fast_download   | 1                   |
| p62_req_encoding_format | B                   |
When I send a 61.x Configuration Read message to the terminal with:",Unknown
"| p61_req_index_num | 1  |
| p62_res_file_length | @regexp:.* |
Scenario: Enable OGSDE DUKPT with AES128 Encryption Configuration
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_unpack_flag     | 0                   |
| p62_req_encoding_format | B                   |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_status                | 2  |
| p62_res_status      | 0          |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 0  |
| p61_res_group_num             | 91 |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
@sde @msr @00x @62x @61x @41x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate step of decryption for On-Guard SDE dukpt Encryption for MSR transaction
| p62_req_fast_download   | 1                   |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"| p62_req_fast_download   | 1                         |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_status                | 2  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0                         |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_encoding_format | B                         |
Scenario Outline: On-Guard SDE DUKPT AES Encryption For MSR Transaction
| p62_res_file_length | @regexp:.\d* |
| p62_res_status      | 0            |
| p61_req_index_num | 1  |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES128.apk"" file using these params:
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 19 |
| p62_req_file_name       | ArcOnGuard-SDE-AES128.apk |
| p61_req_group_num | 91 |",Unknown
"Scenario Outline: On-Guard SDE DUKPT AES Encryption For MSR Transaction
| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 19 |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p62_req_unpack_flag     | 0                         |
| p62_res_file_length | @regexp:.\d* |
Then I should receive the 62.x Write File response from terminal with params:
| p61_req_index_num | 1  |
| p62_res_status      | 0            |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_fast_download   | 1                         |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES128.apk"" file using these params:
| p62_req_encoding_format | B                         |
| p61_res_status                | 2  |
| p62_req_file_name       | ArcOnGuard-SDE-AES128.apk |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_index_num             | 1  |
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
| p61_res_status                | 2  |
| p61_req_index_num | 1  |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p61_req_group_num | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_data_config_parameter | 19 |
| p61_res_group_num             | 91 |
When I send a 61.x Read Configuration message to the terminal with:",Precondition
"| p61_res_data_config_parameter | 19 |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p61_req_group_num | 91 |
When I send a 61.x Read Configuration message to the terminal with:
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p41_req_msr_flag         | 1 |
| p41_req_parse_flag       | 1 |
When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_smc_flag         | 0 |
| p41_req_contactless_flag | 0 |",Unknown
"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |",Unknown
And I wait for 2 seconds,Unknown
And I wait for 2 seconds,Unknown
"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |",Unknown
"| track3 | <additional_data><additional_data>           |
And Axium swipe magnetic card:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Unknown
And I wait 2 seconds,Unknown
And I wait 2 seconds,Unknown
"######################### MSR transaction decryption for SDE AES DUKPT#############################
| p41_res_track_2         | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_encryption      | 19                                                           |
| p41_res_track_1_status  | 0                                                            |
| p41_res_source          | M                                                            |
| p41_res_track_3         | @regexp:.+                                                   |
| p41_res_track_1         | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p41_res_masked_pan      | <masked_pan>                                                 |
| p41_res_account_name    | <name>                                                       |
| p41_res_track_2_status  | 0                                                            |
| p41_res_error_code      | 0                                                            |
| p41_res_pan             | <masked_pan>                                                 |
| p41_res_expiration_date | <exp_date>                                                   |
| p41_res_track_3_status  | 0                                                            |",Unknown
"| p41_res_track_3         | @regexp:.+                                                   |
| p41_res_pan             | <masked_pan>                                                 |
| p41_res_account_name    | <name>                                                       |
| p41_res_track_1_status  | 0                                                            |
######################### MSR transaction decryption for SDE AES DUKPT#############################
| p41_res_encryption      | 19                                                           |
| p41_res_source          | M                                                            |
| p41_res_track_2         | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p41_res_track_3_status  | 0                                                            |
| p41_res_masked_pan      | <masked_pan>                                                 |
| p41_res_error_code      | 0                                                            |
| p41_res_track_2_status  | 0                                                            |
| p41_res_track_1         | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_expiration_date | <exp_date>                                                   |",Unknown
"And decrypted field 'p41_res_track_3' with AES DUKPT algorithm should match the following MSR data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\x00<pan>=<exp_date><code><disc_data_t2><null_characters> |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00                 |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00                 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       | \x00\x00\x00\x00\x00\x00\x00\x00         |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters                          |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00 |
Examples:
Scenario: Teardown - Reset to Default State
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00                 |",Unknown
"| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00                 |
Examples:
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       | \x00\x00\x00\x00\x00\x00\x00\x00         |
Scenario: Teardown - Reset to Default State
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters                          |
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\x00<pan>=<exp_date><code><disc_data_t2><null_characters> |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00                 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00                 |
And decrypted field 'p41_res_track_3' with AES DUKPT algorithm should match the following MSR data:
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00 |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"| p62_req_encoding_format | B                   |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p62_req_fast_download   | 1                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_file_length | @regexp:.* |
""""""
When I send a 61.x Configuration Read message to the terminal with:
@msr @fpe @00x @61x @23x @62x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @known_issue @ARC-5904
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
ARC-5904: decryption of FPE simplify dont work for PAN lengths<=14 digits
Feature: Validate On-Guard FPE simplify decryption step for MSR Transaction
| p62_res_status      | 0          |
| p61_res_data_config_parameter | 0  |
| p62_req_unpack_flag     | 0                   |
| p61_res_status                | 2  |
This feature file Validates decryption step  for FPE simplify
| p62_req_file_name       | ArcNoEncryption.apk |
Scenario: Enable On-Guard FPE Encryption Configuration format simplify
""""""
Then I should receive the 61.x Configuration Read response from terminal with params:",Unknown
"| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
This feature file Validates decryption step  for FPE simplify
| p61_req_index_num | 1  |
| p62_req_encoding_format | B                   |
| p61_res_index_num             | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_file_name       | ArcNoEncryption.apk |
Then I should receive the 62.x Write File response from terminal with params:
""""""
| p61_res_group_num             | 91 |
Feature: Validate On-Guard FPE simplify decryption step for MSR Transaction
| p62_res_file_length | @regexp:.* |
| p62_req_fast_download   | 1                   |
ARC-5904: decryption of FPE simplify dont work for PAN lengths<=14 digits
""""""
| p61_res_data_config_parameter | 0  |
@msr @fpe @00x @61x @23x @62x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @known_issue @ARC-5904
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_req_group_num | 91 |
| p62_res_status      | 0          |
| p62_req_unpack_flag     | 0                   |
Scenario: Enable On-Guard FPE Encryption Configuration format simplify",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 2  |
| p62_req_fast_download   | 1                        |
| p61_res_index_num             | 1  |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_file_length | @regexp:\d* |
| p62_req_unpack_flag     | 0                        |
| p61_req_group_num | 91 |
| p62_res_status      | 0           |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_encoding_format | B                        |
Scenario Outline: On-Guard FPE Encryption For MSR Transaction
When I have successfully sent ""Files/p2p_encryptions/ArcOnguardFPEsimplfy.apk"" file using these params:
| p62_req_file_name       | ArcOnguardFPEsimplfy.apk |
When I send a 61.x Configuration Read message to the terminal with:",Unknown
"| p61_res_status                | 2  |
Scenario Outline: On-Guard FPE Encryption For MSR Transaction
| p62_req_unpack_flag     | 0                        |
When I have successfully sent ""Files/p2p_encryptions/ArcOnguardFPEsimplfy.apk"" file using these params:
| p62_req_encoding_format | B                        |
| p62_res_file_length | @regexp:\d* |
| p62_req_fast_download   | 1                        |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_index_num | 1  |
| p62_req_file_name       | ArcOnguardFPEsimplfy.apk |
| p62_res_status      | 0           |
| p61_res_group_num             | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
Then I should receive the 62.x Write File response from terminal with params:",Unknown
"| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 2  |
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
When I send a 61.x Configuration Read message to the terminal with:",Unknown
"| p61_res_index_num             | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
| p61_res_data_config_parameter | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_group_num             | 91 |
| p61_req_index_num | 1  |",Unknown
"| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |",Card Swipe
"Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |
When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_enable_devices | M          |",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"And  I wait until Element ""btn_cancel"" visible",Unknown
"| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                            |
| p23_res_track3      | @regexp:^B.+\|.+\|.{20}050006$                               |
| p23_res_card_source | M                                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
| track3 | <additional_data><additional_data>           |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
When Axium swipe magnetic card:",Card Swipe
"| p23_res_card_source | M                                                            |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | @regexp:^B.+\|.+\|.{20}050006$                               |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_exit_type   | 0                                                            |
When Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
Then I should receive the 23.x Card Read response from terminal with params:",Card Swipe
"Scenario: Teardown - Reset to Default State
#      | Diners     | 36070500001335   | CARD/IMAGE 33      | 1712     | 201  | 12010000000000000081000000   | 120100008100000 |                      | 36070500001335   | 00000000000000000000000000   | 000000000000000     |
Examples:
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000   | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2    | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000   | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001   | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
| track2 | @regexp:.*                                   |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000   |                      | 6510000000000091 | 0000000000000                | 0000000000000       |
#      | Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000   |                      | 36039600000472   | 00000000000000000000         | 0000000000000       |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100   |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000  |                      | 374245000001008  | 000000000                    | 00000000000000      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001   | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
Then decrypted field 'p23_res_track3' with ON GUARD Simplify algorithm should match the following data:",Unknown
"| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000   | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100   |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000  |                      | 374245000001008  | 000000000                    | 00000000000000      |
| track2 | @regexp:.*                                   |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001   | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000   |                      | 6510000000000091 | 0000000000000                | 0000000000000       |
Scenario: Teardown - Reset to Default State
#      | Diners     | 36070500001335   | CARD/IMAGE 33      | 1712     | 201  | 12010000000000000081000000   | 120100008100000 |                      | 36070500001335   | 00000000000000000000000000   | 000000000000000     |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
#      | Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000   |                      | 36039600000472   | 00000000000000000000         | 0000000000000       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001   | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
Then decrypted field 'p23_res_track3' with ON GUARD Simplify algorithm should match the following data:
Examples:
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000   | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2    | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |",Unknown
"| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_status                | 2  |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p62_res_status      | 0          |
@p2p @secbin @chapter_x @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable chapter_x Encryption Configuration
Scenario: Teardown - Reset to Default State
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_data_config_parameter | 0  |
| p62_req_unpack_flag     | 0                   |
| p62_req_fast_download   | 1                   |
| p61_req_group_num | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_res_group_num             | 91 |
| p62_res_file_length | @regexp:.* |
| p62_req_encoding_format | B                   |",Unknown
"| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
Scenario: Teardown - Reset to Default State
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
Feature: Disable chapter_x Encryption Configuration
| p62_res_file_length | @regexp:.* |
| p62_req_encoding_format | B                   |
| p61_res_index_num             | 1  |
| p62_res_status      | 0          |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
Then I should receive the 61.x Configuration Read response from terminal with params:
@p2p @secbin @chapter_x @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_req_index_num | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 0  |
| p61_res_status                | 2  |
| p62_req_fast_download   | 1                   |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"| p62_res_status      | 0          |
| p61_res_data_config_parameter | 0  |
| p61_req_index_num | 1  |
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @aes128 @aes192 @aes256
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_status                | 2  |
Feature: Disable On-Guard SDE DUKPT Encryption Configuration
| p62_req_fast_download   | 1                   |
| p61_res_group_num             | 91 |
| p62_req_file_name       | ArcNoEncryption.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
Scenario: Teardown - Reset to Default State
| p62_req_encoding_format | B                   |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_index_num             | 1  |
Then I should receive the 62.x Write File response from terminal with params:
| p61_req_group_num | 91 |
| p62_req_unpack_flag     | 0                   |",Unknown
"| p62_req_unpack_flag     | 0                   |
| p61_res_data_config_parameter | 0  |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
Feature: Disable On-Guard SDE DUKPT Encryption Configuration
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_status                | 2  |
Then I should receive the 62.x Write File response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p62_req_fast_download   | 1                   |
| p62_req_encoding_format | B                   |
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @aes128 @aes192 @aes256
| p62_res_file_length | @regexp:.* |
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
Scenario: Teardown - Reset to Default State
| p62_res_status      | 0          |",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Scenario: Teardown - Reset to Default State
| p61_res_data_config_parameter | 0  |
| p62_res_file_length | @regexp:.* |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_encoding_format | B                   |
Feature: Disable On-Guard SDE Encryption Configuration
| p61_req_group_num | 91 |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0                   |
| p62_req_fast_download   | 1                   |
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @jobs @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p61_res_index_num             | 1  |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_status                | 2  |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p62_res_status      | 0          |
| p62_req_file_name       | ArcNoEncryption.apk |",Unknown
"| p61_res_status                | 2  |
| p62_req_unpack_flag     | 0                   |
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @jobs @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 0  |
Scenario: Teardown - Reset to Default State
Feature: Disable On-Guard SDE Encryption Configuration
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_file_name       | ArcNoEncryption.apk |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p61_res_index_num             | 1  |
| p62_res_file_length | @regexp:.* |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
Then I should receive the 62.x Write File response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 0  |
Scenario: Teardown - Reset to Default State
@secbin @rsa @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_req_group_num | 91 |
| p62_res_file_length | @regexp:.* |
| p62_res_status      | 0          |
| p62_req_fast_download   | 1                   |
| p62_req_encoding_format | B                   |
Feature: Disable RSA Encryption Configuration
| p62_req_unpack_flag     | 0                   |
| p61_req_index_num | 1  |",Unknown
"@secbin @rsa @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_req_unpack_flag     | 0                   |
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_res_data_config_parameter | 0  |
| p61_req_group_num | 91 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
Scenario: Teardown - Reset to Default State
| p62_req_encoding_format | B                   |
| p62_res_status      | 0          |
| p62_req_fast_download   | 1                   |
| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
Feature: Disable RSA Encryption Configuration
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |",Unknown
"| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"| p61_req_index_num | 1  |
@secbin @voltage @tep2 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p61_res_group_num             | 91 |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_encoding_format | B                   |
| p61_res_status                | 2  |
| p62_req_file_name       | ArcNoEncryption.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
Feature: Disable Voltage TEP2 Encryption Configuration
Scenario: Teardown - Reset to Default State
| p62_res_file_length | @regexp:.* |
| p62_req_fast_download   | 1                   |
| p61_res_data_config_parameter | 0  |
Then I should receive the 62.x Write File response from terminal with params:
| p61_req_group_num | 91 |
| p62_res_status      | 0          |
| p61_res_index_num             | 1  |
When I send a 61.x Configuration Read message to the terminal with:",Unknown
"| p62_req_unpack_flag     | 0                   |
| p61_res_status                | 2  |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_res_file_length | @regexp:.* |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
@secbin @voltage @tep2 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_req_fast_download   | 1                   |
| p61_req_index_num | 1  |
Feature: Disable Voltage TEP2 Encryption Configuration
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 0  |
Scenario: Teardown - Reset to Default State
| p62_req_encoding_format | B                   |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"Feature: Disable Voltage TEP4 Encryption Configuration
Then I should receive the 61.x Configuration Read response from terminal with params:
@secbin @voltage @tep4 @msr @me @dme @emv @cless @61x @62x @00x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_res_data_config_parameter | 0  |
| p62_res_file_length | @regexp:.* |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1                   |
| p62_req_encoding_format | B                   |
| p61_res_status                | 2  |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_unpack_flag     | 0                   |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
Scenario: Disable Voltage TEP4 Encryption Configuration
| p62_res_status      | 0          |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |",Unknown
"Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p61_res_status                | 2  |
Scenario: Disable Voltage TEP4 Encryption Configuration
Then I should receive the 61.x Configuration Read response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_index_num             | 1  |
| p62_res_file_length | @regexp:.* |
| p61_req_group_num | 91 |
Feature: Disable Voltage TEP4 Encryption Configuration
| p61_res_data_config_parameter | 0  |
| p62_req_encoding_format | B                   |
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_unpack_flag     | 0                   |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
@secbin @voltage @tep4 @msr @me @dme @emv @cless @61x @62x @00x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p61_res_group_num             | 91 |
| p62_req_fast_download   | 1                   |
| p61_req_index_num | 1  |",Unknown
"| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p61_res_status                | 2  |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
Scenario: Teardown - Reset to Default State
| p62_req_fast_download   | 1                   |
| p62_res_file_length | @regexp:.* |
| p61_res_index_num             | 1  |
| p62_req_encoding_format | B                   |
| p61_res_data_config_parameter | 0  |
Feature: Disable Voltage TEP6 Encryption Configuration
Then I should receive the 62.x Write File response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
@secbin @voltage @tep6 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_res_status      | 0          |
| p62_req_unpack_flag     | 0                   |",Unknown
"| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
Scenario: Teardown - Reset to Default State
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 0  |
Feature: Disable Voltage TEP6 Encryption Configuration
| p61_req_group_num | 91 |
| p62_req_fast_download   | 1                   |
| p62_res_status      | 0          |
Then I should receive the 62.x Write File response from terminal with params:
| p61_req_index_num | 1  |
| p62_req_unpack_flag     | 0                   |
| p62_req_encoding_format | B                   |
@secbin @voltage @tep6 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_res_file_length | @regexp:.* |
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_encoding_format | B                   |
| p61_res_index_num             | 1  |
Scenario: Teardown - Reset to Default State
| p62_req_file_name       | ArcNoEncryption.apk |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
| p62_req_fast_download   | 1                   |
| p61_res_data_config_parameter | 0  |
Feature: Disable Voltage TEP7 Encryption Configuration
| p62_req_unpack_flag     | 0                   |
@secbin @voltage @tep7 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_group_num             | 91 |
| p62_res_file_length | @regexp:.* |
Then I should receive the 62.x Write File response from terminal with params:
| p61_req_index_num | 1  |
| p62_res_status      | 0          |",Unknown
"| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
Scenario: Teardown - Reset to Default State
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_data_config_parameter | 0  |
Feature: Disable Voltage TEP7 Encryption Configuration
| p62_req_encoding_format | B                   |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_res_status      | 0          |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
| p62_res_file_length | @regexp:.* |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_group_num | 91 |
@secbin @voltage @tep7 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Unknown
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:",Precondition
"Feature: Enable chapter_x Encryption Configuration
Scenario: Enable chapterX Encryption Configuration
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p61_res_status                | 2  |
| p62_req_file_name       | ArcNoEncryption.apk |
@p2p @msr @me @dme @emv @cless @secbin @chapter_x @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
Then I should receive the 62.x Write File response from terminal with params:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_group_num             | 91 |
| p62_req_unpack_flag     | 0                   |
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
| p61_req_group_num | 91 |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 0  |",Unknown
"| p61_req_index_num | 1  |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_group_num             | 91 |
| p62_req_fast_download   | 1                   |
| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_unpack_flag     | 0                   |
Feature: Enable chapter_x Encryption Configuration
| p61_res_data_config_parameter | 0  |
| p62_req_file_name       | ArcNoEncryption.apk |
| p61_req_group_num | 91 |
Scenario: Enable chapterX Encryption Configuration
| p62_res_file_length | @regexp:.* |
@p2p @msr @me @dme @emv @cless @secbin @chapter_x @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
When I send a 61.x Configuration Read message to the terminal with:
| p62_res_status      | 0          |
| p62_req_encoding_format | B                   |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"| p62_req_encoding_format | B                    |
| p62_req_file_name       | ArcSec_chapter_X.apk |
When I send a 90.x MSR Encryption message to the terminal with:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p61_res_index_num             | 1  |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
Feature: Enable On-Guard FPE Encryption Configuration
When I have successfully sent ""Files/p2p_encryptions/ArcSec_chapter_X.apk"" file using these params:
| p62_req_unpack_flag     | 0                    |
@secbin @fpe @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 30 |
Then I should receive the 61.x Configuration Read response from terminal with params:
Scenario: Enable On-Guard FPE Encryption Configuration
| p62_req_fast_download   | 1                    |
| p90_res_etb      | @regexp:.* |
| p90_req_function | 0 |
| p62_res_status      | 0            |
Then I should receive the 62.x Write File response from terminal with params:
| p90_res_status   | 0          |
| p62_res_file_length | @regexp:.\d* |",Unknown
"| p62_req_fast_download   | 1                    |
| p90_res_function | 0          |
When I send a 90.x MSR Encryption message to the terminal with:
Scenario: Enable On-Guard FPE Encryption Configuration
@secbin @fpe @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p61_req_index_num | 1  |
| p62_res_file_length | @regexp:.\d* |
Then I should receive the 62.x Write File response from terminal with params:
| p90_res_status   | 0          |
| p62_req_encoding_format | B                    |
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p90_res_etb      | @regexp:.* |
| p90_req_function | 0 |
Feature: Enable On-Guard FPE Encryption Configuration
| p61_res_data_config_parameter | 30 |
When I have successfully sent ""Files/p2p_encryptions/ArcSec_chapter_X.apk"" file using these params:
Then I should receive the 90.x MSR Encryption response from terminal with params:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_file_name       | ArcSec_chapter_X.apk |
| p62_req_unpack_flag     | 0                    |
| p62_res_status      | 0            |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_status                | 2  |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"| p62_req_encoding_format | B                 |
| p61_res_group_num             | 91 |
| p62_req_unpack_flag     | 0                 |
| p61_res_status                | 2  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_res_status      | 0           |
| p62_req_fast_download   | 1                 |
@aes128
Scenario: Enable OGSDE DUKPT with AES128 Encryption Configuration
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p61_res_data_config_parameter | 2  |
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
| p62_req_file_name       | ArcOnGuardFPE.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p61_req_group_num | 91 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
Feature: Enable On-Guard SDE DUKPT AES Encryption Configuration",Unknown
"@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
When I send a 61.x Configuration Read message to the terminal with:
Feature: Enable On-Guard SDE DUKPT AES Encryption Configuration
| p62_req_unpack_flag     | 0                 |
| p62_req_fast_download   | 1                 |
| p61_res_group_num             | 91 |
| p61_req_index_num | 1  |
| p61_req_group_num | 91 |
Scenario: Enable OGSDE DUKPT with AES128 Encryption Configuration
| p61_res_data_config_parameter | 2  |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
@aes128
| p61_res_status                | 2  |
| p62_req_encoding_format | B                 |
| p62_res_status      | 0           |
| p61_res_index_num             | 1  |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_file_name       | ArcOnGuardFPE.apk |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_res_file_length | @regexp:\d* |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"@aes192
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p62_req_unpack_flag     | 0                         |
| p61_req_index_num | 1  |
| p62_req_file_name       | ArcOnGuard-SDE-AES128.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES128.apk"" file using these params:
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p61_res_status                | 2  |
| p62_req_encoding_format | B                         |
| p62_req_fast_download   | 1                         |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
Scenario: Enable OGSDE DUKPT with AES192 Encryption Configuration
| p61_res_data_config_parameter | 19 |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:",Unknown
"| p61_res_data_config_parameter | 19 |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
| p62_req_fast_download   | 1                         |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_unpack_flag     | 0                         |
| p62_req_file_name       | ArcOnGuard-SDE-AES128.apk |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_encoding_format | B                         |
Then I should receive the 62.x Write File response from terminal with params:
Scenario: Enable OGSDE DUKPT with AES192 Encryption Configuration
| p62_res_status      | 0            |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES128.apk"" file using these params:
@aes192",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p62_req_file_name       | ArcOnGuard-SDE-AES192.apk |
| p61_res_status                | 2  |
| p61_req_index_num | 1  |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES192.apk"" file using these params:
| p62_req_unpack_flag     | 0                         |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_res_status      | 0            |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
Then I should receive the 62.x Write File response from terminal with params:
Scenario: Enable OGSDE DUKPT with AES256 Encryption Configuration
| p62_res_file_length | @regexp:.\d* |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p62_req_encoding_format | B                         |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_fast_download   | 1                         |
@aes256",Unknown
"Then I should receive the 62.x Write File response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES192.apk"" file using these params:
| p62_res_file_length | @regexp:.\d* |
| p61_req_group_num | 91 |
Scenario: Enable OGSDE DUKPT with AES256 Encryption Configuration
| p62_res_status      | 0            |
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
Then I should receive the 61.x Configuration Read response from terminal with params:
@aes256
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 19 |
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_file_name       | ArcOnGuard-SDE-AES192.apk |
| p62_req_encoding_format | B                         |
| p62_req_unpack_flag     | 0                         |
| p61_res_index_num             | 1  |
| p62_req_fast_download   | 1                         |",Unknown
"Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p62_req_unpack_flag     | 0                         |
Scenario: Enable RSA Encryption Configuration
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_fast_download   | 1                         |
Then I should receive the 61.x Configuration Read response from terminal with params:
@secbin @rsa @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_req_encoding_format | B                         |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_index_num             | 1  |
Feature: Enable RSA Encryption Configuration
| p62_res_status      | 0            |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
| p62_req_file_name       | ArcOnGuard-SDE-AES256.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES256.apk"" file using these params:
| p61_res_data_config_parameter | 19 |
| p61_res_status                | 2  |
| p62_res_file_length | @regexp:.\d* |",Unknown
"| p62_req_fast_download   | 1                         |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES256.apk"" file using these params:
| p61_res_status                | 2  |
| p62_res_status      | 0            |
| p62_req_unpack_flag     | 0                         |
Then I should receive the 61.x Configuration Read response from terminal with params:
@secbin @rsa @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_data_config_parameter | 19 |
| p61_req_index_num | 1  |
Feature: Enable RSA Encryption Configuration
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_file_name       | ArcOnGuard-SDE-AES256.apk |
| p61_req_group_num | 91 |
| p62_req_encoding_format | B                         |
Scenario: Enable RSA Encryption Configuration
| p62_res_file_length | @regexp:.\d* |
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p62_res_status      | 0           |
| p62_req_encoding_format | B               |
| p61_req_index_num | 1  |
| p62_res_file_length | @regexp:\d* |
| p62_req_fast_download   | 1               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_file_name       | ArcRSA-OAEP.apk |
Then I should receive the 61.x Configuration Read response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_status                | 2  |
| p61_req_group_num | 91 |
Scenario: Enable Voltage TEP2 Encryption Configuration
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
When I have successfully sent ""Files/p2p_encryptions/ArcRSA-OAEP.apk"" file using these params:
| p62_req_unpack_flag     | 0               |
@p2p @secbin @msr @me @dme @emv @cless @voltage @tep2 @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p61_res_data_config_parameter | 9  |
Feature: Enable Voltage TEP2 Encryption Configuration",Unknown
"| p62_req_file_name       | ArcRSA-OAEP.apk |
| p61_res_group_num             | 91 |
When I have successfully sent ""Files/p2p_encryptions/ArcRSA-OAEP.apk"" file using these params:
| p62_req_encoding_format | B               |
@p2p @secbin @msr @me @dme @emv @cless @voltage @tep2 @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
When I send a 61.x Configuration Read message to the terminal with:
| p62_req_fast_download   | 1               |
| p61_res_index_num             | 1  |
Feature: Enable Voltage TEP2 Encryption Configuration
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_data_config_parameter | 9  |
Scenario: Enable Voltage TEP2 Encryption Configuration
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
| p61_req_index_num | 1  |
| p61_res_status                | 2  |
| p61_req_group_num | 91 |",Unknown
"Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p62_req_fast_download   | 1                            |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p90_res_etb      | @regexp:.* |
| p62_req_unpack_flag     | 0                            |
| p90_res_status   | 0          |
| p62_res_file_length | @regexp:.\d* |
When I have successfully sent ""Files/p2p_encryptions/voltage_5_default-signed.apk"" file using these params:
| p90_res_function | 0          |
| p62_req_file_name       | voltage_5_default-signed.apk |
| p90_req_function | 0 |
| p61_res_index_num             | 1  |
Scenario: Enable Voltage TEP4 Encryption Configuration
| p61_res_data_config_parameter | 5  |
| p62_res_status      | 0            |
Feature: Enable Voltage TEP4 Encryption Configuration
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
| p61_req_index_num | 1  |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B                            |
| p61_res_group_num             | 91 |
When I send a 90.x MSR Encryption message to the terminal with:
When I send a 61.x Configuration Read message to the terminal with:
Then I should receive the 90.x MSR Encryption response from terminal with params:
@p2p @secbin @voltage @tep4 @msr @me @dme @emv @cless @00x @61x @62x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Unknown
"| p61_req_group_num | 91 |
| p62_req_unpack_flag     | 0                            |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_res_etb      | @regexp:.* |
| p90_res_function | 0          |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
@p2p @secbin @voltage @tep4 @msr @me @dme @emv @cless @00x @61x @62x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p62_res_file_length | @regexp:.\d* |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p62_res_status      | 0            |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p90_req_function | 0 |
Scenario: Enable Voltage TEP4 Encryption Configuration
| p62_req_file_name       | voltage_5_default-signed.apk |
| p90_res_status   | 0          |
| p62_req_fast_download   | 1                            |
Feature: Enable Voltage TEP4 Encryption Configuration
When I have successfully sent ""Files/p2p_encryptions/voltage_5_default-signed.apk"" file using these params:
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_encoding_format | B                            |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 5  |",Unknown
"| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p90_res_etb      | @regexp:.* |
| p61_req_group_num | 91 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_file_name       | voltage_6_default-signed.apk |
@p2p @secbin @voltage @tep6 @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Enable Voltage TEP6 Encryption Configuration
| p62_req_fast_download   | 1                            |
| p62_res_file_length | @regexp:\d* |
Then I should receive the 90.x MSR Encryption response from terminal with params:
Feature: Enable Voltage TEP6 Encryption Configuration
| p62_req_unpack_flag     | 0                            |
| p90_req_function | 0 |
| p61_res_status                | 2  |
| p62_req_encoding_format | B                            |
| p61_res_group_num             | 91 |
| p62_res_status      | 0           |
| p90_res_status   | 0          |
When I have successfully sent ""Files/p2p_encryptions/voltage_6_default-signed.apk"" file using these params:
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 6  |
| p90_res_function | 0          |
When I send a 61.x Configuration Read message to the terminal with:
When I send a 90.x MSR Encryption message to the terminal with:",Unknown
"| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_unpack_flag     | 0                            |
Scenario: Enable Voltage TEP6 Encryption Configuration
Then I should receive the 62.x Write File response from terminal with params:
| p90_res_status   | 0          |
| p62_req_file_name       | voltage_6_default-signed.apk |
| p62_req_encoding_format | B                            |
When I send a 61.x Configuration Read message to the terminal with:
When I have successfully sent ""Files/p2p_encryptions/voltage_6_default-signed.apk"" file using these params:
| p62_req_fast_download   | 1                            |
| p61_res_index_num             | 1  |
Feature: Enable Voltage TEP6 Encryption Configuration
When I send a 90.x MSR Encryption message to the terminal with:
| p62_res_status      | 0           |
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p62_res_file_length | @regexp:\d* |
| p90_res_function | 0          |
| p90_req_function | 0 |
@p2p @secbin @voltage @tep6 @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 6  |
| p90_res_etb      | @regexp:.* |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |",Precondition
"Given I send a 00.x Offline message to the terminal with:
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"Then I should receive the 90.x MSR Encryption response from terminal with params:
| p61_res_status                | 2  |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
| p90_req_function | 0 |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_data_config_parameter | 31 |
| p62_req_unpack_flag     | 0                             |
| p62_req_encoding_format | B                             |
| p62_res_file_length | @regexp:.\d* |
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
| p62_req_fast_download   | 1                             |
And I should receive the 62.x File Write response from terminal with params:
When I send a 61.x Configuration Read message to the terminal with:
@p2p @secbin @voltage @tep7 @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p61_req_group_num | 91 |
| p62_res_status      | 0            |
| p90_res_function | 0          |
When I send a 90.x MSR Encryption message to the terminal with:
Scenario: Enable Voltage TEP7 Encryption Configuration
| p62_req_file_name       | voltage_31_default-signed.apk |
When I have successfully sent ""Files/p2p_encryptions/voltage_31_default-signed.apk"" file using these params:
Feature: Enable Voltage TEP7 Encryption Configuration",Unknown
"When I send a 61.x Configuration Read message to the terminal with:
| p90_res_function | 0          |
| p62_res_status      | 0            |
| p90_res_status   | 0          |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
| p61_res_status                | 2  |
| p90_req_function | 0 |
| p61_res_data_config_parameter | 31 |
| p61_res_index_num             | 1  |
Scenario: Enable Voltage TEP7 Encryption Configuration
| p62_res_file_length | @regexp:.\d* |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p62_req_fast_download   | 1                             |
| p62_req_unpack_flag     | 0                             |
@p2p @secbin @voltage @tep7 @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p90_res_etb      | @regexp:.* |
When I send a 90.x MSR Encryption message to the terminal with:
And I should receive the 62.x File Write response from terminal with params:
| p61_req_index_num | 1  |
When I have successfully sent ""Files/p2p_encryptions/voltage_31_default-signed.apk"" file using these params:
| p62_req_encoding_format | B                             |
| p62_req_file_name       | voltage_31_default-signed.apk |
Feature: Enable Voltage TEP7 Encryption Configuration",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with:",Precondition
"Given I send a 00.x Offline message to the terminal with:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |",Precondition
"| p61_req_group_num | 91 |
| p90_res_status   | 0          |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_res_file_length | @regexp:.\d* |
Then I should receive the 90.x MSR Encryption response from terminal with params:
And I should receive the 62.x File Write response from terminal with params:
When I send a 90.x MSR Encryption message to the terminal with:
| p62_req_unpack_flag     | 0                             |
| p62_res_status      | 0            |
| p90_req_function | 0 |
When I have successfully sent ""Files/p2p_encryptions/voltage_32_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_32_default-signed.apk |
When I send a 61.x Configuration Read message to the terminal with:
| p90_res_etb      | @regexp:.* |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 32 |
| p61_res_index_num             | 1  |
| p62_req_encoding_format | B                             |
| p62_req_fast_download   | 1                             |
| p61_res_status                | 2  |
| p61_req_index_num | 1  |
| p90_res_function | 0          |",Unknown
"| p62_res_status      | 0            |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_data_config_parameter | 32 |
| p61_req_index_num | 1  |
| p90_res_status   | 0          |
| p62_req_fast_download   | 1                             |
And I should receive the 62.x File Write response from terminal with params:
Then I should receive the 61.x Configuration Read response from terminal with params:
When I have successfully sent ""Files/p2p_encryptions/voltage_32_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_32_default-signed.apk |
| p62_res_file_length | @regexp:.\d* |
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
| p90_res_function | 0          |
| p62_req_unpack_flag     | 0                             |
| p90_req_function | 0 |
| p62_req_encoding_format | B                             |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_res_etb      | @regexp:.* |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |",Unknown
"testlink testcase : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1230
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p61_res_group_num             | 91 |
##################select master session pin################""
| p61_req_index_num | 1  |
""""""
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Scenario Outline: Validate master session pin when encryption is off
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_data_config_parameter | 0  |
When I send a 61.x Read Configuration message to the terminal with:
Feature:  Validate  pin block decryption is correct for master session pin when encryption is off
This feature file Feature Validates master session pin when encryption is off
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_index_num             | 1  |
@pin_code @msr @00x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
""""""",Precondition
"| p00_req_reason_code | 0000 |
""""""
@pin_code @msr @00x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| p61_res_index_num             | 1  |
| p61_res_group_num             | 91 |
And I wait until Element ""imageOffline"" visible
Scenario Outline: Validate master session pin when encryption is off
This feature file Feature Validates master session pin when encryption is off
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
##################select master session pin################""
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_group_num | 91 |
| p61_res_status                | 2  |
testlink testcase : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1230
And I Wait until Element ""title"" contains ""This Lane Closed""
Feature:  Validate  pin block decryption is correct for master session pin when encryption is off
""""""
| p00_res_reason_code | 0000 |
| p61_res_data_config_parameter | 0  |
| p61_req_index_num | 1  |
When I send a 61.x Read Configuration message to the terminal with:",Precondition
"And I successfully changed configuration ""0006"" ""0007"" to ""0""",Unknown
"And I successfully changed configuration ""0006"" ""0007"" to ""0""",Unknown
"################## swipe the card #########################""
And I successfully changed configuration ""0006"" ""0008"" to ""0""",Unknown
"And I successfully changed configuration ""0006"" ""0008"" to ""0""
################## swipe the card #########################""",Unknown
"| p13_req_amount | 1000 |
| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:
When I send a 13.x amount message to the terminal with:",Send Amount
"| p13_req_amount | 1000 |
When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      |                                              |
| p23_res_exit_type   | 0                                            |
When Axium swipe magnetic card:
#################### send 31.x message for pin entry #############################
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3 |                                              |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_card_source | M                                            |",CVM Process
"| p23_res_exit_type   | 0                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
#################### send 31.x message for pin entry #############################
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      |                                              |
| track3 |                                              |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |",CVM Process
"Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |
| p29_res_status        | 2          |
| p29_req_variable_id | 000398 |",Extract Card Data
"| p29_res_variable_id   | 000398     |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | @regexp:.* |
| p29_req_variable_id | 000398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |",Extract Card Data
"############################### enter pin #############################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_prompt_index_number          | 1                                                |
| p31_res_status   | 0          |
| p31_res_pin_data | @regexp:.* |
| p31_req_form_name                    |                                                  |
################################# decrypt the enetered pin ###############################
When I send a 31.x PIN Entry message to the terminal with:
And I enter pin ""<pin_code>""
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | M                                                |",CVM Process
"| p31_req_set_key_type                 | M                                                |
################################# decrypt the enetered pin ###############################
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
############################### enter pin #############################
| p31_res_status   | 0          |
And I enter pin ""<pin_code>""
When I send a 31.x PIN Entry message to the terminal with:
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_form_name                    |                                                  |
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_req_prompt_index_number          | 1                                                |
| p31_res_pin_data | @regexp:.* |",CVM Process
"| pin_code | <pin_code>                    |
""""""
""""""
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 1133     | 4          | ffffffffff |
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-917
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 0000000000000000 | 12345    | 5          | fffffffff  |
| pinblock | 0<pin_length><pin_code><tail> |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 0000000000000000 | 0000     | 4          | ffffffffff |
@msr @23x @20x @29x @00x @13x @24x @credit
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | initial_vector   | pin_code | pin_length | tail       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 22110055 | 8          | ffffff     |
Feature: MSR Credit Signature transaction with various card brands
| tail     | <tail>                        |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 0000000000000000 | 1234     | 4          | ffffffffff |
| length   | <pin_length>                  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 0000000000000000 | 4321     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 221100   | 6          | ffffffff   |
@dx8000 @ex8000 @dx4000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
Examples:
And I will decrypt pin block M/S from 'p31_res_pin_data' using the sequence of pan: '<pan>' and initial vector '<initial_vector>' and expect:",Unknown
"""""""
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | initial_vector   | pin_code | pin_length | tail       |
| pin_code | <pin_code>                    |
| length   | <pin_length>                  |
Examples:
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 1133     | 4          | ffffffffff |
And I will decrypt pin block M/S from 'p31_res_pin_data' using the sequence of pan: '<pan>' and initial vector '<initial_vector>' and expect:
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 221100   | 6          | ffffffff   |
| pinblock | 0<pin_length><pin_code><tail> |
| tail     | <tail>                        |
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-917
@dx8000 @ex8000 @dx4000
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 0000000000000000 | 1234     | 4          | ffffffffff |
@msr @23x @20x @29x @00x @13x @24x @credit
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 0000000000000000 | 4321     | 4          | ffffffffff |
""""""
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 0000000000000000 | 12345    | 5          | fffffffff  |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 0000000000000000 | 0000     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 22110055 | 8          | ffffff     |
Feature: MSR Credit Signature transaction with various card brands",Unknown
"Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |
| p13_req_amount | <amount> |
When I send a 13.x amount message to the terminal with:",Send Amount
"| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
When I send a 23.x Card Read message to the terminal with:
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_prompt_index   | 311        |",Card Swipe
"| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |
| p23_req_prompt_index   | 311        |
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_card_source | M                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3 | <additional_data><additional_data>           |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_exit_type   | 0                                            |
When Axium swipe magnetic card:",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
| p29_req_variable_id | 000398 |
| p29_res_variable_data | <exp_date> |
| p29_req_variable_id | 000399 |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <name> |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <pan>  |
| p29_res_variable_id   | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"| p29_res_variable_data | <name> |
| p29_res_variable_id   | 000399 |
| p29_req_variable_id | 000399 |
| p29_res_variable_data | <pan>  |
| p29_res_variable_id   | 000400     |
| p29_res_status        | 2          |
| p29_req_variable_id | 000398 |
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000400 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
| p29_res_variable_data | <exp_date> |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p24_res_exit_type    | 0        |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
| p24_req_type_of_element | T                   |
| p24_res_button_state | tn_enter |
| p24_res_buttonid     | b        |
| p24_req_prompt_idx      | 10                  |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid        | \x1F     |
| p24_req_text_element_id | title               |",Display Confirmation
"| p24_res_keyid        | \x1F     |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
Then I should receive the 24.x Form Entry response from terminal with params:
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
| p24_res_exit_type    | 0        |
| p24_req_type_of_element | T                   |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |",Display Confirmation
"And I wait for 1 second
| p20_req_prompt_index | 165  |
And Draw line from 140x700 to 250x700
When Draw line from 100x800 to 200x500
Then I wait until Element ""paint_view"" visible
And Draw line from 100x800 to 200x500
| p20_req_form_name    | SIGN |
And Draw line from 200x500 to 300x800
And Draw line from 200x500 to 300x800
When I send a 20.x Signature message to the terminal with params:",Unknown
"And Draw line from 100x800 to 200x500
Then I wait until Element ""paint_view"" visible
| p20_req_prompt_index | 165  |
And Draw line from 140x700 to 250x700
And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
And Draw line from 200x500 to 300x800
| p20_req_form_name    | SIGN |
When Draw line from 100x800 to 200x500
And Draw line from 200x500 to 300x800",Unknown
"And I click Element ""btn_enter""",Unknown
"And I click Element ""btn_enter""",Unknown
"| p20_res_data   | 4 |
| p20_res_status | 0 |
Then I should receive the 20.x Signature request response from terminal with params:",Unknown
"| p20_res_status | 0 |
Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_data   | 4 |",Unknown
"When I send a 29.x Get Variable message to the terminal with params:
When I send a 29.x Get Variable message to the terminal with params:
| p29_res_variable_data | @skip_comparison |
| p29_res_variable_id   | 000701           |
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"| p29_req_variable_id | 000701 |
| p29_res_variable_data | @skip_comparison |
| p29_res_variable_id   | 000701           |
| p29_res_status        | 2                |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
| p29_res_status        | 2                |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000700           |",Extract Card Data
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p24_req_text_element_id | title             |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_prompt_idx      | 352               |
| p24_req_type_of_element | T                 |",Display Confirmation
"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"| p24_res_keyid     | \x1F |
| p24_res_exit_type | 0    |
And I should receive the 24.x Form Entry response from terminal with params:",Display Confirmation
"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid     | \x1F |
| p24_res_exit_type | 0    |",Display Confirmation
"| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
Examples:
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
@rx5000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
And I wait for 2 seconds",Unknown
"Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
And I wait for 2 seconds
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
Examples:
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
@rx5000
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |",Unknown
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:
When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |",Send Amount
"Then I should receive the 13.x amount response from terminal with params:
| p13_req_amount | <amount> |
When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |",Send Amount
"Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_prompt_index   | 311        |
| p23_req_enable_devices | M          |
When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |",Card Swipe
"When I send a 23.x Card Read message to the terminal with:
| p23_req_form_name      | read_cards |
| p23_req_prompt_index   | 311        |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_enable_devices | M          |",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_exit_type   | 0                                            |
| track3 | <additional_data><additional_data>           |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
When Axium swipe magnetic card:",Card Swipe
"| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_card_source | M                                            |
| p23_res_exit_type   | 0                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |",Card Swipe
"| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <name> |
| p29_res_status        | 2          |
| p29_res_variable_id   | 000399 |
| p29_req_variable_id | 000400 |
| p29_res_variable_id   | 000398 |
| p29_req_variable_id | 000399 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
"| p29_req_variable_id | 000400 |
| p29_res_variable_data | <exp_date> |
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <name> |
| p29_req_variable_id | 000399 |
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000398 |
| p29_res_status        | 2      |
| p29_res_status        | 2          |",Extract Card Data
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p24_req_text_element_id | title               |
| p24_res_buttonid     | b        |
| p24_req_type_of_element | T                   |
When I click Element ""btn_enter""
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
When I send a 24.x Form Entry message to the terminal with params:
Then I wait until Element ""btn_enter"" visible
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_prompt_idx      | 10                  |
| p24_res_button_state | tn_enter |",Display Confirmation
"| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |
When I send a 24.x Form Entry message to the terminal with params:
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
| p24_req_type_of_element | T                   |
| p24_req_form_number     | confirmation_amount |
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_req_prompt_idx      | 10                  |",Display Confirmation
"And I wait for 1 second
Then Draw line from 300x500 to 400x600
When I send a 20.x Signature message to the terminal with params:
Then Draw line from 200x300 to 300x400
| p20_req_prompt_index | 165  |
Then Draw line from 400x500 to 100x800
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible",Unknown
"| p20_req_prompt_index | 165  |
And I wait for 1 second
| p20_req_form_name    | SIGN |
When I send a 20.x Signature message to the terminal with params:
Then I wait until Element ""paint_view"" visible
Then Draw line from 400x500 to 100x800
Then Draw line from 200x300 to 300x400
Then Draw line from 300x500 to 400x600",Unknown
"And I click Element ""btn_enter""",Unknown
"And I click Element ""btn_enter""",Unknown
"| p20_res_data   | 3 |
Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |",Unknown
"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_data   | 3 |
| p20_res_status | 0 |",Unknown
"When I send a 29.x Get Variable message to the terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000701           |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
| p29_req_variable_id | 000700 |
| p29_res_variable_data | @skip_comparison |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_status        | 2                |",Extract Card Data
"| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000700           |
When I send a 29.x Get Variable message to the terminal with params:
| p29_res_variable_data | @skip_comparison |
| p29_res_status        | 2                |
| p29_res_status        | 2                |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000700 |
| p29_req_variable_id | 000701 |
When I send a 29.x Get Variable message to the terminal with params:",Extract Card Data
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p24_req_text_element_id | title             |
| p24_req_prompt_idx      | 352               |
| p24_req_type_of_element | T                 |
| p24_req_form_number     | status_title_only |
When I send a 24.x Form Entry message to the terminal with params:",Display Confirmation
"| p24_req_type_of_element | T                 |
| p24_req_form_number     | status_title_only |
| p24_req_text_element_id | title             |
| p24_req_prompt_idx      | 352               |
When I send a 24.x Form Entry message to the terminal with params:",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"| p24_res_keyid     | \x1F |
And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |",Display Confirmation
"| p24_res_exit_type | 0    |
And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid     | \x1F |",Display Confirmation
"| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
And I wait for 2 seconds
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
Examples:
@rx7000
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |",Unknown
"And I wait for 2 seconds
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
Examples:
@rx7000",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"When I send a 13.x amount message to the terminal with:
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |
| p13_req_amount | <amount> |",Send Amount
"| p13_res_status | 0 |
When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |
When I send a 23.x Card Read message to the terminal with:
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |",Card Swipe
"| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
| p23_req_prompt_index   | 311        |
When I send a 23.x Card Read message to the terminal with:
Then I Wait until Element ""title"" contains ""Please swipe or insert card""",Card Swipe
"And I wait until Element ""btn_cancel"" visible",Unknown
"And I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |",Card Swipe
"| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | <additional_data><additional_data>           |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
When Axium swipe magnetic card:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"| p29_res_variable_id   | 000400     |
| p29_req_variable_id | 000398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000399 |
| p29_req_variable_id | 000399 |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <exp_date> |
| p29_req_variable_id | 000400 |
| p29_res_variable_data | <pan>  |",Extract Card Data
"Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 000399 |
| p29_res_variable_id   | 000400     |
| p29_req_variable_id | 000400 |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_status        | 2          |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <name> |
| p29_res_variable_id   | 000398 |
| p29_res_variable_id   | 000399 |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <exp_date> |",Extract Card Data
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p24_res_buttonid     | b        |
| p24_req_prompt_idx      | 10                  |
| p24_req_type_of_element | T                   |
| p24_req_form_number     | confirmation_amount |
Then I wait until Element ""btn_enter"" visible
| p24_req_text_element_id | title               |
| p24_res_button_state | tn_enter |
When I send a 24.x Form Entry message to the terminal with params:
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid        | \x1F     |
| p24_res_exit_type    | 0        |
When I click Element ""btn_enter""",Display Confirmation
"Then I wait until Element ""btn_enter"" visible
| p24_req_prompt_idx      | 10                  |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_buttonid     | b        |
| p24_req_type_of_element | T                   |
| p24_req_text_element_id | title               |
| p24_res_keyid        | \x1F     |
| p24_res_button_state | tn_enter |
When I click Element ""btn_enter""
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |",Display Confirmation
"| p20_req_prompt_index | 165  |
Then Draw line from 300x400 to 1100x500
Then I wait until Element ""paint_view"" visible
Then Draw line from 200x300 to 300x400
| p20_req_form_name    | SIGN |
When I send a 20.x Signature message to the terminal with params:
Then Draw line from 600x500 to 1000x200
And I wait for 1 second",Unknown
"Then I wait until Element ""paint_view"" visible
And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then Draw line from 200x300 to 300x400
Then Draw line from 300x400 to 1100x500
Then Draw line from 600x500 to 1000x200",Unknown
"And I click Element ""btn_enter""",Unknown
"And I click Element ""btn_enter""",Unknown
"| p20_res_data   | 3 |
| p20_res_status | 0 |
Then I should receive the 20.x Signature request response from terminal with params:",Unknown
"| p20_res_data   | 3 |
Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |",Unknown
"Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_data | @skip_comparison |
| p29_req_variable_id | 000701 |
| p29_res_variable_data | @skip_comparison |
| p29_res_variable_id   | 000700           |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
| p29_res_variable_id   | 000701           |",Extract Card Data
"Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
| p29_res_variable_id   | 000701           |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
| p29_res_variable_data | @skip_comparison |
| p29_res_status        | 2                |",Extract Card Data
And I wait for 1 second,Unknown
And I wait for 1 second,Unknown
"| p24_req_text_element_id | title             |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_form_number     | status_title_only |",Display Confirmation
"| p24_req_text_element_id | title             |
| p24_req_form_number     | status_title_only |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_prompt_idx      | 352               |
| p24_req_type_of_element | T                 |",Display Confirmation
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"Then I Wait until Element ""title"" contains ""Transaction complete""",Transaction Completion
"| p24_res_exit_type | 0    |
And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid     | \x1F |",Display Confirmation
"| p24_res_exit_type | 0    |
And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_keyid     | \x1F |",Display Confirmation
"| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1031
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
This feature file validates track sentinel for msr transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1000
""""""
""""""
And I wait for 2 seconds
Feature: validate track sentinel for msr transaction
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
Scenario Outline: validate track sentinel for msr transaction
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
@msr @00x @23x @13x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Examples:",Unknown
"""""""
""""""
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
And I wait for 2 seconds
This feature file validates track sentinel for msr transaction
Examples:
Scenario Outline: validate track sentinel for msr transaction
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1031
@msr @00x @23x @13x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: validate track sentinel for msr transaction
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1000
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |",Unknown
"And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p13_req_amount | 1000 |
| p13_res_status | 0 |
And I send a 13.x amount message to the terminal with:
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"| p13_req_amount | 1000 |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |
And I send a 13.x amount message to the terminal with:",Send Amount
"| p23_req_prompt_index   | 311        |
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_form_name      | read_cards |
When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M          |",Card Swipe
"When I send a 23.x Card Read message to the terminal with:
Then I Wait until Element ""title"" contains ""Please swipe or insert card""
| p23_req_prompt_index   | 311        |
| p23_req_enable_devices | M          |
| p23_req_form_name      | read_cards |",Card Swipe
"And  I wait until Element ""btn_cancel"" visible",Unknown
"And  I wait until Element ""btn_cancel"" visible",Unknown
"When Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
################ clear tracks : track 1 starts with B , track 2 starts with pan #############
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Unknown
"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track3 | <additional_data><additional_data>           |
################ clear tracks : track 1 starts with B , track 2 starts with pan #############
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Unknown
"| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_card_source | M                                            |
| p23_res_exit_type   | 0                                            |",Card Swipe
"| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track3      | <additional_data><additional_data>           |
| p23_res_card_source | M                                            |
| p23_res_exit_type   | 0                                            |
Then I should receive the 23.x Read Card response from terminal with params:",Card Swipe
"| p29_res_variable_data | <pan>  |
| p29_res_variable_data | <exp_date> |
| p29_req_variable_id | 000398 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 |
| p29_res_variable_id   | 000398 |
Scenario: Enable On-Guard SDE Encryption Configuration
| p29_res_status        | 2      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| p29_res_variable_id   | 000399 |
Examples:
When I send a 29.x Get Variable message to the terminal with:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
Then I should receive the 29.x Get Variable response from terminal with params:
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| p29_req_variable_id | 000400 |
@sde
When I send a 29.x Get Variable message to the terminal with:
##################### validate track sentinels when encryption is ON #########################
| p29_req_variable_id | 000399 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <name> |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |",Extract Card Data
"Scenario: Enable On-Guard SDE Encryption Configuration
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000398 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <name> |
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | <exp_date> |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |
| p29_res_status        | 2      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
@sde
| p29_req_variable_id | 000398 |
| p29_res_status        | 2      |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
Examples:
| p29_res_variable_id   | 000399 |
##################### validate track sentinels when encryption is ON #########################
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <pan>  |",Extract Card Data
"| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"Then I should receive the 62.x Write File response from terminal with params:
| p62_req_unpack_flag     | 0                 |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_res_file_length | @regexp:.\d* |
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_fast_download   | 1                 |
| p62_req_encoding_format | B                 |
| p62_res_status      | 0            |",Unknown
"Then I should receive the 62.x Write File response from terminal with params:
| p62_req_unpack_flag     | 0                 |
| p62_req_encoding_format | B                 |
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_fast_download   | 1                 |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
| p61_res_group_num             | 91 |
| p00_req_reason_code | 0000 |
| p61_res_data_config_parameter | 19 |
@sde
| p61_req_group_num | 91 |
| p00_res_reason_code | 0000 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_index_num             | 1  |
Given I send a 00.x Offline message to the terminal with params:
Scenario Outline: validate start sentinel and end sentinel for 23. eft message when encryption is on
| p61_res_status                | 2  |
When I send a 61.x Read Configuration message to the terminal with:",Precondition
"When I send a 61.x Read Configuration message to the terminal with:
| p61_res_status                | 2  |
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 19 |
Given I send a 00.x Offline message to the terminal with params:
@sde
Scenario Outline: validate start sentinel and end sentinel for 23. eft message when encryption is on
| p61_req_group_num | 91 |
Then I should receive the 00.x Offline response from terminal with params:
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:",Precondition
"And  I successfully changed configuration ""0008"" ""0001"" to ""9""
And I successfully changed configuration ""0019"" ""0001"" to ""1""",Unknown
"And I successfully changed configuration ""0019"" ""0001"" to ""1""
And  I successfully changed configuration ""0008"" ""0001"" to ""9""",Unknown
"| p61_res_status                | 2  |
| p61_req_group_num | 91 |
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
When I send a 61.x Read Configuration message to the terminal with:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_data_config_parameter | 19 |
Then I should receive the 61.x Read Configuration response from terminal with params:",Unknown
"| p61_res_status                | 2  |
| p61_req_index_num | 1  |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_req_group_num | 91 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_group_num             | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |",Unknown
"| p23_req_prompt_index   | 3 |
When I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | M |
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""",Card Swipe
"Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |
When I send a 23.x Read Card message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
| p23_req_prompt_index   | 3 |",Card Swipe
"| p23_res_card_source | M                                                            |
#################Track2 : Start sentinel ; , End sentinel ?
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
#################Track 1 : Start sentinel % , End sentinel ?
When Axium swipe magnetic card:
| p23_res_track3      | @regexp:.+                                                   |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| track3 | <additional_data><additional_data>           |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"| p23_res_exit_type   | 0                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_card_source | M                                                            |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
Then I should receive the 23.x Card Read response from terminal with params:
#################Track2 : Start sentinel ; , End sentinel ?
| track3 | <additional_data><additional_data>           |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |
#################Track 1 : Start sentinel % , End sentinel ?
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:",Card Swipe
"| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
Scenario: Teardown - Reset to Default State
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
@sde
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\|<pan>=<exp_date><code><disc_data_t2><null_characters> |",Unknown
"| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          |
Scenario: Teardown - Reset to Default State
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\|<pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
@sde
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |",Unknown
"| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |",Precondition
"When I send a 61.x Configuration Read message to the terminal with:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p62_req_encoding_format | B                   |
| p61_res_status                | 2  |
| p61_res_data_config_parameter | 0  |
| p62_res_file_length | @regexp:.* |
| p61_req_group_num | 91 |
| p62_req_file_name       | ArcNoEncryption.apk |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p61_res_group_num             | 91 |
| p62_res_status      | 0          |
| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |",Unknown
"| p61_res_data_config_parameter | 0  |
| p61_res_index_num             | 1  |
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p61_req_index_num | 1  |
| p62_req_unpack_flag     | 0                   |
| p62_res_status      | 0          |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_res_file_length | @regexp:.* |
| p62_req_fast_download   | 1                   |
| p61_res_group_num             | 91 |
When I send a 61.x Configuration Read message to the terminal with:
Then I should receive the 62.x Write File response from terminal with params:
| p61_req_group_num | 91 |",Unknown
"5. Enter a correct online PIN as '111111' if required.
2. The transaction is approved.
- Test purpose and description : To validate POS is able to complete the credit transaction correctly
3. Choose 'UICC Credit'.
1. The terminal goes online to complete the transaction;
- Requirement: Mandatory
####################### Enable EMV Contact reader #######################
Scenario Outline: Instructions to cover testcase TAIS_POS_004
- Testcase contains card image issue : the value of EMV-tag ""0x9F1F"" = ""          0775""
Feature: Validate UnionPay collis testcase TAIS_POS_004
Collis reports :resources\Collis\Reports\contact\UnionPay\Functional_V202205\POS\TAIS_POS_004.zip
and terminal will only check the first digit of the service code.
@msr @collis @emv @unionpay @signature_cvm @credit @00x @13x @23x @33x @04x @09x @dx8000 @ex8000 @rx5000 @rx7000
- Card No: FT04
- Expected result/note
Teminal support the track 1 data contain Chinese characters
2. Please insert a card and select purchase function.
""""""
- Testcase does not contain EMV tag cardholder name (0x9F20)
6. Processing completion
1. Please swipe a card first and the terminal shall prompt to use a chip card.
""""""
- Amount: 400
- Testing Steps:
4. Enter ""400.00"" as transaction amount.
- Step 1. is is simulated in current Feature
Notes :",Unknown
"- Requirement: Mandatory
1. The terminal goes online to complete the transaction;
- Amount: 400
Collis reports :resources\Collis\Reports\contact\UnionPay\Functional_V202205\POS\TAIS_POS_004.zip
Feature: Validate UnionPay collis testcase TAIS_POS_004
""""""
- Testing Steps:
@msr @collis @emv @unionpay @signature_cvm @credit @00x @13x @23x @33x @04x @09x @dx8000 @ex8000 @rx5000 @rx7000
and terminal will only check the first digit of the service code.
####################### Enable EMV Contact reader #######################
""""""
- Test purpose and description : To validate POS is able to complete the credit transaction correctly
- Testcase contains card image issue : the value of EMV-tag ""0x9F1F"" = ""          0775""
Scenario Outline: Instructions to cover testcase TAIS_POS_004
2. Please insert a card and select purchase function.
1. Please swipe a card first and the terminal shall prompt to use a chip card.
- Testcase does not contain EMV tag cardholder name (0x9F20)
3. Choose 'UICC Credit'.
Teminal support the track 1 data contain Chinese characters
- Card No: FT04
- Step 1. is is simulated in current Feature
2. The transaction is approved.
- Expected result/note
6. Processing completion
5. Enter a correct online PIN as '111111' if required.
4. Enter ""400.00"" as transaction amount.
Notes :",Unknown
"And I successfully changed configuration ""0008"" ""0001"" to ""0""
| test_plan | Functional_V202205 |
| test_case | <test_case>        |
####################### Initiating Collis #######################
| brand     | UnionPay           |
When  I initiating Collis Test Case with the following params:
Given I successfully changed configuration ""0019"" ""0001"" to ""1""
And I wait 20 seconds
| interface | contact            |",Unknown
"| test_case | <test_case>        |
####################### Initiating Collis #######################
Given I successfully changed configuration ""0019"" ""0001"" to ""1""
And I successfully changed configuration ""0008"" ""0001"" to ""0""
| test_plan | Functional_V202205 |
| brand     | UnionPay           |
When  I initiating Collis Test Case with the following params:
And I wait 20 seconds
| interface | contact            |",Unknown
"Then I should receive the 00.x Offline response from terminal with params:
####################### Start Transaction #######################
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
And I send a 00.x Offline message to the terminal with params:",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
And I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
####################### Start Transaction #######################
| p00_res_reason_code | 0000 |",Precondition
"| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:
| p13_req_amount | <amount> |
When I send a 13.x amount message to the terminal with:",Send Amount
"| p13_req_amount | <amount> |
| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:
When I send a 13.x amount message to the terminal with:",Send Amount
"And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""
####################### Swipe card step #######################",Unknown
"And I wait until Element ""imageOffline"" visible
####################### Swipe card step #######################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| track2_data | <PAN>=<exp_date><code><add_data>              |
When I swipe card using this params:
When I send a 23.x Card Read message to the terminal with:
| track1_data | B<PAN>^<app_label>^<exp_date><code><add_data> |
| p23_req_prompt_index   | 312 |
| track3_data |                                               |",Card Swipe
"| p23_req_enable_devices | M   |
When I send a 23.x Card Read message to the terminal with:
When I swipe card using this params:
| p23_req_prompt_index   | 312 |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| track3_data |                                               |
| track1_data | B<PAN>^<app_label>^<exp_date><code><add_data> |
| track2_data | <PAN>=<exp_date><code><add_data>              |",Card Swipe
"When I insert card
| p23_req_form_name      | read_cards |
| p23_res_card_source | M                                             |
| p23_res_track2      | <PAN>=<exp_date><code><add_data>              |
####################### EMV Transaction flow #######################
| p23_res_track3      |                                               |
| p23_res_exit_type   | 0                                             |
| p23_req_prompt_index   | 100        |
And I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | S          |
| p23_res_track1      | B<PAN>^<app_label>^<exp_date><code><add_data> |
Then I should receive the 23.x Read Card response from terminal with params:",Card Swipe
"| p23_res_track3      |                                               |
And I send a 23.x Read Card message to the terminal with:
| p23_res_track2      | <PAN>=<exp_date><code><add_data>              |
| p23_res_exit_type   | 0                                             |
| p23_res_track1      | B<PAN>^<app_label>^<exp_date><code><add_data> |
| p23_req_prompt_index   | 100        |
When I insert card
| p23_req_enable_devices | S          |
####################### EMV Transaction flow #######################
| p23_res_card_source | M                                             |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_req_form_name      | read_cards |",Card Swipe
"| p23_res_track2      |   |
| p23_res_track3      |   |
| p23_res_card_source | S |
| p23_res_exit_type   | 0 |
| p23_res_track1      |   |
Then I should receive the 23.x Card Read response from terminal with params:",Card Swipe
"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0 |
| p23_res_card_source | S |
| p23_res_track2      |   |
| p23_res_track3      |   |
| p23_res_track1      |   |",Card Swipe
"| p33_02_res_emvh_current_packet_nbr | 0          |
| 0x5A   | Primary_Account_Number_(PAN) | <PAN>                             |
Then I Wait until Element ""title"" contains ""<app_label>\nPlease wait\nDo not remove card""
| tag    | name                         | value                             |
| p33_02_res_status                  | 00         |
And  I should receive the 33.00 Emv Transaction Initiation response from terminal with params:
| p04_req_force_payment_type | 1   |
#      | 0x9F1F | Track1_Discretionary_Data    | @regexp:[\s]{10}0775              |
| 0xFF25 | Encryption_Whitelisting_Mode | 00                                |
| 0x57   | track_2_equivalent_data      | <PAN>D<exp_date><code><add_data>F |
| p33_00_res_emvh_current_packet_nbr | 0  |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| 0x5F24 | application_expiration_date  | <exp_date>31                      |
| p33_00_req_emvh_current_packet_nbr | 0  |
| 0x9F1B | Terminal_Floor_Limit         | 00000000                          |
| p33_00_req_emvh_packet_type        | 0  |
| 0x100E | User_Language                | EN                                |
#####################################################################
| 0x9F07 | Application_Usage_Control    | FF00                              |
| 0x5F20 | cardholder_name              | UICC<test_card>                   |
When I send a 33.00 EMV Transaction Initiation message to the terminal with:
| p33_00_res_status                  | 00 |
| 0x9F1A | Terminal_Country_Code        | 0840                              |
Then  the reported ""track2_equivalent_data"" container should have the following params:
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
| p04_res_payment_type       | B   |
| p33_02_res_payload                 | @regexp:.+ |
| p04_res_amount             | 000 |
| 0x4F   | application_identifier       | <AID>02                           |
####################### 33.02 payload verification #######################
| p33_00_res_emvh_packet_type        | 0  |
| p33_02_res_emvh_packet_type        | 0          |
And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
| p04_req_payment_type       | B   |
| 0x50   | application_label            | <app_label>                       |
| 0x9F09 | Application_Version_Number   | @regexp:\d{4}                     |
| p04_req_amount             | 000 |
| 0x5F28 | Issuer_Country_Code          | 0156                              |
| p04_res_force_payment_type | 0   |
Then I should receive the 04.x Set Payment Type response from terminal with params:
| 0x5F2D | preferred_languages          | cn                                |
When I send a 04.x Set Payment Type message to the terminal with params:
| 0x84   | dedicated_file_df_name       | <AID>02                           |
| p33_00_req_status                  | 00 |",Unknown
"| p04_res_payment_type       | B   |
#####################################################################
####################### 33.02 payload verification #######################
| p33_02_res_emvh_current_packet_nbr | 0          |
| tag    | name                         | value                             |
#      | 0x9F1F | Track1_Discretionary_Data    | @regexp:[\s]{10}0775              |
| 0x9F07 | Application_Usage_Control    | FF00                              |
| 0x9F09 | Application_Version_Number   | @regexp:\d{4}                     |
| p33_02_res_payload                 | @regexp:.+ |
| 0x9F1A | Terminal_Country_Code        | 0840                              |
Then I should receive the 04.x Set Payment Type response from terminal with params:
| p33_00_res_emvh_current_packet_nbr | 0  |
| p33_00_req_status                  | 00 |
| p04_res_force_payment_type | 0   |
| p33_00_req_emvh_packet_type        | 0  |
| 0x50   | application_label            | <app_label>                       |
| 0x100E | User_Language                | EN                                |
| p04_req_amount             | 000 |
| 0x5F28 | Issuer_Country_Code          | 0156                              |
Then  the reported ""track2_equivalent_data"" container should have the following params:
| 0x5F24 | application_expiration_date  | <exp_date>31                      |
And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
| 0xFF25 | Encryption_Whitelisting_Mode | 00                                |
| 0x84   | dedicated_file_df_name       | <AID>02                           |
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
| p04_req_force_payment_type | 1   |
| p33_00_req_emvh_current_packet_nbr | 0  |
Then I Wait until Element ""title"" contains ""<app_label>\nPlease wait\nDo not remove card""
| p33_00_res_status                  | 00 |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| p33_02_res_emvh_packet_type        | 0          |
| p33_02_res_status                  | 00         |
And  I should receive the 33.00 Emv Transaction Initiation response from terminal with params:
When I send a 33.00 EMV Transaction Initiation message to the terminal with:
| 0x5F20 | cardholder_name              | UICC<test_card>                   |
| 0x4F   | application_identifier       | <AID>02                           |
| p33_00_res_emvh_packet_type        | 0  |
| 0x5A   | Primary_Account_Number_(PAN) | <PAN>                             |
| 0x57   | track_2_equivalent_data      | <PAN>D<exp_date><code><add_data>F |
| p04_req_payment_type       | B   |
When I send a 04.x Set Payment Type message to the terminal with params:
| 0x9F1B | Terminal_Floor_Limit         | 00000000                          |
| 0x5F2D | preferred_languages          | cn                                |
| p04_res_amount             | 000 |",Unknown
"Then I should receive the 13.x amount response from terminal with params:
When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |
| p13_req_amount | <amount> |",Send Amount
"Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |
| p13_req_amount | <amount> |
When I send a 13.x amount message to the terminal with:",Send Amount
"When I click Element ""btn_enter""
And I wait until Element ""btn_enter"" visible",Unknown
"And I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""",Unknown
"| 0x9F07 | Application_Usage_Control                  | FF00                              |
| 0x5F20 | cardholder_name                            | UICC<test_card>                   |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}            |
| 0x84   | dedicated_file_df_name                     | <AID>02                           |
| p33_04_res_emvh_packet_type        | 0              |
| 0xDF05 | Terminal_Action_Code_Online                | D84004F800                        |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                |
| 0x9F0F | issuer_action_code_online                  | FC689CF800                        |
#####################################################################
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                     |
| 0x5F2A | Transaction_Currency_Code                  | 0840                              |
When  I remove card
| 0x9F27 | cryptogram_information_data                | 80                                |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}            |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}            |
| 0x95   | terminal_verification_results              | 000800E000                        |
| 0x1005 | transaction_type                           | 00                                |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}            |
| p33_05_res_status                  | 00         |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                        |
| p33_05_res_emvh_packet_type        | 0          |
| 0x9C   | transaction_type (Purchase)                | 00                                |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}            |
| 0x9F07 | Application_Usage_Control                  | FF00                              |
| p33_05_res_payload                 | @regexp:.* |
| 0x9F1A | terminal_country_code                      | 0840                              |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                     |
| 0x1001 | pin_entry_required_flag                    | 0                                 |
| p09_res_transaction_type | 01 |
| 0x89   | Authorization_Code                         | 3030                              |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>02                           |
| 0x9F0D | issuer_action_code_default                 | FC609CA800                        |
When I send a 33.04 Authorization Response message to the terminal with params:
| 0x9F1B | terminal_floor_limit                       | 00000000                          |
| 0x9001 | card_entry_mode                            | C                                 |
| 0x1003 | Confirmation_Response_Code                 | A                                 |
Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| 0x50   | Application_Label                          | <app_label>                       |
| p33_04_res_status                  | 00             |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}           |
| 0x5F28 | Issuer_Country_Code                        | 0156                              |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}           |
| 0x9000 | card_payment_type                          | B                                 |
| 0x9F0D | issuer_action_code_default                 | FC609CA800                        |
#      | 0x9F1F | Track1_Discretionary_Data                  | @regexp:[\s]{10}0775              |
| p09_res_msg_version      | 02 |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                |
| 0xDF04 | Terminal_Action_Code_Denial                | 0010000000                        |
| 0x5F2A | Transaction_Currency_Code                  | 0840                              |
| tag    | name                                       | value                             |
| 0x8A   | authorisation_response_code                | 00                                |
| p09_res_card_type        | 02 |
| 0x9F1A | terminal_country_code                      | 0840                              |
| p33_04_res_emvh_current_packet_nbr | 0              |
| 0x9F27 | cryptogram_information_data                | 40                                |
| 0x100E | User_Language                              | EN                                |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300              |
| p09_res_card_status      | R  |
| 0x5F20 | cardholder_name                            | UICC<test_card>                   |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                        |
| 0x9C   | transaction_type (Purchase)                | 00                                |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                     |
| 0x84   | dedicated_file_df_name                     | <AID>02                           |
| p33_04_res_payload                 | T008A:0002:a00 |
| 0x100F | pin_entry_successful_flag                  | 0                                 |
| p33_03_req_status                  | 00         |
#      | 0x9F1F | Track1_Discretionary_Data                  | @regexp:[\s]{10}0775              |
| p33_03_req_emvh_packet_type        | 0          |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F |
| 0x9F0F | issuer_action_code_online                  | FC689CF800                        |
| 0x9A   | transaction_date                           | @regexp:\d{6}                     |
| 0x4F   | application_identifier                     | <AID>02                           |
| 0x9F33 | terminal_capabilities                      | E0F8C8                            |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                     |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                     |
| p33_03_req_emvh_current_packet_nbr | 0          |
| 0x5F24 | application_expiration_date                | <exp_date>31                      |
| p33_05_res_emvh_current_packet_nbr | 0          |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300              |
| 0x1002 | signature_required_flag                    | 1                                 |
| 0x9F1B | terminal_floor_limit                       | 00000000                          |
#####################################################################
| 0x8E   | cardholder_verification_method_cvm_list    | 00000000000000005E0342031F00      |
| 0x9F33 | terminal_capabilities                      | E0F8C8                            |
| 0x100E | User_Language                              | EN                                |
| 0x1005 | transaction_type                           | 00                                |
| 0x9001 | card_entry_mode                            | C                                 |
| 0x9F35 | terminal_type                              | 22                                |
| 0x50   | Application_Label                          | <app_label>                       |
Then the reported ""authorization_request_data"" container should have the following params:
| tag    | name                                       | value                             |
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| p33_03_req_payload                 | @regexp:.+ |
And I Wait until Element ""title"" contains ""Approved""
| 0x9000 | card_payment_type                          | B                                 |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
| 0x9F0E | issuer_action_code_denial                  | 0010000000                        |
And I wait 4 seconds
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                    |
| 0x4F   | application_identifier                     | <AID>02                           |
#Ingenico property
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}            |
| 0x1002 | signature_required_flag                    | 1                                 |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}           |
####################### 33.05 payload verification #######################
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                    |
#Ingenico property
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                |
| 0x1001 | pin_entry_required_flag                    | 0                                 |
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
| 0x9F35 | terminal_type                              | 22                                |
| 0x9A   | transaction_date                           | @regexp:\d{6}                     |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}           |
| 0xDF03 | Terminal_Action_Code_(TAC)_Default         | D84000A800                        |
| 0x100F | pin_entry_successful_flag                  | 0                                 |
| 0x5F24 | application_expiration_date                | <exp_date>31                      |
And I Wait until Element ""title"" contains ""Approved\nPlease remove card""
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                     |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>02                           |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                        |
####################### Terminal Offline #######################
Then I should receive the 09.x Set Allowed Payments response from terminal with params:
####################### 33.03 payload verification #######################
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| 0x95   | terminal_verification_results              | 000800E000                        |
| 0x5F2D | Preferred_Languages                        | cn                                |",Unknown
"| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}            |
| 0x1003 | Confirmation_Response_Code                 | A                                 |
#Ingenico property
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                    |
| 0xDF03 | Terminal_Action_Code_(TAC)_Default         | D84000A800                        |
| 0x9000 | card_payment_type                          | B                                 |
| 0x1001 | pin_entry_required_flag                    | 0                                 |
#      | 0x9F1F | Track1_Discretionary_Data                  | @regexp:[\s]{10}0775              |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                    |
| 0x1001 | pin_entry_required_flag                    | 0                                 |
| 0x4F   | application_identifier                     | <AID>02                           |
| p33_05_res_emvh_current_packet_nbr | 0          |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}           |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}           |
When I send a 33.04 Authorization Response message to the terminal with params:
| 0x9001 | card_entry_mode                            | C                                 |
#####################################################################
| p09_res_transaction_type | 01 |
| 0x4F   | application_identifier                     | <AID>02                           |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                     |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                     |
| 0x9A   | transaction_date                           | @regexp:\d{6}                     |
| 0x100F | pin_entry_successful_flag                  | 0                                 |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}           |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                     |
####################### 33.03 payload verification #######################
#      | 0x9F1F | Track1_Discretionary_Data                  | @regexp:[\s]{10}0775              |
| 0x9F0F | issuer_action_code_online                  | FC689CF800                        |
| 0x95   | terminal_verification_results              | 000800E000                        |
| 0x9C   | transaction_type (Purchase)                | 00                                |
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| 0x5F20 | cardholder_name                            | UICC<test_card>                   |
| p33_05_res_status                  | 00         |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}            |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>02                           |
| 0x9F1B | terminal_floor_limit                       | 00000000                          |
| 0x9A   | transaction_date                           | @regexp:\d{6}                     |
| tag    | name                                       | value                             |
| 0x5F24 | application_expiration_date                | <exp_date>31                      |
| tag    | name                                       | value                             |
| 0x9F0F | issuer_action_code_online                  | FC689CF800                        |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                        |
| 0x5F2D | Preferred_Languages                        | cn                                |
| 0x5F2A | Transaction_Currency_Code                  | 0840                              |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300              |
| p33_04_res_emvh_packet_type        | 0              |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                        |
| 0x89   | Authorization_Code                         | 3030                              |
| 0x9000 | card_payment_type                          | B                                 |
| 0x9F1A | terminal_country_code                      | 0840                              |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                        |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                     |
| 0x50   | Application_Label                          | <app_label>                       |
| 0x1002 | signature_required_flag                    | 1                                 |
And I Wait until Element ""title"" contains ""Approved\nPlease remove card""
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}            |
####################### 33.05 payload verification #######################
Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| p33_05_res_payload                 | @regexp:.* |
#####################################################################
| 0x8E   | cardholder_verification_method_cvm_list    | 00000000000000005E0342031F00      |
| p09_res_msg_version      | 02 |
| 0x84   | dedicated_file_df_name                     | <AID>02                           |
| p33_04_res_status                  | 00             |
| 0x9F1A | terminal_country_code                      | 0840                              |
| 0x9F1B | terminal_floor_limit                       | 00000000                          |
| 0x5F20 | cardholder_name                            | UICC<test_card>                   |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300              |
| p33_04_res_emvh_current_packet_nbr | 0              |
| 0xDF04 | Terminal_Action_Code_Denial                | 0010000000                        |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F |
When  I remove card
| p33_04_res_payload                 | T008A:0002:a00 |
| 0x9F35 | terminal_type                              | 22                                |
| p09_res_card_type        | 02 |
| 0x9F0D | issuer_action_code_default                 | FC609CA800                        |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                        |
| p33_03_req_emvh_packet_type        | 0          |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                     |
And I Wait until Element ""title"" contains ""Approved""
| 0x84   | dedicated_file_df_name                     | <AID>02                           |
| p33_05_res_emvh_packet_type        | 0          |
| 0x100E | User_Language                              | EN                                |
| p33_03_req_status                  | 00         |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                |
| p09_res_card_status      | R  |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                     |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}            |
| 0x9F33 | terminal_capabilities                      | E0F8C8                            |
| 0x100E | User_Language                              | EN                                |
| 0x9F35 | terminal_type                              | 22                                |
| 0x95   | terminal_verification_results              | 000800E000                        |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>02                           |
| 0x1005 | transaction_type                           | 00                                |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F |
Then the reported ""authorization_request_data"" container should have the following params:
#Ingenico property
| 0x9C   | transaction_type (Purchase)                | 00                                |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                |
| 0x9F07 | Application_Usage_Control                  | FF00                              |
| 0x9F33 | terminal_capabilities                      | E0F8C8                            |
####################### Terminal Offline #######################
| 0x9F27 | cryptogram_information_data                | 80                                |
| 0xDF05 | Terminal_Action_Code_Online                | D84004F800                        |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
And I wait 4 seconds
| 0x9F27 | cryptogram_information_data                | 40                                |
| 0x50   | Application_Label                          | <app_label>                       |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}            |
| 0x8A   | authorisation_response_code                | 00                                |
| p33_03_req_payload                 | @regexp:.+ |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}            |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                |
| 0x5F2A | Transaction_Currency_Code                  | 0840                              |
| 0x5F28 | Issuer_Country_Code                        | 0156                              |
| 0x1005 | transaction_type                           | 00                                |
| p33_03_req_emvh_current_packet_nbr | 0          |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}           |
| 0x9001 | card_entry_mode                            | C                                 |
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
| 0x5F24 | application_expiration_date                | <exp_date>31                      |
| 0x1002 | signature_required_flag                    | 1                                 |
Then I should receive the 09.x Set Allowed Payments response from terminal with params:
| 0x100F | pin_entry_successful_flag                  | 0                                 |
| 0x9F0D | issuer_action_code_default                 | FC609CA800                        |
| 0x9F07 | Application_Usage_Control                  | FF00                              |",Unknown
"| p00_res_reason_code | 0000 |
####################### Finalize collis #######################
| p00_req_reason_code | 0000 |
#No manual validation
When I send a 00.x Offline message to the terminal with params:
####################### Manual Validations #######################
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:
Then I should receive the 00.x Offline response from terminal with params:
####################### Finalize collis #######################
####################### Manual Validations #######################
#No manual validation",Precondition
"Then I expect Collis Test Case to be ""passed""
When I finalizing Collis Test Case as ""approved""
Examples:
| test_case    | AID            | app_label        | PAN              | test_card | exp_date | code | add_data      | amount |
| TAIS_POS_004 | A0000003330101 | UICC Credit Card | 6210948000000045 | FT04      | 3010     | 220  | 0000000000000 | 400000 |",Unknown
"When I finalizing Collis Test Case as ""approved""
Examples:
Then I expect Collis Test Case to be ""passed""
| TAIS_POS_004 | A0000003330101 | UICC Credit Card | 6210948000000045 | FT04      | 3010     | 220  | 0000000000000 | 400000 |
| test_case    | AID            | app_label        | PAN              | test_card | exp_date | code | add_data      | amount |",Unknown
"- Expected result/note
1. The terminal goes online to complete the transaction;
- The Application Label only detects the readable characters (0x5F20 = '    62      @        Cards')
""""""
- Card No: FT05
####################### Enable EMV Contact reader #######################
- Requirement: Mandatory
Collis reports :resources\Collis\Reports\contact\UnionPay\Functional_V202205\POS\TAIS_POS_005.zip
""""""
- The Application Label from the image card is : D2 F8 C1 AA 36 32 B1 EA D7 BC BF A8 40 B2 E2 CA D4 D7 A8 D3 C3 43 61 72 64 73
1.Please swipe a card first and the terminal shall prompt to use a chip card.
3. Choose 'UICC Quasi Credit'.
Feature: Validate UnionPay collis testcase TAIS_POS_005
- Test purpose and description : To validate POS is able to complete the quasi credit transaction correctly
- Cucumber does not support Chinese words
@msr @collis @emv @unionpay @signature_cvm @credit @00x @13x @23x @33x @04x @09x @dx8000 @ex8000 @rx5000 @rx7000
- Testing Steps:
- encoded using Character encoding GB 18030 (Chinese) :  62@Cards (in English : UnionPay 62 Standard Card@Test Cards)
4. Enter ""500.00"" as transaction amount.
2.Please insert a card and select purchase function.
5. Enter a correct online PIN as '111111' if required.
Scenario Outline: Instructions to cover testcase TAIS_POS_005
- Amount: 500
2. The transaction is approved.
when the application Label(Tag:50) and Application Preferred Name(Tag:9F12) contain Chinese Characters
6. Processing completion
Note :",Unknown
"Collis reports :resources\Collis\Reports\contact\UnionPay\Functional_V202205\POS\TAIS_POS_005.zip
when the application Label(Tag:50) and Application Preferred Name(Tag:9F12) contain Chinese Characters
Feature: Validate UnionPay collis testcase TAIS_POS_005
1.Please swipe a card first and the terminal shall prompt to use a chip card.
- The Application Label only detects the readable characters (0x5F20 = '    62      @        Cards')
4. Enter ""500.00"" as transaction amount.
""""""
Scenario Outline: Instructions to cover testcase TAIS_POS_005
- Cucumber does not support Chinese words
- Card No: FT05
3. Choose 'UICC Quasi Credit'.
""""""
1. The terminal goes online to complete the transaction;
2. The transaction is approved.
- Testing Steps:
- Requirement: Mandatory
- Expected result/note
2.Please insert a card and select purchase function.
- Amount: 500
- encoded using Character encoding GB 18030 (Chinese) :  62@Cards (in English : UnionPay 62 Standard Card@Test Cards)
- The Application Label from the image card is : D2 F8 C1 AA 36 32 B1 EA D7 BC BF A8 40 B2 E2 CA D4 D7 A8 D3 C3 43 61 72 64 73
Note :
@msr @collis @emv @unionpay @signature_cvm @credit @00x @13x @23x @33x @04x @09x @dx8000 @ex8000 @rx5000 @rx7000
5. Enter a correct online PIN as '111111' if required.
6. Processing completion
- Test purpose and description : To validate POS is able to complete the quasi credit transaction correctly
####################### Enable EMV Contact reader #######################",Unknown
"And I successfully changed configuration ""0008"" ""0001"" to ""0""
| brand     | UnionPay           |
And I wait 20 seconds
Given I successfully changed configuration ""0019"" ""0001"" to ""1""
| test_plan | Functional_V202205 |
| interface | contact            |
When  I initiating Collis Test Case with the following params:
####################### Initiating Collis #######################
| test_case | <test_case>        |",Unknown
"And I successfully changed configuration ""0008"" ""0001"" to ""0""
When  I initiating Collis Test Case with the following params:
| test_plan | Functional_V202205 |
| test_case | <test_case>        |
| brand     | UnionPay           |
Given I successfully changed configuration ""0019"" ""0001"" to ""1""
And I wait 20 seconds
####################### Initiating Collis #######################
| interface | contact            |",Unknown
"And I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
####################### Start Transaction #######################
And I wait until Element ""imageOffline"" visible",Precondition
"Then I should receive the 00.x Offline response from terminal with params:
####################### Start Transaction #######################
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
And I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"| p13_req_amount | <amount> |
When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:
| p13_req_amount | <amount> |",Send Amount
"And I wait until Element ""imageOffline"" visible
####################### Swipe card step #######################
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"####################### Swipe card step #######################
And I wait until Element ""imageOffline"" visible
And I Wait until Element ""title"" contains ""This Lane Closed""",Unknown
"| p23_req_prompt_index   | 312 |
| track3_data |                                               |
| p23_req_enable_devices | M   |
| track2_data | <PAN>=<exp_date><code><add_data>              |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
| track1_data | B<PAN>^<app_label>^<exp_date><code><add_data> |
When I swipe card using this params:
When I send a 23.x Card Read message to the terminal with:",Card Swipe
"When I swipe card using this params:
| p23_req_prompt_index   | 312 |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I send a 23.x Card Read message to the terminal with:
| track3_data |                                               |
| track1_data | B<PAN>^<app_label>^<exp_date><code><add_data> |
| p23_req_enable_devices | M   |
| track2_data | <PAN>=<exp_date><code><add_data>              |",Card Swipe
"| p23_res_track3      |                                               |
| p23_res_track2      | <PAN>=<exp_date><code><add_data>              |
####################### EMV Transaction flow #######################
And I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | S          |
| p23_req_form_name      | read_cards |
| p23_res_card_source | M                                             |
| p23_res_exit_type   | 0                                             |
Then I should receive the 23.x Read Card response from terminal with params:
When I insert card
| p23_res_track1      | B<PAN>^<app_label>^<exp_date><code><add_data> |
| p23_req_prompt_index   | 100        |",Card Swipe
"####################### EMV Transaction flow #######################
| p23_res_track2      | <PAN>=<exp_date><code><add_data>              |
When I insert card
| p23_res_track1      | B<PAN>^<app_label>^<exp_date><code><add_data> |
| p23_res_exit_type   | 0                                             |
| p23_req_prompt_index   | 100        |
And I send a 23.x Read Card message to the terminal with:
| p23_req_enable_devices | S          |
| p23_res_track3      |                                               |
| p23_req_form_name      | read_cards |
| p23_res_card_source | M                                             |
Then I should receive the 23.x Read Card response from terminal with params:",Card Swipe
"| p23_res_track2      |   |
| p23_res_exit_type   | 0 |
| p23_res_track1      |   |
| p23_res_card_source | S |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track3      |   |",Card Swipe
"| p23_res_card_source | S |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0 |
| p23_res_track3      |   |
| p23_res_track2      |   |
| p23_res_track1      |   |",Card Swipe
"| p33_00_req_emvh_current_packet_nbr | 0  |
| 0x4F   | application_identifier       | <AID>03                                               |
| 0x9F07 | Application_Usage_Control    | FF00                                                  |
| 0x9F09 | Application_Version_Number   | @regexp:\d{4}                                         |
| p04_req_amount             | 000 |
| p33_00_res_emvh_current_packet_nbr | 0  |
| p33_02_res_status                  | 00         |
| p33_00_req_status                  | 00 |
| 0x5F2D | preferred_languages          | zh                                                    |
| 0x5F28 | Issuer_Country_Code          | 0156                                                  |
| p04_req_force_payment_type | 1   |
| p33_00_res_status                  | 00 |
| p04_res_payment_type       | B   |
Then  the reported ""track2_equivalent_data"" container should have the following params:
| p04_res_force_payment_type | 0   |
| p04_req_payment_type       | B   |
| 0xFF25 | Encryption_Whitelisting_Mode | 00                                                    |
| 0x100E | User_Language                | EN                                                    |
| 0x9F1A | Terminal_Country_Code        | 0840                                                  |
| 0x57   | track_2_equivalent_data      | <PAN>D<exp_date><code><add_data>F                     |
####################### 33.02 payload verification #######################
| 0x9F1F | Track1_Discretionary_Data    | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
| tag    | name                         | value                                                 |
And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
Then I should receive the 04.x Set Payment Type response from terminal with params:
| p33_02_res_emvh_packet_type        | 0          |
| p33_02_res_payload                 | @regexp:.+ |
| 0x84   | dedicated_file_df_name       | <AID>03                                               |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| 0x5F24 | application_expiration_date  | <exp_date>31                                          |
| 0x5A   | Primary_Account_Number_(PAN) | <PAN>                                                 |
When I send a 04.x Set Payment Type message to the terminal with params:
| 0x5F20 | cardholder_name              | UICC<test_card>                                       |
And  I should receive the 33.00 Emv Transaction Initiation response from terminal with params:
| p33_00_req_emvh_packet_type        | 0  |
| 0x50   | application_label            | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
When I send a 33.00 EMV Transaction Initiation message to the terminal with:
#####################################################################
Then I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
| 0x9F1B | Terminal_Floor_Limit         | 00000000                                              |
| p04_res_amount             | 000 |
| p33_02_res_emvh_current_packet_nbr | 0          |
| p33_00_res_emvh_packet_type        | 0  |",Unknown
"| 0x5F20 | cardholder_name              | UICC<test_card>                                       |
| p04_req_amount             | 000 |
| 0x100E | User_Language                | EN                                                    |
| p33_00_req_status                  | 00 |
| p04_res_amount             | 000 |
| 0x84   | dedicated_file_df_name       | <AID>03                                               |
| 0x4F   | application_identifier       | <AID>03                                               |
| p33_02_res_payload                 | @regexp:.+ |
| 0x50   | application_label            | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x9F1A | Terminal_Country_Code        | 0840                                                  |
| 0x9F1B | Terminal_Floor_Limit         | 00000000                                              |
| p33_02_res_emvh_current_packet_nbr | 0          |
| p33_00_res_status                  | 00 |
Then I should receive the 04.x Set Payment Type response from terminal with params:
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
| 0x5F2D | preferred_languages          | zh                                                    |
And  I should receive the 33.00 Emv Transaction Initiation response from terminal with params:
| 0x9F1F | Track1_Discretionary_Data    | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| p33_02_res_status                  | 00         |
| 0x9F09 | Application_Version_Number   | @regexp:\d{4}                                         |
| p04_req_force_payment_type | 1   |
| p04_res_payment_type       | B   |
| p33_00_req_emvh_packet_type        | 0  |
When I send a 04.x Set Payment Type message to the terminal with params:
| 0x5F28 | Issuer_Country_Code          | 0156                                                  |
| 0xFF25 | Encryption_Whitelisting_Mode | 00                                                    |
When I send a 33.00 EMV Transaction Initiation message to the terminal with:
Then I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
| tag    | name                         | value                                                 |
| p04_res_force_payment_type | 0   |
| p33_02_res_emvh_packet_type        | 0          |
| 0x5F24 | application_expiration_date  | <exp_date>31                                          |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| p04_req_payment_type       | B   |
| 0x5A   | Primary_Account_Number_(PAN) | <PAN>                                                 |
| 0x57   | track_2_equivalent_data      | <PAN>D<exp_date><code><add_data>F                     |
#####################################################################
| p33_00_req_emvh_current_packet_nbr | 0  |
| 0x9F07 | Application_Usage_Control    | FF00                                                  |
Then  the reported ""track2_equivalent_data"" container should have the following params:
| p33_00_res_emvh_current_packet_nbr | 0  |
| p33_00_res_emvh_packet_type        | 0  |
####################### 33.02 payload verification #######################",Unknown
"| p13_req_amount | <amount> |
When I send a 13.x amount message to the terminal with:
| p13_res_status | 0 |
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"| p13_res_status | 0 |
When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:",Send Amount
"When I click Element ""btn_enter""
And I wait until Element ""btn_enter"" visible",Unknown
"When I click Element ""btn_enter""
And I wait until Element ""btn_enter"" visible",Unknown
"| 0x1001 | pin_entry_required_flag                    | 0                                                     |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>03                                               |
| 0x4F   | application_identifier                     | <AID>03                                               |
| 0x8A   | authorisation_response_code                | 00                                                    |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F                     |
When  I remove card
| p09_res_transaction_type | 01 |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}                                |
And I wait 4 seconds
| 0x9F1F | Track1_Discretionary_Data                  | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| p09_res_msg_version      | 02 |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x1002 | signature_required_flag                    | 1                                                     |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                                         |
| 0x95   | terminal_verification_results              | 000800E000                                            |
#####################################################################
| p33_05_res_payload                 | @regexp:.* |
| 0x9F1B | terminal_floor_limit                       | 00000000                                              |
| 0x1001 | pin_entry_required_flag                    | 0                                                     |
| 0x95   | terminal_verification_results              | 000800E000                                            |
| 0x5F2A | Transaction_Currency_Code                  | 0840                                                  |
| tag    | name                                       | value                                                 |
| p33_04_res_emvh_current_packet_nbr | 0              |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
Then I should receive the 09.x Set Allowed Payments response from terminal with params:
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                                         |
Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| 0x5F20 | cardholder_name                            | UICC<test_card>                                       |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F1A | terminal_country_code                      | 0840                                                  |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300                                  |
| 0x9F27 | cryptogram_information_data                | 40                                                    |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                                    |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F27 | cryptogram_information_data                | 80                                                    |
| 0x9F07 | Application_Usage_Control                  | FF00                                                  |
| 0x9F35 | terminal_type                              | 22                                                    |
| 0x5F24 | application_expiration_date                | <exp_date>31                                          |
| 0x5F2A | Transaction_Currency_Code                  | 0840                                                  |
And I Wait until Element ""title"" contains ""Approved\nPlease remove card""
| 0x9001 | card_entry_mode                            | C                                                     |
When I send a 33.04 Authorization Response message to the terminal with params:
| 0x8E   | cardholder_verification_method_cvm_list    | 00000000000000005E0342031F00                          |
| 0x9F33 | terminal_capabilities                      | E0F8C8                                                |
| p09_res_card_status      | R  |
| 0x9C   | transaction_type (Purchase)                | 00                                                    |
| 0x4F   | application_identifier                     | <AID>03                                               |
#####################################################################
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| 0x9F0D | issuer_action_code_default                 | FC6004A800                                            |
####################### Terminal Offline #######################
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                                         |
| tag    | name                                       | value                                                 |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                                            |
| 0x5F20 | cardholder_name                            | UICC<test_card>                                       |
| 0x1005 | transaction_type                           | 00                                                    |
| 0xDF05 | Terminal_Action_Code_Online                | D84004F800                                            |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                                        |
| 0x9F1A | terminal_country_code                      | 0840                                                  |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>03                                               |
| p33_03_req_payload                 | @regexp:.+ |
| 0x9F1F | Track1_Discretionary_Data                  | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| p33_05_res_emvh_current_packet_nbr | 0          |
| 0x9F33 | terminal_capabilities                      | E0F8C8                                                |
| 0x89   | Authorization_Code                         | 3030                                                  |
| 0x1005 | transaction_type                           | 00                                                    |
And I Wait until Element ""title"" contains ""Approved""
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                                            |
| 0x5F24 | application_expiration_date                | <exp_date>31                                          |
| p33_04_res_payload                 | T008A:0002:a00 |
| 0x9A   | transaction_date                           | @regexp:\d{6}                                         |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                                    |
| 0x9F35 | terminal_type                              | 22                                                    |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300                                  |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                                         |
| 0x1002 | signature_required_flag                    | 1                                                     |
| p33_03_req_emvh_packet_type        | 0          |
| 0x9F1B | terminal_floor_limit                       | 00000000                                              |
| 0x9F0F | issuer_action_code_online                  | FC6804F800                                            |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}                               |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F                     |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                                            |
| 0x5F28 | Issuer_Country_Code                        | 0156                                                  |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                                         |
| p33_04_res_emvh_packet_type        | 0              |
| p33_05_res_status                  | 00         |
| 0x100E | User_Language                              | EN                                                    |
#Ingenico property
| 0x50   | Application_Label                          | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                                        |
| 0xDF03 | Terminal_Action_Code_(TAC)_Default         | D84000A800                                            |
| p33_05_res_emvh_packet_type        | 0          |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                                    |
| 0x9F07 | Application_Usage_Control                  | FF00                                                  |
| p33_04_res_status                  | 00             |
| 0x5F2D | Preferred_Languages                        | zh                                                    |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                                         |
| 0x100E | User_Language                              | EN                                                    |
| 0x9F0F | issuer_action_code_online                  | FC6804F800                                            |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                                            |
| 0xDF04 | Terminal_Action_Code_Denial                | 0010000000                                            |
| 0x9000 | card_payment_type                          | B                                                     |
| 0x9F0D | issuer_action_code_default                 | FC6004A800                                            |
| 0x84   | dedicated_file_df_name                     | <AID>03                                               |
| 0x100F | pin_entry_successful_flag                  | 0                                                     |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                                    |
Then the reported ""authorization_request_data"" container should have the following params:
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
| 0x84   | dedicated_file_df_name                     | <AID>03                                               |
| p09_res_card_type        | 02 |
| p33_03_req_status                  | 00         |
####################### 33.05 payload verification #######################
####################### 33.03 payload verification #######################
| 0x1003 | Confirmation_Response_Code                 | A                                                     |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9A   | transaction_date                           | @regexp:\d{6}                                         |
#Ingenico property
| 0x100F | pin_entry_successful_flag                  | 0                                                     |
| 0x50   | Application_Label                          | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x9C   | transaction_type (Purchase)                | 00                                                    |
| 0x9000 | card_payment_type                          | B                                                     |
| 0x9001 | card_entry_mode                            | C                                                     |
| p33_03_req_emvh_current_packet_nbr | 0          |",Unknown
"| p33_05_res_payload                 | @regexp:.* |
| 0x9F33 | terminal_capabilities                      | E0F8C8                                                |
| p09_res_transaction_type | 01 |
| 0x9C   | transaction_type (Purchase)                | 00                                                    |
####################### 33.05 payload verification #######################
| 0x89   | Authorization_Code                         | 3030                                                  |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300                                  |
| 0x1005 | transaction_type                           | 00                                                    |
| 0x84   | dedicated_file_df_name                     | <AID>03                                               |
| 0x100E | User_Language                              | EN                                                    |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                                    |
| 0x9A   | transaction_date                           | @regexp:\d{6}                                         |
| 0x9000 | card_payment_type                          | B                                                     |
| 0x5F20 | cardholder_name                            | UICC<test_card>                                       |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>03                                               |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                                         |
| 0x5F24 | application_expiration_date                | <exp_date>31                                          |
| 0x95   | terminal_verification_results              | 000800E000                                            |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                                         |
| 0x1001 | pin_entry_required_flag                    | 0                                                     |
| p33_05_res_status                  | 00         |
| p33_04_res_emvh_current_packet_nbr | 0              |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>03                                               |
| 0x5F2D | Preferred_Languages                        | zh                                                    |
| 0x9F1B | terminal_floor_limit                       | 00000000                                              |
Then I should receive the 09.x Set Allowed Payments response from terminal with params:
| 0x5F2A | Transaction_Currency_Code                  | 0840                                                  |
| p33_05_res_emvh_current_packet_nbr | 0          |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                                    |
| tag    | name                                       | value                                                 |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                                            |
| 0xDF05 | Terminal_Action_Code_Online                | D84004F800                                            |
| 0x9F27 | cryptogram_information_data                | 80                                                    |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F0D | issuer_action_code_default                 | FC6004A800                                            |
| 0x9F0D | issuer_action_code_default                 | FC6004A800                                            |
| 0x100F | pin_entry_successful_flag                  | 0                                                     |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                                         |
| 0x95   | terminal_verification_results              | 000800E000                                            |
| 0x9000 | card_payment_type                          | B                                                     |
#####################################################################
| p09_res_msg_version      | 02 |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F                     |
| 0x9F0F | issuer_action_code_online                  | FC6804F800                                            |
| 0x5F28 | Issuer_Country_Code                        | 0156                                                  |
| 0x5F24 | application_expiration_date                | <exp_date>31                                          |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}                               |
| tag    | name                                       | value                                                 |
| 0x9001 | card_entry_mode                            | C                                                     |
| 0x9A   | transaction_date                           | @regexp:\d{6}                                         |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                                         |
| 0x1001 | pin_entry_required_flag                    | 0                                                     |
| p33_04_res_status                  | 00             |
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
| 0x1003 | Confirmation_Response_Code                 | A                                                     |
| 0x9F07 | Application_Usage_Control                  | FF00                                                  |
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| p33_03_req_emvh_packet_type        | 0          |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                                         |
| 0x84   | dedicated_file_df_name                     | <AID>03                                               |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300                                  |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                                        |
Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| 0x1002 | signature_required_flag                    | 1                                                     |
| 0x100E | User_Language                              | EN                                                    |
| 0x4F   | application_identifier                     | <AID>03                                               |
| 0x9F27 | cryptogram_information_data                | 40                                                    |
| 0x9F1A | terminal_country_code                      | 0840                                                  |
| 0x9F33 | terminal_capabilities                      | E0F8C8                                                |
| p33_05_res_emvh_packet_type        | 0          |
| 0x9F1F | Track1_Discretionary_Data                  | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| 0x9F35 | terminal_type                              | 22                                                    |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                                    |
| 0x9001 | card_entry_mode                            | C                                                     |
| 0x9F35 | terminal_type                              | 22                                                    |
| 0x9C   | transaction_type (Purchase)                | 00                                                    |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                                    |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x1002 | signature_required_flag                    | 1                                                     |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                                            |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
#####################################################################
| p33_03_req_emvh_current_packet_nbr | 0          |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}                               |
#Ingenico property
| 0x9F0F | issuer_action_code_online                  | FC6804F800                                            |
| 0x9F1B | terminal_floor_limit                       | 00000000                                              |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}                                |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
Then the reported ""authorization_request_data"" container should have the following params:
And I Wait until Element ""title"" contains ""Approved""
And I wait 4 seconds
| 0xDF04 | Terminal_Action_Code_Denial                | 0010000000                                            |
####################### Terminal Offline #######################
| 0x9F0E | issuer_action_code_denial                  | 0010000000                                            |
When I send a 33.04 Authorization Response message to the terminal with params:
| p33_04_res_payload                 | T008A:0002:a00 |
| 0x5F20 | cardholder_name                            | UICC<test_card>                                       |
| 0x50   | Application_Label                          | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x9F1A | terminal_country_code                      | 0840                                                  |
| 0x8E   | cardholder_verification_method_cvm_list    | 00000000000000005E0342031F00                          |
When  I remove card
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}                                |
| 0x5F2A | Transaction_Currency_Code                  | 0840                                                  |
| p33_04_res_emvh_packet_type        | 0              |
| 0x1005 | transaction_type                           | 00                                                    |
#Ingenico property
| p33_03_req_status                  | 00         |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                                        |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}                                |
####################### 33.03 payload verification #######################
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                                            |
| 0xDF03 | Terminal_Action_Code_(TAC)_Default         | D84000A800                                            |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                                         |
| 0x8A   | authorisation_response_code                | 00                                                    |
| p09_res_card_status      | R  |
| p09_res_card_type        | 02 |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F                     |
| 0x100F | pin_entry_successful_flag                  | 0                                                     |
And I Wait until Element ""title"" contains ""Approved\nPlease remove card""
| 0x4F   | application_identifier                     | <AID>03                                               |
| 0x9F07 | Application_Usage_Control                  | FF00                                                  |
| p33_03_req_payload                 | @regexp:.+ |
| 0x9F1F | Track1_Discretionary_Data                  | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| 0x50   | Application_Label                          | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}                               |",Unknown
"When I send a 00.x Offline message to the terminal with params:
#No manual validation
####################### Finalize collis #######################
####################### Manual Validations #######################
| p00_res_reason_code | 0000 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"#No manual validation
####################### Finalize collis #######################
####################### Manual Validations #######################
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_req_reason_code | 0000 |
When I send a 00.x Offline message to the terminal with params:",Precondition
"When I finalizing Collis Test Case as ""approved""
Examples:
This feature file validate jobs for Msr Transactions config (0091, 0054)
7 : PAN from Track2,
| test_case    | AID            | app_label        | PAN              | test_card | exp_date | code | add_data      | amount |
@sde @msr @jobs @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
10 Expiry date from Track1
2 : Track 2
14 Cardholder name from Track1
""""""
| TAIS_POS_005 | A0000003330101 | UICC Credit Card | 6210948000000052 | FT05      | 3010     | 220  | 0000000000000 | 500000 |
18 :Track1 no sentinels
Scenario: Enable On-Guard SDE Encryption Configuration and Update jobs values(7 =PAN from Track2, 2 = Track-2 data, 10 Expiry date from Track1)
""""""
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1033
0 : Track 1
11 Expiry date from Track2
Then I expect Collis Test Case to be ""passed""
19 :Track2 no sentinels
Jobs values allowed for msr:
Feature: Validate Jobs for MSR transaction
6 : PAN from Track1",Unknown
"""""""
""""""
7 : PAN from Track2,
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1033
Scenario: Enable On-Guard SDE Encryption Configuration and Update jobs values(7 =PAN from Track2, 2 = Track-2 data, 10 Expiry date from Track1)
| test_case    | AID            | app_label        | PAN              | test_card | exp_date | code | add_data      | amount |
2 : Track 2
Jobs values allowed for msr:
18 :Track1 no sentinels
This feature file validate jobs for Msr Transactions config (0091, 0054)
19 :Track2 no sentinels
@sde @msr @jobs @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
| TAIS_POS_005 | A0000003330101 | UICC Credit Card | 6210948000000052 | FT05      | 3010     | 220  | 0000000000000 | 500000 |
When I finalizing Collis Test Case as ""approved""
14 Cardholder name from Track1
Examples:
10 Expiry date from Track1
11 Expiry date from Track2
0 : Track 1
Then I expect Collis Test Case to be ""passed""
Feature: Validate Jobs for MSR transaction
6 : PAN from Track1",Unknown
"Given I send a 00.x Offline message to the terminal with params:
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_status                | 2                         |
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_config_name | ArcSec/onGuardSde/jobsMsr |
| p61_res_config_name           | ArcSec/onGuardSde/jobsMsr |
And I wait until Element ""imageOffline"" visible
| p61_res_data_config_parameter | 18,19                     |
And I Wait until Element ""title"" contains ""This Lane Closed""",Precondition
"| p61_res_data_config_parameter | 18,19                     |
When I send a 61.x Read Configuration message to the terminal with:
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2                         |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
| p61_req_config_name | ArcSec/onGuardSde/jobsMsr |
| p61_res_config_name           | ArcSec/onGuardSde/jobsMsr |
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I wait until Element ""imageOffline"" visible
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p62_req_file_name       | ArcSec.apk |
| p62_req_encoding_format | B          |
| p62_res_status      | 0            |
| p62_req_fast_download   | 1          |
| p62_req_unpack_flag     | 0          |
| p62_res_file_length | @regexp:.\d* |
When I have successfully sent ""Files/Jobs_Msr/ArcSec.apk"" file using these params:
Then I should receive the 62.x Write File response from terminal with params:",Unknown
"| p62_res_file_length | @regexp:.\d* |
| p62_req_fast_download   | 1          |
| p62_res_status      | 0            |
When I have successfully sent ""Files/Jobs_Msr/ArcSec.apk"" file using these params:
| p62_req_file_name       | ArcSec.apk |
Then I should receive the 62.x Write File response from terminal with params:
| p62_req_unpack_flag     | 0          |
| p62_req_encoding_format | B          |",Unknown
"| p61_res_group_num             | 91 |
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_status                | 2  |
And I wait until Element ""imageOffline"" visible
| p61_res_index_num             | 1  |
| p61_res_status                | 2  |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_config_name           | ArcSec/onGuardSde/jobsMsr |
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 7,2,10                    |
| p61_req_group_num | 91 |
When I send a 61.x Read Configuration message to the terminal with:
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_status                | 2                         |
| p61_res_data_config_parameter | 19 |
| p61_res_data_config_parameter | 19 |
Given I send a 00.x Offline message to the terminal with params:
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
And I wait until Element ""imageOffline"" visible
| p61_req_config_name | ArcSec/onGuardSde/jobsMsr |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_res_reason_code | 0000 |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_req_index_num | 1  |
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |",Precondition
"| p61_res_status                | 2  |
| p61_res_config_name           | ArcSec/onGuardSde/jobsMsr |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_data_config_parameter | 19 |
And I wait until Element ""imageOffline"" visible
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
Then I should receive the 00.x Offline response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
Then I should receive the 61.x Read Configuration response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_res_index_num             | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
| p61_req_group_num | 91 |
And I Wait until Element ""title"" contains ""This Lane Closed""
| p61_req_index_num | 1  |
| p61_res_data_config_parameter | 19 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_index_num | 1  |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 7,2,10                    |
| p61_req_config_name | ArcSec/onGuardSde/jobsMsr |
And I wait until Element ""imageOffline"" visible
| p00_req_reason_code | 0000 |
| p61_req_group_num | 91 |
| p61_res_group_num             | 91 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_res_status                | 2                         |
Then I should receive the 61.x Read Configuration response from terminal with params:",Precondition
"When I send a 23.x Read Card message to the terminal with:
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
And  I wait until Element ""btn_cancel"" visible",Card Swipe
"And  I wait until Element ""btn_cancel"" visible
| p23_req_prompt_index   | 3 |
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_enable_devices | M |
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
Then I should receive the 23.x Card Read response from terminal with params:
When Axium swipe magnetic card:
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_card_source | M                                                            |
| p23_res_exit_type   | 0                                                            |
| track3 | <additional_data><additional_data>           |
| p23_res_track3      | @regexp:.+                                                   |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"| p23_res_exit_type   | 0                                                            |
Then I should receive the 23.x Card Read response from terminal with params:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | @regexp:.+                                                   |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_card_source | M                                                            |
When Axium swipe magnetic card:
| track3 | <additional_data><additional_data>           |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          | lrc_val |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00                 | 4       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       | \x00\x00                 | 9       |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       | \x00\x00                 | 9       |
@msr @tep2 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
This feature file validates Voltage Encryption TEP2 for MSR Transaction.
| result | <pan>\|;<pan>=<exp_date><code><disc_data_t2>?<lrc_val>\|<exp_date><null_characters> |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 | 2       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00             | 4       |
Examples:
""""""
Scenario Outline: Voltage TEP2 Encryption for MSR transaction
Feature: Validate Voltage Encryption Tep2 for MSR Transaction
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
""""""
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       | \x00\x00                 | 6       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 | 4       |
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1228",Unknown
"| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00                 | 4       |
@msr @tep2 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario Outline: Voltage TEP2 Encryption for MSR transaction
And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
This feature file validates Voltage Encryption TEP2 for MSR Transaction.
Feature: Validate Voltage Encryption Tep2 for MSR Transaction
""""""
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 | 4       |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 | 2       |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       | \x00\x00                 | 9       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       | \x00\x00                 | 9       |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          | lrc_val |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00             | 4       |
| result | <pan>\|;<pan>=<exp_date><code><disc_data_t2>?<lrc_val>\|<exp_date><null_characters> |
Examples:
""""""
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       | \x00\x00                 | 6       |
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1228",Unknown
"| p00_res_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:",Precondition
"| p00_req_reason_code | 0000 |
Given I send a 00.x Offline message to the terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"Then I should receive the 61.x Configuration Read response from terminal with params:
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
| p23_req_prompt_index   | 3 |
| p61_res_data_config_parameter | 5  |
When I send a 23.x Read Card message to the terminal with:
| p61_req_index_num | 1  |
And  I wait until Element ""btn_cancel"" visible
| p61_res_status                | 2  |
| p61_res_index_num             | 1  |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |",Card Swipe
"| p61_res_index_num             | 1  |
| p61_req_index_num | 1  |
Then I Wait until Element ""title"" contains ""Please slide card""
| p61_res_group_num             | 91 |
| p61_res_data_config_parameter | 5  |
| p61_req_group_num | 91 |
When I send a 61.x Configuration Read message to the terminal with:
Then I should receive the 61.x Configuration Read response from terminal with params:
| p23_req_enable_devices | M |
| p61_res_status                | 2  |
And  I wait until Element ""btn_cancel"" visible
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |",Card Swipe
"| p23_res_track3      | @regexp:.* |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
When Axium swipe magnetic card:
| p23_res_exit_type   | 0          |
| p23_res_track1      | @regexp:.* |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_track2      | @regexp:.* |
| p23_res_card_source | M          |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |",Card Swipe
"| track3 | <additional_data><additional_data>           |
| p23_res_track2      | @regexp:.* |
| p23_res_exit_type   | 0          |
| p23_res_track1      | @regexp:.* |
| p23_res_card_source | M          |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | @regexp:.* |
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
Then I should receive the 23.x Card Read response from terminal with params:",Card Swipe
"| track2 | <pan>=<exp_date><code><disc_data_t2> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Unknown
"| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |",Unknown
"| p29_req_variable_id | 398 |
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |
Then I should receive the 29.x Get Variable response from terminal with params:",Extract Card Data
"| p29_res_variable_id   | 000398     |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | @regexp:.* |
| p29_res_status        | 2          |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |",Extract Card Data
"| pan | <pan> |
And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:",Unknown
"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |",Unknown
"| p29_res_variable_data | <exp_date> |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
Then I should receive the 29.x Get Variable response from terminal with params:
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| p29_res_variable_id   | 000399 |
When I send a 29.x Get Variable message to the terminal with:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| p29_res_status        | 2      |
| p29_req_variable_id | 399 |
| p29_res_variable_id   | 000400     |
Examples:
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |",Extract Card Data
"When I send a 29.x Get Variable message to the terminal with:
| p29_res_variable_data | <exp_date> |
When I send a 29.x Get Variable message to the terminal with:
Examples:
| p29_req_variable_id | 399 |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| p29_res_variable_id   | 000399 |
| p29_res_status        | 2          |
| p29_res_variable_data | <name> |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| p29_res_variable_id   | 000400     |
| p29_res_status        | 2      |
Then I should receive the 29.x Get Variable response from terminal with params:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_req_variable_id | 400 |
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |",Extract Card Data
"""""""
This feature file validates Voltage Encryption Tep4 for MSR Transaction.
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1236
Feature: Validate Voltage Encryption Tep4 for MSR Transaction
""""""
Scenario Outline: Voltage TEP4 Encryption for MSR transaction
@msr @tep4 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Unknown
"""""""
Feature: Validate Voltage Encryption Tep4 for MSR Transaction
Scenario Outline: Voltage TEP4 Encryption for MSR transaction
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1236
""""""
This feature file validates Voltage Encryption Tep4 for MSR Transaction.
@msr @tep4 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000",Unknown
"| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
And I Wait until Element ""title"" contains ""This Lane Closed""
Given I send a 00.x Offline message to the terminal with params:
| p00_res_reason_code | 0000 |",Precondition
"| p00_req_reason_code | 0000 |
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
Then I should receive the 00.x Offline response from terminal with params:
Given I send a 00.x Offline message to the terminal with params:",Precondition
"| p61_req_index_num | 1  |
| p23_req_enable_devices | M |
| p61_res_group_num             | 91 |
| p23_req_prompt_index   | 3 |
| p61_res_index_num             | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
And  I wait until Element ""btn_cancel"" visible
Then I Wait until Element ""title"" contains ""Please slide card""
| p61_res_data_config_parameter | 6  |
When I send a 61.x Configuration Read message to the terminal with:
| p61_res_status                | 2  |
When I send a 23.x Read Card message to the terminal with:
| p61_req_group_num | 91 |",Card Swipe
"| p61_res_status                | 2  |
| p61_req_index_num | 1  |
| p61_res_group_num             | 91 |
| p61_req_group_num | 91 |
| p23_req_enable_devices | M |
When I send a 61.x Configuration Read message to the terminal with:
And  I wait until Element ""btn_cancel"" visible
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 6  |
| p23_req_prompt_index   | 3 |
Then I Wait until Element ""title"" contains ""Please slide card""
When I send a 23.x Read Card message to the terminal with:",Card Swipe
"| p23_res_exit_type   | 0          |
| p23_res_track2      | @regexp:.* |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
When Axium swipe magnetic card:
| p23_res_track1      | @regexp:.* |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_card_source | M          |
| p23_res_track3      | @regexp:.* |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Card Swipe
"When Axium swipe magnetic card:
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track1      | @regexp:.* |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_card_source | M          |
| p23_res_track3      | @regexp:.* |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | @regexp:.* |
| p23_res_exit_type   | 0          |
| track3 | <additional_data><additional_data>           |",Card Swipe
"| track2 | <pan>=<exp_date><code><disc_data_t2> |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:",Unknown
"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |",Unknown
"| p29_req_variable_id | 398 |
When I send a 29.x Get Variable message to the terminal with:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_data | @regexp:.* |",Extract Card Data
"Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_data | @regexp:.* |
| p29_req_variable_id | 398 |
| p29_res_variable_id   | 000398     |
When I send a 29.x Get Variable message to the terminal with:",Extract Card Data
"| pan | <pan> |
And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:",Unknown
"| pan | <pan> |
And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:",Unknown
"| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| p29_res_variable_data | <name> |
| p29_res_variable_data | <exp_date> |
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
Examples:
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_variable_id   | 000400     |
When I send a 29.x Get Variable message to the terminal with:
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| p29_res_status        | 2          |
| p29_res_variable_id   | 000399 |
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| p29_req_variable_id | 400 |
| p29_res_status        | 2      |
| p29_req_variable_id | 399 |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |",Extract Card Data
"| p29_req_variable_id | 400 |
| p29_res_status        | 2          |
| p29_req_variable_id | 399 |
| p29_res_variable_data | <name> |
| p29_res_variable_id   | 000400     |
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
Then I should receive the 29.x Get Variable response from terminal with params:
When I send a 29.x Get Variable message to the terminal with:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| p29_res_variable_data | <exp_date> |
| p29_res_variable_id   | 000399 |
When I send a 29.x Get Variable message to the terminal with:
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| p29_res_status        | 2      |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
Then I should receive the 29.x Get Variable response from terminal with params:
Examples:",Extract Card Data
