block_label,block_content
Precondition,"@pin_code @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  dukpt pin for msr transaction when encryption is off
""""""
This feature file verify pin block decryption is correct for msr transaction when encryption is off
based on ticket https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1252
""""""
Scenario Outline: verify pin block decryption is correct for msr transaction when encryption is off
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
##################select dukpt pin################"""
Unknown,"When I send a 60.x Configuration Write message to the terminal with:
| p60_req_group_num         | 6 |
| p60_req_index_num         | 7 |
| p60_req_data_config_param | 1 |
Then I should receive the 60.x Configuration Write response from terminal with params:
| p60_res_status | 2 |
When I send a 60.x Configuration Write message to the terminal with:
| p60_req_group_num         | 6 |
| p60_req_index_num         | 8 |
| p60_req_data_config_param | 0 |"
Unknown,"Then I should receive the 60.x Configuration Write response from terminal with params:
| p60_res_status | 2 |
################## swipe the card #########################"""
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
CVM Process,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      |                                              |
#################### send 31.x message for pin entry #############################"
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1     |
| p31_req_customer_acc_num             | <pan> |
| p31_req_set_encryption_configuration | *     |
| p31_req_set_key_type                 | D     |
| p31_req_form_name                    |       |
############################### enter pin #############################
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |
################################# decrypt the enetered pin ###############################"
Unknown,"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |"
Unknown,"@41x @msr @00x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:Swipe Transaction with 41.x Card Read with parse fields
""""""
This feature file Validates MSR transaction using 41.x Card Read Request
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1160.
""""""
Scenario Outline:  Check MSR flow using 41.x (track1 ,track2)"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,Then I wait for 23 seconds
Unknown,"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |"
Unknown,And I wait for 2 seconds
Unknown,"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                            |
| p41_res_encryption      | 00                                           |
| p41_res_track_1_status  | 0                                            |
| p41_res_track_2_status  | 0                                            |
| p41_res_track_3_status  | 1                                            |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_track_3         |                                              |
| p41_res_pan             | <pan>                                        |
| p41_res_masked_pan      | <pan>                                        |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_account_name    | <name>                                       |
| p41_res_error_code      | 0                                            |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data |<name>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | pan                 | name                      | exp_date | code | disc_data_t1         | disc_data_t2  |
| MasterCard | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 122560965000469      | 965000469     |
| VISA       | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372      | 887693372     |
| AMEX 1     | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 57431313685          | 13685         |
| DISCOVER   | 6510000000000091    | CARD/IMAGE 09             | 1712     | 702  | 1000041300000        | 1000041300000 |
| Diners     | 36039667170472      | PETTITT/JO                | 0012     | 521  | 16010000000000000946 | 1000041300000 |
Scenario Outline:  Check MSR flow using 41.x (track1 only)
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,Then I wait for 3 seconds
Unknown,"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data |                                              |
| track3_data |                                              |"
Unknown,And I wait for 2 seconds
Unknown,"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                            |
| p41_res_encryption      | 00                                           |
| p41_res_track_1_status  | 0                                            |
| p41_res_track_2_status  | 1                                            |
| p41_res_track_3_status  | 1                                            |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_track_2         |                                              |
| p41_res_track_3         |                                              |
| p41_res_pan             | <pan>                                        |
| p41_res_masked_pan      | <pan>                                        |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_account_name    | <name>                                       |
| p41_res_error_code      | 0                                            |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data |<name>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | pan                 | name                      | exp_date | code | disc_data_t1         |
| MasterCard | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 122560965000469      |
| VISA       | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372      |
| AMEX 1     | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 57431313685          |
| DISCOVER   | 6510000000000091    | CARD/IMAGE 09             | 1712     | 702  | 1000041300000        |
| Diners     | 36039667170472      | PETTITT/JO                | 0012     | 521  | 16010000000000000946 |
Scenario Outline: Check MSR flow while using 41.x (track2 only)
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,Then I wait for 3 seconds
Unknown,"When I swipe card using this params:
| track1_data |                                      |
| track2_data | <pan>=<exp_date><code><disc_data_t2> |
| track3_data |                                      |"
Unknown,And I wait for 2 seconds
Unknown,"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                    |
| p41_res_encryption      | 00                                   |
| p41_res_track_1_status  | 1                                    |
| p41_res_track_2_status  | 0                                    |
| p41_res_track_3_status  | 1                                    |
| p41_res_track_1         |                                      |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2> |
| p41_res_track_3         |                                      |
| p41_res_pan             | <pan>                                |
| p41_res_masked_pan      | <pan>                                |
| p41_res_expiration_date | <exp_date>                           |
| p41_res_account_name    |                                      |
| p41_res_error_code      | 0                                    |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data |        |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | pan              | name                      | exp_date | code | disc_data_t2  |
| MasterCard | 45358179327829   | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707  | 965000469     |
| VISA       | 34798979016630   | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 823693372     |
| AMEX 1     | 37158413190797   | YYBROXFQJRXJW/EVXOV       | 2001     | 442  | 13685         |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09             | 1712     | 702  | 1000041300000 |
| Diners     | 36039667170472   | PETTITT/JO                | 0012     | 521  | 1000041300000 |"
Unknown,"@sde @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate On-Guard SDE Encryption for MSR transaction with 1 only track card data
""""""
This feature file validates Validate On-Guard SDE Encryption for MSR transaction with one track only card data
based on ticket ARC-5325
""""""
Scenario: Enable On-Guard SDE Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |"
Precondition,"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track1 data
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 |                                              |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      |                                                              |
| p23_res_track3      | @regexp:.+                                                   |"
Unknown,"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | masked_pan       | masked_disc_data_t1          | null_characters          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 5413330000000011 | 000000000000000              | \x00\x00\x00\x00\x00\x00 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 374245000001008  | 000000000                    | \x00\x00\x00\x00         |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 4264510000005621 | 0000000000000000000000000000 |                          |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 6510000000000091 | 0000000000000                | \x00\x00\x00\x00         |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 36039600000472   | 00000000000000000000         | \x00\x00                 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track2 data"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 |                                      |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| track3 |                                      |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                    |
| p23_res_card_source | M                                                    |
| p23_res_track1      |                                                      |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>? |
| p23_res_track3      | @regexp:.+                                           |"
Unknown,"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | <pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | exp_date | code | disc_data_t2   | masked_pan       | masked_disc_data_t2 | null_characters      |
| Mastercard | 5413330089020011 | 2412     | 221  | 0000014000001  | 5413330000000011 | 0000000000000       | \x00\x00\x00         |
| Amex       | 374245001731008  | 2103     | 201  | 15041234500000 | 374245000001008  | 00000000000000      | \x00\x00\x00         |
| VISA       | 4264510228395621 | 1709     | 206  | 0000070400100  | 4264510000005621 | 0000000000000       | \x00\x00\x00         |
| DISCOVER   | 6510000000000091 | 1712     | 702  | 1000041300000  | 6510000000000091 | 0000000000000       | \x00\x00\x00         |
| Diners     | 36039667170472   | 0012     | 521  | 1000041300000  | 36039600000472   | 0000000000000       | \x00\x00\x00\x00\x00 |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@p2p @chapter_x @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: validate chapter X Decryption
""""""
This feature file validates chapterX Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1348
""""""
Scenario Outline: chapter X Encryption For MSR Transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
Unknown,"And decrypted field 'p23_res_track3' with Chapter X algorithm should match the following data:
| ret                 | 00                                                         |
| ez_track2_decrypted | <pan>D<exp_date><code><disc_data_t2><null_characters>      |
| ey_track1_decrypted | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>.+$ |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000000000000     | 0000000000000       | FFFFFFFFFFF     |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | FFFFFFFFFFF     |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | FFFFFFFFFFF     |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | FFFFFFFFFFF     |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | FFFFFFFFFFFFF   |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       | FFFFFFFFFFF     |
| Mastercard | 541389099130     | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 541389000130     | 00000000000000000000         | 0000000000000       | FFFFFFFFFFFFFFF |
@msr @fpe @00x @61x @23x @62x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate On Guard FPE Encryption for MSR Transaction
""""""
This feature file validates On Guard FPE Encryption For MSR Transaction
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-993.
""""""
Scenario Outline: On-Guard FPE Encryption For MSR Transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
Unknown,"And decrypted field ""p23_res_track3"" with ON GUARD algorithm should match the following MSR data:
| track2 | <pan>=<exp_date><code><disc_data_t2> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |
@sde @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate On-Guard SDE Encryption for MSR transaction
""""""
This feature file validates On-Guard SDE Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-985
""""""
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
#Step 5"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
Unknown,"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\|<pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |                          |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |                          |
@rsa @msr @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate RSA Encryption for MSR transaction
""""""
This feature file validates RSA Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1313
""""""
Scenario Outline: RSA Encryption For MSR Transaction
#Step 5"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
Unknown,"When RSA OAEP algorithm private key is set to 'Files\p2p_encryptions\private_RSA_key\private_verify_key.pem'
Then raw field 'p23_res_track3' with RSA OAEP algorithm should have the following attributes:
| cryptogram_length | 344 |
And decrypted field 'p23_res_track3' with RSA OAEP algorithm should match '%B<pan>^<name>^<exp_date><code><disc_data_t1>?;<pan>=<exp_date><code><disc_data_t2>?'
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000000000000     | 0000000000000       |                          |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |                          |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |                          |
@sde @msr @00x @62x @61x @23x
Feature: Validate separator of On-Guard SDE Encryption for Manual Entry transaction
""""""
This feature file validates separator of On-Guard SDE Encryption for Manual Entry transaction
based on ticket    https://ingenico-nar.atlassian.net/browse/ARC-1299
Note : ArcSec.json used in current FF is the version from DefaultConfig of ARC Build ""arc-app-23.09.03-0001""
""""""
@dx8000 @ex8000 @dx4000
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
##################### Enable Onguard_SDE with specific separator #####################
And a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
##################### ########################################## #####################"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
##################### Verify Onguard_SDE enabled #####################
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
##################### ##################### #####################"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 372 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Card""
And  I wait until Element ""btn_cancel"" visible
And  I wait until Element ""btn_manual_entry"" visible"
Unknown,"When I click Element ""btn_manual_entry""
##################### Enter card details #####################
And I click Element ""ed_pan"""
Unknown,"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"And I click Element ""ed_expiry_date"""
Unknown,"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button"
Unknown,"And I click Element ""ed_cvv"""
Unknown,"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"And I click Element ""btn_manual_confirm"""
Card Swipe,"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                             |
| p23_res_card_source | H                                                             |
| p23_res_track1      | %M<masked_pan>^<name>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.{1,92}                                               |"
Unknown,"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | <pan><separator><expect_exp_date><separator><code><null_characters> |
Examples:
| card_type  | pan                 | name             | exp_date | expect_exp_date | code | masked_pan          | masked_disc_data_t1 | masked_disc_data_t2 | null_characters              | separator | ASCII |
| Mastercard | 5413332389          | MANUALLY/ENTERED | 1224     | 2412            | 221  | 5413330009          | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | #         | 23    |
| Amex       | 374245001748        | MANUALLY/ENTERED | 1225     | 2512            | 201  | 374245000748        | 000000000000000     | 000000000000        | \x00\x00\x00                 | ;         | 3B    |
| VISA       | 42645122835621      | MANUALLY/ENTERED | 1227     | 2712            | 206  | 42645100005621      | 000000000000000     | 000000000000        | \x00                         | \|        | 7C    |
| DISCOVER   | 6510000000352591    | MANUALLY/ENTERED | 1227     | 2712            | 702  | 6510000000002591    | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00\x00 | %         | 25    |
| Diners     | 36039667176631472   | MANUALLY/ENTERED | 1228     | 2812            | 521  | 36039600000001472   | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00     | &         | 26    |
| VISA       | 476173900101012010  | MANUALLY/ENTERED | 1229     | 2912            | 201  | 476173000000002010  | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | \x20      | 20    |
| JCB        | 3569990010745082211 | MANUALLY/ENTERED | 1225     | 2512            | 601  | 3569990000000002211 | 000000000000000     | 000000000000        | \x00\x00\x00\x00             | ,         | 2C    |
| Mastercard | 5413330089099130    | MANUALLY/ENTERED | 1226     | 2612            | 201  | 5413330000009130    | 000000000000000     | 000000000000        | \x00                         |           | empty |
@rx5000 @rx7000
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
##################### Enable Onguard_SDE with specific separator #####################
And a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
##################### ########################################## #####################"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
##################### Verify Onguard_SDE enabled #####################
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
##################### ##################### #####################"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 372 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Card""
And  I wait until Element ""btn_cancel"" visible
And  I wait until Element ""btn_manual_entry"" visible"
Unknown,"When I click Element ""btn_manual_entry""
##################### Enter card details #####################
And I click Element ""ed_pan"""
Unknown,"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"And I click Element ""ed_expiry_date"""
Unknown,"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button"
Unknown,"And I click Element ""ed_cvv"""
Unknown,"And I send keys to Element ""ed_cvv"" text ""<code>"" and then ENTER"
Card Swipe,"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                             |
| p23_res_card_source | H                                                             |
| p23_res_track1      | %M<masked_pan>^<name>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.{1,92}                                               |"
Unknown,"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | <pan><separator><expect_exp_date><separator><code><null_characters> |
Examples:
| card_type  | pan                 | name             | exp_date | expect_exp_date | code | masked_pan          | masked_disc_data_t1 | masked_disc_data_t2 | null_characters              | separator | ASCII |
| Mastercard | 5413332389          | MANUALLY/ENTERED | 1224     | 2412            | 221  | 5413330009          | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | #         | 23    |
| Amex       | 374245001748        | MANUALLY/ENTERED | 1225     | 2512            | 201  | 374245000748        | 000000000000000     | 000000000000        | \x00\x00\x00                 | ;         | 3B    |
| VISA       | 42645122835621      | MANUALLY/ENTERED | 1227     | 2712            | 206  | 42645100005621      | 000000000000000     | 000000000000        | \x00                         | \|        | 7C    |
| DISCOVER   | 6510000000352591    | MANUALLY/ENTERED | 1227     | 2712            | 702  | 6510000000002591    | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00\x00 | %         | 25    |
| Diners     | 36039667176631472   | MANUALLY/ENTERED | 1228     | 2812            | 521  | 36039600000001472   | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00\x00     | &         | 26    |
| VISA       | 476173900101012010  | MANUALLY/ENTERED | 1229     | 2912            | 201  | 476173000000002010  | 000000000000000     | 000000000000        | \x00\x00\x00\x00\x00         | \x20      | 20    |
| JCB        | 3569990010745082211 | MANUALLY/ENTERED | 1225     | 2512            | 601  | 3569990000000002211 | 000000000000000     | 000000000000        | \x00\x00\x00\x00             | ,         | 2C    |
| Mastercard | 5413330089099130    | MANUALLY/ENTERED | 1226     | 2612            | 201  | 5413330000009130    | 000000000000000     | 000000000000        | \x00                         |           | empty |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Teardown - Reset to Default State
Given a existing file ""Files/p2p_encryptions/ArcNoEncryption.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"@msr @tep6 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Voltage Encryption Tep6 for MSR Transaction
""""""
This feature file validates Voltage Encryption TEP6 for MSR Transaction.
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1266
""""""
Scenario Outline: Voltage TEP6 Encryption for MSR transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
And I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 31 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |"
Unknown,"Then I Wait until Element ""title"" contains ""Please slide card"""
Card Swipe,"And  I wait until Element ""btn_cancel"" visible
#this step is equivalent to the manual swipe of a card
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |"
Unknown,"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |"
Unknown,"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
#  | Maestro    | 501833000060       | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
#issue is when pan=12 digits to be checked"
Unknown,"@msr @tep7 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Voltage Encryption Tep7 for MSR Transaction
""""""
This feature file validates Voltage Encryption TEP7 for MSR Transaction.
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1309
""""""
Scenario Outline: Voltage TEP7 Encryption for MSR transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
And I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
And I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 32 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |"
Unknown,"Then I Wait until Element ""title"" contains ""Please slide card"""
Card Swipe,"And  I wait until Element ""btn_cancel"" visible
#this step is equivalent to the manual swipe of a card
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |"
Unknown,"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
And I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |"
Unknown,"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
#  | Maestro    | 501833000060        | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
#issue is when pan=12 digits to be checked"
Precondition,"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: change weak pin with a strong entered pin with msr transaction
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1384
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and change weak pin with a strong entered pin
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################"
Unknown,"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Unknown,And I wait for 1 second
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |"
Unknown,"#And I Wait until Element ""fixed_title"" contains ""Please enter your PIN:"""
Unknown,"And I enter pin ""<weak_pin>""
######################## enter the new strong pin #####################"
Unknown,And I wait for 4 seconds
Unknown,"And I enter pin ""<strong_pin>""
################### validate the new strong pin #######################"
Unknown,And I wait for 4 seconds
CVM Process,"And I enter pin ""<strong_pin>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |"
Unknown,"And I Wait until Element ""fixed_title"" contains ""Please reenter your 4-digit PIN""
################# variable is back to false after pin change ##########################"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | false  |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |"
Precondition,"@pin_code @master_session @sde @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when SDE is enabled
""""""
This feature file verify pin block decryption is correct when SDE is enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable On-Guard SDE Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |"
Precondition,"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
Scenario Outline: verify pin block decryption is correct with masked pan
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+:4:.+                                              |"
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1            |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_set_encryption_configuration | 0            |
| p31_req_set_key_type                 | *            |
| p31_req_form_name                    |              |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |"
Unknown,"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Extract Card Data,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@00x @29x @60x @23x @87x @41x
Feature: verify message 29.x of variables 396 398 399 400
""""""
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
""""""
@dx8000 @ex8000 @dx4000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400
Given I successfully changed configuration ""0007"" ""0029"" to ""1"""
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card"""
Unknown,"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible"
Unknown,"And I click Element ""btn_manual_entry""
When I click Element ""ed_pan"""
Unknown,"Then I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"When I click Element ""ed_cvv"""
Unknown,"Then I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"When I click Element ""ed_expiry_date"""
Unknown,"Then I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button"
Unknown,"When I click Element ""btn_manual_confirm"""
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                     |
| p23_res_card_source | H                                                                     |
| p23_res_track1      | M<pan>^<cardholdername>^<expect_exp_date><add_data1><code><add_data1> |
| p23_res_track2      | <pan>=<expect_exp_date><add_data1><code><add_data2>                   |
| p23_res_track3      |                                                                       |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | add_data2 | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | 000       | MANUALLY/ENTERED |
@rx5000 @rx7000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400"
Unknown,"Given I successfully changed configuration ""0007"" ""0029"" to ""1"""
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card"""
Unknown,"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible"
Unknown,"And I click Element ""btn_manual_entry""
When I click Element ""ed_pan"""
Unknown,"Then I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"When I click Element ""ed_cvv"""
Unknown,"Then I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"When I click Element ""ed_expiry_date"""
Card Swipe,"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                     |
| p23_res_card_source | H                                                                     |
| p23_res_track1      | M<pan>^<cardholdername>^<expect_exp_date><add_data1><code><add_data1> |
| p23_res_track2      | <pan>=<expect_exp_date><add_data1><code><add_data2>                   |
| p23_res_track3      |                                                                       |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | add_data2 | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | 000       | MANUALLY/ENTERED |
@dx8000 @ex8000 @dx4000 @me
Scenario Outline: Manual entry transaction with 87.x and 29.x message to verify variables 396 398 399 400"
Unknown,"Given I successfully changed configuration ""0007"" ""0029"" to ""1"""
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 1          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible"
Unknown,"And I click Element ""btn_manual_entry""
When I click Element ""ed_pan"""
Unknown,"Then I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"When I click Element ""ed_cvv"""
Unknown,"Then I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"When I click Element ""ed_expiry_date"""
Unknown,"Then I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button"
Unknown,"When I click Element ""btn_manual_confirm"""
Unknown,"Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                        |
| p87_res_card_source | H                                                                        |
| p87_res_card_data   | @regexp:^M<pan>\^<cardholdername>\^<expect_exp_date><add_data1><code>.*$ |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | MANUALLY/ENTERED |
@rx5000 @rx7000 @me
Scenario Outline: Manual entry transaction with 87.x and 29.x message to verify variables 396 398 399 400"
Unknown,"Given I successfully changed configuration ""0007"" ""0029"" to ""1"""
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 1          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible"
Unknown,"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan"""
Unknown,"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"When I click Element ""ed_cvv"""
Unknown,"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"When I click Element ""ed_expiry_date"""
Unknown,"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER"
Unknown,"Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                        |
| p87_res_card_source | H                                                                        |
| p87_res_card_data   | @regexp:^M<pan>\^<cardholdername>\^<expect_exp_date><add_data1><code>.*$ |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | add_data1 | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000    | MANUALLY/ENTERED |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Scenario Outline: MSR transaction with 23.x and 29.x message to verify variables 394 395 396 398 399 400"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And  I wait until Element ""btn_cancel"" visible"
Unknown,"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |"
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      |                                              |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | amount | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  |
| Mastercard | 120    | 5413339000000119 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Scenario Outline: MSR transaction with 41.x and 29.x message to verify variables 394 395 396 398 399 400"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,Then I wait for 23 seconds
Unknown,"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |"
Unknown,And I wait for 2 seconds
Unknown,"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                            |
| p41_res_encryption      | 00                                           |
| p41_res_track_1_status  | 0                                            |
| p41_res_track_2_status  | 0                                            |
| p41_res_track_3_status  | 1                                            |
| p41_res_track_1         | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_track_2         | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_track_3         |                                              |
| p41_res_pan             | <pan>                                        |
| p41_res_masked_pan      | <pan>                                        |
| p41_res_expiration_date | <exp_date>                                   |
| p41_res_account_name    | <name>                                       |
| p41_res_error_code      | 0                                            |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type | pan              | name          | exp_date | code | disc_data_t1  | disc_data_t2  |
| DISCOVER  | 6510000000000091 | CARD/IMAGE 09 | 1712     | 702  | 1000041300000 | 1000041300000 |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Scenario Outline: MSR transaction with 87.x and 29.x message to verify variables 394 395 396 398 399 400"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Unknown,"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                                                    |
| p87_res_card_source | M                                                                                                    |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 0      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type | pan            | name                      | exp_date | code | disc_data_t1    | disc_data_t2 |
| VISA      | 34798979016630 | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885  | 131026887693372 | 887693372    |"
Unknown,"@sde @msr @00x @60x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate track encryption indicator values
""""""
This feature file validates track encryption indicator with its values for msr track1 , track2 , track1&2
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1800
""""""
Scenario: Enable On-Guard SDE Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |"
Precondition,"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track1 data and track encryption indicator =1
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 |                                              |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      |                                                              |
| p23_res_track3      | @regexp:.+:1:.+                                              |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | masked_pan       | masked_disc_data_t1          | null_characters          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 5413330000000011 | 000000000000000              | \x00\x00\x00\x00\x00\x00 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 374245000001008  | 000000000                    | \x00\x00\x00\x00         |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 4264510000005621 | 0000000000000000000000000000 |                          |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 6510000000000091 | 0000000000000                | \x00\x00\x00\x00         |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 36039600000472   | 00000000000000000000         | \x00\x00                 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with only track2 data and track encryption indicator = 2"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 |                                      |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| track3 |                                      |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                    |
| p23_res_card_source | M                                                    |
| p23_res_track1      |                                                      |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>? |
| p23_res_track3      | @regexp:.+:2:.+                                      |
Examples:
| card_type  | pan              | exp_date | code | disc_data_t2   | masked_pan       | masked_disc_data_t2 | null_characters      |
| Mastercard | 5413330089020011 | 2412     | 221  | 0000014000001  | 5413330000000011 | 0000000000000       | \x00\x00\x00         |
| Amex       | 374245001731008  | 2103     | 201  | 15041234500000 | 374245000001008  | 00000000000000      | \x00\x00\x00         |
| VISA       | 4264510228395621 | 1709     | 206  | 0000070400100  | 4264510000005621 | 0000000000000       | \x00\x00\x00         |
| DISCOVER   | 6510000000000091 | 1712     | 702  | 1000041300000  | 6510000000000091 | 0000000000000       | \x00\x00\x00         |
| Diners     | 36039667170472   | 0012     | 521  | 1000041300000  | 36039600000472   | 0000000000000       | \x00\x00\x00\x00\x00 |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction with track1 and track2 data and track encryption indicator =4"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+:4:.+                                              |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Precondition,"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate an invalid PIN change where the cardholder will enter the same weak PIN in the first and second attempt
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1385
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter the same weak PIN in the first and second attempt.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder will enter the same weak PIN in the first and second attempt
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################"
Unknown,"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Unknown,And I wait for 1 second
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>""
######################## enter the same weak pin again #####################"
Unknown,And I wait for 4 seconds
CVM Process,"And I enter pin ""<weak_pin>""
####### 31.x should return A because the second pin entry is same as the first weak pin entered################### #######################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | A |
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |"
Unknown,"@41x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Swipe non standard cards
""""""
This feature file Validates MSR transaction For Non Standard Card using 41.x Card Read Request
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1208
""""""
Scenario Outline: Check MSR flow while using Non-Standard cards with two tracks(track1 ,track2)"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,And I wait for 2 seconds
Unknown,"And I swipe card using this params:
| track1_data | <track1_data> |
| track2_data | <track2_data> |
| track3_data |               |"
Unknown,And I wait 3 seconds
Unknown,"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M             |
| p41_res_encryption      | 00            |
| p41_res_track_1_status  | 0             |
| p41_res_track_2_status  | 0             |
| p41_res_track_3_status  | 1             |
| p41_res_track_1         | <track1_data> |
| p41_res_track_2         | <track2_data> |
| p41_res_track_3         |               |
| p41_res_pan             | <pan>         |
| p41_res_masked_pan      | <masked_pan>  |
| p41_res_expiration_date | <exp_date>    |
| p41_res_account_name    | <name>        |
| p41_res_error_code      | 0             |"
Precondition,"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Examples:
| type                                                             | track1_data                                                     | track2_data                            | track1_res                                                      | track2_res                             | pan                    | masked_pan             | exp_date | name                |
| NonStandard card -- ISO parser                                   | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | 4147200000002105       | 4147200000002105       | 2603     |                     |
| NonStandard card -- Track 1 and Track 2 pan-only                 | 1234567890123456                                                | 1234567890123456                       | 1234567890123456                                                | 1234567890123456                       | 1234567890123456       | 1234567890123456       |          |                     |
| NonStandard card -- Non Payment card                             | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 0000198800001234560011 | 0000198800001234560011 | 2012     |                     |
| NonStandard card -- FDMS TEST CARD/VISA modified without exp-dat | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | 4000620001234803       | 4000620001234803       |          | FDMS TEST CARD/VISA |
Scenario Outline: Check MSR flow while using Non-Standard cards with track1 only
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I send a 41.x Card Read Message message to the terminal with:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,And I wait for 2 seconds
Unknown,"And I swipe card using this params:
| track1_data | <track1_data> |
| track2_data |               |
| track3_data |               |"
Unknown,And I wait 3 seconds
Unknown,"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M             |
| p41_res_encryption      | 00            |
| p41_res_track_1_status  | 0             |
| p41_res_track_2_status  | 1             |
| p41_res_track_3_status  | 1             |
| p41_res_track_1         | <track1_data> |
| p41_res_track_2         |               |
| p41_res_track_3         |               |
| p41_res_pan             | <pan>         |
| p41_res_masked_pan      | <masked_pan>  |
| p41_res_expiration_date |               |
| p41_res_account_name    |               |
| p41_res_error_code      | 0             |"
Precondition,"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Examples:
| type                                 | track1_data                        | track1_res                         | pan                         | masked_pan                  | exp_date | name |
| NonStandard Card -- Track 1 pan-only | 1234567890123456                   | 1234567890123456                   | 1234567890123456            | 1234567890123456            | 2603     |      |
| NonStandard Card -- Non Payment card | 10063576813       1234567890123456 | 10063576813       1234567890123456 | 100635768131234567890123456 | 100635768131234567890123456 |          |      |
| NonStandard Card -- Track 1 pan-only | 5413339000000119                   | 5413339000000119                   | 5413339000000119            | 5413339000000119            | 2012     |      |
Scenario Outline: Check MSR flow while using Non-Standard cards with track2 only
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,And I wait for 2 seconds
Unknown,"And I swipe card using this params:
| track1_data |               |
| track2_data | <track2_data> |
| track3_data |               |
Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M             |
| p41_res_encryption      | 00            |
| p41_res_track_1_status  | 1             |
| p41_res_track_2_status  | 0             |
| p41_res_track_3_status  | 1             |
| p41_res_track_1         |               |
| p41_res_track_2         | <track2_data> |
| p41_res_track_3         |               |
| p41_res_pan             | <pan>         |
| p41_res_masked_pan      | <masked_pan>  |
| p41_res_expiration_date | <exp_date>    |
| p41_res_account_name    | <name>        |
| p41_res_error_code      | 0             |"
Precondition,"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
Examples:
| type                                 | track2_data                            | track2_res                             | pan                    | masked_pan             | exp_date | name |
| NonStandard Card -- Track 2 pan-only | 1234567890123456                       | 1234567890123456                       | 1234567890123456       | 1234567890123456       |          |      |
| NonStandard Card -- Track 2 pan-only | B4445222AE299990007                    | B4445222AE299990007                    |                        |                        |          |      |
| NonStandard Card -- Non Payment card | 0000198800001234560011=2012=0000002008 | 0000198800001234560011=2012=0000002008 | 0000198800001234560011 | 0000198800001234560011 | 2012     |      |
| NonStandard Card -- Gift ECR         | 1234567897=251210100000001             | 1234567897=251210100000001             | 1234567897             | 1234567897             | 2512     |      |"
Unknown,"@sde @msr @00x @62x @61x @23x
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate separator of On-Guard SDE Encryption for MSR transaction
""""""
This feature file validates separator of On-Guard SDE Encryption for MSR transaction
based on ticket    https://ingenico-nar.atlassian.net/browse/ARC-1299
Note : ArcSec.json used in current FF is the version from DefaultConfig of ARC Build ""arc-app-23.09.02-0006""
""""""
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
##################### Enable Onguard_SDE with specific separator #####################
Given a existing file ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcSec_separator/ArcSec_separator_<ASCII>.apk"" file using these params:
| p62_req_file_name       | ArcSec_separator_<ASCII>.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
##################### ########################################## #####################"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
##################### Verify Onguard_SDE enabled #####################
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
##################### ##################### #####################"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.{1,252}                                             |"
Unknown,"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1><separator><pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          | separator | ASCII |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          | #         | 23    |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2512     | 201  | 150412345                    | 1504123450    |                      | 374245000001008  | 000000000                    | 0000000000          | \x00\x00                 | ;         | 3B    |
| VISA       | 4264510228395621 | JOHN/SMITH         | 2712     | 206  | 0000000000000000000704001000 | 0000070400100 | 123456789            | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 | \|        | 7C    |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 2712     | 702  | 1000041300000                | 1000041300999 |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00 | %         | 25    |
| Diners     | 36039667170472   | PETTITT/JO         | 2812     | 521  | 160100000000000007778946     | 1000051300000 | 0123456789           | 36039600000472   | 000000000000000000000000     | 0000000000000       | \x00\x00                 | &         | 26    |
| VISA       | 4761739001010010 | VISA Credit        | 2912     | 201  | 16010000000000000946         | 10000413      | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 00000000            | \x00\x00\x00\x00\x00\x00 | \x20      | 20    |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 601  | 16010000000000946            | 1000041300000 | 01234567890123456789 | 5413330000009130 | 00000000000000000            | 0000000000000       | \x00\x00\x00\x00         |           | empty |
| JCB        | 3569990010082211 | JCB/TEST           | 2612     | 201  | 1234567891234                | 987654321098  | 01234567890123456789 | 3569990000002211 | 0000000000000                | 000000000000        | \x00\x00\x00\x00         | ,         | 2C    |
Scenario: Teardown - Reset to Default State
Given a existing file ""Files/p2p_encryptions/ArcNoEncryption.apk""
When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"@p2p @secbin @msr @chapter_x @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: validate whitelisting with chapter X Decryption
""""""
This feature file validates whitelisting with chapterX Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1356
""""""
Scenario: Enable Whitelisting Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p62_req_file_name       | apstitan_on.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
Scenario Outline: whitelisting with chapter X Encryption For MSR Transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And  I wait until Element ""btn_cancel"" visible"
Unknown,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |"
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 541389099130     | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
| p62_req_file_name       | apstitan_off.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
@msr @fpe @secbin @00x @61x @23x @62x @13x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Whitelisting With On Guard FPE Encryption for MSR Transaction
""""""
This feature file validates whitelisting for MSR Transaction
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-977.
""""""
Scenario: Enable Whitelisting Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p62_req_file_name       | apstitan_on.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
Scenario Outline: Whitelisting with on guard FPE for MSR Transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |"
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  |                 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                 |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  |                 |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
| p62_req_file_name       | apstitan_off.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
@rsa @msr @secbin @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate RSA Encryption for MSR transaction
""""""
This feature file validates RSA Encryption for MSR transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1335
""""""
Scenario: Enable Whitelisting Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p62_req_file_name       | apstitan_on.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
Scenario Outline: RSA Encryption For MSR Transaction
#Step 5"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M |
| p23_req_prompt_index   | 3 |"
Unknown,"Then I Wait until Element ""title"" contains ""Please slide card"""
Card Swipe,"And  I wait until Element ""btn_cancel"" visible
#this step is equivalent to the manual swipe of a card
When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | @regexp:.*                                   |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan                 | name                   | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011    | TEST/CARD              | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 |
| Amex       | 374245002771003     | XP CARD 07/VER 2.0     | 1125     | 2222 | 150412345            | 15041234500000 |                      |
| DISCOVER   | 651000000880000091  | CARD/IMAGE 09          | 0626     | 702  | 0074901              | 0897740001     |                      |
| Diners     | 36039667170472      | PETTITT/JO             | 1200     | 521  | 1000041300000        | 1000041300000  |                      |
| VISA       | 4264510228321       | JOHN/SMITH             | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      |
| DISCOVER   | 65100000111331191   | CARD/IMAGE 08          | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 |
| Maestro    | 501833000060        | USA DEBIT/TEST CARD 16 | 1225     | 201  | 1000074900000        | 1000041300000  | 01234567890123456789 |
| DISCOVER   | 6510000011122331191 | CARD/IMAGE 07          | 0626     | 702  | 0074901              | 0897740001     | 01234567890123456789 |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/whitelisting/apstitan_off.apk"" file using these params:
| p62_req_file_name       | apstitan_off.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |"
Precondition,"@pin_code @master_session @fpe @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when FPE enabled
""""""
This feature file verify pin block decryption is correct when FPE enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable On-Guard FPE Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardFPE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
Scenario Outline: verify pin block decryption is correct with masked pan"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1            |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_set_encryption_configuration | 0            |
| p31_req_set_key_type                 | *            |
| p31_req_form_name                    |              |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |"
Unknown,"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110044 | 8          | ffffff     |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234123  | 7          | fffffff    |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Extract Card Data,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@00x @29x @60x @23x @87x @41x @fpe
Feature: verify message 29.x of variables 396 398 399 400
""""""
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
""""""
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
Scenario: Enable On-Guard FPE Encryption Configuration
########## Enable FPE encryption###############"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Extract Card Data,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardFPE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
@dx8000 @ex8000 @dx4000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when FPE encryption enabled
########## start transaction ###############
Given I successfully changed configuration ""0007"" ""0029"" to ""1"""
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card"""
Unknown,"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible"
Unknown,"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan"""
Unknown,"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"When I click Element ""ed_cvv"""
Unknown,"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"When I click Element ""ed_expiry_date"""
Unknown,"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button"
Unknown,"When I click Element ""btn_manual_confirm"""
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^<cardholdername>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.*                                                              |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type | pan             | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan      | cardholdername   |
| Amex      | 374245002771003 | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003 | MANUALLY/ENTERED |
@rx5000 @rx7000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when FPE encryption enabled
########## start transaction ###############"
Unknown,"Given I successfully changed configuration ""0007"" ""0029"" to ""1"""
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card"""
Unknown,"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible"
Unknown,"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan"""
Unknown,"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"When I click Element ""ed_cvv"""
Unknown,"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"When I click Element ""ed_expiry_date"""
Card Swipe,"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^<cardholdername>^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.*                                                              |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type | pan             | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan      | cardholdername   |
| Amex      | 374245002771003 | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003 | MANUALLY/ENTERED |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Scenario Outline: Manual entry transaction to verify 29.x variables 394 395 396 398 399 400 when FPE encryption enabled
########## start transaction ###############"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 2      |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 |
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@sde @msr @00x @60x @61x @23x
Feature:  Validate track encryption indicator values
""""""
This feature file validates track encryption indicator with its values for manual entry , encryption indicator=3
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1800
""""""
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Enable On-Guard SDE Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |"
Unknown,"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@dx8000 @ex8000 @dx4000
Scenario Outline: On-Guard SDE Encryption For Manual Entry Transaction with encryption indicator =3"
Unknown,"Given I successfully changed configuration ""0007"" ""0029"" to ""1""
And I successfully changed configuration ""0019"" ""0001"" to ""0"""
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card"""
Unknown,"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan"""
Unknown,"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"When I click Element ""ed_cvv"""
Unknown,"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"When I click Element ""ed_expiry_date"""
Unknown,"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button"
Unknown,"When I click Element ""btn_manual_confirm"""
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.+:3:.+                                                         |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | null_characters              |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | \x00\x00\x00\x00\x00\x00\x00 |
| Amex       | 374245002771003  | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003  | \x00\x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | 2507            | 0725     | 206  | 000000000000000     | 000000000000        | 4264510000005621 | \x00\x00\x00\x00\x00\x00\x00 |
| DISCOVER   | 6510000000000091 | 2606            | 0626     | 702  | 000000000000000     | 000000000000        | 6510000000000091 | \x00\x00\x00\x00\x00\x00\x00 |
@rx5000 @rx7000
Scenario Outline: On-Guard SDE Encryption For Manual Entry Transaction with encryption indicator =3
Given I successfully changed configuration ""0007"" ""0029"" to ""1""
And I successfully changed configuration ""0019"" ""0001"" to ""0"""
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card"""
Unknown,"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan"""
Unknown,"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"When I click Element ""ed_cvv"""
Unknown,"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"When I click Element ""ed_expiry_date"""
Card Swipe,"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.+:3:.+                                                         |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | null_characters              |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | \x00\x00\x00\x00\x00\x00\x00 |
| Amex       | 374245002771003  | 2511            | 1125     | 2222 | 0000000000000000    | 0000000000000       | 374245000001003  | \x00\x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | 2507            | 0725     | 206  | 000000000000000     | 000000000000        | 4264510000005621 | \x00\x00\x00\x00\x00\x00\x00 |
| DISCOVER   | 6510000000000091 | 2606            | 0626     | 702  | 000000000000000     | 000000000000        | 6510000000000091 | \x00\x00\x00\x00\x00\x00\x00 |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Precondition,"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1386
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder will enter the same strong PIN in the first and second attempt
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################"
Unknown,"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Unknown,And I wait for 1 second
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the strong pin################################
And I enter pin ""<strong_pin>""
######################## enter the same strong pin again #####################"
Unknown,And I wait for 4 seconds
CVM Process,"And I enter pin ""<strong_pin>""
####### 31.x should return B because the second pin entry is same as the first strong pin entered################### #######################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | B |
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258       |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124       |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988       |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101       |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593       |"
Unknown,"@41 @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:Swipe Transaction with 41.x Card Read with parse fields
Scenario: Send 41.x Card Read Request then simulate swipe"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,And I wait for 2 seconds
Unknown,"Then Axium swipe magnetic card:
| track1 | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| track2 | 5413330089099130=25122011483594900000                                   |
| track3 |                                                                         |"
Unknown,And I wait 3 seconds
Unknown,"And I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                                                       |
| p41_res_encryption      | 00                                                                      |
| p41_res_track_1_status  | 0                                                                       |
| p41_res_track_2_status  | 0                                                                       |
| p41_res_track_3_status  | 1                                                                       |
| p41_res_track_1         | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| p41_res_track_2         | 5413330089099130=25122011483594900000                                   |
| p41_res_track_3         |                                                                         |
| p41_res_pan             | 5413330089099130                                                        |
| p41_res_masked_pan      | 5413330089099130                                                        |
| p41_res_expiration_date | 2512                                                                    |
| p41_res_account_name    | UAT USA/TEST CARD 20                                                    |
| p41_res_error_code      | 0                                                                       |"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
@pin_code @master_session @tep2 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when TEP2 enabled
""""""
This feature file verify pin block decryption is correct when TEP2 enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable Voltage TEP2 Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/voltage_5_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_5_default-signed.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 5  |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
Scenario Outline: verify pin block decryption is correct with masked pan"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 5  |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |"
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | *                                                |
| p31_req_form_name                    |                                                  |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |"
Unknown,"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 4321     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 552211   | 6          | ffffffff   |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 55221100 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Extract Card Data,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@00x @29x @60x @23x @87x @41x @sde
Feature: verify message 29.x of variables 396 398 399 400
""""""
This feature file validates 29.x message to verify message  variables 396 398 399 400 base on ticket ARC-1689
""""""
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
Scenario: Enable On-Guard SDE Encryption Configuration
########## enable SDE encryption ###############"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |"
Extract Card Data,"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@dx8000 @ex8000 @dx4000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when SDE encryption enabled
########## start transaction ###############"
Unknown,"Given I successfully changed configuration ""0007"" ""0029"" to ""1"""
Precondition,"And I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card"""
Unknown,"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible"
Unknown,"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan"""
Unknown,"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"When I click Element ""ed_cvv"""
Unknown,"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"When I click Element ""ed_expiry_date"""
Unknown,"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>""
And I press enter button"
Unknown,"When I click Element ""btn_manual_confirm"""
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.*                                                              |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 19     |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | MANUALLY/ENTERED |
@rx5000 @rx7000 @me
Scenario Outline: Manual entry transaction with 23.x and 29.x message to verify variables 396 398 399 400 when SDE encryption enabled"
Unknown,"Given I successfully changed configuration ""0007"" ""0029"" to ""1"""
Precondition,"And I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card"""
Unknown,"And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_manual_entry"" visible"
Unknown,"When I click Element ""btn_manual_entry""
And I click Element ""ed_pan"""
Unknown,"And I send keys to Element ""ed_pan"" text ""<pan>""
And I press enter button"
Unknown,"When I click Element ""ed_cvv"""
Unknown,"And I send keys to Element ""ed_cvv"" text ""<code>""
And I press enter button"
Unknown,"When I click Element ""ed_expiry_date"""
Card Swipe,"And I send keys to Element ""ed_expiry_date"" text ""<exp_date>"" and then ENTER
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                                       |
| p23_res_card_source | H                                                                       |
| p23_res_track1      | %M<masked_pan>^MANUALLY/ENTERED^<expect_exp_date><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<expect_exp_date><masked_disc_data_t2>?                   |
| p23_res_track3      | @regexp:.*                                                              |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 19     |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000399           |
| p29_res_variable_data | <cardholdername> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                 |
| p29_res_variable_id   | 000400            |
| p29_res_variable_data | <expect_exp_date> |
Examples:
| card_type  | pan              | expect_exp_date | exp_date | code | masked_disc_data_t1 | masked_disc_data_t2 | masked_pan       | cardholdername   |
| Mastercard | 5413330089020011 | 2512            | 1225     | 221  | 000000000000000     | 000000000000        | 5413330000000011 | MANUALLY/ENTERED |
@dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @msr
Scenario Outline: Manual entry transaction to verify 29.x variables 394 395 396 398 399 400 when SDE encryption enabled
########## start transaction ###############"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 394 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000394 |
| p29_res_variable_data | <code> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 395 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000395 |
| p29_res_variable_data | 19     |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 396 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000396 |
| p29_res_variable_data | true   |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2            |
| p29_res_variable_id   | 000398       |
| p29_res_variable_data | <masked_pan> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
########## remove encryption ###############
Examples:
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 | null_characters |
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |                 |
@dx4000 @dx8000 @ex8000 @rx5000 @rx7000
Scenario: Teardown - Reset to Default State
########## remove encryption ###############"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Precondition,"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate an invalid PIN change where the cardholder will type a third entered PIN that does not match the second entered PIN
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1387
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN where the cardholder enter a 3rd entered pin doesnt match the second enetered pin
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################"
Unknown,"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Unknown,And I wait for 1 second
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>"""
Unknown,"And I wait for 4 seconds
#################enter strong pin################################"
Unknown,"And I enter pin ""<strong_pin1>""
######################## enter another strong pin  #####################"
Unknown,And I wait for 4 seconds
CVM Process,"And I enter pin ""<strong_pin2>""
####### 31.x should return C because the 3rd pin entry is not same as the 2nd strong pin entered################### #######################
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | C |
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin1 | strong_pin2 |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 0258        | 1593        |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 3124        | 0101        |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988        | 3124        |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 0101        | 0258        |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 1593        | 9988        |"
Unknown,"@87x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: MSR transaction For Non Standard Card Using 87.x Card Read Request
""""""
This feature file Validates MSR transaction For Non Standard Card using 87.x Card Read Request
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1199
""""""
Scenario Outline: Check MSR flow while using 87.x with Non-Standard two tracks(track1 ,track2)"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Unknown,"When I swipe card using this params:
| track1_data | <track1_data> |
| track2_data | <track2_data> |
| track3_data |               |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                |
| p87_res_card_source | M                                                |
| p87_res_card_data   | @regexp:^<track1_res>\u001c<track2_res>\u001c.*$ |
Examples:
| track1_data                                                      | track2_data                            | track1_res                                                       | track2_res                             |
| B4147200000002105 KOIRALA/SASMIT 2603201000000000000000000000000 | 4147200000002105=260320100000000       | B4147200000002105 KOIRALA/SASMIT 2603201000000000000000000000000 | 4147200000002105=260320100000000       |
| 1234567890123456                                                 | 1234567890123456                       | 1234567890123456                                                 | 1234567890123456                       |
| 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000  | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000  | 0000198800001234560011=2012=0000002008 |
Scenario Outline: Check MSR flow while using 87.x with  Non-Standard track1 only"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Unknown,"When I swipe card using this params:
| track1_data | <track1_data> |
| track2_data |               |
| track3_data |               |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                        |
| p87_res_card_source | M                        |
| p87_res_card_data   | @regexp:^<track1_res>.*$ |
Examples:
| track1_data                         | track2_data | track1_res                          | track1_res |
| 1234567890123456                    |             | 1234567890123456                    |            |
| 1006357681?3       1234567890123456 |             | 1006357681?3       1234567890123456 |            |
| 5413339000000119                    |             | 5413339000000119                    |            |
Scenario Outline: Check MSR flow while using 87.x with Non-Standard track2 only"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Unknown,"When I swipe card using this params:
| track1_data |               |
| track2_data | <track2_data> |
| track3_data |               |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                        |
| p87_res_card_source | M                        |
| p87_res_card_data   | @regexp:^<track1_res>.*$ |
Examples:
| track1_data | track2_data                            | track1_res | track2_res                             |
|             | B4445222AE299990007                    |            | B4445222AE299990007                    |
|             | 1234567890123456                       |            | 1234567890123456                       |
|             | 0000198800001234560011=2012=0000002008 |            | 0000198800001234560011=2012=0000002008 |
@41 @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:Swipe Transaction with 41.x Card Read without parse fields
Scenario: Send 41.x Card Read Request then simulate swipe"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 0 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,And I wait for 2 seconds
Unknown,"Then Axium swipe magnetic card:
| track1 | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| track2 | 5413330089099130=25122011483594900000                                   |
| track3 |                                                                         |"
Unknown,And I wait for 30 seconds
Unknown,"And I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source         | M                                                                       |
| p41_res_encryption     | 00                                                                      |
| p41_res_track_1_status | 0                                                                       |
| p41_res_track_2_status | 0                                                                       |
| p41_res_track_3_status | 1                                                                       |
| p41_res_track_1        | B5413330089099130^UAT USA/TEST CARD 20^25122011483594900000000000000000 |
| p41_res_track_2        | 5413330089099130=25122011483594900000                                   |
| p41_res_track_3        |                                                                         |
| p41_res_error_code     | 0                                                                       |"
Precondition,"@pin_code @master_session @tep4 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when TEP4 enabled
""""""
This feature file verify pin block decryption is correct when TEP4 enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable Voltage TEP4 Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/voltage_6_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_6_default-signed.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 6  |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
Scenario Outline: verify pin block decryption is correct with masked pan"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 6  |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |"
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | *                                                |
| p31_req_form_name                    |                                                  |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |"
Unknown,"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 432100   | 6          | ffffffff   |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522     | 4          | ffffffffff |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522001  | 7          | fffffff    |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 12341234 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Precondition,"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate invalid PIN change where the cardholder types the second entered PIN with more than 10 digits
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1389
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN change where the cardholder types the second entered PIN with more than 10 digits
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################"
Unknown,"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Unknown,And I wait for 1 second
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>"""
Unknown,"And I wait for 5 seconds
#################enter 10/11 digits pin pin################################"
Unknown,"And I enter pin ""<second_pin>"""
CVM Process,"And I wait for 11 seconds
####### 31.x should return A because the 2nd pin entry is 10 or 11 digits length################### #######################"
CVM Process,"Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | A |
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | second_pin  |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 5026301670  |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 6986301671  |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 9988112589  |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 1122772211  |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4321     | 11445332271 |"
Unknown,"@87x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: MSR transaction using 87.x Card Read Request
""""""
This feature file Validates MSR transaction using 87.x Card Read Request
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1155
""""""
Scenario Outline: Check MSR flow while using 87.x with two tracks(track1 ,track2)"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Unknown,"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                                                    |
| p87_res_card_source | M                                                                                                    |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |
Examples:
| card_type   | pan                 | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| MasterCard  | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| VISA        | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026887693372 | 887693372    |
| AMEX 1      | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
| NonStandard | 999000              | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |
Scenario Outline: Check MSR flow while using  87.x with  track1 only"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Unknown,"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data |                                              |
| track3_data |                                              |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                                |
| p87_res_card_source | M                                                                |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code><disc_data_t1>\x1C\x1C$ |
Examples:
| card_type   | pan                 | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| MasterCard  | 6799998900000201011 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| VISA        | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026887693372 | 887693372    |
| AMEX 1      | 3715841319          | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
| NonStandard | 999000              | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |
Scenario Outline: Check MSR flow while using 87.x with track2 only"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Unknown,"When I swipe card using this params:
| track1_data |                                      |
| track2_data | <pan>=<exp_date><code><disc_data_t2> |
| track3_data |                                      |
Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | 0                                                      |
| p87_res_card_source | M                                                      |
| p87_res_card_data   | @regexp:^\x1C<pan>=<exp_date><code><disc_data_t2>\x1C$ |
Examples:
| card_type   | pan            | name                      | exp_date | code  | disc_data_t1    | disc_data_t2 |
| MasterCard  | 45358179327829 | EKRLOFKPUUTQURT/ALMPWTZUL | 2007     | 707   | 122560965000469 | 965000469    |
| VISA        | 34798979016630 | XNHKBPMOENSGWLH/VVKLBTTVC | 2011     | 885   | 131026823693372 | 823693372    |
| AMEX 1      | 37158413190797 | YYBROXFQJRXJW/EVXOV       | 2001     | 442   | 57431313685     | 13685        |
| NonStandard | 999000         | NENNAEVXO-VVVV            | 001      | 55442 | 333657431313685 | 000013685    |"
Unknown,"@41x @msr @00x @24x @21x @27x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate On-Demand Messages using 41.x EFT message
""""""
This feature file Validates on-demand messages using 41.x EFT message
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1159.
""""""
Scenario Outline: On-Demand Messages using 41.x EFT message"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 21.x Numeric Input message to the terminal with:
| p21_req_display_char        | 0              |
| p21_req_min_input_length    | <min_input>    |
| p21_req_max_input_length    | <max_input>    |
| p21_req_prompt_index        | <prompt_index> |
| p21_req_form_specific_index | input_numeric  |
And I Wait until Element ""fixed_title"" contains ""<title>""
#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible"
Unknown,"When I click Element ""input_box"""
Unknown,"And  I send keys to Element ""input_box"" text ""<input_data>"" and then ENTER
Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | 0            |
| p21_res_input_data | <input_data> |"
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I Wait until Element ""title"" contains ""Welcome""
When I send a 27.x Alpha Input message to the terminal with params:
| p27_req_display_char     | 0           |
| p27_req_min_input_length | 00          |
| p27_req_max_input_length | 40          |
| p27_req_prompt_index     | 016         |
| p27_req_form_specificid  | input_alpha |
And I Wait until Element ""fixed_title"" contains ""Please enter Cashback:""
#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible"
Unknown,"When I click Element ""input_box"""
Unknown,"And I send keys to Element ""input_box"" text ""ISAT-v-1.9.66"" and then ENTER
Then I should receive the 27.x Alpha Input response from terminal with params:
| p27_res_exit_type  | 0             |
| p27_res_data_input | ISAT-v-1.9.66 |"
Unknown,"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 0 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,And I wait for 2 second
Unknown,"Then I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |"
Unknown,When I wait for 5 second
Unknown,"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source         | M                                            |
| p41_res_encryption     | 00                                           |
| p41_res_track_1_status | 0                                            |
| p41_res_track_2_status | 0                                            |
| p41_res_track_3_status | 1                                            |
| p41_res_track_1        | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p41_res_track_2        | <pan>=<exp_date><code><disc_data_t2>         |
| p41_res_track_3        |                                              |
| p41_res_error_code     | 0                                            |"
CVM Process,"When I send a 31.x Pin Entry message to the terminal with params:
| p31_req_set_key_type                 | D     |
| p31_req_set_encryption_configuration | 0     |
| p31_req_prompt_index_number          | 1     |
| p31_req_customer_acc_num             | <pan> |
| p31_req_form_name                    |       |
And I enter pin ""1234""
Then I should receive in '30' seconds the 31.x Pin Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |"
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I Wait until Element ""title"" contains ""Welcome!""
When I send a 21.x Numeric Input message to the terminal with:
| p21_req_display_char        | 0              |
| p21_req_min_input_length    | <min_input>    |
| p21_req_max_input_length    | <max_input>    |
| p21_req_prompt_index        | <prompt_index> |
| p21_req_form_specific_index | input_numeric  |"
Unknown,"And I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 0 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,"And I Wait until Element ""fixed_title"" contains ""<title>""
And I wait until Element ""line_display"" visible
#And I wait until Element ""btn_cancel"" visible"
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |"
Unknown,"Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | a |
| p21_res_input_data |   |"
Display Confirmation,"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I Wait until Element ""title"" contains ""Welcome!"""
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |"
Unknown,"Then I should receive the 41.x response from terminal with params:
| p41_res_source         | U  |
| p41_res_encryption     | 98 |
| p41_res_track_1_status | 1  |
| p41_res_track_2_status | 1  |
| p41_res_track_3_status | 1  |
| p41_res_track_1        |    |
| p41_res_track_2        |    |
| p41_res_track_3        |    |
| p41_res_error_code     | a  |
And I wait 1 second"
Precondition,"And I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                                                                                             | disc_data_t2   | additional_data      | min_input | max_input | prompt_index | input_data | title                   |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000\u001c5413339000000119=24122210000014000001\u001c0123456789012345678901234567890123456789 | 0000014000001  | 01234567890123456789 | 01        | 10        | 001          | 6724240113 | Enter home phone number |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                                                                                                | 15041234500000 |                      | 01        | 20        | 001          | 77457777   | Enter home phone number |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000                                                                             | 0000070400100  |                      | 01        | 40        | 001          | 558555     | Enter home phone number |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                                                                                            | 1000041300000  |                      | 01        | 40        | 001          | 88855588   | Enter home phone number |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946                                                                                     | 1000041300000  | 01234567890123456789 | 01        | 40        | 001          | 74158552   | Enter home phone number |
@pin_code @master_session @tep6 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when TEP6 enabled
""""""
This feature file verify pin block decryption is correct when TEP6 enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable Voltage TEP6 Encryption Configuration
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/voltage_31_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_31_default-signed.apk |
| p62_req_encoding_format | B                             |
| p62_req_fast_download   | 1                             |
| p62_req_unpack_flag     | 0                             |
And I should receive the 62.x File Write response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 31 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
Scenario Outline: verify pin block decryption is correct with masked pan"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 31 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |"
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | *                                                |
| p31_req_form_name                    |                                                  |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |"
Unknown,"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 432100   | 6          | ffffffff   |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522     | 4          | ffffffffff |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 5522110  | 7          | fffffff    |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 12341234 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Precondition,"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate an valid PIN change where the cardholder will type the second entered PIN is more than 4 digits and less than 10 digits
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1388
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and valid PIN change where the cardholder will type the second entered PIN is more than 4 digits and less than 10 digits
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################"
Unknown,"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Unknown,And I wait for 1 second
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>"""
Unknown,"And I wait for 4 seconds
#################enter strong pin >4digits################################"
Unknown,"And I enter pin ""<strong_pin>""
######################## reenter the strong pin  #####################"
Unknown,And I wait for 7 seconds
CVM Process,"And I enter pin ""<strong_pin>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |
############### variable is back to false after pin change ############################"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | false   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | strong_pin |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 15933       |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 010198      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 3124312     |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 02580259    |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 7777     | 998866027   |"
Unknown,"@87x @msr @00x @24x @21x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate On-Demand Messages using 87.x EFT message
""""""
This feature file Validates on-demand messages using 87.x EFT message
TestLink test case link:https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1158.
""""""
Scenario Outline: On-Demand Messages using 87.x EFT message"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 21.x Numeric Input message to the terminal with:
| p21_req_display_char        | 0              |
| p21_req_min_input_length    | <min_input>    |
| p21_req_max_input_length    | <max_input>    |
| p21_req_prompt_index        | <prompt_index> |
| p21_req_form_specific_index | input_numeric  |
And I Wait until Element ""fixed_title"" contains ""<title>""
#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible"
Unknown,"When I click Element ""input_box"""
Unknown,"And  I send keys to Element ""input_box"" text ""<input_data>"" and then ENTER
Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | 0            |
| p21_res_input_data | <input_data> |"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible
And I wait until Element ""image_card"" visible"
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I Wait until Element ""title"" contains ""Welcome""
When I send a 27.x Alpha Input message to the terminal with params:
| p27_req_display_char     | 0           |
| p27_req_min_input_length | 00          |
| p27_req_max_input_length | 40          |
| p27_req_prompt_index     | 016         |
| p27_req_form_specificid  | input_alpha |
And I Wait until Element ""fixed_title"" contains ""Please enter Cashback:""
#And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible"
Unknown,"And I click Element ""input_box"""
Unknown,"And I send keys to Element ""input_box"" text ""ISAT-v-1.9.66"" and then ENTER
Then I should receive the 27.x Alpha Input response from terminal with params:
| p27_res_exit_type  | 0             |
| p27_res_data_input | ISAT-v-1.9.66 |"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait until Element ""line_display"" visible"
Unknown,"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data | <additional_data><additional_data>           |
Then I should receive the 87.x Card Read response from terminal with params:
| p87_res_exit_type   | 0                                            |
| p87_res_card_source | M                                            |
| p87_res_card_data   | @regexp:^B<pan>\^<name>\^<exp_date><code>.*$ |"
CVM Process,"When I send a 31.x Pin Entry message to the terminal with params:
| p31_req_set_key_type                 | D     |
| p31_req_set_encryption_configuration | 0     |
| p31_req_prompt_index_number          | 1     |
| p31_req_customer_acc_num             | <pan> |
| p31_req_form_name                    |       |
And I enter pin ""1234""
Then I should receive in '30' seconds the 31.x Pin Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |"
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I Wait until Element ""title"" contains ""Welcome!""
When I send a 21.x Numeric Input message to the terminal with:
| p21_req_display_char        | 0              |
| p21_req_min_input_length    | <min_input>    |
| p21_req_max_input_length    | <max_input>    |
| p21_req_prompt_index        | <prompt_index> |
| p21_req_form_specific_index | input_numeric  |"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |
| po87_req_options        |            |"
Unknown,"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible
Then I should receive the 21.x Numeric Input response from terminal with params:
| p21_res_exit_type  | a |
| p21_res_input_data |   |"
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number | activity_main |
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I Wait until Element ""title"" contains ""Welcome!""
When I send a 27.x Alpha Input message to the terminal with params:
| p27_req_display_char     | 0           |
| p27_req_min_input_length | 00          |
| p27_req_max_input_length | 40          |
| p27_req_prompt_index     | 206         |
| p27_req_form_specificid  | input_alpha |
#And I wait until Element ""btn_cancel"" visible"
Unknown,"When I send a 87.x On-Guard and KME Card Read message to the terminal with:
| p87_req_prompt_index    | 3          |
| p87_req_form_name       | read_cards |
| p87_req_enabled_devices | M          |"
Unknown,"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""line_display"" visible
And I wait until Element ""btn_cancel"" visible
Then I should receive the 27.x Alpha Input response from terminal with params:
| p27_res_exit_type  | a |
| p27_res_data_input |   |"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"Then I should receive the 87.x On-Guard and KME Card Read Data response from terminal with params:
| p87_res_exit_type   | a        |
| p87_res_card_source | ?        |
| p87_res_card_data   | \x1C\x1C |"
Precondition,"And I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                                                                                             | disc_data_t2   | additional_data      | min_input | max_input | prompt_index | input_data | title                   |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000\u001c5413339000000119=24122210000014000001\u001c0123456789012345678901234567890123456789 | 0000014000001  | 01234567890123456789 | 01        | 10        | 001          | 6724240113 | Enter home phone number |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                                                                                                | 15041234500000 |                      | 01        | 20        | 001          | 77457777   | Enter home phone number |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000                                                                             | 0000070400100  |                      | 01        | 40        | 001          | 558555     | Enter home phone number |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                                                                                            | 1000041300000  |                      | 01        | 40        | 001          | 88855588   | Enter home phone number |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946                                                                                     | 1000041300000  | 01234567890123456789 | 01        | 40        | 001          | 74158552   | Enter home phone number |
@pin_code @master_session @tep7 @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when TEP7 enabled
""""""
This feature file verify pin block decryption is correct when TEP7 enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable Voltage TEP7 Encryption Configuration
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/voltage_32_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_32_default-signed.apk |
| p62_req_encoding_format | B                             |
| p62_req_fast_download   | 1                             |
| p62_req_unpack_flag     | 0                             |
And I should receive the 62.x File Write response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 32 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
Scenario Outline: verify pin block decryption is correct with masked pan"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 32 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |"
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | *                                                |
| p31_req_form_name                    |                                                  |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |"
Unknown,"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan                | name               | exp_date | code | disc_data_t1         | disc_data_t2   | additional_data      | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011   | TEST/CARD          | 1225     | 221  | 000000140000000      | 0000014000001  | 01234567890123456789 | 0000     | 4          | ffffffffff |
| Amex       | 374245002771003    | XP CARD 07/VER 2.0 | 1125     | 2222 | 150412345            | 15041234500000 |                      | 1234     | 4          | ffffffffff |
| DISCOVER   | 651000000880000091 | CARD/IMAGE 09      | 0626     | 702  | 0074901              | 0897740001     |                      | 12345    | 5          | fffffffff  |
| Diners     | 36039667170472     | PETTITT/JO         | 1200     | 521  | 1000041300000        | 1000041300000  |                      | 4321     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/SMITH         | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 552211   | 6          | ffffffff   |
| DISCOVER   | 65100000111331191  | CARD/IMAGE 08      | 0626     | 702  | 16010000000000000946 | 1000041300000  | 01234567890123456789 | 1133     | 4          | ffffffffff |
| VISA       | 4264510228321      | JOHN/COW           | 0725     | 206  | 16010000000000000946 | 1000041300000  |                      | 55221100 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Precondition,"@msr @pin @28x @29x @31x @00x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @crf13
Feature: validate invalid PIN change where the cardholder types the second entered PIN with 12 digits
""""""
TestLink test case link : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1390
- The application validates the PIN according to the following rules:
In this testcase, we are testing an invalid PIN change where the cardholder will enter a strong PIN on the first and second attempts.
- The application validates the PIN according to the following rules:
- The first entered PIN does not match the second entered PIN.
- The second entered PIN:
- is not a weak PIN. The PIN is considered weak if:
- All digits in the PIN are the same (e.g., 4444, 3333)
- Each digit in the PIN is an increment of the previous digit (1234, 3456)
- Each digit in the PIN is a decrement of the previous digit (4321, 9876)
- The number of keys entered is more than four.
- The number of keys entered does not exceed 12.
- The third entered PIN matches the second entered PIN.
""""""
Scenario Outline: Perform MSR transaction and enter an invalid PIN change where the cardholder types the second entered PIN with 12 digits
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
################## enable pin change support ###########################"
Unknown,"When I send a 28.x Set Variable message to the terminal with:
| p28_req_response_type | 1      |
| p28_req_variable_id   | 000920 |
| p28_req_variable_data | 1      |
Then I should receive the 28.x Set Variable response from terminal with params:
| p28_res_status      | 2      |
| p28_res_variable_id | 000920 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
################## swipe card ###########################"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Unknown,And I wait for 1 second
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 14 |
| p31_req_customer_acc_num             |    |
| p31_req_set_encryption_configuration | 0  |
| p31_req_set_key_type                 | D  |
| p31_req_form_name                    |    |
#################enter the weak pin################################
And I enter pin ""<weak_pin>"""
Unknown,"And I wait for 5 seconds
#################enter 12 digits pin pin################################"
Unknown,"And I enter pin ""<second_pin>"""
CVM Process,"And I wait for 12 seconds
####### 31.x should return A because the 2nd pin entry is 12 digits length################### #######################"
CVM Process,"Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | A |
| p31_res_pin_data |   |
############## variable keeps the value true since pin is not sucessfully changed ##########################"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 00000920 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000920 |
| p29_res_variable_data | true   |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | weak_pin | second_pin   |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 1111     | 502630167012 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 1234     | 698630167113 |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4567     | 998811258914 |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 9876     | 112277221125 |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4321     | 114453322716 |"
Precondition,"@pin_code @master_session @rsa @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when RSA enabled
""""""
This feature file verify pin block decryption is correct when RSA enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable RSA Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcRSA-OAEP.apk"" file using these params:
| p62_req_file_name       | ArcRSA-OAEP.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |
Scenario Outline: verify pin block decryption is correct with masked pan"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1            |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_set_encryption_configuration | 0            |
| p31_req_set_key_type                 | *            |
| p31_req_form_name                    |              |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |"
Unknown,"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 22110055 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Precondition,"@pin_code @master_session @chapter_x @msr @00x @60x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct when chapter X enabled
""""""
This feature file verify pin block decryption is correct when chapter X enabled
based on ticket https://ingenico-nar.atlassian.net/browse/ARC-1772
""""""
Scenario: Enable chapterX Encryption Configuration
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcSec_chapter_X.apk"" file using these params:
| p62_req_file_name       | ArcSec_chapter_X.apk |
| p62_req_encoding_format | B                    |
| p62_req_fast_download   | 1                    |
| p62_req_unpack_flag     | 0                    |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
Scenario Outline: verify pin block decryption is correct with masked pan"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1            |
| p31_req_customer_acc_num             | <masked_pan> |
| p31_req_set_encryption_configuration | 0            |
| p31_req_set_key_type                 | *            |
| p31_req_form_name                    |              |
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |"
Unknown,"And I will decrypt pin block from 'p31_res_pin_data_block' using the sequence of pan: '<pan>' and parameters 'p31_res_pin_data_ksn' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 5413330000000011 | 000000000000000              | 0000000000000       | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 6510000000000091 | 0000000000000                | 0000000000000       | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 36039600000472   | 00000000000000000000         | 0000000000000       | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 5413330000009130 | 00000000000000000000         | 0000000000000       | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 4761730000000010 | 00000000000000000000         | 0000000000000       | 2211001  | 7          | fffffff    |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 374245000001008  | 000000000                    | 00000000000000      | 12341234 | 8          | ffffff     |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Card Swipe,"@23x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: 23.x Card Read Request Swipe one track
Scenario Outline: Send 23.x Card Read Request swipe first track"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M  |
| p23_req_prompt_index   | 03 |"
Unknown,"And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 |                                              |
| track3 |                                              |
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | @regexp:.*                                   |
| p23_res_track3      | @regexp:.*                                   |
Examples:
| card_type     | pan                 | name                       | exp_date | code | disc_data_t1    | disc_data_t2 |
| Discover 1    | 62217984210356      | LYUATZMDAU/ABKBXTDWTDZJPHY | 2008     | 305  | 937343886685    | 886685       |
| Discover 2    | 648682809137410     | YHQJOKMYVWVNLRP/RHWSDMBOER | 2009     | 418  | 7254640409      | 0409         |
| Discover 3    | 656147069906747     | ICVLSVZXZM/RLBOT           | 2011     | 596  | 11020664082766  | 64082766     |
| Discover 4    | 521781446878188     | MCOZPS/FTYJMUOLLBYS        | 2006     | 651  | 95135762802916  | 62802916     |
| MasterCard    | 45358179327829      | EKRLOFKPUUTQURT/ALMPWTZUL  | 2007     | 707  | 122560965000469 | 965000469    |
| VISA          | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC  | 2011     | 885  | 131026823693372 | 823693372    |
| AMEX 1        | 37158413190797      | YYBROXFQJRXJW/EVXOV        | 2001     | 442  | 57431313685     | 13685        |
| AMEX 2        | 700199380329310926  | TPZRJLK/NKTUBHJNNWZI       | 2005     | 807  | 3121187689      | 7689         |
| loyalty cards | 62211933327452      | PZNLQXRGCDILK/TDDZHWEUCTJ  | 2009     | 680  | 9497511743      | 1743         |
| other cards   | 2830654628589795710 | XSYWIV/LHJPNU              | 2008     | 770  | 29814983505     | 83505        |
Scenario Outline: Send 23.x Card Read Request swipe second track"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_enable_devices | M  |
| p23_req_prompt_index   | 03 |"
Unknown,"And I Wait until Element ""title"" contains ""Please slide card""
Then I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Unknown,"When Axium swipe magnetic card:
| track1 |                                      |
| track2 | <pan>=<exp_date><code><disc_data_t2> |
| track3 |                                      |"
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                    |
| p23_res_card_source | M                                    |
| p23_res_track1      | @regexp:.*                           |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2> |
| p23_res_track3      | @regexp:.*                           |"
Precondition,"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type     | pan                 | name                       | exp_date | code | disc_data_t1    | disc_data_t2 |
| Discover 1    | 62217984210356      | LYUATZMDAU/ABKBXTDWTDZJPHY | 2008     | 305  | 937343886685    | 886685       |
| Discover 2    | 648682809137410     | YHQJOKMYVWVNLRP/RHWSDMBOER | 2009     | 418  | 7254640409      | 0409         |
| Discover 3    | 656147069906747     | ICVLSVZXZM/RLBOT           | 2011     | 596  | 11020664082766  | 64082766     |
| Discover 4    | 521781446878188     | MCOZPS/FTYJMUOLLBYS        | 2006     | 651  | 95135762802916  | 62802916     |
| MasterCard    | 45358179327829      | EKRLOFKPUUTQURT/ALMPWTZUL  | 2007     | 707  | 122560965000469 | 965000469    |
| VISA          | 34798979016630      | XNHKBPMOENSGWLH/VVKLBTTVC  | 2011     | 885  | 131026823693372 | 823693372    |
| AMEX 1        | 37158413190797      | YYBROXFQJRXJW/EVXOV        | 2001     | 442  | 57431313685     | 13685        |
| AMEX 2        | 700199380329310926  | TPZRJLK/NKTUBHJNNWZI       | 2005     | 807  | 3121187689      | 7689         |
| loyalty cards | 62211933327452      | PZNLQXRGCDILK/TDDZHWEUCTJ  | 2009     | 680  | 9497511743      | 1743         |
| other cards   | 2830654628589795710 | XSYWIV/LHJPNU              | 2008     | 770  | 29814983505     | 83505        |"
Card Swipe,"@23x @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Swipe non standard cards
""""""
This feature file Validates MSR transaction For Non Standard Card using 23.x Card Read Request
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1207
""""""
Scenario Outline: Check MSR flow while using Non-Standard cards with two tracks(track1 ,track2)"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3          |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Card Swipe,"When I swipe card using this params:
| track1_data | <track1_data> |
| track2_data | <track2_data> |
| track3_data |               |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0            |
| p23_res_card_source | M            |
| p23_res_track1      | <track1_res> |
| p23_res_track2      | <track2_res> |
| p23_res_track3      |              |"
Precondition,"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| type                                                             | track1_data                                                     | track2_data                            | track1_res                                                      | track2_res                             |
| NonStandard card -- ISO parser                                   | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       | B4147200000002105 TEST/CARD 2603201000000000000000000000000     | 4147200000002105=260320100000000       |
| NonStandard card -- Track 1 and Track 2 pan-only                 | 1234567890123456                                                | 1234567890123456                       | 1234567890123456                                                | 1234567890123456                       |
| NonStandard card -- Non Payment card                             | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 | 7080010000123456 ENCODING TEST 2012 00011VEH IDFILLERXX0XX40000 | 0000198800001234560011=2012=0000002008 |
| NonStandard card -- FDMS TEST CARD/VISA modified without exp-dat | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       | B4000620001234803^FDMS TEST CARD/VISA^                          | 4000620001234803                       |
Scenario Outline: Check MSR flow while using Non-Standard cards with track1 only
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3          |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Card Swipe,"When I swipe card using this params:
| track1_data | <track1_data> |
| track2_data |               |
| track3_data |               |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0            |
| p23_res_card_source | M            |
| p23_res_track1      | <track1_res> |
| p23_res_track2      |              |
| p23_res_track3      |              |"
Precondition,"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| type                                 | track1_data                         | track1_res                         |
| NonStandard Card -- Track 1 pan-only | 1234567890123456                    | 1234567890123456                   |
| NonStandard Card -- Non Payment card | 1006357681?3       1234567890123456 | 10063576813       1234567890123456 |
| NonStandard Card -- Track 1 pan-only | 5413339000000119                    | 5413339000000119                   |
Scenario Outline: Check MSR flow while using Non-Standard cards with track2 only
Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3          |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Card Swipe,"When I swipe card using this params:
| track1_data |               |
| track2_data | <track2_data> |
| track3_data |               |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0            |
| p23_res_card_source | M            |
| p23_res_track1      |              |
| p23_res_track2      | <track2_res> |
| p23_res_track3      |              |"
Precondition,"When I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| type                                 | track2_data                            | track2_res                             |
| NonStandard Card -- Track 2 pan-only | B4445222AE299990007                    | B4445222AE299990007                    |
| NonStandard Card -- Track 2 pan-only | 1234567890123456                       | 1234567890123456                       |
| NonStandard Card -- Non Payment card | 0000198800001234560011=2012=0000002008 | 0000198800001234560011=2012=0000002008 |
| NonStandard Card -- Gift ECR         | 1234567897=251210100000001             | 1234567897=251210100000001             |"
Unknown,"@smoke @00x @13x @23x @24x @29x @31x @cashback @msr @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: MSR Debit Cashback with PIN entry transaction with various card brands
""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-918
""""""
Scenario Outline: Perform MSR Debit Cashback with PIN entry Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount   | <amount>          |
| p13_req_cashback | <cashback_amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And  I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |"
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 8                   |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |
When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |"
Unknown,And I wait for 1 second
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 3     |
| p31_req_customer_acc_num             | <pan> |
| p31_req_set_encryption_configuration | *     |
| p31_req_set_key_type                 | *     |
And Axium pinpad enter PIN 1234
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status         | 0          |
| p31_res_pin_data       | @regexp:.* |
| p31_res_pin_data_ksn   | @regexp:.* |
| p31_res_status         | @regexp:.* |
| p31_res_pin_data_block | @regexp:.* |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |"
Transaction Completion,"Then I Wait until Element ""title"" contains ""Transaction complete"""
Display Confirmation,"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I wait for 2 seconds
Examples:
| card_type  | amount | cashback_amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 50              | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 1000            | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 2000            | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 10000           | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 4000            | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |"
Card Swipe,"@23x @msr @00x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Cancel 23.x Card Read Request
Scenario: Send 23.x Card Read Request then simulate swipe"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3          |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
And I Wait until Element ""title"" contains ""Please slide card""
And I wait until Element ""btn_cancel"" visible
And I wait for 1 second"
Unknown,"And Axium swipe magnetic card:
| track1 | B62217984210356^LYUATZMDAU/ABKBXTDWTDZJPHY^2008305937343886685 |
| track2 | 62217984210356=2008305886685                                   |
| track3 |                                                                |"
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                                              |
| p23_res_card_source | M                                                              |
| p23_res_track1      | B62217984210356^LYUATZMDAU/ABKBXTDWTDZJPHY^2008305937343886685 |
| p23_res_track2      | 62217984210356=2008305886685                                   |
| p23_res_track3      |                                                                |
@smoke @msr @00x @13x @23x @20x @29x @24x
Feature: MSR Credit Signature transaction with various card brands
""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-917
""""""
@dx8000 @ex8000 @dx4000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |"
Unknown,"And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible
When Draw line from 100x800 to 200x500
And Draw line from 200x500 to 300x800
And Draw line from 100x800 to 200x500
And Draw line from 200x500 to 300x800
And Draw line from 140x700 to 250x700"
Unknown,"And I click Element ""btn_enter"""
Unknown,"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |
| p20_res_data   | 4 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |"
Transaction Completion,"Then I Wait until Element ""title"" contains ""Transaction complete"""
Display Confirmation,"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,And I wait for 2 seconds
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
@rx5000 @rx7000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |"
Unknown,"And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible
When Draw line from 200x300 to 300x360
And Draw line from 300x360 to 360x400"
Unknown,"And I click Element ""btn_enter"""
Unknown,"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |
| p20_res_data   | 2 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |"
Transaction Completion,"Then I Wait until Element ""title"" contains ""Transaction complete"""
Display Confirmation,"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I wait for 2 seconds
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |"
Card Swipe,"@collis @msr @emv @cless @visa @amex @online_pin_cvm @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: 23.x Card Read Request
""""""
Using this feature file, we ensure that the reader should be disabled after start performing a transaction
Test link test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1198
""""""
Scenario Outline: Send 23.x Card Read Request insert and remove chip card then swipe ."
Unknown,"Given I successfully changed configuration ""0019"" ""0001"" to ""1""
And I successfully changed configuration ""0019"" ""0021"" to ""1""
And  I initiating Collis Test Case with the following params:
| brand     | American_Express |
| interface | contact          |
| test_plan | Quick_Chip_1__2  |
| test_case | <test_case>      |
And I wait 20 seconds"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Send Amount,"When  I send a 13.x amount message to the terminal with:
| p13_req_amount   | <amount> |
| p13_req_cashback |          |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Card Swipe,"When I insert card
And I wait 2 seconds
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 100 |
| p23_req_form_name      |     |
| p23_req_enable_devices | S   |
And I wait 2 seconds
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0 |
| p23_res_card_source | Q |
| p23_res_track1      |   |
| p23_res_track2      |   |
| p23_res_track3      |   |"
Unknown,"When I enter pin ""00123"""
Unknown,"And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
When I remove card
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| p33_05_res_status                  | 00         |
| p33_05_res_emvh_current_packet_nbr | 0          |
| p33_05_res_emvh_packet_type        | 0          |
| p33_05_res_payload                 | @regexp:.* |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| tag    | name                                           | value                  |
| 0x4F   | application_identifier                         | <adf>                  |
| 0x84   | dedicated_file_df_name                         | <adf>                  |
| 0x9C   | transaction_type                               | 00                     |
| 0x1001 | ingenico_proprietary_pin_entry_required_flag   | U                      |
| 0x1002 | ingenico_proprietary_signature_required_flag   | U                      |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                     |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | U                      |
| 0x1010 | ingenico_proprietary_error_response_code       | CRPRE                  |
| 0x5F20 | cardholder_name                                | <cardholder_name>      |
| 0x5F24 | application_expiration_date                    | <exp_date>31           |
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                   |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                      |
| 0x9001 | ingenico_proprietary_card_entry_mode           | C                      |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>       |
| 0x9F03 | amount_other                                   | 000000000000           |
| 0x9F0D | issuer_action_code_default                     | BC50ECA800             |
| 0x9F0E | issuer_action_code_denial                      | 0000000000             |
| 0x9F0F | issuer_action_code_online                      | BC78FCF800             |
| 0x9F1A | terminal_country_code                          | 0840                   |
| 0x9F1B | terminal_floor_limit                           | 00002710               |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6} |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}          |
| 0x9F39 | point_of_service_pos_entry_mode                | 05                     |
| 0xDF03 | pin_try_limit_kernel_v2                        | C800000000             |
| 0xDF04 | pin_try_counter                                | 0000000000             |
| 0xDF05 | aip_for_visa_contactless                       | C800000000             |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                     |
And I should receive the 09.x Set Allowed Payment response from terminal with params:
| p09_res_card_type        | 02 |
| p09_res_msg_version      | 02 |
| p09_res_transaction_type | 01 |
| p09_res_card_status      | R  |
And I Wait until Element ""title"" contains ""Card removed\nTransaction canceled"""
Unknown,"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data |                                              |"
Unknown,"And I should not receive in ""2"" seconds anything from terminal
Then I Wait until Element ""title"" contains ""Card removed\nTransaction canceled""
And I successfully changed configuration ""0019"" ""0001"" to ""0"""
Card Swipe,"And I successfully changed configuration ""0019"" ""0021"" to ""0""
Examples:
| test_case                                | adf              | cardholder_name  | pan             | exp_date | amount |
| AXP QC 032 - Online PIN - Successful PIN | A000000025010801 | AEIPS 22/VER 2.3 | 374245001751006 | 2512     | 3250   |
Scenario Outline: Send 23.x Card Read Request Tap and Remove contacless card then swipe ."
Unknown,"Given I successfully changed configuration ""0008"" ""0001"" to ""9""
And I initiating Collis Test Case with the following params:
| brand     | Visa                                 |
| interface | contactless                          |
| test_plan | 06_VisaL3Testing_series_01_build_019 |
| test_case | <test_case>                          |
And I wait 20 seconds"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Send Amount,"When  I send a 13.x amount message to the terminal with:
| p13_req_amount   | <amount> |
| p13_req_cashback |          |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 371        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | MC         |
And I Wait until Element ""title"" contains ""Tap""
And I tap contactless card
Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                          |
| p23_res_card_source | E                          |
| p23_res_track1      |                            |
| p23_res_track2      | <pan>=<exp_date><add_data> |
| p23_res_track3      | @regexp:.*                 |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| p33_02_res_status                  | 00         |
| p33_02_res_emvh_current_packet_nbr | 0          |
| p33_02_res_emvh_packet_type        | 0          |
| p33_02_res_payload                 | @regexp:.+ |
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
Then  the reported ""track2_equivalent_data"" container should have the following params:
| tag    | name                                         | value                      |
| 0x4F   | application_identifier                       | <adf>                      |
| 0x57   | track_2_equivalent_data                      | <pan>D<exp_date><add_data> |
| 0x84   | dedicated_file_df_name                       | <adf>                      |
| 0x1002 | ingenico_proprietary_signature_required_flag | 0                          |
| 0x5F28 | issuer_country_code_kernel_2                 | 0840                       |
| 0x5F20 | cardholder_name                              | <cardholder_name>          |
| 0x5F24 | application_expiration_date                  | <exp_date>31               |
| 0x9F1A | terminal_country_code                        | 0840                       |
| 0x9F1B | terminal_floor_limit                         | 00002710                   |
| 0xFF25 | Encryption/Whitelisting_mode                 | 00                         |"
Unknown,"When I enter pin ""1234"""
Unknown,"Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| p33_03_req_status                  | 00         |
| p33_03_req_emvh_current_packet_nbr | 0          |
| p33_03_req_emvh_packet_type        | 0          |
| p33_03_req_payload                 | @regexp:.+ |
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
Then the reported ""authorization_request_data"" container should have the following params:
| tag    | name                                           | value                      |
| 0x4F   | application_identifier                         | <adf>                      |
| 0x57   | track_2_equivalent_data                        | <pan>D<exp_date><add_data> |
| 0x84   | dedicated_file_df_name                         | <adf>                      |
| 0x95   | terminal_verification_results                  | 0000000000                 |
| 0x9C   | transaction_type                               | 00                         |
| 0x1002 | ingenico_proprietary_signature_required_flag   | 0                          |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                         |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | 1                          |
| 0x5F20 | cardholder_name                                | <cardholder_name>          |
| 0x5F24 | application_expiration_date                    | <exp_date>31               |
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                       |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                          |
| 0x9001 | ingenico_proprietary_card_entry_mode           | D                          |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>           |
| 0x9F03 | amount_other                                   | 000000000000               |
| 0x9F1A | terminal_country_code                          | 0840                       |
| 0x9F1B | terminal_floor_limit                           | 00002710                   |
| 0x9F26 | application_cryptogram                         | @regexp:[0-9A-Fa-f]{16}    |
| 0x9F27 | cryptogram_information_data                    | 80                         |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6}     |
| 0x9F34 | cardholder_verification_method_cvm_results     | @regexp:[048C]{1}20300     |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}              |
| 0x9F39 | point_of_service_pos_entry_mode                | 07                         |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                         |
When I send a 33.04 Authorization Response message to the terminal with params:
| p33_04_res_status                  | 00             |
| p33_04_res_emvh_current_packet_nbr | 0              |
| p33_04_res_emvh_packet_type        | 0              |
| p33_04_res_payload                 | T008A:0002:a00 |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| p33_05_res_status                  | 00         |
| p33_05_res_emvh_current_packet_nbr | 0          |
| p33_05_res_emvh_packet_type        | 0          |
| p33_05_res_payload                 | @regexp:.* |
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| tag    | name                                           | value                      |
| 0x4F   | application_identifier                         | <adf>                      |
| 0x57   | track_2_equivalent_data                        | <pan>D<exp_date><add_data> |
| 0x84   | dedicated_file_df_name                         | <adf>                      |
| 0x8A   | authorisation_response_code                    | 00                         |
| 0x95   | terminal_verification_results                  | 0000000000                 |
| 0x9C   | transaction_type                               | 00                         |
| 0x1002 | ingenico_proprietary_signature_required_flag   | 0                          |
| 0x1005 | ingenico_proprietary_transaction_type          | 00                         |
| 0x100F | ingenico_proprietary_pin_entry_successful_flag | 1                          |
| 0x5F20 | cardholder_name                                | <cardholder_name>          |
| 0x5F24 | application_expiration_date                    | <exp_date>31               |
| 0x5F28 | issuer_country_code_kernel_2                   | 0840                       |
| 0x9000 | ingenico_proprietary_card_payment_type         | B                          |
| 0x9001 | ingenico_proprietary_card_entry_mode           | D                          |
| 0x9F02 | amount_authorised_kernel_v2                    | 00000000<amount>           |
| 0x9F03 | amount_other                                   | 000000000000               |
| 0x9F1A | terminal_country_code                          | 0840                       |
| 0x9F1B | terminal_floor_limit                           | 00002710                   |
| 0x9F26 | application_cryptogram                         | @regexp:[0-9A-Fa-f]{16}    |
| 0x9F27 | cryptogram_information_data                    | 80                         |
| 0x9F33 | terminal_capabilities                          | @regexp:[0-9A-Fa-f]{6}     |
| 0x9F34 | cardholder_verification_method_cvm_results     | @regexp:[048C]{1}20300     |
| 0x9F35 | terminal_type                                  | @regexp:\d{2}              |
| 0x9F39 | point_of_service_pos_entry_mode                | 07                         |
| 0xDF03 | pin_try_limit_kernel_v2                        | DC4000A800                 |
| 0xDF04 | pin_try_counter                                | 0010000000                 |
| 0xDF05 | aip_for_visa_contactless                       | DC4004F800                 |
| 0xFF25 | Encryption/Whitelisting_mode                   | 00                         |
And I Wait until Element ""title"" contains ""Approved"""
Unknown,"When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><add_data> |
| track2_data | <pan>=<exp_date>201<disc_data_t2>  |
| track3_data |                                    |"
Unknown,"And I should not receive in ""2"" seconds anything from terminal
Then I Wait until Element ""title"" contains ""Approved""
And I successfully changed configuration ""0008"" ""0001"" to ""0""
Examples:
| test_case     | adf            | cardholder_name | pan              | exp_date | add_data    | amount | disc_data_t2  |
| VISA.TC.1002a | A0000000031010 | L3TEST/CARD1002 | 4761731000000027 | 3112     | 20119058101 | 1600   | 0000014000001 |
@msr @fpe @00x @62x @61x @63x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate steps of deleting package and files from terminal
""""""
this testcase is to validate the steps of deleting a file and a package from terminal
""""""
Scenario Outline: delete a file from terminal"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent file through 62.x Write File request with:
| p62_req_file_name       | <path>     |
| p62_req_encoding_format | 7          |
| p62_req_fast_download   | 1          |
| p62_req_unpack_flag     | 0          |
| p62_req_record_type     | 0          |
| p62_req_segment_nbr     | 01         |
| p62_req_file_data       | @regexp:.* |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 63.x Find File message to the terminal with:
| p63_req_file_name | Test.txt |
And I should receive the 63.x Find File response from terminal with params:
| p63_res_result      | 0  |
| p63_res_file_length | 40 |
When I delete file ""/sdcard/Android/data/com.ingenico.retail.arcapp/files/Test.txt"" from terminal
And I send a 63.x Find File message to the terminal with:
| p63_req_file_name | Test.txt |
Then I should receive the 63.x Find File response from terminal with params:
| p63_res_result      | 1 |
| p63_res_file_length | 0 |
Examples:
| path           |
| Files/Test.txt |
Scenario: Enable encryption and Whitelisting Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardFPE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
When I have successfully sent ""Files/whitelisting/apstitan_on.apk"" file using these params:
| p62_req_file_name       | apstitan_on.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
Scenario Outline: Validate steps of deleting package from terminal"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |"
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | 1000 |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I swipe card using this params:
| track1_data | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2_data | <pan>=<exp_date><code><disc_data_t2>         |
| track3_data | <additional_data><additional_data>           |"
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | @regexp:.+                                   |
When I uninstall package ""com.ingenico.retail.aps.secure.parameters"" from terminal"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |
#    Then I should receive the 23.x Card Read response from terminal with params:
#      | p23_res_exit_type   | 0          |
#      | p23_res_card_source | M          |
#      | p23_res_track1      | @regexp:.+ |
#      | p23_res_track2      | @regexp:.+ |
#      | p23_res_track3      | @regexp:.+ |"
Unknown,"And decrypted field ""p23_res_track3"" with ON GUARD algorithm should match the following MSR data:
| track2 | <pan>=<exp_date><code><disc_data_t2> |
Examples:
| card_type  | pan              | name      | exp_date | code | disc_data_t1    | disc_data_t2  | additional_data      | masked_pan       | masked_disc_data_t1 | masked_disc_data_t2 |
| Mastercard | 5413330089020011 | TEST/CARD | 2412     | 221  | 000000140000000 | 0000014000001 | 01234567890123456789 | 5413330000000011 | 000000000000000     | 0000000000000       |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@sde @msr @00x @62x @61x @41x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate step of decryption for On-Guard SDE dukpt Encryption for MSR transaction
Scenario: Enable OGSDE DUKPT with AES128 Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES128.apk"" file using these params:
| p62_req_file_name       | ArcOnGuard-SDE-AES128.apk |
| p62_req_encoding_format | B                         |
| p62_req_fast_download   | 1                         |
| p62_req_unpack_flag     | 0                         |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
Scenario Outline: On-Guard SDE DUKPT AES Encryption For MSR Transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Unknown,"When I send a 41.x Card Read Message message to the terminal with params:
| p41_req_parse_flag       | 1 |
| p41_req_msr_flag         | 1 |
| p41_req_contactless_flag | 0 |
| p41_req_smc_flag         | 0 |"
Unknown,And I wait for 2 seconds
Unknown,"And Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |"
Unknown,And I wait 2 seconds
Unknown,"Then I should receive the 41.x Card Read Message response from terminal with params:
| p41_res_source          | M                                                            |
| p41_res_encryption      | 19                                                           |
| p41_res_track_1_status  | 0                                                            |
| p41_res_track_2_status  | 0                                                            |
| p41_res_track_3_status  | 0                                                            |
| p41_res_track_1         | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p41_res_track_2         | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p41_res_track_3         | @regexp:.+                                                   |
| p41_res_pan             | <masked_pan>                                                 |
| p41_res_masked_pan      | <masked_pan>                                                 |
| p41_res_expiration_date | <exp_date>                                                   |
| p41_res_account_name    | <name>                                                       |
| p41_res_error_code      | 0                                                            |
######################### MSR transaction decryption for SDE AES DUKPT#############################"
Unknown,"And decrypted field 'p41_res_track_3' with AES DUKPT algorithm should match the following MSR data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\x00<pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters                          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       | \x00\x00\x00\x00\x00\x00\x00\x00         |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00                 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00 |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00\x00\x00\x00\x00                 |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00                 |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@msr @fpe @00x @61x @23x @62x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @known_issue @ARC-5904
Feature: Validate On-Guard FPE simplify decryption step for MSR Transaction
""""""
This feature file Validates decryption step  for FPE simplify
ARC-5904: decryption of FPE simplify dont work for PAN lengths<=14 digits
""""""
Scenario: Enable On-Guard FPE Encryption Configuration format simplify"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnguardFPEsimplfy.apk"" file using these params:
| p62_req_file_name       | ArcOnguardFPEsimplfy.apk |
| p62_req_encoding_format | B                        |
| p62_req_fast_download   | 1                        |
| p62_req_unpack_flag     | 0                        |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
Scenario Outline: On-Guard FPE Encryption For MSR Transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:^B.+\|.+\|.{20}050006$                               |"
Unknown,"Then decrypted field 'p23_res_track3' with ON GUARD Simplify algorithm should match the following data:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | @regexp:.*                                   |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2    | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001   | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001   | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000  |                      | 374245000001008  | 000000000                    | 00000000000000      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100   |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000   |                      | 6510000000000091 | 0000000000000                | 0000000000000       |
#      | Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000   |                      | 36039600000472   | 00000000000000000000         | 0000000000000       |
#      | Diners     | 36070500001335   | CARD/IMAGE 33      | 1712     | 201  | 12010000000000000081000000   | 120100008100000 |                      | 36070500001335   | 00000000000000000000000000   | 000000000000000     |
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000   | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       |
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000   | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       |
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@p2p @secbin @chapter_x @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable chapter_x Encryption Configuration
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000 @aes128 @aes192 @aes256
Feature: Disable On-Guard SDE DUKPT Encryption Configuration
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @jobs @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable On-Guard SDE Encryption Configuration
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @rsa @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable RSA Encryption Configuration
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @voltage @tep2 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable Voltage TEP2 Encryption Configuration
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @voltage @tep4 @msr @me @dme @emv @cless @61x @62x @00x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable Voltage TEP4 Encryption Configuration
Scenario: Disable Voltage TEP4 Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @voltage @tep6 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable Voltage TEP6 Encryption Configuration
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@secbin @voltage @tep7 @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Disable Voltage TEP7 Encryption Configuration
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
@p2p @msr @me @dme @emv @cless @secbin @chapter_x @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable chapter_x Encryption Configuration
Scenario: Enable chapterX Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcSec_chapter_X.apk"" file using these params:
| p62_req_file_name       | ArcSec_chapter_X.apk |
| p62_req_encoding_format | B                    |
| p62_req_fast_download   | 1                    |
| p62_req_unpack_flag     | 0                    |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 30 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
@secbin @fpe @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable On-Guard FPE Encryption Configuration
Scenario: Enable On-Guard FPE Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardFPE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardFPE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 2  |
@secbin @sde @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable On-Guard SDE DUKPT AES Encryption Configuration
@aes128
Scenario: Enable OGSDE DUKPT with AES128 Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES128.apk"" file using these params:
| p62_req_file_name       | ArcOnGuard-SDE-AES128.apk |
| p62_req_encoding_format | B                         |
| p62_req_fast_download   | 1                         |
| p62_req_unpack_flag     | 0                         |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@aes192
Scenario: Enable OGSDE DUKPT with AES192 Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES192.apk"" file using these params:
| p62_req_file_name       | ArcOnGuard-SDE-AES192.apk |
| p62_req_encoding_format | B                         |
| p62_req_fast_download   | 1                         |
| p62_req_unpack_flag     | 0                         |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@aes256
Scenario: Enable OGSDE DUKPT with AES256 Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuard-SDE-AES256.apk"" file using these params:
| p62_req_file_name       | ArcOnGuard-SDE-AES256.apk |
| p62_req_encoding_format | B                         |
| p62_req_fast_download   | 1                         |
| p62_req_unpack_flag     | 0                         |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@secbin @rsa @msr @me @dme @emv @cless @00x @62x @61x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable RSA Encryption Configuration
Scenario: Enable RSA Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcRSA-OAEP.apk"" file using these params:
| p62_req_file_name       | ArcRSA-OAEP.apk |
| p62_req_encoding_format | B               |
| p62_req_fast_download   | 1               |
| p62_req_unpack_flag     | 0               |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 9  |
@p2p @secbin @msr @me @dme @emv @cless @voltage @tep2 @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable Voltage TEP2 Encryption Configuration
Scenario: Enable Voltage TEP2 Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/voltage_5_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_5_default-signed.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 5  |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
@p2p @secbin @voltage @tep4 @msr @me @dme @emv @cless @00x @61x @62x @p2p @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable Voltage TEP4 Encryption Configuration
Scenario: Enable Voltage TEP4 Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/voltage_6_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_6_default-signed.apk |
| p62_req_encoding_format | B                            |
| p62_req_fast_download   | 1                            |
| p62_req_unpack_flag     | 0                            |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0           |
| p62_res_file_length | @regexp:\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 6  |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
@p2p @secbin @voltage @tep6 @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable Voltage TEP6 Encryption Configuration
Scenario: Enable Voltage TEP6 Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/voltage_31_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_31_default-signed.apk |
| p62_req_encoding_format | B                             |
| p62_req_fast_download   | 1                             |
| p62_req_unpack_flag     | 0                             |
And I should receive the 62.x File Write response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 31 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |
@p2p @secbin @voltage @tep7 @msr @me @dme @emv @cless @00x @62x @61x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Enable Voltage TEP7 Encryption Configuration
Scenario: Enable Voltage TEP7 Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/voltage_32_default-signed.apk"" file using these params:
| p62_req_file_name       | voltage_32_default-signed.apk |
| p62_req_encoding_format | B                             |
| p62_req_fast_download   | 1                             |
| p62_req_unpack_flag     | 0                             |
And I should receive the 62.x File Write response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 32 |
When I send a 90.x MSR Encryption message to the terminal with:
| p90_req_function | 0 |
Then I should receive the 90.x MSR Encryption response from terminal with params:
| p90_res_function | 0          |
| p90_res_status   | 0          |
| p90_res_etb      | @regexp:.* |"
Precondition,"@pin_code @msr @00x @61x @23x @31x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature:  Validate  pin block decryption is correct for master session pin when encryption is off
""""""
This feature file Feature Validates master session pin when encryption is off
testlink testcase : https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1230
""""""
Scenario Outline: Validate master session pin when encryption is off
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |
##################select master session pin################"""
Unknown,"And I successfully changed configuration ""0006"" ""0007"" to ""0"""
Unknown,"And I successfully changed configuration ""0006"" ""0008"" to ""0""
################## swipe the card #########################"""
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | 1000 |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
CVM Process,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 |                                              |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      |                                              |
#################### send 31.x message for pin entry #############################"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |"
CVM Process,"When I send a 31.x PIN Entry message to the terminal with:
| p31_req_prompt_index_number          | 1                                                |
| p31_req_customer_acc_num             | @cache:upp:response:-1:['p29_res_variable_data'] |
| p31_req_set_encryption_configuration | 0                                                |
| p31_req_set_key_type                 | M                                                |
| p31_req_form_name                    |                                                  |
############################### enter pin #############################
And I enter pin ""<pin_code>""
Then I should receive the 31.x PIN Entry response from terminal with params:
| p31_res_status   | 0          |
| p31_res_pin_data | @regexp:.* |
################################# decrypt the enetered pin ###############################"
Unknown,"And I will decrypt pin block M/S from 'p31_res_pin_data' using the sequence of pan: '<pan>' and initial vector '<initial_vector>' and expect:
| length   | <pin_length>                  |
| pin_code | <pin_code>                    |
| tail     | <tail>                        |
| pinblock | 0<pin_length><pin_code><tail> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | initial_vector   | pin_code | pin_length | tail       |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 0000000000000000 | 0000     | 4          | ffffffffff |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 | 0000000000000000 | 1234     | 4          | ffffffffff |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  | 0000000000000000 | 12345    | 5          | fffffffff  |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  | 0000000000000000 | 4321     | 4          | ffffffffff |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 5522     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 221100   | 6          | ffffffff   |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 1133     | 4          | ffffffffff |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 0000000000000000 | 22110055 | 8          | ffffff     |
@msr @23x @20x @29x @00x @13x @24x @credit
Feature: MSR Credit Signature transaction with various card brands
""""""
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-917
""""""
@dx8000 @ex8000 @dx4000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |"
Unknown,"And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible
When Draw line from 100x800 to 200x500
And Draw line from 200x500 to 300x800
And Draw line from 100x800 to 200x500
And Draw line from 200x500 to 300x800
And Draw line from 140x700 to 250x700"
Unknown,"And I click Element ""btn_enter"""
Unknown,"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |
| p20_res_data   | 4 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |"
Transaction Completion,"Then I Wait until Element ""title"" contains ""Transaction complete"""
Display Confirmation,"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I wait for 2 seconds
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
@rx5000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |"
Unknown,"And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible
Then Draw line from 200x300 to 300x400
Then Draw line from 300x500 to 400x600
Then Draw line from 400x500 to 100x800"
Unknown,"And I click Element ""btn_enter"""
Unknown,"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |
| p20_res_data   | 3 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |"
Transaction Completion,"Then I Wait until Element ""title"" contains ""Transaction complete"""
Display Confirmation,"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I wait for 2 seconds
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
@rx7000
Scenario Outline: Perform MSR Credit Signature Transaction with Tracks_1&2&3 and Tracks_1&2  cards for various card brands"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | confirmation_amount |
| p24_req_type_of_element | T                   |
| p24_req_prompt_idx      | 10                  |
| p24_req_text_element_id | title               |
Then I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter""
Then I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type    | 0        |
| p24_res_keyid        | \x1F     |
| p24_res_buttonid     | b        |
| p24_res_button_state | tn_enter |"
Unknown,"And I wait for 1 second
When I send a 20.x Signature message to the terminal with params:
| p20_req_prompt_index | 165  |
| p20_req_form_name    | SIGN |
Then I wait until Element ""paint_view"" visible
Then Draw line from 200x300 to 300x400
Then Draw line from 300x400 to 1100x500
Then Draw line from 600x500 to 1000x200"
Unknown,"And I click Element ""btn_enter"""
Unknown,"Then I should receive the 20.x Signature request response from terminal with params:
| p20_res_status | 0 |
| p20_res_data   | 3 |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000700 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000700           |
| p29_res_variable_data | @skip_comparison |
When I send a 29.x Get Variable message to the terminal with params:
| p29_req_variable_id | 000701 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2                |
| p29_res_variable_id   | 000701           |
| p29_res_variable_data | @skip_comparison |"
Unknown,And I wait for 1 second
Display Confirmation,"When I send a 24.x Form Entry message to the terminal with params:
| p24_req_form_number     | status_title_only |
| p24_req_type_of_element | T                 |
| p24_req_prompt_idx      | 352               |
| p24_req_text_element_id | title             |"
Transaction Completion,"Then I Wait until Element ""title"" contains ""Transaction complete"""
Display Confirmation,"And I should receive the 24.x Form Entry response from terminal with params:
| p24_res_exit_type | 0    |
| p24_res_keyid     | \x1F |"
Unknown,"And I wait for 2 seconds
Examples:
| card_type  | amount | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 120    | 5413339000000119 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 1234   | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 56789  | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 987654 | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 87654  | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
@msr @00x @23x @13x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: validate track sentinel for msr transaction
""""""
This feature file validates track sentinel for msr transaction
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1000
https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1031
""""""
Scenario Outline: validate track sentinel for msr transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Send Amount,"And I send a 13.x amount message to the terminal with:
| p13_req_amount | 1000 |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 311        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | M          |
Then I Wait until Element ""title"" contains ""Please swipe or insert card"""
Unknown,"And  I wait until Element ""btn_cancel"" visible"
Unknown,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
################ clear tracks : track 1 starts with B , track 2 starts with pan #############"
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                            |
| p23_res_card_source | M                                            |
| p23_res_track1      | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| p23_res_track2      | <pan>=<exp_date><code><disc_data_t2>         |
| p23_res_track3      | <additional_data><additional_data>           |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000398 |
| p29_res_variable_data | <pan>  |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 000400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2612     | 221  | 361010000000000933000000     | 0000014000001  | 01234567890123456789 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
##################### validate track sentinels when encryption is ON #########################
@sde
Scenario: Enable On-Guard SDE Encryption Configuration"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcOnGuardSDE.apk"" file using these params:
| p62_req_file_name       | ArcOnGuardSDE.apk |
| p62_req_encoding_format | B                 |
| p62_req_fast_download   | 1                 |
| p62_req_unpack_flag     | 0                 |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |"
Precondition,"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
@sde
Scenario Outline: validate start sentinel and end sentinel for 23. eft message when encryption is on
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |"
Unknown,"And  I successfully changed configuration ""0008"" ""0001"" to ""9""
And I successfully changed configuration ""0019"" ""0001"" to ""1"""
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
#################Track 1 : Start sentinel % , End sentinel ?
#################Track2 : Start sentinel ; , End sentinel ?
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
Unknown,"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | B<pan>^<name>^<exp_date><code><disc_data_t1>\|<pan>=<exp_date><code><disc_data_t2><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       |                          |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00\x00\x00\x00 |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 |
@sde
Scenario: Teardown - Reset to Default State"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Unknown,"When I have successfully sent ""Files/p2p_encryptions/ArcNoEncryption.apk"" file using these params:
| p62_req_file_name       | ArcNoEncryption.apk |
| p62_req_encoding_format | B                   |
| p62_req_fast_download   | 1                   |
| p62_req_unpack_flag     | 0                   |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0          |
| p62_res_file_length | @regexp:.* |
When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 0  |"
Unknown,"@msr @collis @emv @unionpay @signature_cvm @credit @00x @13x @23x @33x @04x @09x @dx8000 @ex8000 @rx5000 @rx7000
Feature: Validate UnionPay collis testcase TAIS_POS_004
""""""
- Requirement: Mandatory
- Test purpose and description : To validate POS is able to complete the credit transaction correctly
and terminal will only check the first digit of the service code.
Teminal support the track 1 data contain Chinese characters
- Card No: FT04
- Amount: 400
- Testing Steps:
1. Please swipe a card first and the terminal shall prompt to use a chip card.
2. Please insert a card and select purchase function.
3. Choose 'UICC Credit'.
4. Enter ""400.00"" as transaction amount.
5. Enter a correct online PIN as '111111' if required.
6. Processing completion
- Expected result/note
1. The terminal goes online to complete the transaction;
2. The transaction is approved.
Collis reports :resources\Collis\Reports\contact\UnionPay\Functional_V202205\POS\TAIS_POS_004.zip
Notes :
- Testcase does not contain EMV tag cardholder name (0x9F20)
- Testcase contains card image issue : the value of EMV-tag ""0x9F1F"" = ""          0775""
- Step 1. is is simulated in current Feature
""""""
Scenario Outline: Instructions to cover testcase TAIS_POS_004
####################### Enable EMV Contact reader #######################"
Unknown,"Given I successfully changed configuration ""0019"" ""0001"" to ""1""
And I successfully changed configuration ""0008"" ""0001"" to ""0""
####################### Initiating Collis #######################
When  I initiating Collis Test Case with the following params:
| brand     | UnionPay           |
| interface | contact            |
| test_plan | Functional_V202205 |
| test_case | <test_case>        |
And I wait 20 seconds"
Precondition,"And I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
####################### Start Transaction #######################"
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
####################### Swipe card step #######################"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I swipe card using this params:
| track1_data | B<PAN>^<app_label>^<exp_date><code><add_data> |
| track2_data | <PAN>=<exp_date><code><add_data>              |
| track3_data |                                               |"
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                             |
| p23_res_card_source | M                                             |
| p23_res_track1      | B<PAN>^<app_label>^<exp_date><code><add_data> |
| p23_res_track2      | <PAN>=<exp_date><code><add_data>              |
| p23_res_track3      |                                               |
####################### EMV Transaction flow #######################
When I insert card
And I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 100        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | S          |"
Card Swipe,"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0 |
| p23_res_card_source | S |
| p23_res_track1      |   |
| p23_res_track2      |   |
| p23_res_track3      |   |"
Unknown,"And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
When I send a 33.00 EMV Transaction Initiation message to the terminal with:
| p33_00_req_status                  | 00 |
| p33_00_req_emvh_current_packet_nbr | 0  |
| p33_00_req_emvh_packet_type        | 0  |
Then I Wait until Element ""title"" contains ""<app_label>\nPlease wait\nDo not remove card""
And  I should receive the 33.00 Emv Transaction Initiation response from terminal with params:
| p33_00_res_status                  | 00 |
| p33_00_res_emvh_current_packet_nbr | 0  |
| p33_00_res_emvh_packet_type        | 0  |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| p33_02_res_status                  | 00         |
| p33_02_res_emvh_current_packet_nbr | 0          |
| p33_02_res_emvh_packet_type        | 0          |
| p33_02_res_payload                 | @regexp:.+ |
####################### 33.02 payload verification #######################
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
Then  the reported ""track2_equivalent_data"" container should have the following params:
| tag    | name                         | value                             |
| 0x4F   | application_identifier       | <AID>02                           |
| 0x50   | application_label            | <app_label>                       |
| 0x57   | track_2_equivalent_data      | <PAN>D<exp_date><code><add_data>F |
| 0x5A   | Primary_Account_Number_(PAN) | <PAN>                             |
| 0x84   | dedicated_file_df_name       | <AID>02                           |
| 0x5F20 | cardholder_name              | UICC<test_card>                   |
| 0x5F24 | application_expiration_date  | <exp_date>31                      |
| 0x5F28 | Issuer_Country_Code          | 0156                              |
| 0x5F2D | preferred_languages          | cn                                |
| 0x9F07 | Application_Usage_Control    | FF00                              |
| 0x9F09 | Application_Version_Number   | @regexp:\d{4}                     |
| 0x9F1A | Terminal_Country_Code        | 0840                              |
| 0x9F1B | Terminal_Floor_Limit         | 00000000                          |
#      | 0x9F1F | Track1_Discretionary_Data    | @regexp:[\s]{10}0775              |
| 0xFF25 | Encryption_Whitelisting_Mode | 00                                |
| 0x100E | User_Language                | EN                                |
#####################################################################
When I send a 04.x Set Payment Type message to the terminal with params:
| p04_req_force_payment_type | 1   |
| p04_req_payment_type       | B   |
| p04_req_amount             | 000 |
Then I should receive the 04.x Set Payment Type response from terminal with params:
| p04_res_force_payment_type | 0   |
| p04_res_payment_type       | B   |
| p04_res_amount             | 000 |"
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Unknown,"And I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter"""
Unknown,"Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| p33_03_req_status                  | 00         |
| p33_03_req_emvh_current_packet_nbr | 0          |
| p33_03_req_emvh_packet_type        | 0          |
| p33_03_req_payload                 | @regexp:.+ |
####################### 33.03 payload verification #######################
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
Then the reported ""authorization_request_data"" container should have the following params:
| tag    | name                                       | value                             |
| 0x4F   | application_identifier                     | <AID>02                           |
| 0x50   | Application_Label                          | <app_label>                       |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}            |
| 0x84   | dedicated_file_df_name                     | <AID>02                           |
| 0x95   | terminal_verification_results              | 000800E000                        |
| 0x9A   | transaction_date                           | @regexp:\d{6}                     |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}            |
| 0x9C   | transaction_type (Purchase)                | 00                                |
| 0x5F20 | cardholder_name                            | UICC<test_card>                   |
| 0x5F24 | application_expiration_date                | <exp_date>31                      |
| 0x5F2A | Transaction_Currency_Code                  | 0840                              |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                    |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>02                           |
| 0x9F07 | Application_Usage_Control                  | FF00                              |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                     |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                     |
| 0x9F0D | issuer_action_code_default                 | FC609CA800                        |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                        |
| 0x9F0F | issuer_action_code_online                  | FC689CF800                        |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}           |
| 0x9F1A | terminal_country_code                      | 0840                              |
| 0x9F1B | terminal_floor_limit                       | 00000000                          |
#      | 0x9F1F | Track1_Discretionary_Data                  | @regexp:[\s]{10}0775              |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                     |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}           |
| 0x9F27 | cryptogram_information_data                | 80                                |
| 0x9F33 | terminal_capabilities                      | E0F8C8                            |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300              |
| 0x9F35 | terminal_type                              | 22                                |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}            |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                        |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                |
#Ingenico property
| 0x1001 | pin_entry_required_flag                    | 0                                 |
| 0x1002 | signature_required_flag                    | 1                                 |
| 0x1005 | transaction_type                           | 00                                |
| 0x100E | User_Language                              | EN                                |
| 0x100F | pin_entry_successful_flag                  | 0                                 |
| 0x9000 | card_payment_type                          | B                                 |
| 0x9001 | card_entry_mode                            | C                                 |
#####################################################################
When I send a 33.04 Authorization Response message to the terminal with params:
| p33_04_res_status                  | 00             |
| p33_04_res_emvh_current_packet_nbr | 0              |
| p33_04_res_emvh_packet_type        | 0              |
| p33_04_res_payload                 | T008A:0002:a00 |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| p33_05_res_status                  | 00         |
| p33_05_res_emvh_current_packet_nbr | 0          |
| p33_05_res_emvh_packet_type        | 0          |
| p33_05_res_payload                 | @regexp:.* |
####################### 33.05 payload verification #######################
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| tag    | name                                       | value                             |
| 0x4F   | application_identifier                     | <AID>02                           |
| 0x50   | Application_Label                          | <app_label>                       |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}            |
| 0x84   | dedicated_file_df_name                     | <AID>02                           |
| 0x89   | Authorization_Code                         | 3030                              |
| 0x8A   | authorisation_response_code                | 00                                |
| 0x8E   | cardholder_verification_method_cvm_list    | 00000000000000005E0342031F00      |
| 0x95   | terminal_verification_results              | 000800E000                        |
| 0x9A   | transaction_date                           | @regexp:\d{6}                     |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}            |
| 0x9C   | transaction_type (Purchase)                | 00                                |
| 0x5F20 | cardholder_name                            | UICC<test_card>                   |
| 0x5F24 | application_expiration_date                | <exp_date>31                      |
| 0x5F28 | Issuer_Country_Code                        | 0156                              |
| 0x5F2A | Transaction_Currency_Code                  | 0840                              |
| 0x5F2D | Preferred_Languages                        | cn                                |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                    |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>02                           |
| 0x9F07 | Application_Usage_Control                  | FF00                              |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                     |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                     |
| 0x9F0D | issuer_action_code_default                 | FC609CA800                        |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                        |
| 0x9F0F | issuer_action_code_online                  | FC689CF800                        |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}           |
| 0x9F1A | terminal_country_code                      | 0840                              |
| 0x9F1B | terminal_floor_limit                       | 00000000                          |
#      | 0x9F1F | Track1_Discretionary_Data                  | @regexp:[\s]{10}0775              |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                     |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}           |
| 0x9F27 | cryptogram_information_data                | 40                                |
| 0x9F33 | terminal_capabilities                      | E0F8C8                            |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300              |
| 0x9F35 | terminal_type                              | 22                                |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}            |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                        |
| 0xDF03 | Terminal_Action_Code_(TAC)_Default         | D84000A800                        |
| 0xDF04 | Terminal_Action_Code_Denial                | 0010000000                        |
| 0xDF05 | Terminal_Action_Code_Online                | D84004F800                        |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                |
#Ingenico property
| 0x1001 | pin_entry_required_flag                    | 0                                 |
| 0x1002 | signature_required_flag                    | 1                                 |
| 0x1003 | Confirmation_Response_Code                 | A                                 |
| 0x1005 | transaction_type                           | 00                                |
| 0x100E | User_Language                              | EN                                |
| 0x100F | pin_entry_successful_flag                  | 0                                 |
| 0x9000 | card_payment_type                          | B                                 |
| 0x9001 | card_entry_mode                            | C                                 |
#####################################################################
And I Wait until Element ""title"" contains ""Approved\nPlease remove card""
When  I remove card
And I wait 4 seconds
Then I should receive the 09.x Set Allowed Payments response from terminal with params:
| p09_res_card_type        | 02 |
| p09_res_msg_version      | 02 |
| p09_res_transaction_type | 01 |
| p09_res_card_status      | R  |
And I Wait until Element ""title"" contains ""Approved""
####################### Terminal Offline #######################"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
####################### Manual Validations #######################
#No manual validation
####################### Finalize collis #######################"
Unknown,"When I finalizing Collis Test Case as ""approved""
Then I expect Collis Test Case to be ""passed""
Examples:
| test_case    | AID            | app_label        | PAN              | test_card | exp_date | code | add_data      | amount |
| TAIS_POS_004 | A0000003330101 | UICC Credit Card | 6210948000000045 | FT04      | 3010     | 220  | 0000000000000 | 400000 |"
Unknown,"@msr @collis @emv @unionpay @signature_cvm @credit @00x @13x @23x @33x @04x @09x @dx8000 @ex8000 @rx5000 @rx7000
Feature: Validate UnionPay collis testcase TAIS_POS_005
""""""
- Requirement: Mandatory
- Test purpose and description : To validate POS is able to complete the quasi credit transaction correctly
when the application Label(Tag:50) and Application Preferred Name(Tag:9F12) contain Chinese Characters
- Card No: FT05
- Amount: 500
- Testing Steps:
1.Please swipe a card first and the terminal shall prompt to use a chip card.
2.Please insert a card and select purchase function.
3. Choose 'UICC Quasi Credit'.
4. Enter ""500.00"" as transaction amount.
5. Enter a correct online PIN as '111111' if required.
6. Processing completion
- Expected result/note
1. The terminal goes online to complete the transaction;
2. The transaction is approved.
Collis reports :resources\Collis\Reports\contact\UnionPay\Functional_V202205\POS\TAIS_POS_005.zip
Note :
- Cucumber does not support Chinese words
- The Application Label from the image card is : D2 F8 C1 AA 36 32 B1 EA D7 BC BF A8 40 B2 E2 CA D4 D7 A8 D3 C3 43 61 72 64 73
- encoded using Character encoding GB 18030 (Chinese) :  62@Cards (in English : UnionPay 62 Standard Card@Test Cards)
- The Application Label only detects the readable characters (0x5F20 = '    62      @        Cards')
""""""
Scenario Outline: Instructions to cover testcase TAIS_POS_005
####################### Enable EMV Contact reader #######################"
Unknown,"Given I successfully changed configuration ""0019"" ""0001"" to ""1""
And I successfully changed configuration ""0008"" ""0001"" to ""0""
####################### Initiating Collis #######################
When  I initiating Collis Test Case with the following params:
| brand     | UnionPay           |
| interface | contact            |
| test_plan | Functional_V202205 |
| test_case | <test_case>        |
And I wait 20 seconds"
Precondition,"And I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
####################### Start Transaction #######################"
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Unknown,"And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
####################### Swipe card step #######################"
Card Swipe,"When I send a 23.x Card Read message to the terminal with:
| p23_req_prompt_index   | 312 |
| p23_req_enable_devices | M   |
Then I Wait until Element ""title"" contains ""Insert, Swipe or Tap Card""
When I swipe card using this params:
| track1_data | B<PAN>^<app_label>^<exp_date><code><add_data> |
| track2_data | <PAN>=<exp_date><code><add_data>              |
| track3_data |                                               |"
Card Swipe,"Then I should receive the 23.x Read Card response from terminal with params:
| p23_res_exit_type   | 0                                             |
| p23_res_card_source | M                                             |
| p23_res_track1      | B<PAN>^<app_label>^<exp_date><code><add_data> |
| p23_res_track2      | <PAN>=<exp_date><code><add_data>              |
| p23_res_track3      |                                               |
####################### EMV Transaction flow #######################
When I insert card
And I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 100        |
| p23_req_form_name      | read_cards |
| p23_req_enable_devices | S          |"
Card Swipe,"Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0 |
| p23_res_card_source | S |
| p23_res_track1      |   |
| p23_res_track2      |   |
| p23_res_track3      |   |"
Unknown,"And I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
When I send a 33.00 EMV Transaction Initiation message to the terminal with:
| p33_00_req_status                  | 00 |
| p33_00_req_emvh_current_packet_nbr | 0  |
| p33_00_req_emvh_packet_type        | 0  |
Then I Wait until Element ""title"" contains ""Please wait\nDo not remove card""
And  I should receive the 33.00 Emv Transaction Initiation response from terminal with params:
| p33_00_res_status                  | 00 |
| p33_00_res_emvh_current_packet_nbr | 0  |
| p33_00_res_emvh_packet_type        | 0  |
And I should receive the 33.02 Emv Transaction track2 response from terminal with params:
| p33_02_res_status                  | 00         |
| p33_02_res_emvh_current_packet_nbr | 0          |
| p33_02_res_emvh_packet_type        | 0          |
| p33_02_res_payload                 | @regexp:.+ |
####################### 33.02 payload verification #######################
When  I deserialize ""p33_02_res_payload"" value from the response object to the ""track2_equivalent_data"" container
Then  the reported ""track2_equivalent_data"" container should have the following params:
| tag    | name                         | value                                                 |
| 0x4F   | application_identifier       | <AID>03                                               |
| 0x50   | application_label            | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x57   | track_2_equivalent_data      | <PAN>D<exp_date><code><add_data>F                     |
| 0x5A   | Primary_Account_Number_(PAN) | <PAN>                                                 |
| 0x84   | dedicated_file_df_name       | <AID>03                                               |
| 0x5F20 | cardholder_name              | UICC<test_card>                                       |
| 0x5F24 | application_expiration_date  | <exp_date>31                                          |
| 0x5F28 | Issuer_Country_Code          | 0156                                                  |
| 0x5F2D | preferred_languages          | zh                                                    |
| 0x9F07 | Application_Usage_Control    | FF00                                                  |
| 0x9F09 | Application_Version_Number   | @regexp:\d{4}                                         |
| 0x9F1A | Terminal_Country_Code        | 0840                                                  |
| 0x9F1B | Terminal_Floor_Limit         | 00000000                                              |
| 0x9F1F | Track1_Discretionary_Data    | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| 0xFF25 | Encryption_Whitelisting_Mode | 00                                                    |
| 0x100E | User_Language                | EN                                                    |
#####################################################################
When I send a 04.x Set Payment Type message to the terminal with params:
| p04_req_force_payment_type | 1   |
| p04_req_payment_type       | B   |
| p04_req_amount             | 000 |
Then I should receive the 04.x Set Payment Type response from terminal with params:
| p04_res_force_payment_type | 0   |
| p04_res_payment_type       | B   |
| p04_res_amount             | 000 |"
Send Amount,"When I send a 13.x amount message to the terminal with:
| p13_req_amount | <amount> |
Then I should receive the 13.x amount response from terminal with params:
| p13_res_status | 0 |"
Unknown,"And I wait until Element ""btn_enter"" visible
When I click Element ""btn_enter"""
Unknown,"Then I should receive the 33.03 Emv Transaction authorization_request response from terminal with params:
| p33_03_req_status                  | 00         |
| p33_03_req_emvh_current_packet_nbr | 0          |
| p33_03_req_emvh_packet_type        | 0          |
| p33_03_req_payload                 | @regexp:.+ |
####################### 33.03 payload verification #######################
When I deserialize ""p33_03_res_payload"" value from the response object to the ""authorization_request_data"" container
Then the reported ""authorization_request_data"" container should have the following params:
| tag    | name                                       | value                                                 |
| 0x4F   | application_identifier                     | <AID>03                                               |
| 0x50   | Application_Label                          | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F                     |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x84   | dedicated_file_df_name                     | <AID>03                                               |
| 0x95   | terminal_verification_results              | 000800E000                                            |
| 0x9A   | transaction_date                           | @regexp:\d{6}                                         |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9C   | transaction_type (Purchase)                | 00                                                    |
| 0x5F20 | cardholder_name                            | UICC<test_card>                                       |
| 0x5F24 | application_expiration_date                | <exp_date>31                                          |
| 0x5F2A | Transaction_Currency_Code                  | 0840                                                  |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                                        |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>03                                               |
| 0x9F07 | Application_Usage_Control                  | FF00                                                  |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                                         |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                                         |
| 0x9F0D | issuer_action_code_default                 | FC6004A800                                            |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                                            |
| 0x9F0F | issuer_action_code_online                  | FC6804F800                                            |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F1A | terminal_country_code                      | 0840                                                  |
| 0x9F1B | terminal_floor_limit                       | 00000000                                              |
| 0x9F1F | Track1_Discretionary_Data                  | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                                         |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F27 | cryptogram_information_data                | 80                                                    |
| 0x9F33 | terminal_capabilities                      | E0F8C8                                                |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300                                  |
| 0x9F35 | terminal_type                              | 22                                                    |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                                    |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                                            |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                                    |
#Ingenico property
| 0x1001 | pin_entry_required_flag                    | 0                                                     |
| 0x1002 | signature_required_flag                    | 1                                                     |
| 0x1005 | transaction_type                           | 00                                                    |
| 0x100E | User_Language                              | EN                                                    |
| 0x100F | pin_entry_successful_flag                  | 0                                                     |
| 0x9000 | card_payment_type                          | B                                                     |
| 0x9001 | card_entry_mode                            | C                                                     |
#####################################################################
When I send a 33.04 Authorization Response message to the terminal with params:
| p33_04_res_status                  | 00             |
| p33_04_res_emvh_current_packet_nbr | 0              |
| p33_04_res_emvh_packet_type        | 0              |
| p33_04_res_payload                 | T008A:0002:a00 |
Then I should receive the 33.05 Emv authorization confirmation response from terminal with params:
| p33_05_res_status                  | 00         |
| p33_05_res_emvh_current_packet_nbr | 0          |
| p33_05_res_emvh_packet_type        | 0          |
| p33_05_res_payload                 | @regexp:.* |
####################### 33.05 payload verification #######################
When  I deserialize ""p33_05_res_payload"" value from the response object to the ""authorization_confirmation_data"" container
Then  the reported ""authorization_confirmation_data"" container should have the following params:
| tag    | name                                       | value                                                 |
| 0x4F   | application_identifier                     | <AID>03                                               |
| 0x50   | Application_Label                          | @regexp:[\s]{4}62[\s]{4}IC[\s]{2}                     |
| 0x57   | track_2_equivalent_data                    | <PAN>D<exp_date><code><add_data>F                     |
| 0x82   | application_interchange_profile            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x84   | dedicated_file_df_name                     | <AID>03                                               |
| 0x89   | Authorization_Code                         | 3030                                                  |
| 0x8A   | authorisation_response_code                | 00                                                    |
| 0x8E   | cardholder_verification_method_cvm_list    | 00000000000000005E0342031F00                          |
| 0x95   | terminal_verification_results              | 000800E000                                            |
| 0x9A   | transaction_date                           | @regexp:\d{6}                                         |
| 0x9B   | Transaction_Status_Information             | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9C   | transaction_type (Purchase)                | 00                                                    |
| 0x5F20 | cardholder_name                            | UICC<test_card>                                       |
| 0x5F24 | application_expiration_date                | <exp_date>31                                          |
| 0x5F28 | Issuer_Country_Code                        | 0156                                                  |
| 0x5F2A | Transaction_Currency_Code                  | 0840                                                  |
| 0x5F2D | Preferred_Languages                        | zh                                                    |
| 0x9F02 | amount_authorised_kernel_v2                | 000000<amount>                                        |
| 0x9F06 | Application_Identifier_(AID)_Terminal      | <AID>03                                               |
| 0x9F07 | Application_Usage_Control                  | FF00                                                  |
| 0x9F08 | Application_Version_Number_ICC             | @regexp:\d{4}                                         |
| 0x9F09 | Application_Version_Number_Terminal        | @regexp:\d{4}                                         |
| 0x9F0D | issuer_action_code_default                 | FC6004A800                                            |
| 0x9F0E | issuer_action_code_denial                  | 0010000000                                            |
| 0x9F0F | issuer_action_code_online                  | FC6804F800                                            |
| 0x9F10 | Issuer_Application_Data_(IAD)              | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F1A | terminal_country_code                      | 0840                                                  |
| 0x9F1B | terminal_floor_limit                       | 00000000                                              |
| 0x9F1F | Track1_Discretionary_Data                  | <PAN>^UICC<test_card>^<exp_date><code>^20130821105304 |
| 0x9F21 | Transaction_Time                           | @regexp:\d{6}                                         |
| 0x9F26 | application_cryptogram                     | @regexp:[0-9A-Fa-f]{16}                               |
| 0x9F27 | cryptogram_information_data                | 40                                                    |
| 0x9F33 | terminal_capabilities                      | E0F8C8                                                |
| 0x9F34 | cardholder_verification_method_cvm_results | @regexp:[15]{1}E0300                                  |
| 0x9F35 | terminal_type                              | 22                                                    |
| 0x9F36 | Application_Transaction_Counter            | @regexp:[0-9A-Fa-f]{4}                                |
| 0x9F39 | point_of_service_pos_entry_mode            | 05                                                    |
| 0x9F40 | Additional_Terminal_Capabilities           | F800F0A3FF                                            |
| 0xDF03 | Terminal_Action_Code_(TAC)_Default         | D84000A800                                            |
| 0xDF04 | Terminal_Action_Code_Denial                | 0010000000                                            |
| 0xDF05 | Terminal_Action_Code_Online                | D84004F800                                            |
| 0xFF25 | Encryption_Whitelisting_Mode               | 00                                                    |
#Ingenico property
| 0x1001 | pin_entry_required_flag                    | 0                                                     |
| 0x1002 | signature_required_flag                    | 1                                                     |
| 0x1003 | Confirmation_Response_Code                 | A                                                     |
| 0x1005 | transaction_type                           | 00                                                    |
| 0x100E | User_Language                              | EN                                                    |
| 0x100F | pin_entry_successful_flag                  | 0                                                     |
| 0x9000 | card_payment_type                          | B                                                     |
| 0x9001 | card_entry_mode                            | C                                                     |
#####################################################################
And I Wait until Element ""title"" contains ""Approved\nPlease remove card""
When  I remove card
And I wait 4 seconds
Then I should receive the 09.x Set Allowed Payments response from terminal with params:
| p09_res_card_type        | 02 |
| p09_res_msg_version      | 02 |
| p09_res_transaction_type | 01 |
| p09_res_card_status      | R  |
And I Wait until Element ""title"" contains ""Approved""
####################### Terminal Offline #######################"
Precondition,"When I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
####################### Manual Validations #######################
#No manual validation
####################### Finalize collis #######################"
Unknown,"When I finalizing Collis Test Case as ""approved""
Then I expect Collis Test Case to be ""passed""
Examples:
| test_case    | AID            | app_label        | PAN              | test_card | exp_date | code | add_data      | amount |
| TAIS_POS_005 | A0000003330101 | UICC Credit Card | 6210948000000052 | FT05      | 3010     | 220  | 0000000000000 | 500000 |
@sde @msr @jobs @00x @62x @61x @23x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Jobs for MSR transaction
""""""
This feature file validate jobs for Msr Transactions config (0091, 0054)
Jobs values allowed for msr:
0 : Track 1
2 : Track 2
6 : PAN from Track1
7 : PAN from Track2,
10 Expiry date from Track1
11 Expiry date from Track2
14 Cardholder name from Track1
18 :Track1 no sentinels
19 :Track2 no sentinels
TestLink test case link: https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1033
""""""
Scenario: Enable On-Guard SDE Encryption Configuration and Update jobs values(7 =PAN from Track2, 2 = Track-2 data, 10 Expiry date from Track1)"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_config_name | ArcSec/onGuardSde/jobsMsr |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2                         |
| p61_res_config_name           | ArcSec/onGuardSde/jobsMsr |
| p61_res_data_config_parameter | 18,19                     |"
Unknown,"When I have successfully sent ""Files/Jobs_Msr/ArcSec.apk"" file using these params:
| p62_req_file_name       | ArcSec.apk |
| p62_req_encoding_format | B          |
| p62_req_fast_download   | 1          |
| p62_req_unpack_flag     | 0          |
Then I should receive the 62.x Write File response from terminal with params:
| p62_res_status      | 0            |
| p62_res_file_length | @regexp:.\d* |"
Precondition,"When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_config_name | ArcSec/onGuardSde/jobsMsr |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2                         |
| p61_res_config_name           | ArcSec/onGuardSde/jobsMsr |
| p61_res_data_config_parameter | 7,2,10                    |
Scenario Outline: On-Guard SDE Encryption For MSR Transaction
Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible
When I send a 61.x Read Configuration message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Read Configuration response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 19 |
And I Wait until Element ""title"" contains ""This Lane Closed""
And I wait until Element ""imageOffline"" visible"
Card Swipe,"When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0                                                            |
| p23_res_card_source | M                                                            |
| p23_res_track1      | %B<masked_pan>^<name>^<exp_date><code><masked_disc_data_t1>? |
| p23_res_track2      | ;<masked_pan>=<exp_date><code><masked_disc_data_t2>?         |
| p23_res_track3      | @regexp:.+                                                   |"
Unknown,"And decrypted field ""p23_res_track3"" with ON GUARD SDE algorithm should match the following data:
| result | <pan>\|;<pan>=<exp_date><code><disc_data_t2>?<lrc_val>\|<exp_date><null_characters> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      | masked_pan       | masked_disc_data_t1          | masked_disc_data_t2 | null_characters          | lrc_val |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 | 5413330000000011 | 000000000000000              | 0000000000000       | \x00\x00                 | 9       |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      | 374245000001008  | 000000000                    | 00000000000000      | \x00\x00\x00             | 4       |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      | 4264510000005621 | 0000000000000000000000000000 | 0000000000000       | \x00\x00                 | 2       |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      | 6510000000000091 | 0000000000000                | 0000000000000       | \x00\x00                 | 4       |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 36039600000472   | 00000000000000000000         | 0000000000000       | \x00\x00\x00\x00\x00\x00 | 4       |
| VISA       | 4761739001010010 | Test Card 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 4761730000000010 | 00000000000000000000         | 0000000000000       | \x00\x00                 | 6       |
| Mastercard | 5413330089099130 | Test Card 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 | 5413330000009130 | 00000000000000000000         | 0000000000000       | \x00\x00                 | 9       |
@msr @tep2 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Voltage Encryption Tep2 for MSR Transaction
""""""
This feature file validates Voltage Encryption TEP2 for MSR Transaction.
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1228
""""""
Scenario Outline: Voltage TEP2 Encryption for MSR transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Card Swipe,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 5  |
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |"
Unknown,"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |"
Unknown,"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |"
Unknown,"@msr @tep4 @voltage @00x @62x @61x @23x @29x @dx8000 @ex8000 @dx4000 @rx5000 @rx7000
Feature: Validate Voltage Encryption Tep4 for MSR Transaction
""""""
This feature file validates Voltage Encryption Tep4 for MSR Transaction.
TestLink test case link :https://testlink.evf.us/linkto.php?tprojectPrefix=ARC&item=testcase&id=ARC-1236
""""""
Scenario Outline: Voltage TEP4 Encryption for MSR transaction"
Precondition,"Given I send a 00.x Offline message to the terminal with params:
| p00_req_reason_code | 0000 |
Then I should receive the 00.x Offline response from terminal with params:
| p00_res_reason_code | 0000 |
And I Wait until Element ""title"" contains ""This Lane Closed"""
Card Swipe,"When I send a 61.x Configuration Read message to the terminal with:
| p61_req_group_num | 91 |
| p61_req_index_num | 1  |
Then I should receive the 61.x Configuration Read response from terminal with params:
| p61_res_status                | 2  |
| p61_res_group_num             | 91 |
| p61_res_index_num             | 1  |
| p61_res_data_config_parameter | 6  |
When I send a 23.x Read Card message to the terminal with:
| p23_req_prompt_index   | 3 |
| p23_req_enable_devices | M |
Then I Wait until Element ""title"" contains ""Please slide card""
And  I wait until Element ""btn_cancel"" visible"
Card Swipe,"When Axium swipe magnetic card:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
| track2 | <pan>=<exp_date><code><disc_data_t2>         |
| track3 | <additional_data><additional_data>           |
Then I should receive the 23.x Card Read response from terminal with params:
| p23_res_exit_type   | 0          |
| p23_res_card_source | M          |
| p23_res_track1      | @regexp:.* |
| p23_res_track2      | @regexp:.* |
| p23_res_track3      | @regexp:.* |"
Unknown,"And decrypted field 'p23_res_track1' with VOLTAGE algorithm should match the following:
| track1 | B<pan>^<name>^<exp_date><code><disc_data_t1> |
And decrypted field 'p23_res_track2' with VOLTAGE algorithm should match the following:
| track2 | <pan>=<exp_date><code><disc_data_t2> |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 398 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000398     |
| p29_res_variable_data | @regexp:.* |"
Unknown,"And decrypted field 'p29_res_variable_data' with VOLTAGE algorithm should match the following:
| pan | <pan> |"
Extract Card Data,"When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 399 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2      |
| p29_res_variable_id   | 000399 |
| p29_res_variable_data | <name> |
When I send a 29.x Get Variable message to the terminal with:
| p29_req_variable_id | 400 |
Then I should receive the 29.x Get Variable response from terminal with params:
| p29_res_status        | 2          |
| p29_res_variable_id   | 000400     |
| p29_res_variable_data | <exp_date> |
Examples:
| card_type  | pan              | name               | exp_date | code | disc_data_t1                 | disc_data_t2   | additional_data      |
| Mastercard | 5413330089020011 | TEST/CARD          | 2412     | 221  | 000000140000000              | 0000014000001  | 01234567890123456789 |
| Amex       | 374245001731008  | XP CARD 07/VER 2.0 | 2103     | 201  | 150412345                    | 15041234500000 |                      |
| VISA       | 4264510228395621 | JOHN/SMITH         | 1709     | 206  | 0000000000000000000704001000 | 0000070400100  |                      |
| DISCOVER   | 6510000000000091 | CARD/IMAGE 09      | 1712     | 702  | 1000041300000                | 1000041300000  |                      |
| Diners     | 36039667170472   | PETTITT/JO         | 0012     | 521  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| VISA       | 4761739001010010 | TEST CARD 04       | 2212     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |
| Mastercard | 5413330089099130 | TEST CARD 20       | 2512     | 201  | 16010000000000000946         | 1000041300000  | 01234567890123456789 |"
